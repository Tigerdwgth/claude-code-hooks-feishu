(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))a(c);new MutationObserver(c=>{for(const h of c)if(h.type==="childList")for(const d of h.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function n(c){const h={};return c.integrity&&(h.integrity=c.integrity),c.referrerPolicy&&(h.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?h.credentials="include":c.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function a(c){if(c.ep)return;c.ep=!0;const h=n(c);fetch(c.href,h)}})();var Zh={exports:{}},gl={};var Hp;function vb(){if(Hp)return gl;Hp=1;var t=Symbol.for("react.transitional.element"),i=Symbol.for("react.fragment");function n(a,c,h){var d=null;if(h!==void 0&&(d=""+h),c.key!==void 0&&(d=""+c.key),"key"in c){h={};for(var p in c)p!=="key"&&(h[p]=c[p])}else h=c;return c=h.ref,{$$typeof:t,type:a,key:d,ref:c!==void 0?c:null,props:h}}return gl.Fragment=i,gl.jsx=n,gl.jsxs=n,gl}var Up;function yb(){return Up||(Up=1,Zh.exports=vb()),Zh.exports}var T=yb(),Qh={exports:{}},Le={};var Ip;function Sb(){if(Ip)return Le;Ip=1;var t=Symbol.for("react.transitional.element"),i=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),h=Symbol.for("react.consumer"),d=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),_=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),b=Symbol.for("react.activity"),E=Symbol.iterator;function R(A){return A===null||typeof A!="object"?null:(A=E&&A[E]||A["@@iterator"],typeof A=="function"?A:null)}var D={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,V={};function X(A,U,L){this.props=A,this.context=U,this.refs=V,this.updater=L||D}X.prototype.isReactComponent={},X.prototype.setState=function(A,U){if(typeof A!="object"&&typeof A!="function"&&A!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,U,"setState")},X.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};function he(){}he.prototype=X.prototype;function te(A,U,L){this.props=A,this.context=U,this.refs=V,this.updater=L||D}var ue=te.prototype=new he;ue.constructor=te,k(ue,X.prototype),ue.isPureReactComponent=!0;var de=Array.isArray;function _e(){}var q={H:null,A:null,T:null,S:null},ge=Object.prototype.hasOwnProperty;function Y(A,U,L){var z=L.ref;return{$$typeof:t,type:A,key:U,ref:z!==void 0?z:null,props:L}}function re(A,U){return Y(A.type,U,A.props)}function ee(A){return typeof A=="object"&&A!==null&&A.$$typeof===t}function Q(A){var U={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function(L){return U[L]})}var j=/\/+/g;function ne(A,U){return typeof A=="object"&&A!==null&&A.key!=null?Q(""+A.key):U.toString(36)}function ce(A){switch(A.status){case"fulfilled":return A.value;case"rejected":throw A.reason;default:switch(typeof A.status=="string"?A.then(_e,_e):(A.status="pending",A.then(function(U){A.status==="pending"&&(A.status="fulfilled",A.value=U)},function(U){A.status==="pending"&&(A.status="rejected",A.reason=U)})),A.status){case"fulfilled":return A.value;case"rejected":throw A.reason}}throw A}function O(A,U,L,z,$){var I=typeof A;(I==="undefined"||I==="boolean")&&(A=null);var ae=!1;if(A===null)ae=!0;else switch(I){case"bigint":case"string":case"number":ae=!0;break;case"object":switch(A.$$typeof){case t:case i:ae=!0;break;case y:return ae=A._init,O(ae(A._payload),U,L,z,$)}}if(ae)return $=$(A),ae=z===""?"."+ne(A,0):z,de($)?(L="",ae!=null&&(L=ae.replace(j,"$&/")+"/"),O($,U,L,"",function(Ae){return Ae})):$!=null&&(ee($)&&($=re($,L+($.key==null||A&&A.key===$.key?"":(""+$.key).replace(j,"$&/")+"/")+ae)),U.push($)),1;ae=0;var ye=z===""?".":z+":";if(de(A))for(var fe=0;fe<A.length;fe++)z=A[fe],I=ye+ne(z,fe),ae+=O(z,U,L,I,$);else if(fe=R(A),typeof fe=="function")for(A=fe.call(A),fe=0;!(z=A.next()).done;)z=z.value,I=ye+ne(z,fe++),ae+=O(z,U,L,I,$);else if(I==="object"){if(typeof A.then=="function")return O(ce(A),U,L,z,$);throw U=String(A),Error("Objects are not valid as a React child (found: "+(U==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":U)+"). If you meant to render a collection of children, use an array instead.")}return ae}function Z(A,U,L){if(A==null)return A;var z=[],$=0;return O(A,z,"","",function(I){return U.call(L,I,$++)}),z}function N(A){if(A._status===-1){var U=A._result;U=U(),U.then(function(L){(A._status===0||A._status===-1)&&(A._status=1,A._result=L)},function(L){(A._status===0||A._status===-1)&&(A._status=2,A._result=L)}),A._status===-1&&(A._status=0,A._result=U)}if(A._status===1)return A._result.default;throw A._result}var me=typeof reportError=="function"?reportError:function(A){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var U=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof A=="object"&&A!==null&&typeof A.message=="string"?String(A.message):String(A),error:A});if(!window.dispatchEvent(U))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",A);return}console.error(A)},we={map:Z,forEach:function(A,U,L){Z(A,function(){U.apply(this,arguments)},L)},count:function(A){var U=0;return Z(A,function(){U++}),U},toArray:function(A){return Z(A,function(U){return U})||[]},only:function(A){if(!ee(A))throw Error("React.Children.only expected to receive a single React element child.");return A}};return Le.Activity=b,Le.Children=we,Le.Component=X,Le.Fragment=n,Le.Profiler=c,Le.PureComponent=te,Le.StrictMode=a,Le.Suspense=m,Le.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=q,Le.__COMPILER_RUNTIME={__proto__:null,c:function(A){return q.H.useMemoCache(A)}},Le.cache=function(A){return function(){return A.apply(null,arguments)}},Le.cacheSignal=function(){return null},Le.cloneElement=function(A,U,L){if(A==null)throw Error("The argument must be a React element, but you passed "+A+".");var z=k({},A.props),$=A.key;if(U!=null)for(I in U.key!==void 0&&($=""+U.key),U)!ge.call(U,I)||I==="key"||I==="__self"||I==="__source"||I==="ref"&&U.ref===void 0||(z[I]=U[I]);var I=arguments.length-2;if(I===1)z.children=L;else if(1<I){for(var ae=Array(I),ye=0;ye<I;ye++)ae[ye]=arguments[ye+2];z.children=ae}return Y(A.type,$,z)},Le.createContext=function(A){return A={$$typeof:d,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null},A.Provider=A,A.Consumer={$$typeof:h,_context:A},A},Le.createElement=function(A,U,L){var z,$={},I=null;if(U!=null)for(z in U.key!==void 0&&(I=""+U.key),U)ge.call(U,z)&&z!=="key"&&z!=="__self"&&z!=="__source"&&($[z]=U[z]);var ae=arguments.length-2;if(ae===1)$.children=L;else if(1<ae){for(var ye=Array(ae),fe=0;fe<ae;fe++)ye[fe]=arguments[fe+2];$.children=ye}if(A&&A.defaultProps)for(z in ae=A.defaultProps,ae)$[z]===void 0&&($[z]=ae[z]);return Y(A,I,$)},Le.createRef=function(){return{current:null}},Le.forwardRef=function(A){return{$$typeof:p,render:A}},Le.isValidElement=ee,Le.lazy=function(A){return{$$typeof:y,_payload:{_status:-1,_result:A},_init:N}},Le.memo=function(A,U){return{$$typeof:_,type:A,compare:U===void 0?null:U}},Le.startTransition=function(A){var U=q.T,L={};q.T=L;try{var z=A(),$=q.S;$!==null&&$(L,z),typeof z=="object"&&z!==null&&typeof z.then=="function"&&z.then(_e,me)}catch(I){me(I)}finally{U!==null&&L.types!==null&&(U.types=L.types),q.T=U}},Le.unstable_useCacheRefresh=function(){return q.H.useCacheRefresh()},Le.use=function(A){return q.H.use(A)},Le.useActionState=function(A,U,L){return q.H.useActionState(A,U,L)},Le.useCallback=function(A,U){return q.H.useCallback(A,U)},Le.useContext=function(A){return q.H.useContext(A)},Le.useDebugValue=function(){},Le.useDeferredValue=function(A,U){return q.H.useDeferredValue(A,U)},Le.useEffect=function(A,U){return q.H.useEffect(A,U)},Le.useEffectEvent=function(A){return q.H.useEffectEvent(A)},Le.useId=function(){return q.H.useId()},Le.useImperativeHandle=function(A,U,L){return q.H.useImperativeHandle(A,U,L)},Le.useInsertionEffect=function(A,U){return q.H.useInsertionEffect(A,U)},Le.useLayoutEffect=function(A,U){return q.H.useLayoutEffect(A,U)},Le.useMemo=function(A,U){return q.H.useMemo(A,U)},Le.useOptimistic=function(A,U){return q.H.useOptimistic(A,U)},Le.useReducer=function(A,U,L){return q.H.useReducer(A,U,L)},Le.useRef=function(A){return q.H.useRef(A)},Le.useState=function(A){return q.H.useState(A)},Le.useSyncExternalStore=function(A,U,L){return q.H.useSyncExternalStore(A,U,L)},Le.useTransition=function(){return q.H.useTransition()},Le.version="19.2.4",Le}var jp;function md(){return jp||(jp=1,Qh.exports=Sb()),Qh.exports}var K=md(),Jh={exports:{}},pl={},eu={exports:{}},tu={};var Wp;function bb(){return Wp||(Wp=1,(function(t){function i(O,Z){var N=O.length;O.push(Z);e:for(;0<N;){var me=N-1>>>1,we=O[me];if(0<c(we,Z))O[me]=Z,O[N]=we,N=me;else break e}}function n(O){return O.length===0?null:O[0]}function a(O){if(O.length===0)return null;var Z=O[0],N=O.pop();if(N!==Z){O[0]=N;e:for(var me=0,we=O.length,A=we>>>1;me<A;){var U=2*(me+1)-1,L=O[U],z=U+1,$=O[z];if(0>c(L,N))z<we&&0>c($,L)?(O[me]=$,O[z]=N,me=z):(O[me]=L,O[U]=N,me=U);else if(z<we&&0>c($,N))O[me]=$,O[z]=N,me=z;else break e}}return Z}function c(O,Z){var N=O.sortIndex-Z.sortIndex;return N!==0?N:O.id-Z.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var h=performance;t.unstable_now=function(){return h.now()}}else{var d=Date,p=d.now();t.unstable_now=function(){return d.now()-p}}var m=[],_=[],y=1,b=null,E=3,R=!1,D=!1,k=!1,V=!1,X=typeof setTimeout=="function"?setTimeout:null,he=typeof clearTimeout=="function"?clearTimeout:null,te=typeof setImmediate<"u"?setImmediate:null;function ue(O){for(var Z=n(_);Z!==null;){if(Z.callback===null)a(_);else if(Z.startTime<=O)a(_),Z.sortIndex=Z.expirationTime,i(m,Z);else break;Z=n(_)}}function de(O){if(k=!1,ue(O),!D)if(n(m)!==null)D=!0,_e||(_e=!0,Q());else{var Z=n(_);Z!==null&&ce(de,Z.startTime-O)}}var _e=!1,q=-1,ge=5,Y=-1;function re(){return V?!0:!(t.unstable_now()-Y<ge)}function ee(){if(V=!1,_e){var O=t.unstable_now();Y=O;var Z=!0;try{e:{D=!1,k&&(k=!1,he(q),q=-1),R=!0;var N=E;try{t:{for(ue(O),b=n(m);b!==null&&!(b.expirationTime>O&&re());){var me=b.callback;if(typeof me=="function"){b.callback=null,E=b.priorityLevel;var we=me(b.expirationTime<=O);if(O=t.unstable_now(),typeof we=="function"){b.callback=we,ue(O),Z=!0;break t}b===n(m)&&a(m),ue(O)}else a(m);b=n(m)}if(b!==null)Z=!0;else{var A=n(_);A!==null&&ce(de,A.startTime-O),Z=!1}}break e}finally{b=null,E=N,R=!1}Z=void 0}}finally{Z?Q():_e=!1}}}var Q;if(typeof te=="function")Q=function(){te(ee)};else if(typeof MessageChannel<"u"){var j=new MessageChannel,ne=j.port2;j.port1.onmessage=ee,Q=function(){ne.postMessage(null)}}else Q=function(){X(ee,0)};function ce(O,Z){q=X(function(){O(t.unstable_now())},Z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(O){O.callback=null},t.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ge=0<O?Math.floor(1e3/O):5},t.unstable_getCurrentPriorityLevel=function(){return E},t.unstable_next=function(O){switch(E){case 1:case 2:case 3:var Z=3;break;default:Z=E}var N=E;E=Z;try{return O()}finally{E=N}},t.unstable_requestPaint=function(){V=!0},t.unstable_runWithPriority=function(O,Z){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var N=E;E=O;try{return Z()}finally{E=N}},t.unstable_scheduleCallback=function(O,Z,N){var me=t.unstable_now();switch(typeof N=="object"&&N!==null?(N=N.delay,N=typeof N=="number"&&0<N?me+N:me):N=me,O){case 1:var we=-1;break;case 2:we=250;break;case 5:we=1073741823;break;case 4:we=1e4;break;default:we=5e3}return we=N+we,O={id:y++,callback:Z,priorityLevel:O,startTime:N,expirationTime:we,sortIndex:-1},N>me?(O.sortIndex=N,i(_,O),n(m)===null&&O===n(_)&&(k?(he(q),q=-1):k=!0,ce(de,N-me))):(O.sortIndex=we,i(m,O),D||R||(D=!0,_e||(_e=!0,Q()))),O},t.unstable_shouldYield=re,t.unstable_wrapCallback=function(O){var Z=E;return function(){var N=E;E=Z;try{return O.apply(this,arguments)}finally{E=N}}}})(tu)),tu}var Fp;function Cb(){return Fp||(Fp=1,eu.exports=bb()),eu.exports}var iu={exports:{}},Ft={};var Pp;function wb(){if(Pp)return Ft;Pp=1;var t=md();function i(m){var _="https://react.dev/errors/"+m;if(1<arguments.length){_+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)_+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+m+"; visit "+_+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var a={d:{f:n,r:function(){throw Error(i(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},c=Symbol.for("react.portal");function h(m,_,y){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:b==null?null:""+b,children:m,containerInfo:_,implementation:y}}var d=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(m,_){if(m==="font")return"";if(typeof _=="string")return _==="use-credentials"?_:""}return Ft.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,Ft.createPortal=function(m,_){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!_||_.nodeType!==1&&_.nodeType!==9&&_.nodeType!==11)throw Error(i(299));return h(m,_,null,y)},Ft.flushSync=function(m){var _=d.T,y=a.p;try{if(d.T=null,a.p=2,m)return m()}finally{d.T=_,a.p=y,a.d.f()}},Ft.preconnect=function(m,_){typeof m=="string"&&(_?(_=_.crossOrigin,_=typeof _=="string"?_==="use-credentials"?_:"":void 0):_=null,a.d.C(m,_))},Ft.prefetchDNS=function(m){typeof m=="string"&&a.d.D(m)},Ft.preinit=function(m,_){if(typeof m=="string"&&_&&typeof _.as=="string"){var y=_.as,b=p(y,_.crossOrigin),E=typeof _.integrity=="string"?_.integrity:void 0,R=typeof _.fetchPriority=="string"?_.fetchPriority:void 0;y==="style"?a.d.S(m,typeof _.precedence=="string"?_.precedence:void 0,{crossOrigin:b,integrity:E,fetchPriority:R}):y==="script"&&a.d.X(m,{crossOrigin:b,integrity:E,fetchPriority:R,nonce:typeof _.nonce=="string"?_.nonce:void 0})}},Ft.preinitModule=function(m,_){if(typeof m=="string")if(typeof _=="object"&&_!==null){if(_.as==null||_.as==="script"){var y=p(_.as,_.crossOrigin);a.d.M(m,{crossOrigin:y,integrity:typeof _.integrity=="string"?_.integrity:void 0,nonce:typeof _.nonce=="string"?_.nonce:void 0})}}else _==null&&a.d.M(m)},Ft.preload=function(m,_){if(typeof m=="string"&&typeof _=="object"&&_!==null&&typeof _.as=="string"){var y=_.as,b=p(y,_.crossOrigin);a.d.L(m,y,{crossOrigin:b,integrity:typeof _.integrity=="string"?_.integrity:void 0,nonce:typeof _.nonce=="string"?_.nonce:void 0,type:typeof _.type=="string"?_.type:void 0,fetchPriority:typeof _.fetchPriority=="string"?_.fetchPriority:void 0,referrerPolicy:typeof _.referrerPolicy=="string"?_.referrerPolicy:void 0,imageSrcSet:typeof _.imageSrcSet=="string"?_.imageSrcSet:void 0,imageSizes:typeof _.imageSizes=="string"?_.imageSizes:void 0,media:typeof _.media=="string"?_.media:void 0})}},Ft.preloadModule=function(m,_){if(typeof m=="string")if(_){var y=p(_.as,_.crossOrigin);a.d.m(m,{as:typeof _.as=="string"&&_.as!=="script"?_.as:void 0,crossOrigin:y,integrity:typeof _.integrity=="string"?_.integrity:void 0})}else a.d.m(m)},Ft.requestFormReset=function(m){a.d.r(m)},Ft.unstable_batchedUpdates=function(m,_){return m(_)},Ft.useFormState=function(m,_,y){return d.H.useFormState(m,_,y)},Ft.useFormStatus=function(){return d.H.useHostTransitionStatus()},Ft.version="19.2.4",Ft}var Yp;function xb(){if(Yp)return iu.exports;Yp=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(i){console.error(i)}}return t(),iu.exports=wb(),iu.exports}var qp;function Eb(){if(qp)return pl;qp=1;var t=Cb(),i=md(),n=xb();function a(s){var r="https://react.dev/errors/"+s;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)r+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+s+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function c(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function h(s){var r=s,l=s;if(s.alternate)for(;r.return;)r=r.return;else{s=r;do r=s,(r.flags&4098)!==0&&(l=r.return),s=r.return;while(s)}return r.tag===3?l:null}function d(s){if(s.tag===13){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function p(s){if(s.tag===31){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function m(s){if(h(s)!==s)throw Error(a(188))}function _(s){var r=s.alternate;if(!r){if(r=h(s),r===null)throw Error(a(188));return r!==s?null:s}for(var l=s,o=r;;){var u=l.return;if(u===null)break;var f=u.alternate;if(f===null){if(o=u.return,o!==null){l=o;continue}break}if(u.child===f.child){for(f=u.child;f;){if(f===l)return m(u),s;if(f===o)return m(u),r;f=f.sibling}throw Error(a(188))}if(l.return!==o.return)l=u,o=f;else{for(var v=!1,x=u.child;x;){if(x===l){v=!0,l=u,o=f;break}if(x===o){v=!0,o=u,l=f;break}x=x.sibling}if(!v){for(x=f.child;x;){if(x===l){v=!0,l=f,o=u;break}if(x===o){v=!0,o=f,l=u;break}x=x.sibling}if(!v)throw Error(a(189))}}if(l.alternate!==o)throw Error(a(190))}if(l.tag!==3)throw Error(a(188));return l.stateNode.current===l?s:r}function y(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s;for(s=s.child;s!==null;){if(r=y(s),r!==null)return r;s=s.sibling}return null}var b=Object.assign,E=Symbol.for("react.element"),R=Symbol.for("react.transitional.element"),D=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),V=Symbol.for("react.strict_mode"),X=Symbol.for("react.profiler"),he=Symbol.for("react.consumer"),te=Symbol.for("react.context"),ue=Symbol.for("react.forward_ref"),de=Symbol.for("react.suspense"),_e=Symbol.for("react.suspense_list"),q=Symbol.for("react.memo"),ge=Symbol.for("react.lazy"),Y=Symbol.for("react.activity"),re=Symbol.for("react.memo_cache_sentinel"),ee=Symbol.iterator;function Q(s){return s===null||typeof s!="object"?null:(s=ee&&s[ee]||s["@@iterator"],typeof s=="function"?s:null)}var j=Symbol.for("react.client.reference");function ne(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===j?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case k:return"Fragment";case X:return"Profiler";case V:return"StrictMode";case de:return"Suspense";case _e:return"SuspenseList";case Y:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case D:return"Portal";case te:return s.displayName||"Context";case he:return(s._context.displayName||"Context")+".Consumer";case ue:var r=s.render;return s=s.displayName,s||(s=r.displayName||r.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case q:return r=s.displayName||null,r!==null?r:ne(s.type)||"Memo";case ge:r=s._payload,s=s._init;try{return ne(s(r))}catch{}}return null}var ce=Array.isArray,O=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,N={pending:!1,data:null,method:null,action:null},me=[],we=-1;function A(s){return{current:s}}function U(s){0>we||(s.current=me[we],me[we]=null,we--)}function L(s,r){we++,me[we]=s.current,s.current=r}var z=A(null),$=A(null),I=A(null),ae=A(null);function ye(s,r){switch(L(I,r),L($,s),L(z,null),r.nodeType){case 9:case 11:s=(s=r.documentElement)&&(s=s.namespaceURI)?lp(s):0;break;default:if(s=r.tagName,r=r.namespaceURI)r=lp(r),s=ap(r,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}U(z),L(z,s)}function fe(){U(z),U($),U(I)}function Ae(s){s.memoizedState!==null&&L(ae,s);var r=z.current,l=ap(r,s.type);r!==l&&(L($,s),L(z,l))}function Se(s){$.current===s&&(U(z),U($)),ae.current===s&&(U(ae),ul._currentValue=N)}var Be,De;function Wt(s){if(Be===void 0)try{throw Error()}catch(l){var r=l.stack.trim().match(/\n( *(at )?)/);Be=r&&r[1]||"",De=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Be+s+De}var Gi=!1;function Ar(s,r){if(!s||Gi)return"";Gi=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var o={DetermineComponentFrameRoot:function(){try{if(r){var le=function(){throw Error()};if(Object.defineProperty(le.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(le,[])}catch(G){var P=G}Reflect.construct(s,[],le)}else{try{le.call()}catch(G){P=G}s.call(le.prototype)}}else{try{throw Error()}catch(G){P=G}(le=s())&&typeof le.catch=="function"&&le.catch(function(){})}}catch(G){if(G&&P&&typeof G.stack=="string")return[G.stack,P.stack]}return[null,null]}};o.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var u=Object.getOwnPropertyDescriptor(o.DetermineComponentFrameRoot,"name");u&&u.configurable&&Object.defineProperty(o.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var f=o.DetermineComponentFrameRoot(),v=f[0],x=f[1];if(v&&x){var M=v.split(`
`),F=x.split(`
`);for(u=o=0;o<M.length&&!M[o].includes("DetermineComponentFrameRoot");)o++;for(;u<F.length&&!F[u].includes("DetermineComponentFrameRoot");)u++;if(o===M.length||u===F.length)for(o=M.length-1,u=F.length-1;1<=o&&0<=u&&M[o]!==F[u];)u--;for(;1<=o&&0<=u;o--,u--)if(M[o]!==F[u]){if(o!==1||u!==1)do if(o--,u--,0>u||M[o]!==F[u]){var J=`
`+M[o].replace(" at new "," at ");return s.displayName&&J.includes("<anonymous>")&&(J=J.replace("<anonymous>",s.displayName)),J}while(1<=o&&0<=u);break}}}finally{Gi=!1,Error.prepareStackTrace=l}return(l=s?s.displayName||s.name:"")?Wt(l):""}function jl(s,r){switch(s.tag){case 26:case 27:case 5:return Wt(s.type);case 16:return Wt("Lazy");case 13:return s.child!==r&&r!==null?Wt("Suspense Fallback"):Wt("Suspense");case 19:return Wt("SuspenseList");case 0:case 15:return Ar(s.type,!1);case 11:return Ar(s.type.render,!1);case 1:return Ar(s.type,!0);case 31:return Wt("Activity");default:return""}}function Cn(s){try{var r="",l=null;do r+=jl(s,l),l=s,s=s.return;while(s);return r}catch(o){return`
Error generating stack: `+o.message+`
`+o.stack}}var No=Object.prototype.hasOwnProperty,Ho=t.unstable_scheduleCallback,Uo=t.unstable_cancelCallback,$0=t.unstable_shouldYield,Z0=t.unstable_requestPaint,ri=t.unstable_now,Q0=t.unstable_getCurrentPriorityLevel,Hd=t.unstable_ImmediatePriority,Ud=t.unstable_UserBlockingPriority,Wl=t.unstable_NormalPriority,J0=t.unstable_LowPriority,Id=t.unstable_IdlePriority,ey=t.log,ty=t.unstable_setDisableYieldValue,wn=null,ni=null;function ys(s){if(typeof ey=="function"&&ty(s),ni&&typeof ni.setStrictMode=="function")try{ni.setStrictMode(wn,s)}catch{}}var li=Math.clz32?Math.clz32:ry,iy=Math.log,sy=Math.LN2;function ry(s){return s>>>=0,s===0?32:31-(iy(s)/sy|0)|0}var Fl=256,Pl=262144,Yl=4194304;function Qs(s){var r=s&42;if(r!==0)return r;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function ql(s,r,l){var o=s.pendingLanes;if(o===0)return 0;var u=0,f=s.suspendedLanes,v=s.pingedLanes;s=s.warmLanes;var x=o&134217727;return x!==0?(o=x&~f,o!==0?u=Qs(o):(v&=x,v!==0?u=Qs(v):l||(l=x&~s,l!==0&&(u=Qs(l))))):(x=o&~f,x!==0?u=Qs(x):v!==0?u=Qs(v):l||(l=o&~s,l!==0&&(u=Qs(l)))),u===0?0:r!==0&&r!==u&&(r&f)===0&&(f=u&-u,l=r&-r,f>=l||f===32&&(l&4194048)!==0)?r:u}function xn(s,r){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&r)===0}function ny(s,r){switch(s){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jd(){var s=Yl;return Yl<<=1,(Yl&62914560)===0&&(Yl=4194304),s}function Io(s){for(var r=[],l=0;31>l;l++)r.push(s);return r}function En(s,r){s.pendingLanes|=r,r!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function ly(s,r,l,o,u,f){var v=s.pendingLanes;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=l,s.entangledLanes&=l,s.errorRecoveryDisabledLanes&=l,s.shellSuspendCounter=0;var x=s.entanglements,M=s.expirationTimes,F=s.hiddenUpdates;for(l=v&~l;0<l;){var J=31-li(l),le=1<<J;x[J]=0,M[J]=-1;var P=F[J];if(P!==null)for(F[J]=null,J=0;J<P.length;J++){var G=P[J];G!==null&&(G.lane&=-536870913)}l&=~le}o!==0&&Wd(s,o,0),f!==0&&u===0&&s.tag!==0&&(s.suspendedLanes|=f&~(v&~r))}function Wd(s,r,l){s.pendingLanes|=r,s.suspendedLanes&=~r;var o=31-li(r);s.entangledLanes|=r,s.entanglements[o]=s.entanglements[o]|1073741824|l&261930}function Fd(s,r){var l=s.entangledLanes|=r;for(s=s.entanglements;l;){var o=31-li(l),u=1<<o;u&r|s[o]&r&&(s[o]|=r),l&=~u}}function Pd(s,r){var l=r&-r;return l=(l&42)!==0?1:jo(l),(l&(s.suspendedLanes|r))!==0?0:l}function jo(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Wo(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Yd(){var s=Z.p;return s!==0?s:(s=window.event,s===void 0?32:kp(s.type))}function qd(s,r){var l=Z.p;try{return Z.p=s,r()}finally{Z.p=l}}var Ss=Math.random().toString(36).slice(2),zt="__reactFiber$"+Ss,Xt="__reactProps$"+Ss,Rr="__reactContainer$"+Ss,Fo="__reactEvents$"+Ss,ay="__reactListeners$"+Ss,oy="__reactHandles$"+Ss,Kd="__reactResources$"+Ss,Tn="__reactMarker$"+Ss;function Po(s){delete s[zt],delete s[Xt],delete s[Fo],delete s[ay],delete s[oy]}function Dr(s){var r=s[zt];if(r)return r;for(var l=s.parentNode;l;){if(r=l[Rr]||l[zt]){if(l=r.alternate,r.child!==null||l!==null&&l.child!==null)for(s=_p(s);s!==null;){if(l=s[zt])return l;s=_p(s)}return r}s=l,l=s.parentNode}return null}function kr(s){if(s=s[zt]||s[Rr]){var r=s.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return s}return null}function An(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s.stateNode;throw Error(a(33))}function Mr(s){var r=s[Kd];return r||(r=s[Kd]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function Rt(s){s[Tn]=!0}var Gd=new Set,Xd={};function Js(s,r){Lr(s,r),Lr(s+"Capture",r)}function Lr(s,r){for(Xd[s]=r,s=0;s<r.length;s++)Gd.add(r[s])}var cy=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Vd={},$d={};function hy(s){return No.call($d,s)?!0:No.call(Vd,s)?!1:cy.test(s)?$d[s]=!0:(Vd[s]=!0,!1)}function Kl(s,r,l){if(hy(r))if(l===null)s.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":s.removeAttribute(r);return;case"boolean":var o=r.toLowerCase().slice(0,5);if(o!=="data-"&&o!=="aria-"){s.removeAttribute(r);return}}s.setAttribute(r,""+l)}}function Gl(s,r,l){if(l===null)s.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(r);return}s.setAttribute(r,""+l)}}function Xi(s,r,l,o){if(o===null)s.removeAttribute(l);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttributeNS(r,l,""+o)}}function mi(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Zd(s){var r=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function uy(s,r,l){var o=Object.getOwnPropertyDescriptor(s.constructor.prototype,r);if(!s.hasOwnProperty(r)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var u=o.get,f=o.set;return Object.defineProperty(s,r,{configurable:!0,get:function(){return u.call(this)},set:function(v){l=""+v,f.call(this,v)}}),Object.defineProperty(s,r,{enumerable:o.enumerable}),{getValue:function(){return l},setValue:function(v){l=""+v},stopTracking:function(){s._valueTracker=null,delete s[r]}}}}function Yo(s){if(!s._valueTracker){var r=Zd(s)?"checked":"value";s._valueTracker=uy(s,r,""+s[r])}}function Qd(s){if(!s)return!1;var r=s._valueTracker;if(!r)return!0;var l=r.getValue(),o="";return s&&(o=Zd(s)?s.checked?"true":"false":s.value),s=o,s!==l?(r.setValue(s),!0):!1}function Xl(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var dy=/[\n"\\]/g;function vi(s){return s.replace(dy,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function qo(s,r,l,o,u,f,v,x){s.name="",v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?s.type=v:s.removeAttribute("type"),r!=null?v==="number"?(r===0&&s.value===""||s.value!=r)&&(s.value=""+mi(r)):s.value!==""+mi(r)&&(s.value=""+mi(r)):v!=="submit"&&v!=="reset"||s.removeAttribute("value"),r!=null?Ko(s,v,mi(r)):l!=null?Ko(s,v,mi(l)):o!=null&&s.removeAttribute("value"),u==null&&f!=null&&(s.defaultChecked=!!f),u!=null&&(s.checked=u&&typeof u!="function"&&typeof u!="symbol"),x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?s.name=""+mi(x):s.removeAttribute("name")}function Jd(s,r,l,o,u,f,v,x){if(f!=null&&typeof f!="function"&&typeof f!="symbol"&&typeof f!="boolean"&&(s.type=f),r!=null||l!=null){if(!(f!=="submit"&&f!=="reset"||r!=null)){Yo(s);return}l=l!=null?""+mi(l):"",r=r!=null?""+mi(r):l,x||r===s.value||(s.value=r),s.defaultValue=r}o=o??u,o=typeof o!="function"&&typeof o!="symbol"&&!!o,s.checked=x?s.checked:!!o,s.defaultChecked=!!o,v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(s.name=v),Yo(s)}function Ko(s,r,l){r==="number"&&Xl(s.ownerDocument)===s||s.defaultValue===""+l||(s.defaultValue=""+l)}function Br(s,r,l,o){if(s=s.options,r){r={};for(var u=0;u<l.length;u++)r["$"+l[u]]=!0;for(l=0;l<s.length;l++)u=r.hasOwnProperty("$"+s[l].value),s[l].selected!==u&&(s[l].selected=u),u&&o&&(s[l].defaultSelected=!0)}else{for(l=""+mi(l),r=null,u=0;u<s.length;u++){if(s[u].value===l){s[u].selected=!0,o&&(s[u].defaultSelected=!0);return}r!==null||s[u].disabled||(r=s[u])}r!==null&&(r.selected=!0)}}function ef(s,r,l){if(r!=null&&(r=""+mi(r),r!==s.value&&(s.value=r),l==null)){s.defaultValue!==r&&(s.defaultValue=r);return}s.defaultValue=l!=null?""+mi(l):""}function tf(s,r,l,o){if(r==null){if(o!=null){if(l!=null)throw Error(a(92));if(ce(o)){if(1<o.length)throw Error(a(93));o=o[0]}l=o}l==null&&(l=""),r=l}l=mi(r),s.defaultValue=l,o=s.textContent,o===l&&o!==""&&o!==null&&(s.value=o),Yo(s)}function Or(s,r){if(r){var l=s.firstChild;if(l&&l===s.lastChild&&l.nodeType===3){l.nodeValue=r;return}}s.textContent=r}var fy=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function sf(s,r,l){var o=r.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?o?s.setProperty(r,""):r==="float"?s.cssFloat="":s[r]="":o?s.setProperty(r,l):typeof l!="number"||l===0||fy.has(r)?r==="float"?s.cssFloat=l:s[r]=(""+l).trim():s[r]=l+"px"}function rf(s,r,l){if(r!=null&&typeof r!="object")throw Error(a(62));if(s=s.style,l!=null){for(var o in l)!l.hasOwnProperty(o)||r!=null&&r.hasOwnProperty(o)||(o.indexOf("--")===0?s.setProperty(o,""):o==="float"?s.cssFloat="":s[o]="");for(var u in r)o=r[u],r.hasOwnProperty(u)&&l[u]!==o&&sf(s,u,o)}else for(var f in r)r.hasOwnProperty(f)&&sf(s,f,r[f])}function Go(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _y=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),gy=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Vl(s){return gy.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Vi(){}var Xo=null;function Vo(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var zr=null,Nr=null;function nf(s){var r=kr(s);if(r&&(s=r.stateNode)){var l=s[Xt]||null;e:switch(s=r.stateNode,r.type){case"input":if(qo(s,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),r=l.name,l.type==="radio"&&r!=null){for(l=s;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+vi(""+r)+'"][type="radio"]'),r=0;r<l.length;r++){var o=l[r];if(o!==s&&o.form===s.form){var u=o[Xt]||null;if(!u)throw Error(a(90));qo(o,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name)}}for(r=0;r<l.length;r++)o=l[r],o.form===s.form&&Qd(o)}break e;case"textarea":ef(s,l.value,l.defaultValue);break e;case"select":r=l.value,r!=null&&Br(s,!!l.multiple,r,!1)}}}var $o=!1;function lf(s,r,l){if($o)return s(r,l);$o=!0;try{var o=s(r);return o}finally{if($o=!1,(zr!==null||Nr!==null)&&(Na(),zr&&(r=zr,s=Nr,Nr=zr=null,nf(r),s)))for(r=0;r<s.length;r++)nf(s[r])}}function Rn(s,r){var l=s.stateNode;if(l===null)return null;var o=l[Xt]||null;if(o===null)return null;l=o[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(s=s.type,o=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!o;break e;default:s=!1}if(s)return null;if(l&&typeof l!="function")throw Error(a(231,r,typeof l));return l}var $i=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Zo=!1;if($i)try{var Dn={};Object.defineProperty(Dn,"passive",{get:function(){Zo=!0}}),window.addEventListener("test",Dn,Dn),window.removeEventListener("test",Dn,Dn)}catch{Zo=!1}var bs=null,Qo=null,$l=null;function af(){if($l)return $l;var s,r=Qo,l=r.length,o,u="value"in bs?bs.value:bs.textContent,f=u.length;for(s=0;s<l&&r[s]===u[s];s++);var v=l-s;for(o=1;o<=v&&r[l-o]===u[f-o];o++);return $l=u.slice(s,1<o?1-o:void 0)}function Zl(s){var r=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&r===13&&(s=13)):s=r,s===10&&(s=13),32<=s||s===13?s:0}function Ql(){return!0}function of(){return!1}function Vt(s){function r(l,o,u,f,v){this._reactName=l,this._targetInst=u,this.type=o,this.nativeEvent=f,this.target=v,this.currentTarget=null;for(var x in s)s.hasOwnProperty(x)&&(l=s[x],this[x]=l?l(f):f[x]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?Ql:of,this.isPropagationStopped=of,this}return b(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Ql)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Ql)},persist:function(){},isPersistent:Ql}),r}var er={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Jl=Vt(er),kn=b({},er,{view:0,detail:0}),py=Vt(kn),Jo,ec,Mn,ea=b({},kn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ic,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Mn&&(Mn&&s.type==="mousemove"?(Jo=s.screenX-Mn.screenX,ec=s.screenY-Mn.screenY):ec=Jo=0,Mn=s),Jo)},movementY:function(s){return"movementY"in s?s.movementY:ec}}),cf=Vt(ea),my=b({},ea,{dataTransfer:0}),vy=Vt(my),yy=b({},kn,{relatedTarget:0}),tc=Vt(yy),Sy=b({},er,{animationName:0,elapsedTime:0,pseudoElement:0}),by=Vt(Sy),Cy=b({},er,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),wy=Vt(Cy),xy=b({},er,{data:0}),hf=Vt(xy),Ey={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ty={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ay={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ry(s){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(s):(s=Ay[s])?!!r[s]:!1}function ic(){return Ry}var Dy=b({},kn,{key:function(s){if(s.key){var r=Ey[s.key]||s.key;if(r!=="Unidentified")return r}return s.type==="keypress"?(s=Zl(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Ty[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ic,charCode:function(s){return s.type==="keypress"?Zl(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Zl(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),ky=Vt(Dy),My=b({},ea,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),uf=Vt(My),Ly=b({},kn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ic}),By=Vt(Ly),Oy=b({},er,{propertyName:0,elapsedTime:0,pseudoElement:0}),zy=Vt(Oy),Ny=b({},ea,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Hy=Vt(Ny),Uy=b({},er,{newState:0,oldState:0}),Iy=Vt(Uy),jy=[9,13,27,32],sc=$i&&"CompositionEvent"in window,Ln=null;$i&&"documentMode"in document&&(Ln=document.documentMode);var Wy=$i&&"TextEvent"in window&&!Ln,df=$i&&(!sc||Ln&&8<Ln&&11>=Ln),ff=" ",_f=!1;function gf(s,r){switch(s){case"keyup":return jy.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function pf(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Hr=!1;function Fy(s,r){switch(s){case"compositionend":return pf(r);case"keypress":return r.which!==32?null:(_f=!0,ff);case"textInput":return s=r.data,s===ff&&_f?null:s;default:return null}}function Py(s,r){if(Hr)return s==="compositionend"||!sc&&gf(s,r)?(s=af(),$l=Qo=bs=null,Hr=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return df&&r.locale!=="ko"?null:r.data;default:return null}}var Yy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function mf(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r==="input"?!!Yy[s.type]:r==="textarea"}function vf(s,r,l,o){zr?Nr?Nr.push(o):Nr=[o]:zr=o,r=Pa(r,"onChange"),0<r.length&&(l=new Jl("onChange","change",null,l,o),s.push({event:l,listeners:r}))}var Bn=null,On=null;function qy(s){ep(s,0)}function ta(s){var r=An(s);if(Qd(r))return s}function yf(s,r){if(s==="change")return r}var Sf=!1;if($i){var rc;if($i){var nc="oninput"in document;if(!nc){var bf=document.createElement("div");bf.setAttribute("oninput","return;"),nc=typeof bf.oninput=="function"}rc=nc}else rc=!1;Sf=rc&&(!document.documentMode||9<document.documentMode)}function Cf(){Bn&&(Bn.detachEvent("onpropertychange",wf),On=Bn=null)}function wf(s){if(s.propertyName==="value"&&ta(On)){var r=[];vf(r,On,s,Vo(s)),lf(qy,r)}}function Ky(s,r,l){s==="focusin"?(Cf(),Bn=r,On=l,Bn.attachEvent("onpropertychange",wf)):s==="focusout"&&Cf()}function Gy(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return ta(On)}function Xy(s,r){if(s==="click")return ta(r)}function Vy(s,r){if(s==="input"||s==="change")return ta(r)}function $y(s,r){return s===r&&(s!==0||1/s===1/r)||s!==s&&r!==r}var ai=typeof Object.is=="function"?Object.is:$y;function zn(s,r){if(ai(s,r))return!0;if(typeof s!="object"||s===null||typeof r!="object"||r===null)return!1;var l=Object.keys(s),o=Object.keys(r);if(l.length!==o.length)return!1;for(o=0;o<l.length;o++){var u=l[o];if(!No.call(r,u)||!ai(s[u],r[u]))return!1}return!0}function xf(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Ef(s,r){var l=xf(s);s=0;for(var o;l;){if(l.nodeType===3){if(o=s+l.textContent.length,s<=r&&o>=r)return{node:l,offset:r-s};s=o}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=xf(l)}}function Tf(s,r){return s&&r?s===r?!0:s&&s.nodeType===3?!1:r&&r.nodeType===3?Tf(s,r.parentNode):"contains"in s?s.contains(r):s.compareDocumentPosition?!!(s.compareDocumentPosition(r)&16):!1:!1}function Af(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var r=Xl(s.document);r instanceof s.HTMLIFrameElement;){try{var l=typeof r.contentWindow.location.href=="string"}catch{l=!1}if(l)s=r.contentWindow;else break;r=Xl(s.document)}return r}function lc(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r&&(r==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||r==="textarea"||s.contentEditable==="true")}var Zy=$i&&"documentMode"in document&&11>=document.documentMode,Ur=null,ac=null,Nn=null,oc=!1;function Rf(s,r,l){var o=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;oc||Ur==null||Ur!==Xl(o)||(o=Ur,"selectionStart"in o&&lc(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),Nn&&zn(Nn,o)||(Nn=o,o=Pa(ac,"onSelect"),0<o.length&&(r=new Jl("onSelect","select",null,r,l),s.push({event:r,listeners:o}),r.target=Ur)))}function tr(s,r){var l={};return l[s.toLowerCase()]=r.toLowerCase(),l["Webkit"+s]="webkit"+r,l["Moz"+s]="moz"+r,l}var Ir={animationend:tr("Animation","AnimationEnd"),animationiteration:tr("Animation","AnimationIteration"),animationstart:tr("Animation","AnimationStart"),transitionrun:tr("Transition","TransitionRun"),transitionstart:tr("Transition","TransitionStart"),transitioncancel:tr("Transition","TransitionCancel"),transitionend:tr("Transition","TransitionEnd")},cc={},Df={};$i&&(Df=document.createElement("div").style,"AnimationEvent"in window||(delete Ir.animationend.animation,delete Ir.animationiteration.animation,delete Ir.animationstart.animation),"TransitionEvent"in window||delete Ir.transitionend.transition);function ir(s){if(cc[s])return cc[s];if(!Ir[s])return s;var r=Ir[s],l;for(l in r)if(r.hasOwnProperty(l)&&l in Df)return cc[s]=r[l];return s}var kf=ir("animationend"),Mf=ir("animationiteration"),Lf=ir("animationstart"),Qy=ir("transitionrun"),Jy=ir("transitionstart"),eS=ir("transitioncancel"),Bf=ir("transitionend"),Of=new Map,hc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");hc.push("scrollEnd");function Mi(s,r){Of.set(s,r),Js(r,[s])}var ia=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},yi=[],jr=0,uc=0;function sa(){for(var s=jr,r=uc=jr=0;r<s;){var l=yi[r];yi[r++]=null;var o=yi[r];yi[r++]=null;var u=yi[r];yi[r++]=null;var f=yi[r];if(yi[r++]=null,o!==null&&u!==null){var v=o.pending;v===null?u.next=u:(u.next=v.next,v.next=u),o.pending=u}f!==0&&zf(l,u,f)}}function ra(s,r,l,o){yi[jr++]=s,yi[jr++]=r,yi[jr++]=l,yi[jr++]=o,uc|=o,s.lanes|=o,s=s.alternate,s!==null&&(s.lanes|=o)}function dc(s,r,l,o){return ra(s,r,l,o),na(s)}function sr(s,r){return ra(s,null,null,r),na(s)}function zf(s,r,l){s.lanes|=l;var o=s.alternate;o!==null&&(o.lanes|=l);for(var u=!1,f=s.return;f!==null;)f.childLanes|=l,o=f.alternate,o!==null&&(o.childLanes|=l),f.tag===22&&(s=f.stateNode,s===null||s._visibility&1||(u=!0)),s=f,f=f.return;return s.tag===3?(f=s.stateNode,u&&r!==null&&(u=31-li(l),s=f.hiddenUpdates,o=s[u],o===null?s[u]=[r]:o.push(r),r.lane=l|536870912),f):null}function na(s){if(50<rl)throw rl=0,bh=null,Error(a(185));for(var r=s.return;r!==null;)s=r,r=s.return;return s.tag===3?s.stateNode:null}var Wr={};function tS(s,r,l,o){this.tag=s,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function oi(s,r,l,o){return new tS(s,r,l,o)}function fc(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Zi(s,r){var l=s.alternate;return l===null?(l=oi(s.tag,r,s.key,s.mode),l.elementType=s.elementType,l.type=s.type,l.stateNode=s.stateNode,l.alternate=s,s.alternate=l):(l.pendingProps=r,l.type=s.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=s.flags&65011712,l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,r=s.dependencies,l.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},l.sibling=s.sibling,l.index=s.index,l.ref=s.ref,l.refCleanup=s.refCleanup,l}function Nf(s,r){s.flags&=65011714;var l=s.alternate;return l===null?(s.childLanes=0,s.lanes=r,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,r=l.dependencies,s.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),s}function la(s,r,l,o,u,f){var v=0;if(o=s,typeof s=="function")fc(s)&&(v=1);else if(typeof s=="string")v=lb(s,l,z.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case Y:return s=oi(31,l,r,u),s.elementType=Y,s.lanes=f,s;case k:return rr(l.children,u,f,r);case V:v=8,u|=24;break;case X:return s=oi(12,l,r,u|2),s.elementType=X,s.lanes=f,s;case de:return s=oi(13,l,r,u),s.elementType=de,s.lanes=f,s;case _e:return s=oi(19,l,r,u),s.elementType=_e,s.lanes=f,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case te:v=10;break e;case he:v=9;break e;case ue:v=11;break e;case q:v=14;break e;case ge:v=16,o=null;break e}v=29,l=Error(a(130,s===null?"null":typeof s,"")),o=null}return r=oi(v,l,r,u),r.elementType=s,r.type=o,r.lanes=f,r}function rr(s,r,l,o){return s=oi(7,s,o,r),s.lanes=l,s}function _c(s,r,l){return s=oi(6,s,null,r),s.lanes=l,s}function Hf(s){var r=oi(18,null,null,0);return r.stateNode=s,r}function gc(s,r,l){return r=oi(4,s.children!==null?s.children:[],s.key,r),r.lanes=l,r.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},r}var Uf=new WeakMap;function Si(s,r){if(typeof s=="object"&&s!==null){var l=Uf.get(s);return l!==void 0?l:(r={value:s,source:r,stack:Cn(r)},Uf.set(s,r),r)}return{value:s,source:r,stack:Cn(r)}}var Fr=[],Pr=0,aa=null,Hn=0,bi=[],Ci=0,Cs=null,zi=1,Ni="";function Qi(s,r){Fr[Pr++]=Hn,Fr[Pr++]=aa,aa=s,Hn=r}function If(s,r,l){bi[Ci++]=zi,bi[Ci++]=Ni,bi[Ci++]=Cs,Cs=s;var o=zi;s=Ni;var u=32-li(o)-1;o&=~(1<<u),l+=1;var f=32-li(r)+u;if(30<f){var v=u-u%5;f=(o&(1<<v)-1).toString(32),o>>=v,u-=v,zi=1<<32-li(r)+u|l<<u|o,Ni=f+s}else zi=1<<f|l<<u|o,Ni=s}function pc(s){s.return!==null&&(Qi(s,1),If(s,1,0))}function mc(s){for(;s===aa;)aa=Fr[--Pr],Fr[Pr]=null,Hn=Fr[--Pr],Fr[Pr]=null;for(;s===Cs;)Cs=bi[--Ci],bi[Ci]=null,Ni=bi[--Ci],bi[Ci]=null,zi=bi[--Ci],bi[Ci]=null}function jf(s,r){bi[Ci++]=zi,bi[Ci++]=Ni,bi[Ci++]=Cs,zi=r.id,Ni=r.overflow,Cs=s}var Nt=null,tt=null,Pe=!1,ws=null,wi=!1,vc=Error(a(519));function xs(s){var r=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Un(Si(r,s)),vc}function Wf(s){var r=s.stateNode,l=s.type,o=s.memoizedProps;switch(r[zt]=s,r[Xt]=o,l){case"dialog":je("cancel",r),je("close",r);break;case"iframe":case"object":case"embed":je("load",r);break;case"video":case"audio":for(l=0;l<ll.length;l++)je(ll[l],r);break;case"source":je("error",r);break;case"img":case"image":case"link":je("error",r),je("load",r);break;case"details":je("toggle",r);break;case"input":je("invalid",r),Jd(r,o.value,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name,!0);break;case"select":je("invalid",r);break;case"textarea":je("invalid",r),tf(r,o.value,o.defaultValue,o.children)}l=o.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||r.textContent===""+l||o.suppressHydrationWarning===!0||rp(r.textContent,l)?(o.popover!=null&&(je("beforetoggle",r),je("toggle",r)),o.onScroll!=null&&je("scroll",r),o.onScrollEnd!=null&&je("scrollend",r),o.onClick!=null&&(r.onclick=Vi),r=!0):r=!1,r||xs(s,!0)}function Ff(s){for(Nt=s.return;Nt;)switch(Nt.tag){case 5:case 31:case 13:wi=!1;return;case 27:case 3:wi=!0;return;default:Nt=Nt.return}}function Yr(s){if(s!==Nt)return!1;if(!Pe)return Ff(s),Pe=!0,!1;var r=s.tag,l;if((l=r!==3&&r!==27)&&((l=r===5)&&(l=s.type,l=!(l!=="form"&&l!=="button")||Nh(s.type,s.memoizedProps)),l=!l),l&&tt&&xs(s),Ff(s),r===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(a(317));tt=fp(s)}else if(r===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(a(317));tt=fp(s)}else r===27?(r=tt,Us(s.type)?(s=Wh,Wh=null,tt=s):tt=r):tt=Nt?Ei(s.stateNode.nextSibling):null;return!0}function nr(){tt=Nt=null,Pe=!1}function yc(){var s=ws;return s!==null&&(Jt===null?Jt=s:Jt.push.apply(Jt,s),ws=null),s}function Un(s){ws===null?ws=[s]:ws.push(s)}var Sc=A(null),lr=null,Ji=null;function Es(s,r,l){L(Sc,r._currentValue),r._currentValue=l}function es(s){s._currentValue=Sc.current,U(Sc)}function bc(s,r,l){for(;s!==null;){var o=s.alternate;if((s.childLanes&r)!==r?(s.childLanes|=r,o!==null&&(o.childLanes|=r)):o!==null&&(o.childLanes&r)!==r&&(o.childLanes|=r),s===l)break;s=s.return}}function Cc(s,r,l,o){var u=s.child;for(u!==null&&(u.return=s);u!==null;){var f=u.dependencies;if(f!==null){var v=u.child;f=f.firstContext;e:for(;f!==null;){var x=f;f=u;for(var M=0;M<r.length;M++)if(x.context===r[M]){f.lanes|=l,x=f.alternate,x!==null&&(x.lanes|=l),bc(f.return,l,s),o||(v=null);break e}f=x.next}}else if(u.tag===18){if(v=u.return,v===null)throw Error(a(341));v.lanes|=l,f=v.alternate,f!==null&&(f.lanes|=l),bc(v,l,s),v=null}else v=u.child;if(v!==null)v.return=u;else for(v=u;v!==null;){if(v===s){v=null;break}if(u=v.sibling,u!==null){u.return=v.return,v=u;break}v=v.return}u=v}}function qr(s,r,l,o){s=null;for(var u=r,f=!1;u!==null;){if(!f){if((u.flags&524288)!==0)f=!0;else if((u.flags&262144)!==0)break}if(u.tag===10){var v=u.alternate;if(v===null)throw Error(a(387));if(v=v.memoizedProps,v!==null){var x=u.type;ai(u.pendingProps.value,v.value)||(s!==null?s.push(x):s=[x])}}else if(u===ae.current){if(v=u.alternate,v===null)throw Error(a(387));v.memoizedState.memoizedState!==u.memoizedState.memoizedState&&(s!==null?s.push(ul):s=[ul])}u=u.return}s!==null&&Cc(r,s,l,o),r.flags|=262144}function oa(s){for(s=s.firstContext;s!==null;){if(!ai(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function ar(s){lr=s,Ji=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Ht(s){return Pf(lr,s)}function ca(s,r){return lr===null&&ar(s),Pf(s,r)}function Pf(s,r){var l=r._currentValue;if(r={context:r,memoizedValue:l,next:null},Ji===null){if(s===null)throw Error(a(308));Ji=r,s.dependencies={lanes:0,firstContext:r},s.flags|=524288}else Ji=Ji.next=r;return l}var iS=typeof AbortController<"u"?AbortController:function(){var s=[],r=this.signal={aborted:!1,addEventListener:function(l,o){s.push(o)}};this.abort=function(){r.aborted=!0,s.forEach(function(l){return l()})}},sS=t.unstable_scheduleCallback,rS=t.unstable_NormalPriority,mt={$$typeof:te,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function wc(){return{controller:new iS,data:new Map,refCount:0}}function In(s){s.refCount--,s.refCount===0&&sS(rS,function(){s.controller.abort()})}var jn=null,xc=0,Kr=0,Gr=null;function nS(s,r){if(jn===null){var l=jn=[];xc=0,Kr=Ah(),Gr={status:"pending",value:void 0,then:function(o){l.push(o)}}}return xc++,r.then(Yf,Yf),r}function Yf(){if(--xc===0&&jn!==null){Gr!==null&&(Gr.status="fulfilled");var s=jn;jn=null,Kr=0,Gr=null;for(var r=0;r<s.length;r++)(0,s[r])()}}function lS(s,r){var l=[],o={status:"pending",value:null,reason:null,then:function(u){l.push(u)}};return s.then(function(){o.status="fulfilled",o.value=r;for(var u=0;u<l.length;u++)(0,l[u])(r)},function(u){for(o.status="rejected",o.reason=u,u=0;u<l.length;u++)(0,l[u])(void 0)}),o}var qf=O.S;O.S=function(s,r){Rg=ri(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&nS(s,r),qf!==null&&qf(s,r)};var or=A(null);function Ec(){var s=or.current;return s!==null?s:Je.pooledCache}function ha(s,r){r===null?L(or,or.current):L(or,r.pool)}function Kf(){var s=Ec();return s===null?null:{parent:mt._currentValue,pool:s}}var Xr=Error(a(460)),Tc=Error(a(474)),ua=Error(a(542)),da={then:function(){}};function Gf(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Xf(s,r,l){switch(l=s[l],l===void 0?s.push(r):l!==r&&(r.then(Vi,Vi),r=l),r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,$f(s),s;default:if(typeof r.status=="string")r.then(Vi,Vi);else{if(s=Je,s!==null&&100<s.shellSuspendCounter)throw Error(a(482));s=r,s.status="pending",s.then(function(o){if(r.status==="pending"){var u=r;u.status="fulfilled",u.value=o}},function(o){if(r.status==="pending"){var u=r;u.status="rejected",u.reason=o}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,$f(s),s}throw hr=r,Xr}}function cr(s){try{var r=s._init;return r(s._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(hr=l,Xr):l}}var hr=null;function Vf(){if(hr===null)throw Error(a(459));var s=hr;return hr=null,s}function $f(s){if(s===Xr||s===ua)throw Error(a(483))}var Vr=null,Wn=0;function fa(s){var r=Wn;return Wn+=1,Vr===null&&(Vr=[]),Xf(Vr,s,r)}function Fn(s,r){r=r.props.ref,s.ref=r!==void 0?r:null}function _a(s,r){throw r.$$typeof===E?Error(a(525)):(s=Object.prototype.toString.call(r),Error(a(31,s==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":s)))}function Zf(s){function r(H,B){if(s){var W=H.deletions;W===null?(H.deletions=[B],H.flags|=16):W.push(B)}}function l(H,B){if(!s)return null;for(;B!==null;)r(H,B),B=B.sibling;return null}function o(H){for(var B=new Map;H!==null;)H.key!==null?B.set(H.key,H):B.set(H.index,H),H=H.sibling;return B}function u(H,B){return H=Zi(H,B),H.index=0,H.sibling=null,H}function f(H,B,W){return H.index=W,s?(W=H.alternate,W!==null?(W=W.index,W<B?(H.flags|=67108866,B):W):(H.flags|=67108866,B)):(H.flags|=1048576,B)}function v(H){return s&&H.alternate===null&&(H.flags|=67108866),H}function x(H,B,W,ie){return B===null||B.tag!==6?(B=_c(W,H.mode,ie),B.return=H,B):(B=u(B,W),B.return=H,B)}function M(H,B,W,ie){var Re=W.type;return Re===k?J(H,B,W.props.children,ie,W.key):B!==null&&(B.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===ge&&cr(Re)===B.type)?(B=u(B,W.props),Fn(B,W),B.return=H,B):(B=la(W.type,W.key,W.props,null,H.mode,ie),Fn(B,W),B.return=H,B)}function F(H,B,W,ie){return B===null||B.tag!==4||B.stateNode.containerInfo!==W.containerInfo||B.stateNode.implementation!==W.implementation?(B=gc(W,H.mode,ie),B.return=H,B):(B=u(B,W.children||[]),B.return=H,B)}function J(H,B,W,ie,Re){return B===null||B.tag!==7?(B=rr(W,H.mode,ie,Re),B.return=H,B):(B=u(B,W),B.return=H,B)}function le(H,B,W){if(typeof B=="string"&&B!==""||typeof B=="number"||typeof B=="bigint")return B=_c(""+B,H.mode,W),B.return=H,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case R:return W=la(B.type,B.key,B.props,null,H.mode,W),Fn(W,B),W.return=H,W;case D:return B=gc(B,H.mode,W),B.return=H,B;case ge:return B=cr(B),le(H,B,W)}if(ce(B)||Q(B))return B=rr(B,H.mode,W,null),B.return=H,B;if(typeof B.then=="function")return le(H,fa(B),W);if(B.$$typeof===te)return le(H,ca(H,B),W);_a(H,B)}return null}function P(H,B,W,ie){var Re=B!==null?B.key:null;if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return Re!==null?null:x(H,B,""+W,ie);if(typeof W=="object"&&W!==null){switch(W.$$typeof){case R:return W.key===Re?M(H,B,W,ie):null;case D:return W.key===Re?F(H,B,W,ie):null;case ge:return W=cr(W),P(H,B,W,ie)}if(ce(W)||Q(W))return Re!==null?null:J(H,B,W,ie,null);if(typeof W.then=="function")return P(H,B,fa(W),ie);if(W.$$typeof===te)return P(H,B,ca(H,W),ie);_a(H,W)}return null}function G(H,B,W,ie,Re){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return H=H.get(W)||null,x(B,H,""+ie,Re);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case R:return H=H.get(ie.key===null?W:ie.key)||null,M(B,H,ie,Re);case D:return H=H.get(ie.key===null?W:ie.key)||null,F(B,H,ie,Re);case ge:return ie=cr(ie),G(H,B,W,ie,Re)}if(ce(ie)||Q(ie))return H=H.get(W)||null,J(B,H,ie,Re,null);if(typeof ie.then=="function")return G(H,B,W,fa(ie),Re);if(ie.$$typeof===te)return G(H,B,W,ca(B,ie),Re);_a(B,ie)}return null}function Ce(H,B,W,ie){for(var Re=null,Ye=null,xe=B,ze=B=0,Fe=null;xe!==null&&ze<W.length;ze++){xe.index>ze?(Fe=xe,xe=null):Fe=xe.sibling;var qe=P(H,xe,W[ze],ie);if(qe===null){xe===null&&(xe=Fe);break}s&&xe&&qe.alternate===null&&r(H,xe),B=f(qe,B,ze),Ye===null?Re=qe:Ye.sibling=qe,Ye=qe,xe=Fe}if(ze===W.length)return l(H,xe),Pe&&Qi(H,ze),Re;if(xe===null){for(;ze<W.length;ze++)xe=le(H,W[ze],ie),xe!==null&&(B=f(xe,B,ze),Ye===null?Re=xe:Ye.sibling=xe,Ye=xe);return Pe&&Qi(H,ze),Re}for(xe=o(xe);ze<W.length;ze++)Fe=G(xe,H,ze,W[ze],ie),Fe!==null&&(s&&Fe.alternate!==null&&xe.delete(Fe.key===null?ze:Fe.key),B=f(Fe,B,ze),Ye===null?Re=Fe:Ye.sibling=Fe,Ye=Fe);return s&&xe.forEach(function(Ps){return r(H,Ps)}),Pe&&Qi(H,ze),Re}function ke(H,B,W,ie){if(W==null)throw Error(a(151));for(var Re=null,Ye=null,xe=B,ze=B=0,Fe=null,qe=W.next();xe!==null&&!qe.done;ze++,qe=W.next()){xe.index>ze?(Fe=xe,xe=null):Fe=xe.sibling;var Ps=P(H,xe,qe.value,ie);if(Ps===null){xe===null&&(xe=Fe);break}s&&xe&&Ps.alternate===null&&r(H,xe),B=f(Ps,B,ze),Ye===null?Re=Ps:Ye.sibling=Ps,Ye=Ps,xe=Fe}if(qe.done)return l(H,xe),Pe&&Qi(H,ze),Re;if(xe===null){for(;!qe.done;ze++,qe=W.next())qe=le(H,qe.value,ie),qe!==null&&(B=f(qe,B,ze),Ye===null?Re=qe:Ye.sibling=qe,Ye=qe);return Pe&&Qi(H,ze),Re}for(xe=o(xe);!qe.done;ze++,qe=W.next())qe=G(xe,H,ze,qe.value,ie),qe!==null&&(s&&qe.alternate!==null&&xe.delete(qe.key===null?ze:qe.key),B=f(qe,B,ze),Ye===null?Re=qe:Ye.sibling=qe,Ye=qe);return s&&xe.forEach(function(mb){return r(H,mb)}),Pe&&Qi(H,ze),Re}function Ze(H,B,W,ie){if(typeof W=="object"&&W!==null&&W.type===k&&W.key===null&&(W=W.props.children),typeof W=="object"&&W!==null){switch(W.$$typeof){case R:e:{for(var Re=W.key;B!==null;){if(B.key===Re){if(Re=W.type,Re===k){if(B.tag===7){l(H,B.sibling),ie=u(B,W.props.children),ie.return=H,H=ie;break e}}else if(B.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===ge&&cr(Re)===B.type){l(H,B.sibling),ie=u(B,W.props),Fn(ie,W),ie.return=H,H=ie;break e}l(H,B);break}else r(H,B);B=B.sibling}W.type===k?(ie=rr(W.props.children,H.mode,ie,W.key),ie.return=H,H=ie):(ie=la(W.type,W.key,W.props,null,H.mode,ie),Fn(ie,W),ie.return=H,H=ie)}return v(H);case D:e:{for(Re=W.key;B!==null;){if(B.key===Re)if(B.tag===4&&B.stateNode.containerInfo===W.containerInfo&&B.stateNode.implementation===W.implementation){l(H,B.sibling),ie=u(B,W.children||[]),ie.return=H,H=ie;break e}else{l(H,B);break}else r(H,B);B=B.sibling}ie=gc(W,H.mode,ie),ie.return=H,H=ie}return v(H);case ge:return W=cr(W),Ze(H,B,W,ie)}if(ce(W))return Ce(H,B,W,ie);if(Q(W)){if(Re=Q(W),typeof Re!="function")throw Error(a(150));return W=Re.call(W),ke(H,B,W,ie)}if(typeof W.then=="function")return Ze(H,B,fa(W),ie);if(W.$$typeof===te)return Ze(H,B,ca(H,W),ie);_a(H,W)}return typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint"?(W=""+W,B!==null&&B.tag===6?(l(H,B.sibling),ie=u(B,W),ie.return=H,H=ie):(l(H,B),ie=_c(W,H.mode,ie),ie.return=H,H=ie),v(H)):l(H,B)}return function(H,B,W,ie){try{Wn=0;var Re=Ze(H,B,W,ie);return Vr=null,Re}catch(xe){if(xe===Xr||xe===ua)throw xe;var Ye=oi(29,xe,null,H.mode);return Ye.lanes=ie,Ye.return=H,Ye}}}var ur=Zf(!0),Qf=Zf(!1),Ts=!1;function Ac(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Rc(s,r){s=s.updateQueue,r.updateQueue===s&&(r.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function As(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Rs(s,r,l){var o=s.updateQueue;if(o===null)return null;if(o=o.shared,(Ke&2)!==0){var u=o.pending;return u===null?r.next=r:(r.next=u.next,u.next=r),o.pending=r,r=na(s),zf(s,null,l),r}return ra(s,o,r,l),na(s)}function Pn(s,r,l){if(r=r.updateQueue,r!==null&&(r=r.shared,(l&4194048)!==0)){var o=r.lanes;o&=s.pendingLanes,l|=o,r.lanes=l,Fd(s,l)}}function Dc(s,r){var l=s.updateQueue,o=s.alternate;if(o!==null&&(o=o.updateQueue,l===o)){var u=null,f=null;if(l=l.firstBaseUpdate,l!==null){do{var v={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};f===null?u=f=v:f=f.next=v,l=l.next}while(l!==null);f===null?u=f=r:f=f.next=r}else u=f=r;l={baseState:o.baseState,firstBaseUpdate:u,lastBaseUpdate:f,shared:o.shared,callbacks:o.callbacks},s.updateQueue=l;return}s=l.lastBaseUpdate,s===null?l.firstBaseUpdate=r:s.next=r,l.lastBaseUpdate=r}var kc=!1;function Yn(){if(kc){var s=Gr;if(s!==null)throw s}}function qn(s,r,l,o){kc=!1;var u=s.updateQueue;Ts=!1;var f=u.firstBaseUpdate,v=u.lastBaseUpdate,x=u.shared.pending;if(x!==null){u.shared.pending=null;var M=x,F=M.next;M.next=null,v===null?f=F:v.next=F,v=M;var J=s.alternate;J!==null&&(J=J.updateQueue,x=J.lastBaseUpdate,x!==v&&(x===null?J.firstBaseUpdate=F:x.next=F,J.lastBaseUpdate=M))}if(f!==null){var le=u.baseState;v=0,J=F=M=null,x=f;do{var P=x.lane&-536870913,G=P!==x.lane;if(G?(We&P)===P:(o&P)===P){P!==0&&P===Kr&&(kc=!0),J!==null&&(J=J.next={lane:0,tag:x.tag,payload:x.payload,callback:null,next:null});e:{var Ce=s,ke=x;P=r;var Ze=l;switch(ke.tag){case 1:if(Ce=ke.payload,typeof Ce=="function"){le=Ce.call(Ze,le,P);break e}le=Ce;break e;case 3:Ce.flags=Ce.flags&-65537|128;case 0:if(Ce=ke.payload,P=typeof Ce=="function"?Ce.call(Ze,le,P):Ce,P==null)break e;le=b({},le,P);break e;case 2:Ts=!0}}P=x.callback,P!==null&&(s.flags|=64,G&&(s.flags|=8192),G=u.callbacks,G===null?u.callbacks=[P]:G.push(P))}else G={lane:P,tag:x.tag,payload:x.payload,callback:x.callback,next:null},J===null?(F=J=G,M=le):J=J.next=G,v|=P;if(x=x.next,x===null){if(x=u.shared.pending,x===null)break;G=x,x=G.next,G.next=null,u.lastBaseUpdate=G,u.shared.pending=null}}while(!0);J===null&&(M=le),u.baseState=M,u.firstBaseUpdate=F,u.lastBaseUpdate=J,f===null&&(u.shared.lanes=0),Bs|=v,s.lanes=v,s.memoizedState=le}}function Jf(s,r){if(typeof s!="function")throw Error(a(191,s));s.call(r)}function e_(s,r){var l=s.callbacks;if(l!==null)for(s.callbacks=null,s=0;s<l.length;s++)Jf(l[s],r)}var $r=A(null),ga=A(0);function t_(s,r){s=cs,L(ga,s),L($r,r),cs=s|r.baseLanes}function Mc(){L(ga,cs),L($r,$r.current)}function Lc(){cs=ga.current,U($r),U(ga)}var ci=A(null),xi=null;function Ds(s){var r=s.alternate;L(_t,_t.current&1),L(ci,s),xi===null&&(r===null||$r.current!==null||r.memoizedState!==null)&&(xi=s)}function Bc(s){L(_t,_t.current),L(ci,s),xi===null&&(xi=s)}function i_(s){s.tag===22?(L(_t,_t.current),L(ci,s),xi===null&&(xi=s)):ks()}function ks(){L(_t,_t.current),L(ci,ci.current)}function hi(s){U(ci),xi===s&&(xi=null),U(_t)}var _t=A(0);function pa(s){for(var r=s;r!==null;){if(r.tag===13){var l=r.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||Ih(l)||jh(l)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var ts=0,Oe=null,Ve=null,vt=null,ma=!1,Zr=!1,dr=!1,va=0,Kn=0,Qr=null,aS=0;function ht(){throw Error(a(321))}function Oc(s,r){if(r===null)return!1;for(var l=0;l<r.length&&l<s.length;l++)if(!ai(s[l],r[l]))return!1;return!0}function zc(s,r,l,o,u,f){return ts=f,Oe=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,O.H=s===null||s.memoizedState===null?I_:$c,dr=!1,f=l(o,u),dr=!1,Zr&&(f=r_(r,l,o,u)),s_(s),f}function s_(s){O.H=Vn;var r=Ve!==null&&Ve.next!==null;if(ts=0,vt=Ve=Oe=null,ma=!1,Kn=0,Qr=null,r)throw Error(a(300));s===null||yt||(s=s.dependencies,s!==null&&oa(s)&&(yt=!0))}function r_(s,r,l,o){Oe=s;var u=0;do{if(Zr&&(Qr=null),Kn=0,Zr=!1,25<=u)throw Error(a(301));if(u+=1,vt=Ve=null,s.updateQueue!=null){var f=s.updateQueue;f.lastEffect=null,f.events=null,f.stores=null,f.memoCache!=null&&(f.memoCache.index=0)}O.H=j_,f=r(l,o)}while(Zr);return f}function oS(){var s=O.H,r=s.useState()[0];return r=typeof r.then=="function"?Gn(r):r,s=s.useState()[0],(Ve!==null?Ve.memoizedState:null)!==s&&(Oe.flags|=1024),r}function Nc(){var s=va!==0;return va=0,s}function Hc(s,r,l){r.updateQueue=s.updateQueue,r.flags&=-2053,s.lanes&=~l}function Uc(s){if(ma){for(s=s.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}ma=!1}ts=0,vt=Ve=Oe=null,Zr=!1,Kn=va=0,Qr=null}function Yt(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vt===null?Oe.memoizedState=vt=s:vt=vt.next=s,vt}function gt(){if(Ve===null){var s=Oe.alternate;s=s!==null?s.memoizedState:null}else s=Ve.next;var r=vt===null?Oe.memoizedState:vt.next;if(r!==null)vt=r,Ve=s;else{if(s===null)throw Oe.alternate===null?Error(a(467)):Error(a(310));Ve=s,s={memoizedState:Ve.memoizedState,baseState:Ve.baseState,baseQueue:Ve.baseQueue,queue:Ve.queue,next:null},vt===null?Oe.memoizedState=vt=s:vt=vt.next=s}return vt}function ya(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Gn(s){var r=Kn;return Kn+=1,Qr===null&&(Qr=[]),s=Xf(Qr,s,r),r=Oe,(vt===null?r.memoizedState:vt.next)===null&&(r=r.alternate,O.H=r===null||r.memoizedState===null?I_:$c),s}function Sa(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Gn(s);if(s.$$typeof===te)return Ht(s)}throw Error(a(438,String(s)))}function Ic(s){var r=null,l=Oe.updateQueue;if(l!==null&&(r=l.memoCache),r==null){var o=Oe.alternate;o!==null&&(o=o.updateQueue,o!==null&&(o=o.memoCache,o!=null&&(r={data:o.data.map(function(u){return u.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),l===null&&(l=ya(),Oe.updateQueue=l),l.memoCache=r,l=r.data[r.index],l===void 0)for(l=r.data[r.index]=Array(s),o=0;o<s;o++)l[o]=re;return r.index++,l}function is(s,r){return typeof r=="function"?r(s):r}function ba(s){var r=gt();return jc(r,Ve,s)}function jc(s,r,l){var o=s.queue;if(o===null)throw Error(a(311));o.lastRenderedReducer=l;var u=s.baseQueue,f=o.pending;if(f!==null){if(u!==null){var v=u.next;u.next=f.next,f.next=v}r.baseQueue=u=f,o.pending=null}if(f=s.baseState,u===null)s.memoizedState=f;else{r=u.next;var x=v=null,M=null,F=r,J=!1;do{var le=F.lane&-536870913;if(le!==F.lane?(We&le)===le:(ts&le)===le){var P=F.revertLane;if(P===0)M!==null&&(M=M.next={lane:0,revertLane:0,gesture:null,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null}),le===Kr&&(J=!0);else if((ts&P)===P){F=F.next,P===Kr&&(J=!0);continue}else le={lane:0,revertLane:F.revertLane,gesture:null,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null},M===null?(x=M=le,v=f):M=M.next=le,Oe.lanes|=P,Bs|=P;le=F.action,dr&&l(f,le),f=F.hasEagerState?F.eagerState:l(f,le)}else P={lane:le,revertLane:F.revertLane,gesture:F.gesture,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null},M===null?(x=M=P,v=f):M=M.next=P,Oe.lanes|=le,Bs|=le;F=F.next}while(F!==null&&F!==r);if(M===null?v=f:M.next=x,!ai(f,s.memoizedState)&&(yt=!0,J&&(l=Gr,l!==null)))throw l;s.memoizedState=f,s.baseState=v,s.baseQueue=M,o.lastRenderedState=f}return u===null&&(o.lanes=0),[s.memoizedState,o.dispatch]}function Wc(s){var r=gt(),l=r.queue;if(l===null)throw Error(a(311));l.lastRenderedReducer=s;var o=l.dispatch,u=l.pending,f=r.memoizedState;if(u!==null){l.pending=null;var v=u=u.next;do f=s(f,v.action),v=v.next;while(v!==u);ai(f,r.memoizedState)||(yt=!0),r.memoizedState=f,r.baseQueue===null&&(r.baseState=f),l.lastRenderedState=f}return[f,o]}function n_(s,r,l){var o=Oe,u=gt(),f=Pe;if(f){if(l===void 0)throw Error(a(407));l=l()}else l=r();var v=!ai((Ve||u).memoizedState,l);if(v&&(u.memoizedState=l,yt=!0),u=u.queue,Yc(o_.bind(null,o,u,s),[s]),u.getSnapshot!==r||v||vt!==null&&vt.memoizedState.tag&1){if(o.flags|=2048,Jr(9,{destroy:void 0},a_.bind(null,o,u,l,r),null),Je===null)throw Error(a(349));f||(ts&127)!==0||l_(o,r,l)}return l}function l_(s,r,l){s.flags|=16384,s={getSnapshot:r,value:l},r=Oe.updateQueue,r===null?(r=ya(),Oe.updateQueue=r,r.stores=[s]):(l=r.stores,l===null?r.stores=[s]:l.push(s))}function a_(s,r,l,o){r.value=l,r.getSnapshot=o,c_(r)&&h_(s)}function o_(s,r,l){return l(function(){c_(r)&&h_(s)})}function c_(s){var r=s.getSnapshot;s=s.value;try{var l=r();return!ai(s,l)}catch{return!0}}function h_(s){var r=sr(s,2);r!==null&&ei(r,s,2)}function Fc(s){var r=Yt();if(typeof s=="function"){var l=s;if(s=l(),dr){ys(!0);try{l()}finally{ys(!1)}}}return r.memoizedState=r.baseState=s,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:is,lastRenderedState:s},r}function u_(s,r,l,o){return s.baseState=l,jc(s,Ve,typeof o=="function"?o:is)}function cS(s,r,l,o,u){if(xa(s))throw Error(a(485));if(s=r.action,s!==null){var f={payload:u,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){f.listeners.push(v)}};O.T!==null?l(!0):f.isTransition=!1,o(f),l=r.pending,l===null?(f.next=r.pending=f,d_(r,f)):(f.next=l.next,r.pending=l.next=f)}}function d_(s,r){var l=r.action,o=r.payload,u=s.state;if(r.isTransition){var f=O.T,v={};O.T=v;try{var x=l(u,o),M=O.S;M!==null&&M(v,x),f_(s,r,x)}catch(F){Pc(s,r,F)}finally{f!==null&&v.types!==null&&(f.types=v.types),O.T=f}}else try{f=l(u,o),f_(s,r,f)}catch(F){Pc(s,r,F)}}function f_(s,r,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(o){__(s,r,o)},function(o){return Pc(s,r,o)}):__(s,r,l)}function __(s,r,l){r.status="fulfilled",r.value=l,g_(r),s.state=l,r=s.pending,r!==null&&(l=r.next,l===r?s.pending=null:(l=l.next,r.next=l,d_(s,l)))}function Pc(s,r,l){var o=s.pending;if(s.pending=null,o!==null){o=o.next;do r.status="rejected",r.reason=l,g_(r),r=r.next;while(r!==o)}s.action=null}function g_(s){s=s.listeners;for(var r=0;r<s.length;r++)(0,s[r])()}function p_(s,r){return r}function m_(s,r){if(Pe){var l=Je.formState;if(l!==null){e:{var o=Oe;if(Pe){if(tt){t:{for(var u=tt,f=wi;u.nodeType!==8;){if(!f){u=null;break t}if(u=Ei(u.nextSibling),u===null){u=null;break t}}f=u.data,u=f==="F!"||f==="F"?u:null}if(u){tt=Ei(u.nextSibling),o=u.data==="F!";break e}}xs(o)}o=!1}o&&(r=l[0])}}return l=Yt(),l.memoizedState=l.baseState=r,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:p_,lastRenderedState:r},l.queue=o,l=N_.bind(null,Oe,o),o.dispatch=l,o=Fc(!1),f=Vc.bind(null,Oe,!1,o.queue),o=Yt(),u={state:r,dispatch:null,action:s,pending:null},o.queue=u,l=cS.bind(null,Oe,u,f,l),u.dispatch=l,o.memoizedState=s,[r,l,!1]}function v_(s){var r=gt();return y_(r,Ve,s)}function y_(s,r,l){if(r=jc(s,r,p_)[0],s=ba(is)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var o=Gn(r)}catch(v){throw v===Xr?ua:v}else o=r;r=gt();var u=r.queue,f=u.dispatch;return l!==r.memoizedState&&(Oe.flags|=2048,Jr(9,{destroy:void 0},hS.bind(null,u,l),null)),[o,f,s]}function hS(s,r){s.action=r}function S_(s){var r=gt(),l=Ve;if(l!==null)return y_(r,l,s);gt(),r=r.memoizedState,l=gt();var o=l.queue.dispatch;return l.memoizedState=s,[r,o,!1]}function Jr(s,r,l,o){return s={tag:s,create:l,deps:o,inst:r,next:null},r=Oe.updateQueue,r===null&&(r=ya(),Oe.updateQueue=r),l=r.lastEffect,l===null?r.lastEffect=s.next=s:(o=l.next,l.next=s,s.next=o,r.lastEffect=s),s}function b_(){return gt().memoizedState}function Ca(s,r,l,o){var u=Yt();Oe.flags|=s,u.memoizedState=Jr(1|r,{destroy:void 0},l,o===void 0?null:o)}function wa(s,r,l,o){var u=gt();o=o===void 0?null:o;var f=u.memoizedState.inst;Ve!==null&&o!==null&&Oc(o,Ve.memoizedState.deps)?u.memoizedState=Jr(r,f,l,o):(Oe.flags|=s,u.memoizedState=Jr(1|r,f,l,o))}function C_(s,r){Ca(8390656,8,s,r)}function Yc(s,r){wa(2048,8,s,r)}function uS(s){Oe.flags|=4;var r=Oe.updateQueue;if(r===null)r=ya(),Oe.updateQueue=r,r.events=[s];else{var l=r.events;l===null?r.events=[s]:l.push(s)}}function w_(s){var r=gt().memoizedState;return uS({ref:r,nextImpl:s}),function(){if((Ke&2)!==0)throw Error(a(440));return r.impl.apply(void 0,arguments)}}function x_(s,r){return wa(4,2,s,r)}function E_(s,r){return wa(4,4,s,r)}function T_(s,r){if(typeof r=="function"){s=s();var l=r(s);return function(){typeof l=="function"?l():r(null)}}if(r!=null)return s=s(),r.current=s,function(){r.current=null}}function A_(s,r,l){l=l!=null?l.concat([s]):null,wa(4,4,T_.bind(null,r,s),l)}function qc(){}function R_(s,r){var l=gt();r=r===void 0?null:r;var o=l.memoizedState;return r!==null&&Oc(r,o[1])?o[0]:(l.memoizedState=[s,r],s)}function D_(s,r){var l=gt();r=r===void 0?null:r;var o=l.memoizedState;if(r!==null&&Oc(r,o[1]))return o[0];if(o=s(),dr){ys(!0);try{s()}finally{ys(!1)}}return l.memoizedState=[o,r],o}function Kc(s,r,l){return l===void 0||(ts&1073741824)!==0&&(We&261930)===0?s.memoizedState=r:(s.memoizedState=l,s=kg(),Oe.lanes|=s,Bs|=s,l)}function k_(s,r,l,o){return ai(l,r)?l:$r.current!==null?(s=Kc(s,l,o),ai(s,r)||(yt=!0),s):(ts&42)===0||(ts&1073741824)!==0&&(We&261930)===0?(yt=!0,s.memoizedState=l):(s=kg(),Oe.lanes|=s,Bs|=s,r)}function M_(s,r,l,o,u){var f=Z.p;Z.p=f!==0&&8>f?f:8;var v=O.T,x={};O.T=x,Vc(s,!1,r,l);try{var M=u(),F=O.S;if(F!==null&&F(x,M),M!==null&&typeof M=="object"&&typeof M.then=="function"){var J=lS(M,o);Xn(s,r,J,fi(s))}else Xn(s,r,o,fi(s))}catch(le){Xn(s,r,{then:function(){},status:"rejected",reason:le},fi())}finally{Z.p=f,v!==null&&x.types!==null&&(v.types=x.types),O.T=v}}function dS(){}function Gc(s,r,l,o){if(s.tag!==5)throw Error(a(476));var u=L_(s).queue;M_(s,u,r,N,l===null?dS:function(){return B_(s),l(o)})}function L_(s){var r=s.memoizedState;if(r!==null)return r;r={memoizedState:N,baseState:N,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:is,lastRenderedState:N},next:null};var l={};return r.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:is,lastRenderedState:l},next:null},s.memoizedState=r,s=s.alternate,s!==null&&(s.memoizedState=r),r}function B_(s){var r=L_(s);r.next===null&&(r=s.alternate.memoizedState),Xn(s,r.next.queue,{},fi())}function Xc(){return Ht(ul)}function O_(){return gt().memoizedState}function z_(){return gt().memoizedState}function fS(s){for(var r=s.return;r!==null;){switch(r.tag){case 24:case 3:var l=fi();s=As(l);var o=Rs(r,s,l);o!==null&&(ei(o,r,l),Pn(o,r,l)),r={cache:wc()},s.payload=r;return}r=r.return}}function _S(s,r,l){var o=fi();l={lane:o,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},xa(s)?H_(r,l):(l=dc(s,r,l,o),l!==null&&(ei(l,s,o),U_(l,r,o)))}function N_(s,r,l){var o=fi();Xn(s,r,l,o)}function Xn(s,r,l,o){var u={lane:o,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(xa(s))H_(r,u);else{var f=s.alternate;if(s.lanes===0&&(f===null||f.lanes===0)&&(f=r.lastRenderedReducer,f!==null))try{var v=r.lastRenderedState,x=f(v,l);if(u.hasEagerState=!0,u.eagerState=x,ai(x,v))return ra(s,r,u,0),Je===null&&sa(),!1}catch{}if(l=dc(s,r,u,o),l!==null)return ei(l,s,o),U_(l,r,o),!0}return!1}function Vc(s,r,l,o){if(o={lane:2,revertLane:Ah(),gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},xa(s)){if(r)throw Error(a(479))}else r=dc(s,l,o,2),r!==null&&ei(r,s,2)}function xa(s){var r=s.alternate;return s===Oe||r!==null&&r===Oe}function H_(s,r){Zr=ma=!0;var l=s.pending;l===null?r.next=r:(r.next=l.next,l.next=r),s.pending=r}function U_(s,r,l){if((l&4194048)!==0){var o=r.lanes;o&=s.pendingLanes,l|=o,r.lanes=l,Fd(s,l)}}var Vn={readContext:Ht,use:Sa,useCallback:ht,useContext:ht,useEffect:ht,useImperativeHandle:ht,useLayoutEffect:ht,useInsertionEffect:ht,useMemo:ht,useReducer:ht,useRef:ht,useState:ht,useDebugValue:ht,useDeferredValue:ht,useTransition:ht,useSyncExternalStore:ht,useId:ht,useHostTransitionStatus:ht,useFormState:ht,useActionState:ht,useOptimistic:ht,useMemoCache:ht,useCacheRefresh:ht};Vn.useEffectEvent=ht;var I_={readContext:Ht,use:Sa,useCallback:function(s,r){return Yt().memoizedState=[s,r===void 0?null:r],s},useContext:Ht,useEffect:C_,useImperativeHandle:function(s,r,l){l=l!=null?l.concat([s]):null,Ca(4194308,4,T_.bind(null,r,s),l)},useLayoutEffect:function(s,r){return Ca(4194308,4,s,r)},useInsertionEffect:function(s,r){Ca(4,2,s,r)},useMemo:function(s,r){var l=Yt();r=r===void 0?null:r;var o=s();if(dr){ys(!0);try{s()}finally{ys(!1)}}return l.memoizedState=[o,r],o},useReducer:function(s,r,l){var o=Yt();if(l!==void 0){var u=l(r);if(dr){ys(!0);try{l(r)}finally{ys(!1)}}}else u=r;return o.memoizedState=o.baseState=u,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:u},o.queue=s,s=s.dispatch=_S.bind(null,Oe,s),[o.memoizedState,s]},useRef:function(s){var r=Yt();return s={current:s},r.memoizedState=s},useState:function(s){s=Fc(s);var r=s.queue,l=N_.bind(null,Oe,r);return r.dispatch=l,[s.memoizedState,l]},useDebugValue:qc,useDeferredValue:function(s,r){var l=Yt();return Kc(l,s,r)},useTransition:function(){var s=Fc(!1);return s=M_.bind(null,Oe,s.queue,!0,!1),Yt().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,r,l){var o=Oe,u=Yt();if(Pe){if(l===void 0)throw Error(a(407));l=l()}else{if(l=r(),Je===null)throw Error(a(349));(We&127)!==0||l_(o,r,l)}u.memoizedState=l;var f={value:l,getSnapshot:r};return u.queue=f,C_(o_.bind(null,o,f,s),[s]),o.flags|=2048,Jr(9,{destroy:void 0},a_.bind(null,o,f,l,r),null),l},useId:function(){var s=Yt(),r=Je.identifierPrefix;if(Pe){var l=Ni,o=zi;l=(o&~(1<<32-li(o)-1)).toString(32)+l,r="_"+r+"R_"+l,l=va++,0<l&&(r+="H"+l.toString(32)),r+="_"}else l=aS++,r="_"+r+"r_"+l.toString(32)+"_";return s.memoizedState=r},useHostTransitionStatus:Xc,useFormState:m_,useActionState:m_,useOptimistic:function(s){var r=Yt();r.memoizedState=r.baseState=s;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=l,r=Vc.bind(null,Oe,!0,l),l.dispatch=r,[s,r]},useMemoCache:Ic,useCacheRefresh:function(){return Yt().memoizedState=fS.bind(null,Oe)},useEffectEvent:function(s){var r=Yt(),l={impl:s};return r.memoizedState=l,function(){if((Ke&2)!==0)throw Error(a(440));return l.impl.apply(void 0,arguments)}}},$c={readContext:Ht,use:Sa,useCallback:R_,useContext:Ht,useEffect:Yc,useImperativeHandle:A_,useInsertionEffect:x_,useLayoutEffect:E_,useMemo:D_,useReducer:ba,useRef:b_,useState:function(){return ba(is)},useDebugValue:qc,useDeferredValue:function(s,r){var l=gt();return k_(l,Ve.memoizedState,s,r)},useTransition:function(){var s=ba(is)[0],r=gt().memoizedState;return[typeof s=="boolean"?s:Gn(s),r]},useSyncExternalStore:n_,useId:O_,useHostTransitionStatus:Xc,useFormState:v_,useActionState:v_,useOptimistic:function(s,r){var l=gt();return u_(l,Ve,s,r)},useMemoCache:Ic,useCacheRefresh:z_};$c.useEffectEvent=w_;var j_={readContext:Ht,use:Sa,useCallback:R_,useContext:Ht,useEffect:Yc,useImperativeHandle:A_,useInsertionEffect:x_,useLayoutEffect:E_,useMemo:D_,useReducer:Wc,useRef:b_,useState:function(){return Wc(is)},useDebugValue:qc,useDeferredValue:function(s,r){var l=gt();return Ve===null?Kc(l,s,r):k_(l,Ve.memoizedState,s,r)},useTransition:function(){var s=Wc(is)[0],r=gt().memoizedState;return[typeof s=="boolean"?s:Gn(s),r]},useSyncExternalStore:n_,useId:O_,useHostTransitionStatus:Xc,useFormState:S_,useActionState:S_,useOptimistic:function(s,r){var l=gt();return Ve!==null?u_(l,Ve,s,r):(l.baseState=s,[s,l.queue.dispatch])},useMemoCache:Ic,useCacheRefresh:z_};j_.useEffectEvent=w_;function Zc(s,r,l,o){r=s.memoizedState,l=l(o,r),l=l==null?r:b({},r,l),s.memoizedState=l,s.lanes===0&&(s.updateQueue.baseState=l)}var Qc={enqueueSetState:function(s,r,l){s=s._reactInternals;var o=fi(),u=As(o);u.payload=r,l!=null&&(u.callback=l),r=Rs(s,u,o),r!==null&&(ei(r,s,o),Pn(r,s,o))},enqueueReplaceState:function(s,r,l){s=s._reactInternals;var o=fi(),u=As(o);u.tag=1,u.payload=r,l!=null&&(u.callback=l),r=Rs(s,u,o),r!==null&&(ei(r,s,o),Pn(r,s,o))},enqueueForceUpdate:function(s,r){s=s._reactInternals;var l=fi(),o=As(l);o.tag=2,r!=null&&(o.callback=r),r=Rs(s,o,l),r!==null&&(ei(r,s,l),Pn(r,s,l))}};function W_(s,r,l,o,u,f,v){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(o,f,v):r.prototype&&r.prototype.isPureReactComponent?!zn(l,o)||!zn(u,f):!0}function F_(s,r,l,o){s=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(l,o),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(l,o),r.state!==s&&Qc.enqueueReplaceState(r,r.state,null)}function fr(s,r){var l=r;if("ref"in r){l={};for(var o in r)o!=="ref"&&(l[o]=r[o])}if(s=s.defaultProps){l===r&&(l=b({},l));for(var u in s)l[u]===void 0&&(l[u]=s[u])}return l}function P_(s){ia(s)}function Y_(s){console.error(s)}function q_(s){ia(s)}function Ea(s,r){try{var l=s.onUncaughtError;l(r.value,{componentStack:r.stack})}catch(o){setTimeout(function(){throw o})}}function K_(s,r,l){try{var o=s.onCaughtError;o(l.value,{componentStack:l.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(u){setTimeout(function(){throw u})}}function Jc(s,r,l){return l=As(l),l.tag=3,l.payload={element:null},l.callback=function(){Ea(s,r)},l}function G_(s){return s=As(s),s.tag=3,s}function X_(s,r,l,o){var u=l.type.getDerivedStateFromError;if(typeof u=="function"){var f=o.value;s.payload=function(){return u(f)},s.callback=function(){K_(r,l,o)}}var v=l.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(s.callback=function(){K_(r,l,o),typeof u!="function"&&(Os===null?Os=new Set([this]):Os.add(this));var x=o.stack;this.componentDidCatch(o.value,{componentStack:x!==null?x:""})})}function gS(s,r,l,o,u){if(l.flags|=32768,o!==null&&typeof o=="object"&&typeof o.then=="function"){if(r=l.alternate,r!==null&&qr(r,l,u,!0),l=ci.current,l!==null){switch(l.tag){case 31:case 13:return xi===null?Ha():l.alternate===null&&ut===0&&(ut=3),l.flags&=-257,l.flags|=65536,l.lanes=u,o===da?l.flags|=16384:(r=l.updateQueue,r===null?l.updateQueue=new Set([o]):r.add(o),xh(s,o,u)),!1;case 22:return l.flags|=65536,o===da?l.flags|=16384:(r=l.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([o])},l.updateQueue=r):(l=r.retryQueue,l===null?r.retryQueue=new Set([o]):l.add(o)),xh(s,o,u)),!1}throw Error(a(435,l.tag))}return xh(s,o,u),Ha(),!1}if(Pe)return r=ci.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=u,o!==vc&&(s=Error(a(422),{cause:o}),Un(Si(s,l)))):(o!==vc&&(r=Error(a(423),{cause:o}),Un(Si(r,l))),s=s.current.alternate,s.flags|=65536,u&=-u,s.lanes|=u,o=Si(o,l),u=Jc(s.stateNode,o,u),Dc(s,u),ut!==4&&(ut=2)),!1;var f=Error(a(520),{cause:o});if(f=Si(f,l),sl===null?sl=[f]:sl.push(f),ut!==4&&(ut=2),r===null)return!0;o=Si(o,l),l=r;do{switch(l.tag){case 3:return l.flags|=65536,s=u&-u,l.lanes|=s,s=Jc(l.stateNode,o,s),Dc(l,s),!1;case 1:if(r=l.type,f=l.stateNode,(l.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&(Os===null||!Os.has(f))))return l.flags|=65536,u&=-u,l.lanes|=u,u=G_(u),X_(u,s,l,o),Dc(l,u),!1}l=l.return}while(l!==null);return!1}var eh=Error(a(461)),yt=!1;function Ut(s,r,l,o){r.child=s===null?Qf(r,null,l,o):ur(r,s.child,l,o)}function V_(s,r,l,o,u){l=l.render;var f=r.ref;if("ref"in o){var v={};for(var x in o)x!=="ref"&&(v[x]=o[x])}else v=o;return ar(r),o=zc(s,r,l,v,f,u),x=Nc(),s!==null&&!yt?(Hc(s,r,u),ss(s,r,u)):(Pe&&x&&pc(r),r.flags|=1,Ut(s,r,o,u),r.child)}function $_(s,r,l,o,u){if(s===null){var f=l.type;return typeof f=="function"&&!fc(f)&&f.defaultProps===void 0&&l.compare===null?(r.tag=15,r.type=f,Z_(s,r,f,o,u)):(s=la(l.type,null,o,r,r.mode,u),s.ref=r.ref,s.return=r,r.child=s)}if(f=s.child,!oh(s,u)){var v=f.memoizedProps;if(l=l.compare,l=l!==null?l:zn,l(v,o)&&s.ref===r.ref)return ss(s,r,u)}return r.flags|=1,s=Zi(f,o),s.ref=r.ref,s.return=r,r.child=s}function Z_(s,r,l,o,u){if(s!==null){var f=s.memoizedProps;if(zn(f,o)&&s.ref===r.ref)if(yt=!1,r.pendingProps=o=f,oh(s,u))(s.flags&131072)!==0&&(yt=!0);else return r.lanes=s.lanes,ss(s,r,u)}return th(s,r,l,o,u)}function Q_(s,r,l,o){var u=o.children,f=s!==null?s.memoizedState:null;if(s===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.mode==="hidden"){if((r.flags&128)!==0){if(f=f!==null?f.baseLanes|l:l,s!==null){for(o=r.child=s.child,u=0;o!==null;)u=u|o.lanes|o.childLanes,o=o.sibling;o=u&~f}else o=0,r.child=null;return J_(s,r,f,l,o)}if((l&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},s!==null&&ha(r,f!==null?f.cachePool:null),f!==null?t_(r,f):Mc(),i_(r);else return o=r.lanes=536870912,J_(s,r,f!==null?f.baseLanes|l:l,l,o)}else f!==null?(ha(r,f.cachePool),t_(r,f),ks(),r.memoizedState=null):(s!==null&&ha(r,null),Mc(),ks());return Ut(s,r,u,l),r.child}function $n(s,r){return s!==null&&s.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function J_(s,r,l,o,u){var f=Ec();return f=f===null?null:{parent:mt._currentValue,pool:f},r.memoizedState={baseLanes:l,cachePool:f},s!==null&&ha(r,null),Mc(),i_(r),s!==null&&qr(s,r,o,!0),r.childLanes=u,null}function Ta(s,r){return r=Ra({mode:r.mode,children:r.children},s.mode),r.ref=s.ref,s.child=r,r.return=s,r}function eg(s,r,l){return ur(r,s.child,null,l),s=Ta(r,r.pendingProps),s.flags|=2,hi(r),r.memoizedState=null,s}function pS(s,r,l){var o=r.pendingProps,u=(r.flags&128)!==0;if(r.flags&=-129,s===null){if(Pe){if(o.mode==="hidden")return s=Ta(r,o),r.lanes=536870912,$n(null,s);if(Bc(r),(s=tt)?(s=dp(s,wi),s=s!==null&&s.data==="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:Cs!==null?{id:zi,overflow:Ni}:null,retryLane:536870912,hydrationErrors:null},l=Hf(s),l.return=r,r.child=l,Nt=r,tt=null)):s=null,s===null)throw xs(r);return r.lanes=536870912,null}return Ta(r,o)}var f=s.memoizedState;if(f!==null){var v=f.dehydrated;if(Bc(r),u)if(r.flags&256)r.flags&=-257,r=eg(s,r,l);else if(r.memoizedState!==null)r.child=s.child,r.flags|=128,r=null;else throw Error(a(558));else if(yt||qr(s,r,l,!1),u=(l&s.childLanes)!==0,yt||u){if(o=Je,o!==null&&(v=Pd(o,l),v!==0&&v!==f.retryLane))throw f.retryLane=v,sr(s,v),ei(o,s,v),eh;Ha(),r=eg(s,r,l)}else s=f.treeContext,tt=Ei(v.nextSibling),Nt=r,Pe=!0,ws=null,wi=!1,s!==null&&jf(r,s),r=Ta(r,o),r.flags|=4096;return r}return s=Zi(s.child,{mode:o.mode,children:o.children}),s.ref=r.ref,r.child=s,s.return=r,s}function Aa(s,r){var l=r.ref;if(l===null)s!==null&&s.ref!==null&&(r.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(a(284));(s===null||s.ref!==l)&&(r.flags|=4194816)}}function th(s,r,l,o,u){return ar(r),l=zc(s,r,l,o,void 0,u),o=Nc(),s!==null&&!yt?(Hc(s,r,u),ss(s,r,u)):(Pe&&o&&pc(r),r.flags|=1,Ut(s,r,l,u),r.child)}function tg(s,r,l,o,u,f){return ar(r),r.updateQueue=null,l=r_(r,o,l,u),s_(s),o=Nc(),s!==null&&!yt?(Hc(s,r,f),ss(s,r,f)):(Pe&&o&&pc(r),r.flags|=1,Ut(s,r,l,f),r.child)}function ig(s,r,l,o,u){if(ar(r),r.stateNode===null){var f=Wr,v=l.contextType;typeof v=="object"&&v!==null&&(f=Ht(v)),f=new l(o,f),r.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=Qc,r.stateNode=f,f._reactInternals=r,f=r.stateNode,f.props=o,f.state=r.memoizedState,f.refs={},Ac(r),v=l.contextType,f.context=typeof v=="object"&&v!==null?Ht(v):Wr,f.state=r.memoizedState,v=l.getDerivedStateFromProps,typeof v=="function"&&(Zc(r,l,v,o),f.state=r.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(v=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),v!==f.state&&Qc.enqueueReplaceState(f,f.state,null),qn(r,o,f,u),Yn(),f.state=r.memoizedState),typeof f.componentDidMount=="function"&&(r.flags|=4194308),o=!0}else if(s===null){f=r.stateNode;var x=r.memoizedProps,M=fr(l,x);f.props=M;var F=f.context,J=l.contextType;v=Wr,typeof J=="object"&&J!==null&&(v=Ht(J));var le=l.getDerivedStateFromProps;J=typeof le=="function"||typeof f.getSnapshotBeforeUpdate=="function",x=r.pendingProps!==x,J||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(x||F!==v)&&F_(r,f,o,v),Ts=!1;var P=r.memoizedState;f.state=P,qn(r,o,f,u),Yn(),F=r.memoizedState,x||P!==F||Ts?(typeof le=="function"&&(Zc(r,l,le,o),F=r.memoizedState),(M=Ts||W_(r,l,M,o,P,F,v))?(J||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(r.flags|=4194308)):(typeof f.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=o,r.memoizedState=F),f.props=o,f.state=F,f.context=v,o=M):(typeof f.componentDidMount=="function"&&(r.flags|=4194308),o=!1)}else{f=r.stateNode,Rc(s,r),v=r.memoizedProps,J=fr(l,v),f.props=J,le=r.pendingProps,P=f.context,F=l.contextType,M=Wr,typeof F=="object"&&F!==null&&(M=Ht(F)),x=l.getDerivedStateFromProps,(F=typeof x=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(v!==le||P!==M)&&F_(r,f,o,M),Ts=!1,P=r.memoizedState,f.state=P,qn(r,o,f,u),Yn();var G=r.memoizedState;v!==le||P!==G||Ts||s!==null&&s.dependencies!==null&&oa(s.dependencies)?(typeof x=="function"&&(Zc(r,l,x,o),G=r.memoizedState),(J=Ts||W_(r,l,J,o,P,G,M)||s!==null&&s.dependencies!==null&&oa(s.dependencies))?(F||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(o,G,M),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(o,G,M)),typeof f.componentDidUpdate=="function"&&(r.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof f.componentDidUpdate!="function"||v===s.memoizedProps&&P===s.memoizedState||(r.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||v===s.memoizedProps&&P===s.memoizedState||(r.flags|=1024),r.memoizedProps=o,r.memoizedState=G),f.props=o,f.state=G,f.context=M,o=J):(typeof f.componentDidUpdate!="function"||v===s.memoizedProps&&P===s.memoizedState||(r.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||v===s.memoizedProps&&P===s.memoizedState||(r.flags|=1024),o=!1)}return f=o,Aa(s,r),o=(r.flags&128)!==0,f||o?(f=r.stateNode,l=o&&typeof l.getDerivedStateFromError!="function"?null:f.render(),r.flags|=1,s!==null&&o?(r.child=ur(r,s.child,null,u),r.child=ur(r,null,l,u)):Ut(s,r,l,u),r.memoizedState=f.state,s=r.child):s=ss(s,r,u),s}function sg(s,r,l,o){return nr(),r.flags|=256,Ut(s,r,l,o),r.child}var ih={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function sh(s){return{baseLanes:s,cachePool:Kf()}}function rh(s,r,l){return s=s!==null?s.childLanes&~l:0,r&&(s|=di),s}function rg(s,r,l){var o=r.pendingProps,u=!1,f=(r.flags&128)!==0,v;if((v=f)||(v=s!==null&&s.memoizedState===null?!1:(_t.current&2)!==0),v&&(u=!0,r.flags&=-129),v=(r.flags&32)!==0,r.flags&=-33,s===null){if(Pe){if(u?Ds(r):ks(),(s=tt)?(s=dp(s,wi),s=s!==null&&s.data!=="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:Cs!==null?{id:zi,overflow:Ni}:null,retryLane:536870912,hydrationErrors:null},l=Hf(s),l.return=r,r.child=l,Nt=r,tt=null)):s=null,s===null)throw xs(r);return jh(s)?r.lanes=32:r.lanes=536870912,null}var x=o.children;return o=o.fallback,u?(ks(),u=r.mode,x=Ra({mode:"hidden",children:x},u),o=rr(o,u,l,null),x.return=r,o.return=r,x.sibling=o,r.child=x,o=r.child,o.memoizedState=sh(l),o.childLanes=rh(s,v,l),r.memoizedState=ih,$n(null,o)):(Ds(r),nh(r,x))}var M=s.memoizedState;if(M!==null&&(x=M.dehydrated,x!==null)){if(f)r.flags&256?(Ds(r),r.flags&=-257,r=lh(s,r,l)):r.memoizedState!==null?(ks(),r.child=s.child,r.flags|=128,r=null):(ks(),x=o.fallback,u=r.mode,o=Ra({mode:"visible",children:o.children},u),x=rr(x,u,l,null),x.flags|=2,o.return=r,x.return=r,o.sibling=x,r.child=o,ur(r,s.child,null,l),o=r.child,o.memoizedState=sh(l),o.childLanes=rh(s,v,l),r.memoizedState=ih,r=$n(null,o));else if(Ds(r),jh(x)){if(v=x.nextSibling&&x.nextSibling.dataset,v)var F=v.dgst;v=F,o=Error(a(419)),o.stack="",o.digest=v,Un({value:o,source:null,stack:null}),r=lh(s,r,l)}else if(yt||qr(s,r,l,!1),v=(l&s.childLanes)!==0,yt||v){if(v=Je,v!==null&&(o=Pd(v,l),o!==0&&o!==M.retryLane))throw M.retryLane=o,sr(s,o),ei(v,s,o),eh;Ih(x)||Ha(),r=lh(s,r,l)}else Ih(x)?(r.flags|=192,r.child=s.child,r=null):(s=M.treeContext,tt=Ei(x.nextSibling),Nt=r,Pe=!0,ws=null,wi=!1,s!==null&&jf(r,s),r=nh(r,o.children),r.flags|=4096);return r}return u?(ks(),x=o.fallback,u=r.mode,M=s.child,F=M.sibling,o=Zi(M,{mode:"hidden",children:o.children}),o.subtreeFlags=M.subtreeFlags&65011712,F!==null?x=Zi(F,x):(x=rr(x,u,l,null),x.flags|=2),x.return=r,o.return=r,o.sibling=x,r.child=o,$n(null,o),o=r.child,x=s.child.memoizedState,x===null?x=sh(l):(u=x.cachePool,u!==null?(M=mt._currentValue,u=u.parent!==M?{parent:M,pool:M}:u):u=Kf(),x={baseLanes:x.baseLanes|l,cachePool:u}),o.memoizedState=x,o.childLanes=rh(s,v,l),r.memoizedState=ih,$n(s.child,o)):(Ds(r),l=s.child,s=l.sibling,l=Zi(l,{mode:"visible",children:o.children}),l.return=r,l.sibling=null,s!==null&&(v=r.deletions,v===null?(r.deletions=[s],r.flags|=16):v.push(s)),r.child=l,r.memoizedState=null,l)}function nh(s,r){return r=Ra({mode:"visible",children:r},s.mode),r.return=s,s.child=r}function Ra(s,r){return s=oi(22,s,null,r),s.lanes=0,s}function lh(s,r,l){return ur(r,s.child,null,l),s=nh(r,r.pendingProps.children),s.flags|=2,r.memoizedState=null,s}function ng(s,r,l){s.lanes|=r;var o=s.alternate;o!==null&&(o.lanes|=r),bc(s.return,r,l)}function ah(s,r,l,o,u,f){var v=s.memoizedState;v===null?s.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:o,tail:l,tailMode:u,treeForkCount:f}:(v.isBackwards=r,v.rendering=null,v.renderingStartTime=0,v.last=o,v.tail=l,v.tailMode=u,v.treeForkCount=f)}function lg(s,r,l){var o=r.pendingProps,u=o.revealOrder,f=o.tail;o=o.children;var v=_t.current,x=(v&2)!==0;if(x?(v=v&1|2,r.flags|=128):v&=1,L(_t,v),Ut(s,r,o,l),o=Pe?Hn:0,!x&&s!==null&&(s.flags&128)!==0)e:for(s=r.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&ng(s,l,r);else if(s.tag===19)ng(s,l,r);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(u){case"forwards":for(l=r.child,u=null;l!==null;)s=l.alternate,s!==null&&pa(s)===null&&(u=l),l=l.sibling;l=u,l===null?(u=r.child,r.child=null):(u=l.sibling,l.sibling=null),ah(r,!1,u,l,f,o);break;case"backwards":case"unstable_legacy-backwards":for(l=null,u=r.child,r.child=null;u!==null;){if(s=u.alternate,s!==null&&pa(s)===null){r.child=u;break}s=u.sibling,u.sibling=l,l=u,u=s}ah(r,!0,l,null,f,o);break;case"together":ah(r,!1,null,null,void 0,o);break;default:r.memoizedState=null}return r.child}function ss(s,r,l){if(s!==null&&(r.dependencies=s.dependencies),Bs|=r.lanes,(l&r.childLanes)===0)if(s!==null){if(qr(s,r,l,!1),(l&r.childLanes)===0)return null}else return null;if(s!==null&&r.child!==s.child)throw Error(a(153));if(r.child!==null){for(s=r.child,l=Zi(s,s.pendingProps),r.child=l,l.return=r;s.sibling!==null;)s=s.sibling,l=l.sibling=Zi(s,s.pendingProps),l.return=r;l.sibling=null}return r.child}function oh(s,r){return(s.lanes&r)!==0?!0:(s=s.dependencies,!!(s!==null&&oa(s)))}function mS(s,r,l){switch(r.tag){case 3:ye(r,r.stateNode.containerInfo),Es(r,mt,s.memoizedState.cache),nr();break;case 27:case 5:Ae(r);break;case 4:ye(r,r.stateNode.containerInfo);break;case 10:Es(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,Bc(r),null;break;case 13:var o=r.memoizedState;if(o!==null)return o.dehydrated!==null?(Ds(r),r.flags|=128,null):(l&r.child.childLanes)!==0?rg(s,r,l):(Ds(r),s=ss(s,r,l),s!==null?s.sibling:null);Ds(r);break;case 19:var u=(s.flags&128)!==0;if(o=(l&r.childLanes)!==0,o||(qr(s,r,l,!1),o=(l&r.childLanes)!==0),u){if(o)return lg(s,r,l);r.flags|=128}if(u=r.memoizedState,u!==null&&(u.rendering=null,u.tail=null,u.lastEffect=null),L(_t,_t.current),o)break;return null;case 22:return r.lanes=0,Q_(s,r,l,r.pendingProps);case 24:Es(r,mt,s.memoizedState.cache)}return ss(s,r,l)}function ag(s,r,l){if(s!==null)if(s.memoizedProps!==r.pendingProps)yt=!0;else{if(!oh(s,l)&&(r.flags&128)===0)return yt=!1,mS(s,r,l);yt=(s.flags&131072)!==0}else yt=!1,Pe&&(r.flags&1048576)!==0&&If(r,Hn,r.index);switch(r.lanes=0,r.tag){case 16:e:{var o=r.pendingProps;if(s=cr(r.elementType),r.type=s,typeof s=="function")fc(s)?(o=fr(s,o),r.tag=1,r=ig(null,r,s,o,l)):(r.tag=0,r=th(null,r,s,o,l));else{if(s!=null){var u=s.$$typeof;if(u===ue){r.tag=11,r=V_(null,r,s,o,l);break e}else if(u===q){r.tag=14,r=$_(null,r,s,o,l);break e}}throw r=ne(s)||s,Error(a(306,r,""))}}return r;case 0:return th(s,r,r.type,r.pendingProps,l);case 1:return o=r.type,u=fr(o,r.pendingProps),ig(s,r,o,u,l);case 3:e:{if(ye(r,r.stateNode.containerInfo),s===null)throw Error(a(387));o=r.pendingProps;var f=r.memoizedState;u=f.element,Rc(s,r),qn(r,o,null,l);var v=r.memoizedState;if(o=v.cache,Es(r,mt,o),o!==f.cache&&Cc(r,[mt],l,!0),Yn(),o=v.element,f.isDehydrated)if(f={element:o,isDehydrated:!1,cache:v.cache},r.updateQueue.baseState=f,r.memoizedState=f,r.flags&256){r=sg(s,r,o,l);break e}else if(o!==u){u=Si(Error(a(424)),r),Un(u),r=sg(s,r,o,l);break e}else for(s=r.stateNode.containerInfo,s.nodeType===9?s=s.body:s=s.nodeName==="HTML"?s.ownerDocument.body:s,tt=Ei(s.firstChild),Nt=r,Pe=!0,ws=null,wi=!0,l=Qf(r,null,o,l),r.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(nr(),o===u){r=ss(s,r,l);break e}Ut(s,r,o,l)}r=r.child}return r;case 26:return Aa(s,r),s===null?(l=vp(r.type,null,r.pendingProps,null))?r.memoizedState=l:Pe||(l=r.type,s=r.pendingProps,o=Ya(I.current).createElement(l),o[zt]=r,o[Xt]=s,It(o,l,s),Rt(o),r.stateNode=o):r.memoizedState=vp(r.type,s.memoizedProps,r.pendingProps,s.memoizedState),null;case 27:return Ae(r),s===null&&Pe&&(o=r.stateNode=gp(r.type,r.pendingProps,I.current),Nt=r,wi=!0,u=tt,Us(r.type)?(Wh=u,tt=Ei(o.firstChild)):tt=u),Ut(s,r,r.pendingProps.children,l),Aa(s,r),s===null&&(r.flags|=4194304),r.child;case 5:return s===null&&Pe&&((u=o=tt)&&(o=GS(o,r.type,r.pendingProps,wi),o!==null?(r.stateNode=o,Nt=r,tt=Ei(o.firstChild),wi=!1,u=!0):u=!1),u||xs(r)),Ae(r),u=r.type,f=r.pendingProps,v=s!==null?s.memoizedProps:null,o=f.children,Nh(u,f)?o=null:v!==null&&Nh(u,v)&&(r.flags|=32),r.memoizedState!==null&&(u=zc(s,r,oS,null,null,l),ul._currentValue=u),Aa(s,r),Ut(s,r,o,l),r.child;case 6:return s===null&&Pe&&((s=l=tt)&&(l=XS(l,r.pendingProps,wi),l!==null?(r.stateNode=l,Nt=r,tt=null,s=!0):s=!1),s||xs(r)),null;case 13:return rg(s,r,l);case 4:return ye(r,r.stateNode.containerInfo),o=r.pendingProps,s===null?r.child=ur(r,null,o,l):Ut(s,r,o,l),r.child;case 11:return V_(s,r,r.type,r.pendingProps,l);case 7:return Ut(s,r,r.pendingProps,l),r.child;case 8:return Ut(s,r,r.pendingProps.children,l),r.child;case 12:return Ut(s,r,r.pendingProps.children,l),r.child;case 10:return o=r.pendingProps,Es(r,r.type,o.value),Ut(s,r,o.children,l),r.child;case 9:return u=r.type._context,o=r.pendingProps.children,ar(r),u=Ht(u),o=o(u),r.flags|=1,Ut(s,r,o,l),r.child;case 14:return $_(s,r,r.type,r.pendingProps,l);case 15:return Z_(s,r,r.type,r.pendingProps,l);case 19:return lg(s,r,l);case 31:return pS(s,r,l);case 22:return Q_(s,r,l,r.pendingProps);case 24:return ar(r),o=Ht(mt),s===null?(u=Ec(),u===null&&(u=Je,f=wc(),u.pooledCache=f,f.refCount++,f!==null&&(u.pooledCacheLanes|=l),u=f),r.memoizedState={parent:o,cache:u},Ac(r),Es(r,mt,u)):((s.lanes&l)!==0&&(Rc(s,r),qn(r,null,null,l),Yn()),u=s.memoizedState,f=r.memoizedState,u.parent!==o?(u={parent:o,cache:o},r.memoizedState=u,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=u),Es(r,mt,o)):(o=f.cache,Es(r,mt,o),o!==u.cache&&Cc(r,[mt],l,!0))),Ut(s,r,r.pendingProps.children,l),r.child;case 29:throw r.pendingProps}throw Error(a(156,r.tag))}function rs(s){s.flags|=4}function ch(s,r,l,o,u){if((r=(s.mode&32)!==0)&&(r=!1),r){if(s.flags|=16777216,(u&335544128)===u)if(s.stateNode.complete)s.flags|=8192;else if(Og())s.flags|=8192;else throw hr=da,Tc}else s.flags&=-16777217}function og(s,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!wp(r))if(Og())s.flags|=8192;else throw hr=da,Tc}function Da(s,r){r!==null&&(s.flags|=4),s.flags&16384&&(r=s.tag!==22?jd():536870912,s.lanes|=r,rn|=r)}function Zn(s,r){if(!Pe)switch(s.tailMode){case"hidden":r=s.tail;for(var l=null;r!==null;)r.alternate!==null&&(l=r),r=r.sibling;l===null?s.tail=null:l.sibling=null;break;case"collapsed":l=s.tail;for(var o=null;l!==null;)l.alternate!==null&&(o=l),l=l.sibling;o===null?r||s.tail===null?s.tail=null:s.tail.sibling=null:o.sibling=null}}function it(s){var r=s.alternate!==null&&s.alternate.child===s.child,l=0,o=0;if(r)for(var u=s.child;u!==null;)l|=u.lanes|u.childLanes,o|=u.subtreeFlags&65011712,o|=u.flags&65011712,u.return=s,u=u.sibling;else for(u=s.child;u!==null;)l|=u.lanes|u.childLanes,o|=u.subtreeFlags,o|=u.flags,u.return=s,u=u.sibling;return s.subtreeFlags|=o,s.childLanes=l,r}function vS(s,r,l){var o=r.pendingProps;switch(mc(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return it(r),null;case 1:return it(r),null;case 3:return l=r.stateNode,o=null,s!==null&&(o=s.memoizedState.cache),r.memoizedState.cache!==o&&(r.flags|=2048),es(mt),fe(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(s===null||s.child===null)&&(Yr(r)?rs(r):s===null||s.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,yc())),it(r),null;case 26:var u=r.type,f=r.memoizedState;return s===null?(rs(r),f!==null?(it(r),og(r,f)):(it(r),ch(r,u,null,o,l))):f?f!==s.memoizedState?(rs(r),it(r),og(r,f)):(it(r),r.flags&=-16777217):(s=s.memoizedProps,s!==o&&rs(r),it(r),ch(r,u,s,o,l)),null;case 27:if(Se(r),l=I.current,u=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==o&&rs(r);else{if(!o){if(r.stateNode===null)throw Error(a(166));return it(r),null}s=z.current,Yr(r)?Wf(r):(s=gp(u,o,l),r.stateNode=s,rs(r))}return it(r),null;case 5:if(Se(r),u=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==o&&rs(r);else{if(!o){if(r.stateNode===null)throw Error(a(166));return it(r),null}if(f=z.current,Yr(r))Wf(r);else{var v=Ya(I.current);switch(f){case 1:f=v.createElementNS("http://www.w3.org/2000/svg",u);break;case 2:f=v.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;default:switch(u){case"svg":f=v.createElementNS("http://www.w3.org/2000/svg",u);break;case"math":f=v.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;case"script":f=v.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild);break;case"select":f=typeof o.is=="string"?v.createElement("select",{is:o.is}):v.createElement("select"),o.multiple?f.multiple=!0:o.size&&(f.size=o.size);break;default:f=typeof o.is=="string"?v.createElement(u,{is:o.is}):v.createElement(u)}}f[zt]=r,f[Xt]=o;e:for(v=r.child;v!==null;){if(v.tag===5||v.tag===6)f.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===r)break e;for(;v.sibling===null;){if(v.return===null||v.return===r)break e;v=v.return}v.sibling.return=v.return,v=v.sibling}r.stateNode=f;e:switch(It(f,u,o),u){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}o&&rs(r)}}return it(r),ch(r,r.type,s===null?null:s.memoizedProps,r.pendingProps,l),null;case 6:if(s&&r.stateNode!=null)s.memoizedProps!==o&&rs(r);else{if(typeof o!="string"&&r.stateNode===null)throw Error(a(166));if(s=I.current,Yr(r)){if(s=r.stateNode,l=r.memoizedProps,o=null,u=Nt,u!==null)switch(u.tag){case 27:case 5:o=u.memoizedProps}s[zt]=r,s=!!(s.nodeValue===l||o!==null&&o.suppressHydrationWarning===!0||rp(s.nodeValue,l)),s||xs(r,!0)}else s=Ya(s).createTextNode(o),s[zt]=r,r.stateNode=s}return it(r),null;case 31:if(l=r.memoizedState,s===null||s.memoizedState!==null){if(o=Yr(r),l!==null){if(s===null){if(!o)throw Error(a(318));if(s=r.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(a(557));s[zt]=r}else nr(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;it(r),s=!1}else l=yc(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=l),s=!0;if(!s)return r.flags&256?(hi(r),r):(hi(r),null);if((r.flags&128)!==0)throw Error(a(558))}return it(r),null;case 13:if(o=r.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(u=Yr(r),o!==null&&o.dehydrated!==null){if(s===null){if(!u)throw Error(a(318));if(u=r.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(a(317));u[zt]=r}else nr(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;it(r),u=!1}else u=yc(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=u),u=!0;if(!u)return r.flags&256?(hi(r),r):(hi(r),null)}return hi(r),(r.flags&128)!==0?(r.lanes=l,r):(l=o!==null,s=s!==null&&s.memoizedState!==null,l&&(o=r.child,u=null,o.alternate!==null&&o.alternate.memoizedState!==null&&o.alternate.memoizedState.cachePool!==null&&(u=o.alternate.memoizedState.cachePool.pool),f=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(f=o.memoizedState.cachePool.pool),f!==u&&(o.flags|=2048)),l!==s&&l&&(r.child.flags|=8192),Da(r,r.updateQueue),it(r),null);case 4:return fe(),s===null&&Mh(r.stateNode.containerInfo),it(r),null;case 10:return es(r.type),it(r),null;case 19:if(U(_t),o=r.memoizedState,o===null)return it(r),null;if(u=(r.flags&128)!==0,f=o.rendering,f===null)if(u)Zn(o,!1);else{if(ut!==0||s!==null&&(s.flags&128)!==0)for(s=r.child;s!==null;){if(f=pa(s),f!==null){for(r.flags|=128,Zn(o,!1),s=f.updateQueue,r.updateQueue=s,Da(r,s),r.subtreeFlags=0,s=l,l=r.child;l!==null;)Nf(l,s),l=l.sibling;return L(_t,_t.current&1|2),Pe&&Qi(r,o.treeForkCount),r.child}s=s.sibling}o.tail!==null&&ri()>Oa&&(r.flags|=128,u=!0,Zn(o,!1),r.lanes=4194304)}else{if(!u)if(s=pa(f),s!==null){if(r.flags|=128,u=!0,s=s.updateQueue,r.updateQueue=s,Da(r,s),Zn(o,!0),o.tail===null&&o.tailMode==="hidden"&&!f.alternate&&!Pe)return it(r),null}else 2*ri()-o.renderingStartTime>Oa&&l!==536870912&&(r.flags|=128,u=!0,Zn(o,!1),r.lanes=4194304);o.isBackwards?(f.sibling=r.child,r.child=f):(s=o.last,s!==null?s.sibling=f:r.child=f,o.last=f)}return o.tail!==null?(s=o.tail,o.rendering=s,o.tail=s.sibling,o.renderingStartTime=ri(),s.sibling=null,l=_t.current,L(_t,u?l&1|2:l&1),Pe&&Qi(r,o.treeForkCount),s):(it(r),null);case 22:case 23:return hi(r),Lc(),o=r.memoizedState!==null,s!==null?s.memoizedState!==null!==o&&(r.flags|=8192):o&&(r.flags|=8192),o?(l&536870912)!==0&&(r.flags&128)===0&&(it(r),r.subtreeFlags&6&&(r.flags|=8192)):it(r),l=r.updateQueue,l!==null&&Da(r,l.retryQueue),l=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),o=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),o!==l&&(r.flags|=2048),s!==null&&U(or),null;case 24:return l=null,s!==null&&(l=s.memoizedState.cache),r.memoizedState.cache!==l&&(r.flags|=2048),es(mt),it(r),null;case 25:return null;case 30:return null}throw Error(a(156,r.tag))}function yS(s,r){switch(mc(r),r.tag){case 1:return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 3:return es(mt),fe(),s=r.flags,(s&65536)!==0&&(s&128)===0?(r.flags=s&-65537|128,r):null;case 26:case 27:case 5:return Se(r),null;case 31:if(r.memoizedState!==null){if(hi(r),r.alternate===null)throw Error(a(340));nr()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 13:if(hi(r),s=r.memoizedState,s!==null&&s.dehydrated!==null){if(r.alternate===null)throw Error(a(340));nr()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 19:return U(_t),null;case 4:return fe(),null;case 10:return es(r.type),null;case 22:case 23:return hi(r),Lc(),s!==null&&U(or),s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 24:return es(mt),null;case 25:return null;default:return null}}function cg(s,r){switch(mc(r),r.tag){case 3:es(mt),fe();break;case 26:case 27:case 5:Se(r);break;case 4:fe();break;case 31:r.memoizedState!==null&&hi(r);break;case 13:hi(r);break;case 19:U(_t);break;case 10:es(r.type);break;case 22:case 23:hi(r),Lc(),s!==null&&U(or);break;case 24:es(mt)}}function Qn(s,r){try{var l=r.updateQueue,o=l!==null?l.lastEffect:null;if(o!==null){var u=o.next;l=u;do{if((l.tag&s)===s){o=void 0;var f=l.create,v=l.inst;o=f(),v.destroy=o}l=l.next}while(l!==u)}}catch(x){Xe(r,r.return,x)}}function Ms(s,r,l){try{var o=r.updateQueue,u=o!==null?o.lastEffect:null;if(u!==null){var f=u.next;o=f;do{if((o.tag&s)===s){var v=o.inst,x=v.destroy;if(x!==void 0){v.destroy=void 0,u=r;var M=l,F=x;try{F()}catch(J){Xe(u,M,J)}}}o=o.next}while(o!==f)}}catch(J){Xe(r,r.return,J)}}function hg(s){var r=s.updateQueue;if(r!==null){var l=s.stateNode;try{e_(r,l)}catch(o){Xe(s,s.return,o)}}}function ug(s,r,l){l.props=fr(s.type,s.memoizedProps),l.state=s.memoizedState;try{l.componentWillUnmount()}catch(o){Xe(s,r,o)}}function Jn(s,r){try{var l=s.ref;if(l!==null){switch(s.tag){case 26:case 27:case 5:var o=s.stateNode;break;case 30:o=s.stateNode;break;default:o=s.stateNode}typeof l=="function"?s.refCleanup=l(o):l.current=o}}catch(u){Xe(s,r,u)}}function Hi(s,r){var l=s.ref,o=s.refCleanup;if(l!==null)if(typeof o=="function")try{o()}catch(u){Xe(s,r,u)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(u){Xe(s,r,u)}else l.current=null}function dg(s){var r=s.type,l=s.memoizedProps,o=s.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":l.autoFocus&&o.focus();break e;case"img":l.src?o.src=l.src:l.srcSet&&(o.srcset=l.srcSet)}}catch(u){Xe(s,s.return,u)}}function hh(s,r,l){try{var o=s.stateNode;WS(o,s.type,l,r),o[Xt]=r}catch(u){Xe(s,s.return,u)}}function fg(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Us(s.type)||s.tag===4}function uh(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||fg(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Us(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function dh(s,r,l){var o=s.tag;if(o===5||o===6)s=s.stateNode,r?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(s,r):(r=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,r.appendChild(s),l=l._reactRootContainer,l!=null||r.onclick!==null||(r.onclick=Vi));else if(o!==4&&(o===27&&Us(s.type)&&(l=s.stateNode,r=null),s=s.child,s!==null))for(dh(s,r,l),s=s.sibling;s!==null;)dh(s,r,l),s=s.sibling}function ka(s,r,l){var o=s.tag;if(o===5||o===6)s=s.stateNode,r?l.insertBefore(s,r):l.appendChild(s);else if(o!==4&&(o===27&&Us(s.type)&&(l=s.stateNode),s=s.child,s!==null))for(ka(s,r,l),s=s.sibling;s!==null;)ka(s,r,l),s=s.sibling}function _g(s){var r=s.stateNode,l=s.memoizedProps;try{for(var o=s.type,u=r.attributes;u.length;)r.removeAttributeNode(u[0]);It(r,o,l),r[zt]=s,r[Xt]=l}catch(f){Xe(s,s.return,f)}}var ns=!1,St=!1,fh=!1,gg=typeof WeakSet=="function"?WeakSet:Set,Dt=null;function SS(s,r){if(s=s.containerInfo,Oh=Za,s=Af(s),lc(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else e:{l=(l=s.ownerDocument)&&l.defaultView||window;var o=l.getSelection&&l.getSelection();if(o&&o.rangeCount!==0){l=o.anchorNode;var u=o.anchorOffset,f=o.focusNode;o=o.focusOffset;try{l.nodeType,f.nodeType}catch{l=null;break e}var v=0,x=-1,M=-1,F=0,J=0,le=s,P=null;t:for(;;){for(var G;le!==l||u!==0&&le.nodeType!==3||(x=v+u),le!==f||o!==0&&le.nodeType!==3||(M=v+o),le.nodeType===3&&(v+=le.nodeValue.length),(G=le.firstChild)!==null;)P=le,le=G;for(;;){if(le===s)break t;if(P===l&&++F===u&&(x=v),P===f&&++J===o&&(M=v),(G=le.nextSibling)!==null)break;le=P,P=le.parentNode}le=G}l=x===-1||M===-1?null:{start:x,end:M}}else l=null}l=l||{start:0,end:0}}else l=null;for(zh={focusedElem:s,selectionRange:l},Za=!1,Dt=r;Dt!==null;)if(r=Dt,s=r.child,(r.subtreeFlags&1028)!==0&&s!==null)s.return=r,Dt=s;else for(;Dt!==null;){switch(r=Dt,f=r.alternate,s=r.flags,r.tag){case 0:if((s&4)!==0&&(s=r.updateQueue,s=s!==null?s.events:null,s!==null))for(l=0;l<s.length;l++)u=s[l],u.ref.impl=u.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&f!==null){s=void 0,l=r,u=f.memoizedProps,f=f.memoizedState,o=l.stateNode;try{var Ce=fr(l.type,u);s=o.getSnapshotBeforeUpdate(Ce,f),o.__reactInternalSnapshotBeforeUpdate=s}catch(ke){Xe(l,l.return,ke)}}break;case 3:if((s&1024)!==0){if(s=r.stateNode.containerInfo,l=s.nodeType,l===9)Uh(s);else if(l===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Uh(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(a(163))}if(s=r.sibling,s!==null){s.return=r.return,Dt=s;break}Dt=r.return}}function pg(s,r,l){var o=l.flags;switch(l.tag){case 0:case 11:case 15:as(s,l),o&4&&Qn(5,l);break;case 1:if(as(s,l),o&4)if(s=l.stateNode,r===null)try{s.componentDidMount()}catch(v){Xe(l,l.return,v)}else{var u=fr(l.type,r.memoizedProps);r=r.memoizedState;try{s.componentDidUpdate(u,r,s.__reactInternalSnapshotBeforeUpdate)}catch(v){Xe(l,l.return,v)}}o&64&&hg(l),o&512&&Jn(l,l.return);break;case 3:if(as(s,l),o&64&&(s=l.updateQueue,s!==null)){if(r=null,l.child!==null)switch(l.child.tag){case 27:case 5:r=l.child.stateNode;break;case 1:r=l.child.stateNode}try{e_(s,r)}catch(v){Xe(l,l.return,v)}}break;case 27:r===null&&o&4&&_g(l);case 26:case 5:as(s,l),r===null&&o&4&&dg(l),o&512&&Jn(l,l.return);break;case 12:as(s,l);break;case 31:as(s,l),o&4&&yg(s,l);break;case 13:as(s,l),o&4&&Sg(s,l),o&64&&(s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(l=DS.bind(null,l),VS(s,l))));break;case 22:if(o=l.memoizedState!==null||ns,!o){r=r!==null&&r.memoizedState!==null||St,u=ns;var f=St;ns=o,(St=r)&&!f?os(s,l,(l.subtreeFlags&8772)!==0):as(s,l),ns=u,St=f}break;case 30:break;default:as(s,l)}}function mg(s){var r=s.alternate;r!==null&&(s.alternate=null,mg(r)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(r=s.stateNode,r!==null&&Po(r)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var rt=null,$t=!1;function ls(s,r,l){for(l=l.child;l!==null;)vg(s,r,l),l=l.sibling}function vg(s,r,l){if(ni&&typeof ni.onCommitFiberUnmount=="function")try{ni.onCommitFiberUnmount(wn,l)}catch{}switch(l.tag){case 26:St||Hi(l,r),ls(s,r,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:St||Hi(l,r);var o=rt,u=$t;Us(l.type)&&(rt=l.stateNode,$t=!1),ls(s,r,l),ol(l.stateNode),rt=o,$t=u;break;case 5:St||Hi(l,r);case 6:if(o=rt,u=$t,rt=null,ls(s,r,l),rt=o,$t=u,rt!==null)if($t)try{(rt.nodeType===9?rt.body:rt.nodeName==="HTML"?rt.ownerDocument.body:rt).removeChild(l.stateNode)}catch(f){Xe(l,r,f)}else try{rt.removeChild(l.stateNode)}catch(f){Xe(l,r,f)}break;case 18:rt!==null&&($t?(s=rt,hp(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,l.stateNode),dn(s)):hp(rt,l.stateNode));break;case 4:o=rt,u=$t,rt=l.stateNode.containerInfo,$t=!0,ls(s,r,l),rt=o,$t=u;break;case 0:case 11:case 14:case 15:Ms(2,l,r),St||Ms(4,l,r),ls(s,r,l);break;case 1:St||(Hi(l,r),o=l.stateNode,typeof o.componentWillUnmount=="function"&&ug(l,r,o)),ls(s,r,l);break;case 21:ls(s,r,l);break;case 22:St=(o=St)||l.memoizedState!==null,ls(s,r,l),St=o;break;default:ls(s,r,l)}}function yg(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{dn(s)}catch(l){Xe(r,r.return,l)}}}function Sg(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{dn(s)}catch(l){Xe(r,r.return,l)}}function bS(s){switch(s.tag){case 31:case 13:case 19:var r=s.stateNode;return r===null&&(r=s.stateNode=new gg),r;case 22:return s=s.stateNode,r=s._retryCache,r===null&&(r=s._retryCache=new gg),r;default:throw Error(a(435,s.tag))}}function Ma(s,r){var l=bS(s);r.forEach(function(o){if(!l.has(o)){l.add(o);var u=kS.bind(null,s,o);o.then(u,u)}})}function Zt(s,r){var l=r.deletions;if(l!==null)for(var o=0;o<l.length;o++){var u=l[o],f=s,v=r,x=v;e:for(;x!==null;){switch(x.tag){case 27:if(Us(x.type)){rt=x.stateNode,$t=!1;break e}break;case 5:rt=x.stateNode,$t=!1;break e;case 3:case 4:rt=x.stateNode.containerInfo,$t=!0;break e}x=x.return}if(rt===null)throw Error(a(160));vg(f,v,u),rt=null,$t=!1,f=u.alternate,f!==null&&(f.return=null),u.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)bg(r,s),r=r.sibling}var Li=null;function bg(s,r){var l=s.alternate,o=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Zt(r,s),Qt(s),o&4&&(Ms(3,s,s.return),Qn(3,s),Ms(5,s,s.return));break;case 1:Zt(r,s),Qt(s),o&512&&(St||l===null||Hi(l,l.return)),o&64&&ns&&(s=s.updateQueue,s!==null&&(o=s.callbacks,o!==null&&(l=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=l===null?o:l.concat(o))));break;case 26:var u=Li;if(Zt(r,s),Qt(s),o&512&&(St||l===null||Hi(l,l.return)),o&4){var f=l!==null?l.memoizedState:null;if(o=s.memoizedState,l===null)if(o===null)if(s.stateNode===null){e:{o=s.type,l=s.memoizedProps,u=u.ownerDocument||u;t:switch(o){case"title":f=u.getElementsByTagName("title")[0],(!f||f[Tn]||f[zt]||f.namespaceURI==="http://www.w3.org/2000/svg"||f.hasAttribute("itemprop"))&&(f=u.createElement(o),u.head.insertBefore(f,u.querySelector("head > title"))),It(f,o,l),f[zt]=s,Rt(f),o=f;break e;case"link":var v=bp("link","href",u).get(o+(l.href||""));if(v){for(var x=0;x<v.length;x++)if(f=v[x],f.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&f.getAttribute("rel")===(l.rel==null?null:l.rel)&&f.getAttribute("title")===(l.title==null?null:l.title)&&f.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){v.splice(x,1);break t}}f=u.createElement(o),It(f,o,l),u.head.appendChild(f);break;case"meta":if(v=bp("meta","content",u).get(o+(l.content||""))){for(x=0;x<v.length;x++)if(f=v[x],f.getAttribute("content")===(l.content==null?null:""+l.content)&&f.getAttribute("name")===(l.name==null?null:l.name)&&f.getAttribute("property")===(l.property==null?null:l.property)&&f.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&f.getAttribute("charset")===(l.charSet==null?null:l.charSet)){v.splice(x,1);break t}}f=u.createElement(o),It(f,o,l),u.head.appendChild(f);break;default:throw Error(a(468,o))}f[zt]=s,Rt(f),o=f}s.stateNode=o}else Cp(u,s.type,s.stateNode);else s.stateNode=Sp(u,o,s.memoizedProps);else f!==o?(f===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):f.count--,o===null?Cp(u,s.type,s.stateNode):Sp(u,o,s.memoizedProps)):o===null&&s.stateNode!==null&&hh(s,s.memoizedProps,l.memoizedProps)}break;case 27:Zt(r,s),Qt(s),o&512&&(St||l===null||Hi(l,l.return)),l!==null&&o&4&&hh(s,s.memoizedProps,l.memoizedProps);break;case 5:if(Zt(r,s),Qt(s),o&512&&(St||l===null||Hi(l,l.return)),s.flags&32){u=s.stateNode;try{Or(u,"")}catch(Ce){Xe(s,s.return,Ce)}}o&4&&s.stateNode!=null&&(u=s.memoizedProps,hh(s,u,l!==null?l.memoizedProps:u)),o&1024&&(fh=!0);break;case 6:if(Zt(r,s),Qt(s),o&4){if(s.stateNode===null)throw Error(a(162));o=s.memoizedProps,l=s.stateNode;try{l.nodeValue=o}catch(Ce){Xe(s,s.return,Ce)}}break;case 3:if(Ga=null,u=Li,Li=qa(r.containerInfo),Zt(r,s),Li=u,Qt(s),o&4&&l!==null&&l.memoizedState.isDehydrated)try{dn(r.containerInfo)}catch(Ce){Xe(s,s.return,Ce)}fh&&(fh=!1,Cg(s));break;case 4:o=Li,Li=qa(s.stateNode.containerInfo),Zt(r,s),Qt(s),Li=o;break;case 12:Zt(r,s),Qt(s);break;case 31:Zt(r,s),Qt(s),o&4&&(o=s.updateQueue,o!==null&&(s.updateQueue=null,Ma(s,o)));break;case 13:Zt(r,s),Qt(s),s.child.flags&8192&&s.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Ba=ri()),o&4&&(o=s.updateQueue,o!==null&&(s.updateQueue=null,Ma(s,o)));break;case 22:u=s.memoizedState!==null;var M=l!==null&&l.memoizedState!==null,F=ns,J=St;if(ns=F||u,St=J||M,Zt(r,s),St=J,ns=F,Qt(s),o&8192)e:for(r=s.stateNode,r._visibility=u?r._visibility&-2:r._visibility|1,u&&(l===null||M||ns||St||_r(s)),l=null,r=s;;){if(r.tag===5||r.tag===26){if(l===null){M=l=r;try{if(f=M.stateNode,u)v=f.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{x=M.stateNode;var le=M.memoizedProps.style,P=le!=null&&le.hasOwnProperty("display")?le.display:null;x.style.display=P==null||typeof P=="boolean"?"":(""+P).trim()}}catch(Ce){Xe(M,M.return,Ce)}}}else if(r.tag===6){if(l===null){M=r;try{M.stateNode.nodeValue=u?"":M.memoizedProps}catch(Ce){Xe(M,M.return,Ce)}}}else if(r.tag===18){if(l===null){M=r;try{var G=M.stateNode;u?up(G,!0):up(M.stateNode,!1)}catch(Ce){Xe(M,M.return,Ce)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===s)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;l===r&&(l=null),r=r.return}l===r&&(l=null),r.sibling.return=r.return,r=r.sibling}o&4&&(o=s.updateQueue,o!==null&&(l=o.retryQueue,l!==null&&(o.retryQueue=null,Ma(s,l))));break;case 19:Zt(r,s),Qt(s),o&4&&(o=s.updateQueue,o!==null&&(s.updateQueue=null,Ma(s,o)));break;case 30:break;case 21:break;default:Zt(r,s),Qt(s)}}function Qt(s){var r=s.flags;if(r&2){try{for(var l,o=s.return;o!==null;){if(fg(o)){l=o;break}o=o.return}if(l==null)throw Error(a(160));switch(l.tag){case 27:var u=l.stateNode,f=uh(s);ka(s,f,u);break;case 5:var v=l.stateNode;l.flags&32&&(Or(v,""),l.flags&=-33);var x=uh(s);ka(s,x,v);break;case 3:case 4:var M=l.stateNode.containerInfo,F=uh(s);dh(s,F,M);break;default:throw Error(a(161))}}catch(J){Xe(s,s.return,J)}s.flags&=-3}r&4096&&(s.flags&=-4097)}function Cg(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var r=s;Cg(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),s=s.sibling}}function as(s,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)pg(s,r.alternate,r),r=r.sibling}function _r(s){for(s=s.child;s!==null;){var r=s;switch(r.tag){case 0:case 11:case 14:case 15:Ms(4,r,r.return),_r(r);break;case 1:Hi(r,r.return);var l=r.stateNode;typeof l.componentWillUnmount=="function"&&ug(r,r.return,l),_r(r);break;case 27:ol(r.stateNode);case 26:case 5:Hi(r,r.return),_r(r);break;case 22:r.memoizedState===null&&_r(r);break;case 30:_r(r);break;default:_r(r)}s=s.sibling}}function os(s,r,l){for(l=l&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var o=r.alternate,u=s,f=r,v=f.flags;switch(f.tag){case 0:case 11:case 15:os(u,f,l),Qn(4,f);break;case 1:if(os(u,f,l),o=f,u=o.stateNode,typeof u.componentDidMount=="function")try{u.componentDidMount()}catch(F){Xe(o,o.return,F)}if(o=f,u=o.updateQueue,u!==null){var x=o.stateNode;try{var M=u.shared.hiddenCallbacks;if(M!==null)for(u.shared.hiddenCallbacks=null,u=0;u<M.length;u++)Jf(M[u],x)}catch(F){Xe(o,o.return,F)}}l&&v&64&&hg(f),Jn(f,f.return);break;case 27:_g(f);case 26:case 5:os(u,f,l),l&&o===null&&v&4&&dg(f),Jn(f,f.return);break;case 12:os(u,f,l);break;case 31:os(u,f,l),l&&v&4&&yg(u,f);break;case 13:os(u,f,l),l&&v&4&&Sg(u,f);break;case 22:f.memoizedState===null&&os(u,f,l),Jn(f,f.return);break;case 30:break;default:os(u,f,l)}r=r.sibling}}function _h(s,r){var l=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),s=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(s=r.memoizedState.cachePool.pool),s!==l&&(s!=null&&s.refCount++,l!=null&&In(l))}function gh(s,r){s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&In(s))}function Bi(s,r,l,o){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)wg(s,r,l,o),r=r.sibling}function wg(s,r,l,o){var u=r.flags;switch(r.tag){case 0:case 11:case 15:Bi(s,r,l,o),u&2048&&Qn(9,r);break;case 1:Bi(s,r,l,o);break;case 3:Bi(s,r,l,o),u&2048&&(s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&In(s)));break;case 12:if(u&2048){Bi(s,r,l,o),s=r.stateNode;try{var f=r.memoizedProps,v=f.id,x=f.onPostCommit;typeof x=="function"&&x(v,r.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(M){Xe(r,r.return,M)}}else Bi(s,r,l,o);break;case 31:Bi(s,r,l,o);break;case 13:Bi(s,r,l,o);break;case 23:break;case 22:f=r.stateNode,v=r.alternate,r.memoizedState!==null?f._visibility&2?Bi(s,r,l,o):el(s,r):f._visibility&2?Bi(s,r,l,o):(f._visibility|=2,en(s,r,l,o,(r.subtreeFlags&10256)!==0||!1)),u&2048&&_h(v,r);break;case 24:Bi(s,r,l,o),u&2048&&gh(r.alternate,r);break;default:Bi(s,r,l,o)}}function en(s,r,l,o,u){for(u=u&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var f=s,v=r,x=l,M=o,F=v.flags;switch(v.tag){case 0:case 11:case 15:en(f,v,x,M,u),Qn(8,v);break;case 23:break;case 22:var J=v.stateNode;v.memoizedState!==null?J._visibility&2?en(f,v,x,M,u):el(f,v):(J._visibility|=2,en(f,v,x,M,u)),u&&F&2048&&_h(v.alternate,v);break;case 24:en(f,v,x,M,u),u&&F&2048&&gh(v.alternate,v);break;default:en(f,v,x,M,u)}r=r.sibling}}function el(s,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var l=s,o=r,u=o.flags;switch(o.tag){case 22:el(l,o),u&2048&&_h(o.alternate,o);break;case 24:el(l,o),u&2048&&gh(o.alternate,o);break;default:el(l,o)}r=r.sibling}}var tl=8192;function tn(s,r,l){if(s.subtreeFlags&tl)for(s=s.child;s!==null;)xg(s,r,l),s=s.sibling}function xg(s,r,l){switch(s.tag){case 26:tn(s,r,l),s.flags&tl&&s.memoizedState!==null&&ab(l,Li,s.memoizedState,s.memoizedProps);break;case 5:tn(s,r,l);break;case 3:case 4:var o=Li;Li=qa(s.stateNode.containerInfo),tn(s,r,l),Li=o;break;case 22:s.memoizedState===null&&(o=s.alternate,o!==null&&o.memoizedState!==null?(o=tl,tl=16777216,tn(s,r,l),tl=o):tn(s,r,l));break;default:tn(s,r,l)}}function Eg(s){var r=s.alternate;if(r!==null&&(s=r.child,s!==null)){r.child=null;do r=s.sibling,s.sibling=null,s=r;while(s!==null)}}function il(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var o=r[l];Dt=o,Ag(o,s)}Eg(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Tg(s),s=s.sibling}function Tg(s){switch(s.tag){case 0:case 11:case 15:il(s),s.flags&2048&&Ms(9,s,s.return);break;case 3:il(s);break;case 12:il(s);break;case 22:var r=s.stateNode;s.memoizedState!==null&&r._visibility&2&&(s.return===null||s.return.tag!==13)?(r._visibility&=-3,La(s)):il(s);break;default:il(s)}}function La(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var o=r[l];Dt=o,Ag(o,s)}Eg(s)}for(s=s.child;s!==null;){switch(r=s,r.tag){case 0:case 11:case 15:Ms(8,r,r.return),La(r);break;case 22:l=r.stateNode,l._visibility&2&&(l._visibility&=-3,La(r));break;default:La(r)}s=s.sibling}}function Ag(s,r){for(;Dt!==null;){var l=Dt;switch(l.tag){case 0:case 11:case 15:Ms(8,l,r);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var o=l.memoizedState.cachePool.pool;o!=null&&o.refCount++}break;case 24:In(l.memoizedState.cache)}if(o=l.child,o!==null)o.return=l,Dt=o;else e:for(l=s;Dt!==null;){o=Dt;var u=o.sibling,f=o.return;if(mg(o),o===l){Dt=null;break e}if(u!==null){u.return=f,Dt=u;break e}Dt=f}}}var CS={getCacheForType:function(s){var r=Ht(mt),l=r.data.get(s);return l===void 0&&(l=s(),r.data.set(s,l)),l},cacheSignal:function(){return Ht(mt).controller.signal}},wS=typeof WeakMap=="function"?WeakMap:Map,Ke=0,Je=null,Ie=null,We=0,Ge=0,ui=null,Ls=!1,sn=!1,ph=!1,cs=0,ut=0,Bs=0,gr=0,mh=0,di=0,rn=0,sl=null,Jt=null,vh=!1,Ba=0,Rg=0,Oa=1/0,za=null,Os=null,wt=0,zs=null,nn=null,hs=0,yh=0,Sh=null,Dg=null,rl=0,bh=null;function fi(){return(Ke&2)!==0&&We!==0?We&-We:O.T!==null?Ah():Yd()}function kg(){if(di===0)if((We&536870912)===0||Pe){var s=Pl;Pl<<=1,(Pl&3932160)===0&&(Pl=262144),di=s}else di=536870912;return s=ci.current,s!==null&&(s.flags|=32),di}function ei(s,r,l){(s===Je&&(Ge===2||Ge===9)||s.cancelPendingCommit!==null)&&(ln(s,0),Ns(s,We,di,!1)),En(s,l),((Ke&2)===0||s!==Je)&&(s===Je&&((Ke&2)===0&&(gr|=l),ut===4&&Ns(s,We,di,!1)),Ui(s))}function Mg(s,r,l){if((Ke&6)!==0)throw Error(a(327));var o=!l&&(r&127)===0&&(r&s.expiredLanes)===0||xn(s,r),u=o?TS(s,r):wh(s,r,!0),f=o;do{if(u===0){sn&&!o&&Ns(s,r,0,!1);break}else{if(l=s.current.alternate,f&&!xS(l)){u=wh(s,r,!1),f=!1;continue}if(u===2){if(f=r,s.errorRecoveryDisabledLanes&f)var v=0;else v=s.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){r=v;e:{var x=s;u=sl;var M=x.current.memoizedState.isDehydrated;if(M&&(ln(x,v).flags|=256),v=wh(x,v,!1),v!==2){if(ph&&!M){x.errorRecoveryDisabledLanes|=f,gr|=f,u=4;break e}f=Jt,Jt=u,f!==null&&(Jt===null?Jt=f:Jt.push.apply(Jt,f))}u=v}if(f=!1,u!==2)continue}}if(u===1){ln(s,0),Ns(s,r,0,!0);break}e:{switch(o=s,f=u,f){case 0:case 1:throw Error(a(345));case 4:if((r&4194048)!==r)break;case 6:Ns(o,r,di,!Ls);break e;case 2:Jt=null;break;case 3:case 5:break;default:throw Error(a(329))}if((r&62914560)===r&&(u=Ba+300-ri(),10<u)){if(Ns(o,r,di,!Ls),ql(o,0,!0)!==0)break e;hs=r,o.timeoutHandle=op(Lg.bind(null,o,l,Jt,za,vh,r,di,gr,rn,Ls,f,"Throttled",-0,0),u);break e}Lg(o,l,Jt,za,vh,r,di,gr,rn,Ls,f,null,-0,0)}}break}while(!0);Ui(s)}function Lg(s,r,l,o,u,f,v,x,M,F,J,le,P,G){if(s.timeoutHandle=-1,le=r.subtreeFlags,le&8192||(le&16785408)===16785408){le={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Vi},xg(r,f,le);var Ce=(f&62914560)===f?Ba-ri():(f&4194048)===f?Rg-ri():0;if(Ce=ob(le,Ce),Ce!==null){hs=f,s.cancelPendingCommit=Ce(jg.bind(null,s,r,f,l,o,u,v,x,M,J,le,null,P,G)),Ns(s,f,v,!F);return}}jg(s,r,f,l,o,u,v,x,M)}function xS(s){for(var r=s;;){var l=r.tag;if((l===0||l===11||l===15)&&r.flags&16384&&(l=r.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var o=0;o<l.length;o++){var u=l[o],f=u.getSnapshot;u=u.value;try{if(!ai(f(),u))return!1}catch{return!1}}if(l=r.child,r.subtreeFlags&16384&&l!==null)l.return=r,r=l;else{if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Ns(s,r,l,o){r&=~mh,r&=~gr,s.suspendedLanes|=r,s.pingedLanes&=~r,o&&(s.warmLanes|=r),o=s.expirationTimes;for(var u=r;0<u;){var f=31-li(u),v=1<<f;o[f]=-1,u&=~v}l!==0&&Wd(s,l,r)}function Na(){return(Ke&6)===0?(nl(0),!1):!0}function Ch(){if(Ie!==null){if(Ge===0)var s=Ie.return;else s=Ie,Ji=lr=null,Uc(s),Vr=null,Wn=0,s=Ie;for(;s!==null;)cg(s.alternate,s),s=s.return;Ie=null}}function ln(s,r){var l=s.timeoutHandle;l!==-1&&(s.timeoutHandle=-1,YS(l)),l=s.cancelPendingCommit,l!==null&&(s.cancelPendingCommit=null,l()),hs=0,Ch(),Je=s,Ie=l=Zi(s.current,null),We=r,Ge=0,ui=null,Ls=!1,sn=xn(s,r),ph=!1,rn=di=mh=gr=Bs=ut=0,Jt=sl=null,vh=!1,(r&8)!==0&&(r|=r&32);var o=s.entangledLanes;if(o!==0)for(s=s.entanglements,o&=r;0<o;){var u=31-li(o),f=1<<u;r|=s[u],o&=~f}return cs=r,sa(),l}function Bg(s,r){Oe=null,O.H=Vn,r===Xr||r===ua?(r=Vf(),Ge=3):r===Tc?(r=Vf(),Ge=4):Ge=r===eh?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,ui=r,Ie===null&&(ut=1,Ea(s,Si(r,s.current)))}function Og(){var s=ci.current;return s===null?!0:(We&4194048)===We?xi===null:(We&62914560)===We||(We&536870912)!==0?s===xi:!1}function zg(){var s=O.H;return O.H=Vn,s===null?Vn:s}function Ng(){var s=O.A;return O.A=CS,s}function Ha(){ut=4,Ls||(We&4194048)!==We&&ci.current!==null||(sn=!0),(Bs&134217727)===0&&(gr&134217727)===0||Je===null||Ns(Je,We,di,!1)}function wh(s,r,l){var o=Ke;Ke|=2;var u=zg(),f=Ng();(Je!==s||We!==r)&&(za=null,ln(s,r)),r=!1;var v=ut;e:do try{if(Ge!==0&&Ie!==null){var x=Ie,M=ui;switch(Ge){case 8:Ch(),v=6;break e;case 3:case 2:case 9:case 6:ci.current===null&&(r=!0);var F=Ge;if(Ge=0,ui=null,an(s,x,M,F),l&&sn){v=0;break e}break;default:F=Ge,Ge=0,ui=null,an(s,x,M,F)}}ES(),v=ut;break}catch(J){Bg(s,J)}while(!0);return r&&s.shellSuspendCounter++,Ji=lr=null,Ke=o,O.H=u,O.A=f,Ie===null&&(Je=null,We=0,sa()),v}function ES(){for(;Ie!==null;)Hg(Ie)}function TS(s,r){var l=Ke;Ke|=2;var o=zg(),u=Ng();Je!==s||We!==r?(za=null,Oa=ri()+500,ln(s,r)):sn=xn(s,r);e:do try{if(Ge!==0&&Ie!==null){r=Ie;var f=ui;t:switch(Ge){case 1:Ge=0,ui=null,an(s,r,f,1);break;case 2:case 9:if(Gf(f)){Ge=0,ui=null,Ug(r);break}r=function(){Ge!==2&&Ge!==9||Je!==s||(Ge=7),Ui(s)},f.then(r,r);break e;case 3:Ge=7;break e;case 4:Ge=5;break e;case 7:Gf(f)?(Ge=0,ui=null,Ug(r)):(Ge=0,ui=null,an(s,r,f,7));break;case 5:var v=null;switch(Ie.tag){case 26:v=Ie.memoizedState;case 5:case 27:var x=Ie;if(v?wp(v):x.stateNode.complete){Ge=0,ui=null;var M=x.sibling;if(M!==null)Ie=M;else{var F=x.return;F!==null?(Ie=F,Ua(F)):Ie=null}break t}}Ge=0,ui=null,an(s,r,f,5);break;case 6:Ge=0,ui=null,an(s,r,f,6);break;case 8:Ch(),ut=6;break e;default:throw Error(a(462))}}AS();break}catch(J){Bg(s,J)}while(!0);return Ji=lr=null,O.H=o,O.A=u,Ke=l,Ie!==null?0:(Je=null,We=0,sa(),ut)}function AS(){for(;Ie!==null&&!$0();)Hg(Ie)}function Hg(s){var r=ag(s.alternate,s,cs);s.memoizedProps=s.pendingProps,r===null?Ua(s):Ie=r}function Ug(s){var r=s,l=r.alternate;switch(r.tag){case 15:case 0:r=tg(l,r,r.pendingProps,r.type,void 0,We);break;case 11:r=tg(l,r,r.pendingProps,r.type.render,r.ref,We);break;case 5:Uc(r);default:cg(l,r),r=Ie=Nf(r,cs),r=ag(l,r,cs)}s.memoizedProps=s.pendingProps,r===null?Ua(s):Ie=r}function an(s,r,l,o){Ji=lr=null,Uc(r),Vr=null,Wn=0;var u=r.return;try{if(gS(s,u,r,l,We)){ut=1,Ea(s,Si(l,s.current)),Ie=null;return}}catch(f){if(u!==null)throw Ie=u,f;ut=1,Ea(s,Si(l,s.current)),Ie=null;return}r.flags&32768?(Pe||o===1?s=!0:sn||(We&536870912)!==0?s=!1:(Ls=s=!0,(o===2||o===9||o===3||o===6)&&(o=ci.current,o!==null&&o.tag===13&&(o.flags|=16384))),Ig(r,s)):Ua(r)}function Ua(s){var r=s;do{if((r.flags&32768)!==0){Ig(r,Ls);return}s=r.return;var l=vS(r.alternate,r,cs);if(l!==null){Ie=l;return}if(r=r.sibling,r!==null){Ie=r;return}Ie=r=s}while(r!==null);ut===0&&(ut=5)}function Ig(s,r){do{var l=yS(s.alternate,s);if(l!==null){l.flags&=32767,Ie=l;return}if(l=s.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!r&&(s=s.sibling,s!==null)){Ie=s;return}Ie=s=l}while(s!==null);ut=6,Ie=null}function jg(s,r,l,o,u,f,v,x,M){s.cancelPendingCommit=null;do Ia();while(wt!==0);if((Ke&6)!==0)throw Error(a(327));if(r!==null){if(r===s.current)throw Error(a(177));if(f=r.lanes|r.childLanes,f|=uc,ly(s,l,f,v,x,M),s===Je&&(Ie=Je=null,We=0),nn=r,zs=s,hs=l,yh=f,Sh=u,Dg=o,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,MS(Wl,function(){return qg(),null})):(s.callbackNode=null,s.callbackPriority=0),o=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||o){o=O.T,O.T=null,u=Z.p,Z.p=2,v=Ke,Ke|=4;try{SS(s,r,l)}finally{Ke=v,Z.p=u,O.T=o}}wt=1,Wg(),Fg(),Pg()}}function Wg(){if(wt===1){wt=0;var s=zs,r=nn,l=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||l){l=O.T,O.T=null;var o=Z.p;Z.p=2;var u=Ke;Ke|=4;try{bg(r,s);var f=zh,v=Af(s.containerInfo),x=f.focusedElem,M=f.selectionRange;if(v!==x&&x&&x.ownerDocument&&Tf(x.ownerDocument.documentElement,x)){if(M!==null&&lc(x)){var F=M.start,J=M.end;if(J===void 0&&(J=F),"selectionStart"in x)x.selectionStart=F,x.selectionEnd=Math.min(J,x.value.length);else{var le=x.ownerDocument||document,P=le&&le.defaultView||window;if(P.getSelection){var G=P.getSelection(),Ce=x.textContent.length,ke=Math.min(M.start,Ce),Ze=M.end===void 0?ke:Math.min(M.end,Ce);!G.extend&&ke>Ze&&(v=Ze,Ze=ke,ke=v);var H=Ef(x,ke),B=Ef(x,Ze);if(H&&B&&(G.rangeCount!==1||G.anchorNode!==H.node||G.anchorOffset!==H.offset||G.focusNode!==B.node||G.focusOffset!==B.offset)){var W=le.createRange();W.setStart(H.node,H.offset),G.removeAllRanges(),ke>Ze?(G.addRange(W),G.extend(B.node,B.offset)):(W.setEnd(B.node,B.offset),G.addRange(W))}}}}for(le=[],G=x;G=G.parentNode;)G.nodeType===1&&le.push({element:G,left:G.scrollLeft,top:G.scrollTop});for(typeof x.focus=="function"&&x.focus(),x=0;x<le.length;x++){var ie=le[x];ie.element.scrollLeft=ie.left,ie.element.scrollTop=ie.top}}Za=!!Oh,zh=Oh=null}finally{Ke=u,Z.p=o,O.T=l}}s.current=r,wt=2}}function Fg(){if(wt===2){wt=0;var s=zs,r=nn,l=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||l){l=O.T,O.T=null;var o=Z.p;Z.p=2;var u=Ke;Ke|=4;try{pg(s,r.alternate,r)}finally{Ke=u,Z.p=o,O.T=l}}wt=3}}function Pg(){if(wt===4||wt===3){wt=0,Z0();var s=zs,r=nn,l=hs,o=Dg;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?wt=5:(wt=0,nn=zs=null,Yg(s,s.pendingLanes));var u=s.pendingLanes;if(u===0&&(Os=null),Wo(l),r=r.stateNode,ni&&typeof ni.onCommitFiberRoot=="function")try{ni.onCommitFiberRoot(wn,r,void 0,(r.current.flags&128)===128)}catch{}if(o!==null){r=O.T,u=Z.p,Z.p=2,O.T=null;try{for(var f=s.onRecoverableError,v=0;v<o.length;v++){var x=o[v];f(x.value,{componentStack:x.stack})}}finally{O.T=r,Z.p=u}}(hs&3)!==0&&Ia(),Ui(s),u=s.pendingLanes,(l&261930)!==0&&(u&42)!==0?s===bh?rl++:(rl=0,bh=s):rl=0,nl(0)}}function Yg(s,r){(s.pooledCacheLanes&=r)===0&&(r=s.pooledCache,r!=null&&(s.pooledCache=null,In(r)))}function Ia(){return Wg(),Fg(),Pg(),qg()}function qg(){if(wt!==5)return!1;var s=zs,r=yh;yh=0;var l=Wo(hs),o=O.T,u=Z.p;try{Z.p=32>l?32:l,O.T=null,l=Sh,Sh=null;var f=zs,v=hs;if(wt=0,nn=zs=null,hs=0,(Ke&6)!==0)throw Error(a(331));var x=Ke;if(Ke|=4,Tg(f.current),wg(f,f.current,v,l),Ke=x,nl(0,!1),ni&&typeof ni.onPostCommitFiberRoot=="function")try{ni.onPostCommitFiberRoot(wn,f)}catch{}return!0}finally{Z.p=u,O.T=o,Yg(s,r)}}function Kg(s,r,l){r=Si(l,r),r=Jc(s.stateNode,r,2),s=Rs(s,r,2),s!==null&&(En(s,2),Ui(s))}function Xe(s,r,l){if(s.tag===3)Kg(s,s,l);else for(;r!==null;){if(r.tag===3){Kg(r,s,l);break}else if(r.tag===1){var o=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(Os===null||!Os.has(o))){s=Si(l,s),l=G_(2),o=Rs(r,l,2),o!==null&&(X_(l,o,r,s),En(o,2),Ui(o));break}}r=r.return}}function xh(s,r,l){var o=s.pingCache;if(o===null){o=s.pingCache=new wS;var u=new Set;o.set(r,u)}else u=o.get(r),u===void 0&&(u=new Set,o.set(r,u));u.has(l)||(ph=!0,u.add(l),s=RS.bind(null,s,r,l),r.then(s,s))}function RS(s,r,l){var o=s.pingCache;o!==null&&o.delete(r),s.pingedLanes|=s.suspendedLanes&l,s.warmLanes&=~l,Je===s&&(We&l)===l&&(ut===4||ut===3&&(We&62914560)===We&&300>ri()-Ba?(Ke&2)===0&&ln(s,0):mh|=l,rn===We&&(rn=0)),Ui(s)}function Gg(s,r){r===0&&(r=jd()),s=sr(s,r),s!==null&&(En(s,r),Ui(s))}function DS(s){var r=s.memoizedState,l=0;r!==null&&(l=r.retryLane),Gg(s,l)}function kS(s,r){var l=0;switch(s.tag){case 31:case 13:var o=s.stateNode,u=s.memoizedState;u!==null&&(l=u.retryLane);break;case 19:o=s.stateNode;break;case 22:o=s.stateNode._retryCache;break;default:throw Error(a(314))}o!==null&&o.delete(r),Gg(s,l)}function MS(s,r){return Ho(s,r)}var ja=null,on=null,Eh=!1,Wa=!1,Th=!1,Hs=0;function Ui(s){s!==on&&s.next===null&&(on===null?ja=on=s:on=on.next=s),Wa=!0,Eh||(Eh=!0,BS())}function nl(s,r){if(!Th&&Wa){Th=!0;do for(var l=!1,o=ja;o!==null;){if(s!==0){var u=o.pendingLanes;if(u===0)var f=0;else{var v=o.suspendedLanes,x=o.pingedLanes;f=(1<<31-li(42|s)+1)-1,f&=u&~(v&~x),f=f&201326741?f&201326741|1:f?f|2:0}f!==0&&(l=!0,Zg(o,f))}else f=We,f=ql(o,o===Je?f:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),(f&3)===0||xn(o,f)||(l=!0,Zg(o,f));o=o.next}while(l);Th=!1}}function LS(){Xg()}function Xg(){Wa=Eh=!1;var s=0;Hs!==0&&PS()&&(s=Hs);for(var r=ri(),l=null,o=ja;o!==null;){var u=o.next,f=Vg(o,r);f===0?(o.next=null,l===null?ja=u:l.next=u,u===null&&(on=l)):(l=o,(s!==0||(f&3)!==0)&&(Wa=!0)),o=u}wt!==0&&wt!==5||nl(s),Hs!==0&&(Hs=0)}function Vg(s,r){for(var l=s.suspendedLanes,o=s.pingedLanes,u=s.expirationTimes,f=s.pendingLanes&-62914561;0<f;){var v=31-li(f),x=1<<v,M=u[v];M===-1?((x&l)===0||(x&o)!==0)&&(u[v]=ny(x,r)):M<=r&&(s.expiredLanes|=x),f&=~x}if(r=Je,l=We,l=ql(s,s===r?l:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),o=s.callbackNode,l===0||s===r&&(Ge===2||Ge===9)||s.cancelPendingCommit!==null)return o!==null&&o!==null&&Uo(o),s.callbackNode=null,s.callbackPriority=0;if((l&3)===0||xn(s,l)){if(r=l&-l,r===s.callbackPriority)return r;switch(o!==null&&Uo(o),Wo(l)){case 2:case 8:l=Ud;break;case 32:l=Wl;break;case 268435456:l=Id;break;default:l=Wl}return o=$g.bind(null,s),l=Ho(l,o),s.callbackPriority=r,s.callbackNode=l,r}return o!==null&&o!==null&&Uo(o),s.callbackPriority=2,s.callbackNode=null,2}function $g(s,r){if(wt!==0&&wt!==5)return s.callbackNode=null,s.callbackPriority=0,null;var l=s.callbackNode;if(Ia()&&s.callbackNode!==l)return null;var o=We;return o=ql(s,s===Je?o:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),o===0?null:(Mg(s,o,r),Vg(s,ri()),s.callbackNode!=null&&s.callbackNode===l?$g.bind(null,s):null)}function Zg(s,r){if(Ia())return null;Mg(s,r,!0)}function BS(){qS(function(){(Ke&6)!==0?Ho(Hd,LS):Xg()})}function Ah(){if(Hs===0){var s=Kr;s===0&&(s=Fl,Fl<<=1,(Fl&261888)===0&&(Fl=256)),Hs=s}return Hs}function Qg(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Vl(""+s)}function Jg(s,r){var l=r.ownerDocument.createElement("input");return l.name=r.name,l.value=r.value,s.id&&l.setAttribute("form",s.id),r.parentNode.insertBefore(l,r),s=new FormData(s),l.parentNode.removeChild(l),s}function OS(s,r,l,o,u){if(r==="submit"&&l&&l.stateNode===u){var f=Qg((u[Xt]||null).action),v=o.submitter;v&&(r=(r=v[Xt]||null)?Qg(r.formAction):v.getAttribute("formAction"),r!==null&&(f=r,v=null));var x=new Jl("action","action",null,o,u);s.push({event:x,listeners:[{instance:null,listener:function(){if(o.defaultPrevented){if(Hs!==0){var M=v?Jg(u,v):new FormData(u);Gc(l,{pending:!0,data:M,method:u.method,action:f},null,M)}}else typeof f=="function"&&(x.preventDefault(),M=v?Jg(u,v):new FormData(u),Gc(l,{pending:!0,data:M,method:u.method,action:f},f,M))},currentTarget:u}]})}}for(var Rh=0;Rh<hc.length;Rh++){var Dh=hc[Rh],zS=Dh.toLowerCase(),NS=Dh[0].toUpperCase()+Dh.slice(1);Mi(zS,"on"+NS)}Mi(kf,"onAnimationEnd"),Mi(Mf,"onAnimationIteration"),Mi(Lf,"onAnimationStart"),Mi("dblclick","onDoubleClick"),Mi("focusin","onFocus"),Mi("focusout","onBlur"),Mi(Qy,"onTransitionRun"),Mi(Jy,"onTransitionStart"),Mi(eS,"onTransitionCancel"),Mi(Bf,"onTransitionEnd"),Lr("onMouseEnter",["mouseout","mouseover"]),Lr("onMouseLeave",["mouseout","mouseover"]),Lr("onPointerEnter",["pointerout","pointerover"]),Lr("onPointerLeave",["pointerout","pointerover"]),Js("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Js("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Js("onBeforeInput",["compositionend","keypress","textInput","paste"]),Js("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Js("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Js("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ll="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),HS=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ll));function ep(s,r){r=(r&4)!==0;for(var l=0;l<s.length;l++){var o=s[l],u=o.event;o=o.listeners;e:{var f=void 0;if(r)for(var v=o.length-1;0<=v;v--){var x=o[v],M=x.instance,F=x.currentTarget;if(x=x.listener,M!==f&&u.isPropagationStopped())break e;f=x,u.currentTarget=F;try{f(u)}catch(J){ia(J)}u.currentTarget=null,f=M}else for(v=0;v<o.length;v++){if(x=o[v],M=x.instance,F=x.currentTarget,x=x.listener,M!==f&&u.isPropagationStopped())break e;f=x,u.currentTarget=F;try{f(u)}catch(J){ia(J)}u.currentTarget=null,f=M}}}}function je(s,r){var l=r[Fo];l===void 0&&(l=r[Fo]=new Set);var o=s+"__bubble";l.has(o)||(tp(r,s,2,!1),l.add(o))}function kh(s,r,l){var o=0;r&&(o|=4),tp(l,s,o,r)}var Fa="_reactListening"+Math.random().toString(36).slice(2);function Mh(s){if(!s[Fa]){s[Fa]=!0,Gd.forEach(function(l){l!=="selectionchange"&&(HS.has(l)||kh(l,!1,s),kh(l,!0,s))});var r=s.nodeType===9?s:s.ownerDocument;r===null||r[Fa]||(r[Fa]=!0,kh("selectionchange",!1,r))}}function tp(s,r,l,o){switch(kp(r)){case 2:var u=ub;break;case 8:u=db;break;default:u=Kh}l=u.bind(null,r,l,s),u=void 0,!Zo||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(u=!0),o?u!==void 0?s.addEventListener(r,l,{capture:!0,passive:u}):s.addEventListener(r,l,!0):u!==void 0?s.addEventListener(r,l,{passive:u}):s.addEventListener(r,l,!1)}function Lh(s,r,l,o,u){var f=o;if((r&1)===0&&(r&2)===0&&o!==null)e:for(;;){if(o===null)return;var v=o.tag;if(v===3||v===4){var x=o.stateNode.containerInfo;if(x===u)break;if(v===4)for(v=o.return;v!==null;){var M=v.tag;if((M===3||M===4)&&v.stateNode.containerInfo===u)return;v=v.return}for(;x!==null;){if(v=Dr(x),v===null)return;if(M=v.tag,M===5||M===6||M===26||M===27){o=f=v;continue e}x=x.parentNode}}o=o.return}lf(function(){var F=f,J=Vo(l),le=[];e:{var P=Of.get(s);if(P!==void 0){var G=Jl,Ce=s;switch(s){case"keypress":if(Zl(l)===0)break e;case"keydown":case"keyup":G=ky;break;case"focusin":Ce="focus",G=tc;break;case"focusout":Ce="blur",G=tc;break;case"beforeblur":case"afterblur":G=tc;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":G=cf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":G=vy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":G=By;break;case kf:case Mf:case Lf:G=by;break;case Bf:G=zy;break;case"scroll":case"scrollend":G=py;break;case"wheel":G=Hy;break;case"copy":case"cut":case"paste":G=wy;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":G=uf;break;case"toggle":case"beforetoggle":G=Iy}var ke=(r&4)!==0,Ze=!ke&&(s==="scroll"||s==="scrollend"),H=ke?P!==null?P+"Capture":null:P;ke=[];for(var B=F,W;B!==null;){var ie=B;if(W=ie.stateNode,ie=ie.tag,ie!==5&&ie!==26&&ie!==27||W===null||H===null||(ie=Rn(B,H),ie!=null&&ke.push(al(B,ie,W))),Ze)break;B=B.return}0<ke.length&&(P=new G(P,Ce,null,l,J),le.push({event:P,listeners:ke}))}}if((r&7)===0){e:{if(P=s==="mouseover"||s==="pointerover",G=s==="mouseout"||s==="pointerout",P&&l!==Xo&&(Ce=l.relatedTarget||l.fromElement)&&(Dr(Ce)||Ce[Rr]))break e;if((G||P)&&(P=J.window===J?J:(P=J.ownerDocument)?P.defaultView||P.parentWindow:window,G?(Ce=l.relatedTarget||l.toElement,G=F,Ce=Ce?Dr(Ce):null,Ce!==null&&(Ze=h(Ce),ke=Ce.tag,Ce!==Ze||ke!==5&&ke!==27&&ke!==6)&&(Ce=null)):(G=null,Ce=F),G!==Ce)){if(ke=cf,ie="onMouseLeave",H="onMouseEnter",B="mouse",(s==="pointerout"||s==="pointerover")&&(ke=uf,ie="onPointerLeave",H="onPointerEnter",B="pointer"),Ze=G==null?P:An(G),W=Ce==null?P:An(Ce),P=new ke(ie,B+"leave",G,l,J),P.target=Ze,P.relatedTarget=W,ie=null,Dr(J)===F&&(ke=new ke(H,B+"enter",Ce,l,J),ke.target=W,ke.relatedTarget=Ze,ie=ke),Ze=ie,G&&Ce)t:{for(ke=US,H=G,B=Ce,W=0,ie=H;ie;ie=ke(ie))W++;ie=0;for(var Re=B;Re;Re=ke(Re))ie++;for(;0<W-ie;)H=ke(H),W--;for(;0<ie-W;)B=ke(B),ie--;for(;W--;){if(H===B||B!==null&&H===B.alternate){ke=H;break t}H=ke(H),B=ke(B)}ke=null}else ke=null;G!==null&&ip(le,P,G,ke,!1),Ce!==null&&Ze!==null&&ip(le,Ze,Ce,ke,!0)}}e:{if(P=F?An(F):window,G=P.nodeName&&P.nodeName.toLowerCase(),G==="select"||G==="input"&&P.type==="file")var Ye=yf;else if(mf(P))if(Sf)Ye=Vy;else{Ye=Gy;var xe=Ky}else G=P.nodeName,!G||G.toLowerCase()!=="input"||P.type!=="checkbox"&&P.type!=="radio"?F&&Go(F.elementType)&&(Ye=yf):Ye=Xy;if(Ye&&(Ye=Ye(s,F))){vf(le,Ye,l,J);break e}xe&&xe(s,P,F),s==="focusout"&&F&&P.type==="number"&&F.memoizedProps.value!=null&&Ko(P,"number",P.value)}switch(xe=F?An(F):window,s){case"focusin":(mf(xe)||xe.contentEditable==="true")&&(Ur=xe,ac=F,Nn=null);break;case"focusout":Nn=ac=Ur=null;break;case"mousedown":oc=!0;break;case"contextmenu":case"mouseup":case"dragend":oc=!1,Rf(le,l,J);break;case"selectionchange":if(Zy)break;case"keydown":case"keyup":Rf(le,l,J)}var ze;if(sc)e:{switch(s){case"compositionstart":var Fe="onCompositionStart";break e;case"compositionend":Fe="onCompositionEnd";break e;case"compositionupdate":Fe="onCompositionUpdate";break e}Fe=void 0}else Hr?gf(s,l)&&(Fe="onCompositionEnd"):s==="keydown"&&l.keyCode===229&&(Fe="onCompositionStart");Fe&&(df&&l.locale!=="ko"&&(Hr||Fe!=="onCompositionStart"?Fe==="onCompositionEnd"&&Hr&&(ze=af()):(bs=J,Qo="value"in bs?bs.value:bs.textContent,Hr=!0)),xe=Pa(F,Fe),0<xe.length&&(Fe=new hf(Fe,s,null,l,J),le.push({event:Fe,listeners:xe}),ze?Fe.data=ze:(ze=pf(l),ze!==null&&(Fe.data=ze)))),(ze=Wy?Fy(s,l):Py(s,l))&&(Fe=Pa(F,"onBeforeInput"),0<Fe.length&&(xe=new hf("onBeforeInput","beforeinput",null,l,J),le.push({event:xe,listeners:Fe}),xe.data=ze)),OS(le,s,F,l,J)}ep(le,r)})}function al(s,r,l){return{instance:s,listener:r,currentTarget:l}}function Pa(s,r){for(var l=r+"Capture",o=[];s!==null;){var u=s,f=u.stateNode;if(u=u.tag,u!==5&&u!==26&&u!==27||f===null||(u=Rn(s,l),u!=null&&o.unshift(al(s,u,f)),u=Rn(s,r),u!=null&&o.push(al(s,u,f))),s.tag===3)return o;s=s.return}return[]}function US(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function ip(s,r,l,o,u){for(var f=r._reactName,v=[];l!==null&&l!==o;){var x=l,M=x.alternate,F=x.stateNode;if(x=x.tag,M!==null&&M===o)break;x!==5&&x!==26&&x!==27||F===null||(M=F,u?(F=Rn(l,f),F!=null&&v.unshift(al(l,F,M))):u||(F=Rn(l,f),F!=null&&v.push(al(l,F,M)))),l=l.return}v.length!==0&&s.push({event:r,listeners:v})}var IS=/\r\n?/g,jS=/\u0000|\uFFFD/g;function sp(s){return(typeof s=="string"?s:""+s).replace(IS,`
`).replace(jS,"")}function rp(s,r){return r=sp(r),sp(s)===r}function $e(s,r,l,o,u,f){switch(l){case"children":typeof o=="string"?r==="body"||r==="textarea"&&o===""||Or(s,o):(typeof o=="number"||typeof o=="bigint")&&r!=="body"&&Or(s,""+o);break;case"className":Gl(s,"class",o);break;case"tabIndex":Gl(s,"tabindex",o);break;case"dir":case"role":case"viewBox":case"width":case"height":Gl(s,l,o);break;case"style":rf(s,o,f);break;case"data":if(r!=="object"){Gl(s,"data",o);break}case"src":case"href":if(o===""&&(r!=="a"||l!=="href")){s.removeAttribute(l);break}if(o==null||typeof o=="function"||typeof o=="symbol"||typeof o=="boolean"){s.removeAttribute(l);break}o=Vl(""+o),s.setAttribute(l,o);break;case"action":case"formAction":if(typeof o=="function"){s.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof f=="function"&&(l==="formAction"?(r!=="input"&&$e(s,r,"name",u.name,u,null),$e(s,r,"formEncType",u.formEncType,u,null),$e(s,r,"formMethod",u.formMethod,u,null),$e(s,r,"formTarget",u.formTarget,u,null)):($e(s,r,"encType",u.encType,u,null),$e(s,r,"method",u.method,u,null),$e(s,r,"target",u.target,u,null)));if(o==null||typeof o=="symbol"||typeof o=="boolean"){s.removeAttribute(l);break}o=Vl(""+o),s.setAttribute(l,o);break;case"onClick":o!=null&&(s.onclick=Vi);break;case"onScroll":o!=null&&je("scroll",s);break;case"onScrollEnd":o!=null&&je("scrollend",s);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(a(61));if(l=o.__html,l!=null){if(u.children!=null)throw Error(a(60));s.innerHTML=l}}break;case"multiple":s.multiple=o&&typeof o!="function"&&typeof o!="symbol";break;case"muted":s.muted=o&&typeof o!="function"&&typeof o!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(o==null||typeof o=="function"||typeof o=="boolean"||typeof o=="symbol"){s.removeAttribute("xlink:href");break}l=Vl(""+o),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":o!=null&&typeof o!="function"&&typeof o!="symbol"?s.setAttribute(l,""+o):s.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":o&&typeof o!="function"&&typeof o!="symbol"?s.setAttribute(l,""):s.removeAttribute(l);break;case"capture":case"download":o===!0?s.setAttribute(l,""):o!==!1&&o!=null&&typeof o!="function"&&typeof o!="symbol"?s.setAttribute(l,o):s.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":o!=null&&typeof o!="function"&&typeof o!="symbol"&&!isNaN(o)&&1<=o?s.setAttribute(l,o):s.removeAttribute(l);break;case"rowSpan":case"start":o==null||typeof o=="function"||typeof o=="symbol"||isNaN(o)?s.removeAttribute(l):s.setAttribute(l,o);break;case"popover":je("beforetoggle",s),je("toggle",s),Kl(s,"popover",o);break;case"xlinkActuate":Xi(s,"http://www.w3.org/1999/xlink","xlink:actuate",o);break;case"xlinkArcrole":Xi(s,"http://www.w3.org/1999/xlink","xlink:arcrole",o);break;case"xlinkRole":Xi(s,"http://www.w3.org/1999/xlink","xlink:role",o);break;case"xlinkShow":Xi(s,"http://www.w3.org/1999/xlink","xlink:show",o);break;case"xlinkTitle":Xi(s,"http://www.w3.org/1999/xlink","xlink:title",o);break;case"xlinkType":Xi(s,"http://www.w3.org/1999/xlink","xlink:type",o);break;case"xmlBase":Xi(s,"http://www.w3.org/XML/1998/namespace","xml:base",o);break;case"xmlLang":Xi(s,"http://www.w3.org/XML/1998/namespace","xml:lang",o);break;case"xmlSpace":Xi(s,"http://www.w3.org/XML/1998/namespace","xml:space",o);break;case"is":Kl(s,"is",o);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=_y.get(l)||l,Kl(s,l,o))}}function Bh(s,r,l,o,u,f){switch(l){case"style":rf(s,o,f);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(a(61));if(l=o.__html,l!=null){if(u.children!=null)throw Error(a(60));s.innerHTML=l}}break;case"children":typeof o=="string"?Or(s,o):(typeof o=="number"||typeof o=="bigint")&&Or(s,""+o);break;case"onScroll":o!=null&&je("scroll",s);break;case"onScrollEnd":o!=null&&je("scrollend",s);break;case"onClick":o!=null&&(s.onclick=Vi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Xd.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(u=l.endsWith("Capture"),r=l.slice(2,u?l.length-7:void 0),f=s[Xt]||null,f=f!=null?f[l]:null,typeof f=="function"&&s.removeEventListener(r,f,u),typeof o=="function")){typeof f!="function"&&f!==null&&(l in s?s[l]=null:s.hasAttribute(l)&&s.removeAttribute(l)),s.addEventListener(r,o,u);break e}l in s?s[l]=o:o===!0?s.setAttribute(l,""):Kl(s,l,o)}}}function It(s,r,l){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":je("error",s),je("load",s);var o=!1,u=!1,f;for(f in l)if(l.hasOwnProperty(f)){var v=l[f];if(v!=null)switch(f){case"src":o=!0;break;case"srcSet":u=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,r));default:$e(s,r,f,v,l,null)}}u&&$e(s,r,"srcSet",l.srcSet,l,null),o&&$e(s,r,"src",l.src,l,null);return;case"input":je("invalid",s);var x=f=v=u=null,M=null,F=null;for(o in l)if(l.hasOwnProperty(o)){var J=l[o];if(J!=null)switch(o){case"name":u=J;break;case"type":v=J;break;case"checked":M=J;break;case"defaultChecked":F=J;break;case"value":f=J;break;case"defaultValue":x=J;break;case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(a(137,r));break;default:$e(s,r,o,J,l,null)}}Jd(s,f,x,M,F,v,u,!1);return;case"select":je("invalid",s),o=v=f=null;for(u in l)if(l.hasOwnProperty(u)&&(x=l[u],x!=null))switch(u){case"value":f=x;break;case"defaultValue":v=x;break;case"multiple":o=x;default:$e(s,r,u,x,l,null)}r=f,l=v,s.multiple=!!o,r!=null?Br(s,!!o,r,!1):l!=null&&Br(s,!!o,l,!0);return;case"textarea":je("invalid",s),f=u=o=null;for(v in l)if(l.hasOwnProperty(v)&&(x=l[v],x!=null))switch(v){case"value":o=x;break;case"defaultValue":u=x;break;case"children":f=x;break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(a(91));break;default:$e(s,r,v,x,l,null)}tf(s,o,u,f);return;case"option":for(M in l)l.hasOwnProperty(M)&&(o=l[M],o!=null)&&(M==="selected"?s.selected=o&&typeof o!="function"&&typeof o!="symbol":$e(s,r,M,o,l,null));return;case"dialog":je("beforetoggle",s),je("toggle",s),je("cancel",s),je("close",s);break;case"iframe":case"object":je("load",s);break;case"video":case"audio":for(o=0;o<ll.length;o++)je(ll[o],s);break;case"image":je("error",s),je("load",s);break;case"details":je("toggle",s);break;case"embed":case"source":case"link":je("error",s),je("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(F in l)if(l.hasOwnProperty(F)&&(o=l[F],o!=null))switch(F){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,r));default:$e(s,r,F,o,l,null)}return;default:if(Go(r)){for(J in l)l.hasOwnProperty(J)&&(o=l[J],o!==void 0&&Bh(s,r,J,o,l,void 0));return}}for(x in l)l.hasOwnProperty(x)&&(o=l[x],o!=null&&$e(s,r,x,o,l,null))}function WS(s,r,l,o){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var u=null,f=null,v=null,x=null,M=null,F=null,J=null;for(G in l){var le=l[G];if(l.hasOwnProperty(G)&&le!=null)switch(G){case"checked":break;case"value":break;case"defaultValue":M=le;default:o.hasOwnProperty(G)||$e(s,r,G,null,o,le)}}for(var P in o){var G=o[P];if(le=l[P],o.hasOwnProperty(P)&&(G!=null||le!=null))switch(P){case"type":f=G;break;case"name":u=G;break;case"checked":F=G;break;case"defaultChecked":J=G;break;case"value":v=G;break;case"defaultValue":x=G;break;case"children":case"dangerouslySetInnerHTML":if(G!=null)throw Error(a(137,r));break;default:G!==le&&$e(s,r,P,G,o,le)}}qo(s,v,x,M,F,J,f,u);return;case"select":G=v=x=P=null;for(f in l)if(M=l[f],l.hasOwnProperty(f)&&M!=null)switch(f){case"value":break;case"multiple":G=M;default:o.hasOwnProperty(f)||$e(s,r,f,null,o,M)}for(u in o)if(f=o[u],M=l[u],o.hasOwnProperty(u)&&(f!=null||M!=null))switch(u){case"value":P=f;break;case"defaultValue":x=f;break;case"multiple":v=f;default:f!==M&&$e(s,r,u,f,o,M)}r=x,l=v,o=G,P!=null?Br(s,!!l,P,!1):!!o!=!!l&&(r!=null?Br(s,!!l,r,!0):Br(s,!!l,l?[]:"",!1));return;case"textarea":G=P=null;for(x in l)if(u=l[x],l.hasOwnProperty(x)&&u!=null&&!o.hasOwnProperty(x))switch(x){case"value":break;case"children":break;default:$e(s,r,x,null,o,u)}for(v in o)if(u=o[v],f=l[v],o.hasOwnProperty(v)&&(u!=null||f!=null))switch(v){case"value":P=u;break;case"defaultValue":G=u;break;case"children":break;case"dangerouslySetInnerHTML":if(u!=null)throw Error(a(91));break;default:u!==f&&$e(s,r,v,u,o,f)}ef(s,P,G);return;case"option":for(var Ce in l)P=l[Ce],l.hasOwnProperty(Ce)&&P!=null&&!o.hasOwnProperty(Ce)&&(Ce==="selected"?s.selected=!1:$e(s,r,Ce,null,o,P));for(M in o)P=o[M],G=l[M],o.hasOwnProperty(M)&&P!==G&&(P!=null||G!=null)&&(M==="selected"?s.selected=P&&typeof P!="function"&&typeof P!="symbol":$e(s,r,M,P,o,G));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ke in l)P=l[ke],l.hasOwnProperty(ke)&&P!=null&&!o.hasOwnProperty(ke)&&$e(s,r,ke,null,o,P);for(F in o)if(P=o[F],G=l[F],o.hasOwnProperty(F)&&P!==G&&(P!=null||G!=null))switch(F){case"children":case"dangerouslySetInnerHTML":if(P!=null)throw Error(a(137,r));break;default:$e(s,r,F,P,o,G)}return;default:if(Go(r)){for(var Ze in l)P=l[Ze],l.hasOwnProperty(Ze)&&P!==void 0&&!o.hasOwnProperty(Ze)&&Bh(s,r,Ze,void 0,o,P);for(J in o)P=o[J],G=l[J],!o.hasOwnProperty(J)||P===G||P===void 0&&G===void 0||Bh(s,r,J,P,o,G);return}}for(var H in l)P=l[H],l.hasOwnProperty(H)&&P!=null&&!o.hasOwnProperty(H)&&$e(s,r,H,null,o,P);for(le in o)P=o[le],G=l[le],!o.hasOwnProperty(le)||P===G||P==null&&G==null||$e(s,r,le,P,o,G)}function np(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function FS(){if(typeof performance.getEntriesByType=="function"){for(var s=0,r=0,l=performance.getEntriesByType("resource"),o=0;o<l.length;o++){var u=l[o],f=u.transferSize,v=u.initiatorType,x=u.duration;if(f&&x&&np(v)){for(v=0,x=u.responseEnd,o+=1;o<l.length;o++){var M=l[o],F=M.startTime;if(F>x)break;var J=M.transferSize,le=M.initiatorType;J&&np(le)&&(M=M.responseEnd,v+=J*(M<x?1:(x-F)/(M-F)))}if(--o,r+=8*(f+v)/(u.duration/1e3),s++,10<s)break}}if(0<s)return r/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Oh=null,zh=null;function Ya(s){return s.nodeType===9?s:s.ownerDocument}function lp(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ap(s,r){if(s===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&r==="foreignObject"?0:s}function Nh(s,r){return s==="textarea"||s==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Hh=null;function PS(){var s=window.event;return s&&s.type==="popstate"?s===Hh?!1:(Hh=s,!0):(Hh=null,!1)}var op=typeof setTimeout=="function"?setTimeout:void 0,YS=typeof clearTimeout=="function"?clearTimeout:void 0,cp=typeof Promise=="function"?Promise:void 0,qS=typeof queueMicrotask=="function"?queueMicrotask:typeof cp<"u"?function(s){return cp.resolve(null).then(s).catch(KS)}:op;function KS(s){setTimeout(function(){throw s})}function Us(s){return s==="head"}function hp(s,r){var l=r,o=0;do{var u=l.nextSibling;if(s.removeChild(l),u&&u.nodeType===8)if(l=u.data,l==="/$"||l==="/&"){if(o===0){s.removeChild(u),dn(r);return}o--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")o++;else if(l==="html")ol(s.ownerDocument.documentElement);else if(l==="head"){l=s.ownerDocument.head,ol(l);for(var f=l.firstChild;f;){var v=f.nextSibling,x=f.nodeName;f[Tn]||x==="SCRIPT"||x==="STYLE"||x==="LINK"&&f.rel.toLowerCase()==="stylesheet"||l.removeChild(f),f=v}}else l==="body"&&ol(s.ownerDocument.body);l=u}while(l);dn(r)}function up(s,r){var l=s;s=0;do{var o=l.nextSibling;if(l.nodeType===1?r?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(r?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),o&&o.nodeType===8)if(l=o.data,l==="/$"){if(s===0)break;s--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||s++;l=o}while(l)}function Uh(s){var r=s.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var l=r;switch(r=r.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Uh(l),Po(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}s.removeChild(l)}}function GS(s,r,l,o){for(;s.nodeType===1;){var u=l;if(s.nodeName.toLowerCase()!==r.toLowerCase()){if(!o&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(o){if(!s[Tn])switch(r){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(f=s.getAttribute("rel"),f==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(f!==u.rel||s.getAttribute("href")!==(u.href==null||u.href===""?null:u.href)||s.getAttribute("crossorigin")!==(u.crossOrigin==null?null:u.crossOrigin)||s.getAttribute("title")!==(u.title==null?null:u.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(f=s.getAttribute("src"),(f!==(u.src==null?null:u.src)||s.getAttribute("type")!==(u.type==null?null:u.type)||s.getAttribute("crossorigin")!==(u.crossOrigin==null?null:u.crossOrigin))&&f&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(r==="input"&&s.type==="hidden"){var f=u.name==null?null:""+u.name;if(u.type==="hidden"&&s.getAttribute("name")===f)return s}else return s;if(s=Ei(s.nextSibling),s===null)break}return null}function XS(s,r,l){if(r==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=Ei(s.nextSibling),s===null))return null;return s}function dp(s,r){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!r||(s=Ei(s.nextSibling),s===null))return null;return s}function Ih(s){return s.data==="$?"||s.data==="$~"}function jh(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function VS(s,r){var l=s.ownerDocument;if(s.data==="$~")s._reactRetry=r;else if(s.data!=="$?"||l.readyState!=="loading")r();else{var o=function(){r(),l.removeEventListener("DOMContentLoaded",o)};l.addEventListener("DOMContentLoaded",o),s._reactRetry=o}}function Ei(s){for(;s!=null;s=s.nextSibling){var r=s.nodeType;if(r===1||r===3)break;if(r===8){if(r=s.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return s}var Wh=null;function fp(s){s=s.nextSibling;for(var r=0;s;){if(s.nodeType===8){var l=s.data;if(l==="/$"||l==="/&"){if(r===0)return Ei(s.nextSibling);r--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||r++}s=s.nextSibling}return null}function _p(s){s=s.previousSibling;for(var r=0;s;){if(s.nodeType===8){var l=s.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(r===0)return s;r--}else l!=="/$"&&l!=="/&"||r++}s=s.previousSibling}return null}function gp(s,r,l){switch(r=Ya(l),s){case"html":if(s=r.documentElement,!s)throw Error(a(452));return s;case"head":if(s=r.head,!s)throw Error(a(453));return s;case"body":if(s=r.body,!s)throw Error(a(454));return s;default:throw Error(a(451))}}function ol(s){for(var r=s.attributes;r.length;)s.removeAttributeNode(r[0]);Po(s)}var Ti=new Map,pp=new Set;function qa(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var us=Z.d;Z.d={f:$S,r:ZS,D:QS,C:JS,L:eb,m:tb,X:sb,S:ib,M:rb};function $S(){var s=us.f(),r=Na();return s||r}function ZS(s){var r=kr(s);r!==null&&r.tag===5&&r.type==="form"?B_(r):us.r(s)}var cn=typeof document>"u"?null:document;function mp(s,r,l){var o=cn;if(o&&typeof r=="string"&&r){var u=vi(r);u='link[rel="'+s+'"][href="'+u+'"]',typeof l=="string"&&(u+='[crossorigin="'+l+'"]'),pp.has(u)||(pp.add(u),s={rel:s,crossOrigin:l,href:r},o.querySelector(u)===null&&(r=o.createElement("link"),It(r,"link",s),Rt(r),o.head.appendChild(r)))}}function QS(s){us.D(s),mp("dns-prefetch",s,null)}function JS(s,r){us.C(s,r),mp("preconnect",s,r)}function eb(s,r,l){us.L(s,r,l);var o=cn;if(o&&s&&r){var u='link[rel="preload"][as="'+vi(r)+'"]';r==="image"&&l&&l.imageSrcSet?(u+='[imagesrcset="'+vi(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(u+='[imagesizes="'+vi(l.imageSizes)+'"]')):u+='[href="'+vi(s)+'"]';var f=u;switch(r){case"style":f=hn(s);break;case"script":f=un(s)}Ti.has(f)||(s=b({rel:"preload",href:r==="image"&&l&&l.imageSrcSet?void 0:s,as:r},l),Ti.set(f,s),o.querySelector(u)!==null||r==="style"&&o.querySelector(cl(f))||r==="script"&&o.querySelector(hl(f))||(r=o.createElement("link"),It(r,"link",s),Rt(r),o.head.appendChild(r)))}}function tb(s,r){us.m(s,r);var l=cn;if(l&&s){var o=r&&typeof r.as=="string"?r.as:"script",u='link[rel="modulepreload"][as="'+vi(o)+'"][href="'+vi(s)+'"]',f=u;switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":f=un(s)}if(!Ti.has(f)&&(s=b({rel:"modulepreload",href:s},r),Ti.set(f,s),l.querySelector(u)===null)){switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(hl(f)))return}o=l.createElement("link"),It(o,"link",s),Rt(o),l.head.appendChild(o)}}}function ib(s,r,l){us.S(s,r,l);var o=cn;if(o&&s){var u=Mr(o).hoistableStyles,f=hn(s);r=r||"default";var v=u.get(f);if(!v){var x={loading:0,preload:null};if(v=o.querySelector(cl(f)))x.loading=5;else{s=b({rel:"stylesheet",href:s,"data-precedence":r},l),(l=Ti.get(f))&&Fh(s,l);var M=v=o.createElement("link");Rt(M),It(M,"link",s),M._p=new Promise(function(F,J){M.onload=F,M.onerror=J}),M.addEventListener("load",function(){x.loading|=1}),M.addEventListener("error",function(){x.loading|=2}),x.loading|=4,Ka(v,r,o)}v={type:"stylesheet",instance:v,count:1,state:x},u.set(f,v)}}}function sb(s,r){us.X(s,r);var l=cn;if(l&&s){var o=Mr(l).hoistableScripts,u=un(s),f=o.get(u);f||(f=l.querySelector(hl(u)),f||(s=b({src:s,async:!0},r),(r=Ti.get(u))&&Ph(s,r),f=l.createElement("script"),Rt(f),It(f,"link",s),l.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},o.set(u,f))}}function rb(s,r){us.M(s,r);var l=cn;if(l&&s){var o=Mr(l).hoistableScripts,u=un(s),f=o.get(u);f||(f=l.querySelector(hl(u)),f||(s=b({src:s,async:!0,type:"module"},r),(r=Ti.get(u))&&Ph(s,r),f=l.createElement("script"),Rt(f),It(f,"link",s),l.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},o.set(u,f))}}function vp(s,r,l,o){var u=(u=I.current)?qa(u):null;if(!u)throw Error(a(446));switch(s){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(r=hn(l.href),l=Mr(u).hoistableStyles,o=l.get(r),o||(o={type:"style",instance:null,count:0,state:null},l.set(r,o)),o):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){s=hn(l.href);var f=Mr(u).hoistableStyles,v=f.get(s);if(v||(u=u.ownerDocument||u,v={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},f.set(s,v),(f=u.querySelector(cl(s)))&&!f._p&&(v.instance=f,v.state.loading=5),Ti.has(s)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Ti.set(s,l),f||nb(u,s,l,v.state))),r&&o===null)throw Error(a(528,""));return v}if(r&&o!==null)throw Error(a(529,""));return null;case"script":return r=l.async,l=l.src,typeof l=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=un(l),l=Mr(u).hoistableScripts,o=l.get(r),o||(o={type:"script",instance:null,count:0,state:null},l.set(r,o)),o):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,s))}}function hn(s){return'href="'+vi(s)+'"'}function cl(s){return'link[rel="stylesheet"]['+s+"]"}function yp(s){return b({},s,{"data-precedence":s.precedence,precedence:null})}function nb(s,r,l,o){s.querySelector('link[rel="preload"][as="style"]['+r+"]")?o.loading=1:(r=s.createElement("link"),o.preload=r,r.addEventListener("load",function(){return o.loading|=1}),r.addEventListener("error",function(){return o.loading|=2}),It(r,"link",l),Rt(r),s.head.appendChild(r))}function un(s){return'[src="'+vi(s)+'"]'}function hl(s){return"script[async]"+s}function Sp(s,r,l){if(r.count++,r.instance===null)switch(r.type){case"style":var o=s.querySelector('style[data-href~="'+vi(l.href)+'"]');if(o)return r.instance=o,Rt(o),o;var u=b({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return o=(s.ownerDocument||s).createElement("style"),Rt(o),It(o,"style",u),Ka(o,l.precedence,s),r.instance=o;case"stylesheet":u=hn(l.href);var f=s.querySelector(cl(u));if(f)return r.state.loading|=4,r.instance=f,Rt(f),f;o=yp(l),(u=Ti.get(u))&&Fh(o,u),f=(s.ownerDocument||s).createElement("link"),Rt(f);var v=f;return v._p=new Promise(function(x,M){v.onload=x,v.onerror=M}),It(f,"link",o),r.state.loading|=4,Ka(f,l.precedence,s),r.instance=f;case"script":return f=un(l.src),(u=s.querySelector(hl(f)))?(r.instance=u,Rt(u),u):(o=l,(u=Ti.get(f))&&(o=b({},l),Ph(o,u)),s=s.ownerDocument||s,u=s.createElement("script"),Rt(u),It(u,"link",o),s.head.appendChild(u),r.instance=u);case"void":return null;default:throw Error(a(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(o=r.instance,r.state.loading|=4,Ka(o,l.precedence,s));return r.instance}function Ka(s,r,l){for(var o=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),u=o.length?o[o.length-1]:null,f=u,v=0;v<o.length;v++){var x=o[v];if(x.dataset.precedence===r)f=x;else if(f!==u)break}f?f.parentNode.insertBefore(s,f.nextSibling):(r=l.nodeType===9?l.head:l,r.insertBefore(s,r.firstChild))}function Fh(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.title==null&&(s.title=r.title)}function Ph(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.integrity==null&&(s.integrity=r.integrity)}var Ga=null;function bp(s,r,l){if(Ga===null){var o=new Map,u=Ga=new Map;u.set(l,o)}else u=Ga,o=u.get(l),o||(o=new Map,u.set(l,o));if(o.has(s))return o;for(o.set(s,null),l=l.getElementsByTagName(s),u=0;u<l.length;u++){var f=l[u];if(!(f[Tn]||f[zt]||s==="link"&&f.getAttribute("rel")==="stylesheet")&&f.namespaceURI!=="http://www.w3.org/2000/svg"){var v=f.getAttribute(r)||"";v=s+v;var x=o.get(v);x?x.push(f):o.set(v,[f])}}return o}function Cp(s,r,l){s=s.ownerDocument||s,s.head.insertBefore(l,r==="title"?s.querySelector("head > title"):null)}function lb(s,r,l){if(l===1||r.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;return r.rel==="stylesheet"?(s=r.disabled,typeof r.precedence=="string"&&s==null):!0;case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function wp(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function ab(s,r,l,o){if(l.type==="stylesheet"&&(typeof o.media!="string"||matchMedia(o.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var u=hn(o.href),f=r.querySelector(cl(u));if(f){r=f._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(s.count++,s=Xa.bind(s),r.then(s,s)),l.state.loading|=4,l.instance=f,Rt(f);return}f=r.ownerDocument||r,o=yp(o),(u=Ti.get(u))&&Fh(o,u),f=f.createElement("link"),Rt(f);var v=f;v._p=new Promise(function(x,M){v.onload=x,v.onerror=M}),It(f,"link",o),l.instance=f}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(l,r),(r=l.state.preload)&&(l.state.loading&3)===0&&(s.count++,l=Xa.bind(s),r.addEventListener("load",l),r.addEventListener("error",l))}}var Yh=0;function ob(s,r){return s.stylesheets&&s.count===0&&$a(s,s.stylesheets),0<s.count||0<s.imgCount?function(l){var o=setTimeout(function(){if(s.stylesheets&&$a(s,s.stylesheets),s.unsuspend){var f=s.unsuspend;s.unsuspend=null,f()}},6e4+r);0<s.imgBytes&&Yh===0&&(Yh=62500*FS());var u=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&$a(s,s.stylesheets),s.unsuspend)){var f=s.unsuspend;s.unsuspend=null,f()}},(s.imgBytes>Yh?50:800)+r);return s.unsuspend=l,function(){s.unsuspend=null,clearTimeout(o),clearTimeout(u)}}:null}function Xa(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)$a(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Va=null;function $a(s,r){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Va=new Map,r.forEach(cb,s),Va=null,Xa.call(s))}function cb(s,r){if(!(r.state.loading&4)){var l=Va.get(s);if(l)var o=l.get(null);else{l=new Map,Va.set(s,l);for(var u=s.querySelectorAll("link[data-precedence],style[data-precedence]"),f=0;f<u.length;f++){var v=u[f];(v.nodeName==="LINK"||v.getAttribute("media")!=="not all")&&(l.set(v.dataset.precedence,v),o=v)}o&&l.set(null,o)}u=r.instance,v=u.getAttribute("data-precedence"),f=l.get(v)||o,f===o&&l.set(null,u),l.set(v,u),this.count++,o=Xa.bind(this),u.addEventListener("load",o),u.addEventListener("error",o),f?f.parentNode.insertBefore(u,f.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(u,s.firstChild)),r.state.loading|=4}}var ul={$$typeof:te,Provider:null,Consumer:null,_currentValue:N,_currentValue2:N,_threadCount:0};function hb(s,r,l,o,u,f,v,x,M){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Io(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Io(0),this.hiddenUpdates=Io(null),this.identifierPrefix=o,this.onUncaughtError=u,this.onCaughtError=f,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=M,this.incompleteTransitions=new Map}function xp(s,r,l,o,u,f,v,x,M,F,J,le){return s=new hb(s,r,l,v,M,F,J,le,x),r=1,f===!0&&(r|=24),f=oi(3,null,null,r),s.current=f,f.stateNode=s,r=wc(),r.refCount++,s.pooledCache=r,r.refCount++,f.memoizedState={element:o,isDehydrated:l,cache:r},Ac(f),s}function Ep(s){return s?(s=Wr,s):Wr}function Tp(s,r,l,o,u,f){u=Ep(u),o.context===null?o.context=u:o.pendingContext=u,o=As(r),o.payload={element:l},f=f===void 0?null:f,f!==null&&(o.callback=f),l=Rs(s,o,r),l!==null&&(ei(l,s,r),Pn(l,s,r))}function Ap(s,r){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var l=s.retryLane;s.retryLane=l!==0&&l<r?l:r}}function qh(s,r){Ap(s,r),(s=s.alternate)&&Ap(s,r)}function Rp(s){if(s.tag===13||s.tag===31){var r=sr(s,67108864);r!==null&&ei(r,s,67108864),qh(s,67108864)}}function Dp(s){if(s.tag===13||s.tag===31){var r=fi();r=jo(r);var l=sr(s,r);l!==null&&ei(l,s,r),qh(s,r)}}var Za=!0;function ub(s,r,l,o){var u=O.T;O.T=null;var f=Z.p;try{Z.p=2,Kh(s,r,l,o)}finally{Z.p=f,O.T=u}}function db(s,r,l,o){var u=O.T;O.T=null;var f=Z.p;try{Z.p=8,Kh(s,r,l,o)}finally{Z.p=f,O.T=u}}function Kh(s,r,l,o){if(Za){var u=Gh(o);if(u===null)Lh(s,r,o,Qa,l),Mp(s,o);else if(_b(u,s,r,l,o))o.stopPropagation();else if(Mp(s,o),r&4&&-1<fb.indexOf(s)){for(;u!==null;){var f=kr(u);if(f!==null)switch(f.tag){case 3:if(f=f.stateNode,f.current.memoizedState.isDehydrated){var v=Qs(f.pendingLanes);if(v!==0){var x=f;for(x.pendingLanes|=2,x.entangledLanes|=2;v;){var M=1<<31-li(v);x.entanglements[1]|=M,v&=~M}Ui(f),(Ke&6)===0&&(Oa=ri()+500,nl(0))}}break;case 31:case 13:x=sr(f,2),x!==null&&ei(x,f,2),Na(),qh(f,2)}if(f=Gh(o),f===null&&Lh(s,r,o,Qa,l),f===u)break;u=f}u!==null&&o.stopPropagation()}else Lh(s,r,o,null,l)}}function Gh(s){return s=Vo(s),Xh(s)}var Qa=null;function Xh(s){if(Qa=null,s=Dr(s),s!==null){var r=h(s);if(r===null)s=null;else{var l=r.tag;if(l===13){if(s=d(r),s!==null)return s;s=null}else if(l===31){if(s=p(r),s!==null)return s;s=null}else if(l===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;s=null}else r!==s&&(s=null)}}return Qa=s,null}function kp(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Q0()){case Hd:return 2;case Ud:return 8;case Wl:case J0:return 32;case Id:return 268435456;default:return 32}default:return 32}}var Vh=!1,Is=null,js=null,Ws=null,dl=new Map,fl=new Map,Fs=[],fb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Mp(s,r){switch(s){case"focusin":case"focusout":Is=null;break;case"dragenter":case"dragleave":js=null;break;case"mouseover":case"mouseout":Ws=null;break;case"pointerover":case"pointerout":dl.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":fl.delete(r.pointerId)}}function _l(s,r,l,o,u,f){return s===null||s.nativeEvent!==f?(s={blockedOn:r,domEventName:l,eventSystemFlags:o,nativeEvent:f,targetContainers:[u]},r!==null&&(r=kr(r),r!==null&&Rp(r)),s):(s.eventSystemFlags|=o,r=s.targetContainers,u!==null&&r.indexOf(u)===-1&&r.push(u),s)}function _b(s,r,l,o,u){switch(r){case"focusin":return Is=_l(Is,s,r,l,o,u),!0;case"dragenter":return js=_l(js,s,r,l,o,u),!0;case"mouseover":return Ws=_l(Ws,s,r,l,o,u),!0;case"pointerover":var f=u.pointerId;return dl.set(f,_l(dl.get(f)||null,s,r,l,o,u)),!0;case"gotpointercapture":return f=u.pointerId,fl.set(f,_l(fl.get(f)||null,s,r,l,o,u)),!0}return!1}function Lp(s){var r=Dr(s.target);if(r!==null){var l=h(r);if(l!==null){if(r=l.tag,r===13){if(r=d(l),r!==null){s.blockedOn=r,qd(s.priority,function(){Dp(l)});return}}else if(r===31){if(r=p(l),r!==null){s.blockedOn=r,qd(s.priority,function(){Dp(l)});return}}else if(r===3&&l.stateNode.current.memoizedState.isDehydrated){s.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Ja(s){if(s.blockedOn!==null)return!1;for(var r=s.targetContainers;0<r.length;){var l=Gh(s.nativeEvent);if(l===null){l=s.nativeEvent;var o=new l.constructor(l.type,l);Xo=o,l.target.dispatchEvent(o),Xo=null}else return r=kr(l),r!==null&&Rp(r),s.blockedOn=l,!1;r.shift()}return!0}function Bp(s,r,l){Ja(s)&&l.delete(r)}function gb(){Vh=!1,Is!==null&&Ja(Is)&&(Is=null),js!==null&&Ja(js)&&(js=null),Ws!==null&&Ja(Ws)&&(Ws=null),dl.forEach(Bp),fl.forEach(Bp)}function eo(s,r){s.blockedOn===r&&(s.blockedOn=null,Vh||(Vh=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,gb)))}var to=null;function Op(s){to!==s&&(to=s,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){to===s&&(to=null);for(var r=0;r<s.length;r+=3){var l=s[r],o=s[r+1],u=s[r+2];if(typeof o!="function"){if(Xh(o||l)===null)continue;break}var f=kr(l);f!==null&&(s.splice(r,3),r-=3,Gc(f,{pending:!0,data:u,method:l.method,action:o},o,u))}}))}function dn(s){function r(M){return eo(M,s)}Is!==null&&eo(Is,s),js!==null&&eo(js,s),Ws!==null&&eo(Ws,s),dl.forEach(r),fl.forEach(r);for(var l=0;l<Fs.length;l++){var o=Fs[l];o.blockedOn===s&&(o.blockedOn=null)}for(;0<Fs.length&&(l=Fs[0],l.blockedOn===null);)Lp(l),l.blockedOn===null&&Fs.shift();if(l=(s.ownerDocument||s).$$reactFormReplay,l!=null)for(o=0;o<l.length;o+=3){var u=l[o],f=l[o+1],v=u[Xt]||null;if(typeof f=="function")v||Op(l);else if(v){var x=null;if(f&&f.hasAttribute("formAction")){if(u=f,v=f[Xt]||null)x=v.formAction;else if(Xh(u)!==null)continue}else x=v.action;typeof x=="function"?l[o+1]=x:(l.splice(o,3),o-=3),Op(l)}}}function zp(){function s(f){f.canIntercept&&f.info==="react-transition"&&f.intercept({handler:function(){return new Promise(function(v){return u=v})},focusReset:"manual",scroll:"manual"})}function r(){u!==null&&(u(),u=null),o||setTimeout(l,20)}function l(){if(!o&&!navigation.transition){var f=navigation.currentEntry;f&&f.url!=null&&navigation.navigate(f.url,{state:f.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var o=!1,u=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(l,100),function(){o=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),u!==null&&(u(),u=null)}}}function $h(s){this._internalRoot=s}io.prototype.render=$h.prototype.render=function(s){var r=this._internalRoot;if(r===null)throw Error(a(409));var l=r.current,o=fi();Tp(l,o,s,r,null,null)},io.prototype.unmount=$h.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var r=s.containerInfo;Tp(s.current,2,null,s,null,null),Na(),r[Rr]=null}};function io(s){this._internalRoot=s}io.prototype.unstable_scheduleHydration=function(s){if(s){var r=Yd();s={blockedOn:null,target:s,priority:r};for(var l=0;l<Fs.length&&r!==0&&r<Fs[l].priority;l++);Fs.splice(l,0,s),l===0&&Lp(s)}};var Np=i.version;if(Np!=="19.2.4")throw Error(a(527,Np,"19.2.4"));Z.findDOMNode=function(s){var r=s._reactInternals;if(r===void 0)throw typeof s.render=="function"?Error(a(188)):(s=Object.keys(s).join(","),Error(a(268,s)));return s=_(r),s=s!==null?y(s):null,s=s===null?null:s.stateNode,s};var pb={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:O,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var so=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!so.isDisabled&&so.supportsFiber)try{wn=so.inject(pb),ni=so}catch{}}return pl.createRoot=function(s,r){if(!c(s))throw Error(a(299));var l=!1,o="",u=P_,f=Y_,v=q_;return r!=null&&(r.unstable_strictMode===!0&&(l=!0),r.identifierPrefix!==void 0&&(o=r.identifierPrefix),r.onUncaughtError!==void 0&&(u=r.onUncaughtError),r.onCaughtError!==void 0&&(f=r.onCaughtError),r.onRecoverableError!==void 0&&(v=r.onRecoverableError)),r=xp(s,1,!1,null,null,l,o,null,u,f,v,zp),s[Rr]=r.current,Mh(s),new $h(r)},pl.hydrateRoot=function(s,r,l){if(!c(s))throw Error(a(299));var o=!1,u="",f=P_,v=Y_,x=q_,M=null;return l!=null&&(l.unstable_strictMode===!0&&(o=!0),l.identifierPrefix!==void 0&&(u=l.identifierPrefix),l.onUncaughtError!==void 0&&(f=l.onUncaughtError),l.onCaughtError!==void 0&&(v=l.onCaughtError),l.onRecoverableError!==void 0&&(x=l.onRecoverableError),l.formState!==void 0&&(M=l.formState)),r=xp(s,1,!0,r,l??null,o,u,M,f,v,x,zp),r.context=Ep(null),l=r.current,o=fi(),o=jo(o),u=As(o),u.callback=null,Rs(l,u,o),l=o,r.current.lanes=l,En(r,l),Ui(r),s[Rr]=r.current,Mh(s),new io(r)},pl.version="19.2.4",pl}var Kp;function Tb(){if(Kp)return Jh.exports;Kp=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(i){console.error(i)}}return t(),Jh.exports=Eb(),Jh.exports}var Ab=Tb();const Lv={accent:"#6366f1",accentHover:"#818cf8",accentDim:"rgba(99,102,241,0.15)",borderAccent:"rgba(99,102,241,0.4)",success:"#10b981",successDim:"rgba(16,185,129,0.15)",danger:"#ef4444",dangerDim:"rgba(239,68,68,0.15)",warning:"#f59e0b",radiusSm:"6px",radiusMd:"8px",radiusLg:"12px",radiusPill:"9999px",fontSans:'"DM Sans", system-ui, sans-serif',fontMono:'"Geist Mono", "JetBrains Mono", monospace'},vd={...Lv,bgBase:"#0a0a0f",bgPanel:"#0f0f17",bgCard:"#16161f",bgHover:"#1e1e2e",bgInput:"#0d0d14",border:"rgba(255,255,255,0.07)",borderHover:"rgba(255,255,255,0.14)",textPrimary:"#f1f5f9",textSecondary:"#94a3b8",textMuted:"#475569"},Rb={...Lv,bgBase:"#f4f4f5",bgPanel:"#ffffff",bgCard:"#ffffff",bgHover:"#f0f0f2",bgInput:"#f9f9fb",border:"rgba(0,0,0,0.08)",borderHover:"rgba(0,0,0,0.15)",textPrimary:"#111118",textSecondary:"#4b5563",textMuted:"#9ca3af"},Db=t=>t?vd:Rb,Bv=K.createContext(vd),Ki=()=>K.useContext(Bv),yd=t=>({display:"block",width:"100%",padding:"0.55rem 0.85rem",borderRadius:t.radiusSm,border:`1px solid ${t.border}`,background:t.bgInput,color:t.textPrimary,boxSizing:"border-box",outline:"none",fontSize:"0.875rem",fontFamily:t.fontSans,transition:"border-color 0.15s"});yd(vd);const kb=t=>t?`radial-gradient(ellipse 80% 60% at 50% -10%, rgba(99,102,241,0.18) 0%, transparent 70%),
     linear-gradient(rgba(255,255,255,0.025) 1px, transparent 1px),
     linear-gradient(90deg, rgba(255,255,255,0.025) 1px, transparent 1px)`:`radial-gradient(ellipse 80% 60% at 50% -10%, rgba(99,102,241,0.1) 0%, transparent 70%),
     linear-gradient(rgba(0,0,0,0.04) 1px, transparent 1px),
     linear-gradient(90deg, rgba(0,0,0,0.04) 1px, transparent 1px)`;function Mb({onLogin:t,onRegister:i,isDark:n,onToggleTheme:a}){const c=Ki(),h=yd(c),[d,p]=K.useState(""),[m,_]=K.useState(""),[y,b]=K.useState(""),[E,R]=K.useState(!1),[D,k]=K.useState("");async function V(X){X.preventDefault(),b(""),R(!0);try{const he=await fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:d,password:m})});if(he.ok){const{token:te}=await he.json();t(te)}else{const{error:te}=await he.json();b(te||"")}}catch{b("")}finally{R(!1)}}return T.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",background:c.bgBase,backgroundImage:kb(n!==!1),backgroundSize:"100% 100%, 32px 32px, 32px 32px",fontFamily:c.fontSans},children:[T.jsx("style",{children:`
        @import url('https://fonts.googleapis.com/css2?family=DM+Sans:wght@300;400;500;600&display=swap');
        .login-input:focus { border-color: ${c.borderAccent} !important; box-shadow: 0 0 0 3px ${c.accentDim}; }
        .login-btn:hover:not(:disabled) { background: ${c.accentHover} !important; transform: translateY(-1px); box-shadow: 0 4px 20px rgba(99,102,241,0.35); }
        .login-btn { transition: all 0.15s ease; }
        .login-card { animation: fadeUp 0.4s ease both; }
        @keyframes fadeUp { from { opacity:0; transform:translateY(16px); } to { opacity:1; transform:translateY(0); } }
      `}),T.jsxs("div",{className:"login-card",style:{background:c.bgCard,border:`1px solid ${c.border}`,borderRadius:c.radiusLg,padding:"2.25rem 2rem",width:"100%",maxWidth:"360px",boxShadow:"0 24px 64px rgba(0,0,0,0.5), 0 0 0 1px rgba(255,255,255,0.04) inset",position:"relative"},children:[a&&T.jsx("button",{onClick:a,title:n!==!1?"":"",style:{position:"absolute",top:"1rem",right:"1rem",background:"none",border:`1px solid ${c.border}`,color:c.textMuted,borderRadius:c.radiusSm,cursor:"pointer",padding:"3px 8px",fontSize:"0.85rem"},children:n!==!1?"":""}),T.jsxs("div",{style:{textAlign:"center",marginBottom:"1.75rem"},children:[T.jsx("div",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:"44px",height:"44px",borderRadius:"10px",background:`linear-gradient(135deg, ${c.accent}, #818cf8)`,marginBottom:"0.75rem",boxShadow:"0 8px 24px rgba(99,102,241,0.4)"},children:T.jsx("span",{style:{fontSize:"1.25rem"},children:""})}),T.jsx("div",{style:{color:c.textPrimary,fontWeight:600,fontSize:"1.05rem",letterSpacing:"-0.01em"},children:"Claude Code"}),T.jsx("div",{style:{color:c.textMuted,fontSize:"0.78rem",marginTop:"2px"},children:"Dashboard"})]}),y&&T.jsx("div",{style:{background:c.dangerDim,border:"1px solid rgba(239,68,68,0.25)",borderRadius:c.radiusSm,padding:"0.5rem 0.75rem",color:"#fca5a5",fontSize:"0.82rem",marginBottom:"1rem"},children:y}),T.jsxs("form",{onSubmit:V,children:[T.jsxs("div",{style:{marginBottom:"0.75rem"},children:[T.jsx("label",{style:{display:"block",color:c.textSecondary,fontSize:"0.78rem",marginBottom:"0.35rem",fontWeight:500},children:""}),T.jsx("input",{className:"login-input",placeholder:"",value:d,onChange:X=>p(X.target.value),autoFocus:!0,style:{...h,border:`1px solid ${D==="u"?c.borderAccent:c.border}`},onFocus:()=>k("u"),onBlur:()=>k("")})]}),T.jsxs("div",{style:{marginBottom:"1.25rem"},children:[T.jsx("label",{style:{display:"block",color:c.textSecondary,fontSize:"0.78rem",marginBottom:"0.35rem",fontWeight:500},children:""}),T.jsx("input",{className:"login-input",type:"password",placeholder:"",value:m,onChange:X=>_(X.target.value),style:{...h,border:`1px solid ${D==="p"?c.borderAccent:c.border}`},onFocus:()=>k("p"),onBlur:()=>k("")})]}),T.jsx("button",{className:"login-btn",type:"submit",disabled:E,style:{width:"100%",padding:"0.6rem",background:E?c.bgHover:c.accent,color:"#fff",border:"none",borderRadius:c.radiusSm,cursor:E?"not-allowed":"pointer",fontSize:"0.875rem",fontWeight:600,fontFamily:c.fontSans,opacity:E?.7:1},children:E?"":""})]}),T.jsxs("p",{style:{textAlign:"center",marginTop:"1.25rem",fontSize:"0.8rem",color:c.textMuted},children:["",T.jsx("span",{onClick:i,style:{color:c.accent,cursor:"pointer",marginLeft:"4px",fontWeight:500},children:""})]})]})]})}function Lb({onLogin:t,onBack:i}){const[n,a]=K.useState(""),[c,h]=K.useState(""),[d,p]=K.useState(""),[m,_]=K.useState(""),[y,b]=K.useState(!1);async function E(R){if(R.preventDefault(),_(""),c!==d){_("");return}if(c.length<6){_("6");return}b(!0);try{const D=await fetch("/api/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,password:c})}),k=await D.json();D.ok?t(k.token):_(k.error||"")}catch{_("")}finally{b(!1)}}return T.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",background:"#0d1117"},children:T.jsxs("form",{onSubmit:E,style:{background:"#161b22",padding:"2rem",borderRadius:"8px",minWidth:"320px",border:"1px solid #30363d"},children:[T.jsx("h2",{style:{color:"#e6edf3",marginBottom:"1.5rem",textAlign:"center",fontSize:"1.2rem"},children:""}),m&&T.jsx("p",{style:{color:"#f85149",fontSize:"0.85rem",margin:"0 0 1rem"},children:m}),T.jsx("input",{placeholder:"2",value:n,onChange:R=>a(R.target.value),autoFocus:!0,style:su}),T.jsx("input",{type:"password",placeholder:"6",value:c,onChange:R=>h(R.target.value),style:su}),T.jsx("input",{type:"password",placeholder:"",value:d,onChange:R=>p(R.target.value),style:su}),T.jsx("button",{type:"submit",disabled:y,style:Bb(y),children:y?"":""}),T.jsxs("p",{style:{textAlign:"center",marginTop:"1rem",fontSize:"0.82rem",color:"#8b949e"},children:["",T.jsx("span",{onClick:i,style:{color:"#58a6ff",cursor:"pointer",marginLeft:"4px"},children:""})]})]})})}const su={display:"block",width:"100%",marginBottom:"0.75rem",padding:"0.5rem 0.75rem",borderRadius:"6px",border:"1px solid #30363d",background:"#0d1117",color:"#e6edf3",boxSizing:"border-box",outline:"none"},Bb=t=>({width:"100%",padding:"0.5rem",background:t?"#21262d":"#1f6feb",color:"#e6edf3",border:"1px solid #388bfd",borderRadius:"6px",cursor:t?"not-allowed":"pointer",fontSize:"0.9rem"});var Ov=Object.defineProperty,Ob=Object.getOwnPropertyDescriptor,zb=(t,i)=>{for(var n in i)Ov(t,n,{get:i[n],enumerable:!0})},ft=(t,i,n,a)=>{for(var c=a>1?void 0:a?Ob(i,n):i,h=t.length-1,d;h>=0;h--)(d=t[h])&&(c=(a?d(i,n,c):d(c))||c);return a&&c&&Ov(i,n,c),c},ve=(t,i)=>(n,a)=>i(n,a,t),Gp="Terminal input",Tu={get:()=>Gp,set:t=>Gp=t},Xp="Too much output to announce, navigate to rows manually to read",Au={get:()=>Xp,set:t=>Xp=t};function Nb(t){return t.replace(/\r?\n/g,"\r")}function Hb(t,i){return i?"\x1B[200~"+t+"\x1B[201~":t}function Ub(t,i){t.clipboardData&&t.clipboardData.setData("text/plain",i.selectionText),t.preventDefault()}function Ib(t,i,n,a){if(t.stopPropagation(),t.clipboardData){let c=t.clipboardData.getData("text/plain");zv(c,i,n,a)}}function zv(t,i,n,a){t=Nb(t),t=Hb(t,n.decPrivateModes.bracketedPasteMode&&a.rawOptions.ignoreBracketedPasteMode!==!0),n.triggerDataEvent(t,!0),i.value=""}function Nv(t,i,n){let a=n.getBoundingClientRect(),c=t.clientX-a.left-10,h=t.clientY-a.top-10;i.style.width="20px",i.style.height="20px",i.style.left=`${c}px`,i.style.top=`${h}px`,i.style.zIndex="1000",i.focus()}function Vp(t,i,n,a,c){Nv(t,i,n),c&&a.rightClickSelect(t),i.value=a.selectionText,i.select()}function Xs(t){return t>65535?(t-=65536,String.fromCharCode((t>>10)+55296)+String.fromCharCode(t%1024+56320)):String.fromCharCode(t)}function Mo(t,i=0,n=t.length){let a="";for(let c=i;c<n;++c){let h=t[c];h>65535?(h-=65536,a+=String.fromCharCode((h>>10)+55296)+String.fromCharCode(h%1024+56320)):a+=String.fromCharCode(h)}return a}var jb=class{constructor(){this._interim=0}clear(){this._interim=0}decode(t,i){let n=t.length;if(!n)return 0;let a=0,c=0;if(this._interim){let h=t.charCodeAt(c++);56320<=h&&h<=57343?i[a++]=(this._interim-55296)*1024+h-56320+65536:(i[a++]=this._interim,i[a++]=h),this._interim=0}for(let h=c;h<n;++h){let d=t.charCodeAt(h);if(55296<=d&&d<=56319){if(++h>=n)return this._interim=d,a;let p=t.charCodeAt(h);56320<=p&&p<=57343?i[a++]=(d-55296)*1024+p-56320+65536:(i[a++]=d,i[a++]=p);continue}d!==65279&&(i[a++]=d)}return a}},Wb=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(t,i){let n=t.length;if(!n)return 0;let a=0,c,h,d,p,m=0,_=0;if(this.interim[0]){let E=!1,R=this.interim[0];R&=(R&224)===192?31:(R&240)===224?15:7;let D=0,k;for(;(k=this.interim[++D]&63)&&D<4;)R<<=6,R|=k;let V=(this.interim[0]&224)===192?2:(this.interim[0]&240)===224?3:4,X=V-D;for(;_<X;){if(_>=n)return 0;if(k=t[_++],(k&192)!==128){_--,E=!0;break}else this.interim[D++]=k,R<<=6,R|=k&63}E||(V===2?R<128?_--:i[a++]=R:V===3?R<2048||R>=55296&&R<=57343||R===65279||(i[a++]=R):R<65536||R>1114111||(i[a++]=R)),this.interim.fill(0)}let y=n-4,b=_;for(;b<n;){for(;b<y&&!((c=t[b])&128)&&!((h=t[b+1])&128)&&!((d=t[b+2])&128)&&!((p=t[b+3])&128);)i[a++]=c,i[a++]=h,i[a++]=d,i[a++]=p,b+=4;if(c=t[b++],c<128)i[a++]=c;else if((c&224)===192){if(b>=n)return this.interim[0]=c,a;if(h=t[b++],(h&192)!==128){b--;continue}if(m=(c&31)<<6|h&63,m<128){b--;continue}i[a++]=m}else if((c&240)===224){if(b>=n)return this.interim[0]=c,a;if(h=t[b++],(h&192)!==128){b--;continue}if(b>=n)return this.interim[0]=c,this.interim[1]=h,a;if(d=t[b++],(d&192)!==128){b--;continue}if(m=(c&15)<<12|(h&63)<<6|d&63,m<2048||m>=55296&&m<=57343||m===65279)continue;i[a++]=m}else if((c&248)===240){if(b>=n)return this.interim[0]=c,a;if(h=t[b++],(h&192)!==128){b--;continue}if(b>=n)return this.interim[0]=c,this.interim[1]=h,a;if(d=t[b++],(d&192)!==128){b--;continue}if(b>=n)return this.interim[0]=c,this.interim[1]=h,this.interim[2]=d,a;if(p=t[b++],(p&192)!==128){b--;continue}if(m=(c&7)<<18|(h&63)<<12|(d&63)<<6|p&63,m<65536||m>1114111)continue;i[a++]=m}}return a}},Hv="",Vs=" ",Nl=class Uv{constructor(){this.fg=0,this.bg=0,this.extended=new xo}static toColorRGB(i){return[i>>>16&255,i>>>8&255,i&255]}static fromColorRGB(i){return(i[0]&255)<<16|(i[1]&255)<<8|i[2]&255}clone(){let i=new Uv;return i.fg=this.fg,i.bg=this.bg,i.extended=this.extended.clone(),i}isInverse(){return this.fg&67108864}isBold(){return this.fg&134217728}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:this.fg&268435456}isBlink(){return this.fg&536870912}isInvisible(){return this.fg&1073741824}isItalic(){return this.bg&67108864}isDim(){return this.bg&134217728}isStrikethrough(){return this.fg&2147483648}isProtected(){return this.bg&536870912}isOverline(){return this.bg&1073741824}getFgColorMode(){return this.fg&50331648}getBgColorMode(){return this.bg&50331648}isFgRGB(){return(this.fg&50331648)===50331648}isBgRGB(){return(this.bg&50331648)===50331648}isFgPalette(){return(this.fg&50331648)===16777216||(this.fg&50331648)===33554432}isBgPalette(){return(this.bg&50331648)===16777216||(this.bg&50331648)===33554432}isFgDefault(){return(this.fg&50331648)===0}isBgDefault(){return(this.bg&50331648)===0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(this.fg&50331648){case 16777216:case 33554432:return this.fg&255;case 50331648:return this.fg&16777215;default:return-1}}getBgColor(){switch(this.bg&50331648){case 16777216:case 33554432:return this.bg&255;case 50331648:return this.bg&16777215;default:return-1}}hasExtendedAttrs(){return this.bg&268435456}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(this.bg&268435456&&~this.extended.underlineColor)switch(this.extended.underlineColor&50331648){case 16777216:case 33554432:return this.extended.underlineColor&255;case 50331648:return this.extended.underlineColor&16777215;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return this.bg&268435456&&~this.extended.underlineColor?this.extended.underlineColor&50331648:this.getFgColorMode()}isUnderlineColorRGB(){return this.bg&268435456&&~this.extended.underlineColor?(this.extended.underlineColor&50331648)===50331648:this.isFgRGB()}isUnderlineColorPalette(){return this.bg&268435456&&~this.extended.underlineColor?(this.extended.underlineColor&50331648)===16777216||(this.extended.underlineColor&50331648)===33554432:this.isFgPalette()}isUnderlineColorDefault(){return this.bg&268435456&&~this.extended.underlineColor?(this.extended.underlineColor&50331648)===0:this.isFgDefault()}getUnderlineStyle(){return this.fg&268435456?this.bg&268435456?this.extended.underlineStyle:1:0}getUnderlineVariantOffset(){return this.extended.underlineVariantOffset}},xo=class Iv{constructor(i=0,n=0){this._ext=0,this._urlId=0,this._ext=i,this._urlId=n}get ext(){return this._urlId?this._ext&-469762049|this.underlineStyle<<26:this._ext}set ext(i){this._ext=i}get underlineStyle(){return this._urlId?5:(this._ext&469762048)>>26}set underlineStyle(i){this._ext&=-469762049,this._ext|=i<<26&469762048}get underlineColor(){return this._ext&67108863}set underlineColor(i){this._ext&=-67108864,this._ext|=i&67108863}get urlId(){return this._urlId}set urlId(i){this._urlId=i}get underlineVariantOffset(){let i=(this._ext&3758096384)>>29;return i<0?i^4294967288:i}set underlineVariantOffset(i){this._ext&=536870911,this._ext|=i<<29&3758096384}clone(){return new Iv(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}},ki=class jv extends Nl{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new xo,this.combinedData=""}static fromCharData(i){let n=new jv;return n.setFromCharData(i),n}isCombined(){return this.content&2097152}getWidth(){return this.content>>22}getChars(){return this.content&2097152?this.combinedData:this.content&2097151?Xs(this.content&2097151):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):this.content&2097151}setFromCharData(i){this.fg=i[0],this.bg=0;let n=!1;if(i[1].length>2)n=!0;else if(i[1].length===2){let a=i[1].charCodeAt(0);if(55296<=a&&a<=56319){let c=i[1].charCodeAt(1);56320<=c&&c<=57343?this.content=(a-55296)*1024+c-56320+65536|i[2]<<22:n=!0}else n=!0}else this.content=i[1].charCodeAt(0)|i[2]<<22;n&&(this.combinedData=i[1],this.content=2097152|i[2]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}},$p="di$target",Ru="di$dependencies",ru=new Map;function Fb(t){return t[Ru]||[]}function Ot(t){if(ru.has(t))return ru.get(t);let i=function(n,a,c){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");Pb(i,n,c)};return i._id=t,ru.set(t,i),i}function Pb(t,i,n){i[$p]===i?i[Ru].push({id:t,index:n}):(i[Ru]=[{id:t,index:n}],i[$p]=i)}var Kt=Ot("BufferService"),Wv=Ot("CoreMouseService"),Tr=Ot("CoreService"),Yb=Ot("CharsetService"),Sd=Ot("InstantiationService"),Fv=Ot("LogService"),Gt=Ot("OptionsService"),Pv=Ot("OscLinkService"),qb=Ot("UnicodeService"),Hl=Ot("DecorationService"),Du=class{constructor(t,i,n){this._bufferService=t,this._optionsService=i,this._oscLinkService=n}provideLinks(t,i){let n=this._bufferService.buffer.lines.get(t-1);if(!n){i(void 0);return}let a=[],c=this._optionsService.rawOptions.linkHandler,h=new ki,d=n.getTrimmedLength(),p=-1,m=-1,_=!1;for(let y=0;y<d;y++)if(!(m===-1&&!n.hasContent(y))){if(n.loadCell(y,h),h.hasExtendedAttrs()&&h.extended.urlId)if(m===-1){m=y,p=h.extended.urlId;continue}else _=h.extended.urlId!==p;else m!==-1&&(_=!0);if(_||m!==-1&&y===d-1){let b=this._oscLinkService.getLinkData(p)?.uri;if(b){let E={start:{x:m+1,y:t},end:{x:y+(!_&&y===d-1?1:0),y:t}},R=!1;if(!c?.allowNonHttpProtocols)try{let D=new URL(b);["http:","https:"].includes(D.protocol)||(R=!0)}catch{R=!0}R||a.push({text:b,range:E,activate:(D,k)=>c?c.activate(D,k,E):Kb(D,k),hover:(D,k)=>c?.hover?.(D,k,E),leave:(D,k)=>c?.leave?.(D,k,E)})}_=!1,h.hasExtendedAttrs()&&h.extended.urlId?(m=y,p=h.extended.urlId):(m=-1,p=-1)}}i(a)}};Du=ft([ve(0,Kt),ve(1,Gt),ve(2,Pv)],Du);function Kb(t,i){if(confirm(`Do you want to navigate to ${i}?

WARNING: This link could potentially be dangerous`)){let n=window.open();if(n){try{n.opener=null}catch{}n.location.href=i}else console.warn("Opening link blocked as opener could not be cleared")}}var Lo=Ot("CharSizeService"),ms=Ot("CoreBrowserService"),bd=Ot("MouseService"),vs=Ot("RenderService"),Gb=Ot("SelectionService"),Yv=Ot("CharacterJoinerService"),Sn=Ot("ThemeService"),qv=Ot("LinkProviderService"),Xb=class{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(t){setTimeout(()=>{throw t.stack?Zp.isErrorNoTelemetry(t)?new Zp(t.message+`

`+t.stack):new Error(t.message+`

`+t.stack):t},0)}}addListener(t){return this.listeners.push(t),()=>{this._removeListener(t)}}emit(t){this.listeners.forEach(i=>{i(t)})}_removeListener(t){this.listeners.splice(this.listeners.indexOf(t),1)}setUnexpectedErrorHandler(t){this.unexpectedErrorHandler=t}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(t){this.unexpectedErrorHandler(t),this.emit(t)}onUnexpectedExternalError(t){this.unexpectedErrorHandler(t)}},Vb=new Xb;function po(t){$b(t)||Vb.onUnexpectedError(t)}var ku="Canceled";function $b(t){return t instanceof Zb?!0:t instanceof Error&&t.name===ku&&t.message===ku}var Zb=class extends Error{constructor(){super(ku),this.name=this.message}};function Qb(t){return new Error(`Illegal argument: ${t}`)}var Zp=class Mu extends Error{constructor(i){super(i),this.name="CodeExpectedError"}static fromError(i){if(i instanceof Mu)return i;let n=new Mu;return n.message=i.message,n.stack=i.stack,n}static isErrorNoTelemetry(i){return i.name==="CodeExpectedError"}},Lu=class Kv extends Error{constructor(i){super(i||"An unexpected bug occurred."),Object.setPrototypeOf(this,Kv.prototype)}};function _i(t,i=0){return t[t.length-(1+i)]}var Jb;(t=>{function i(h){return h<0}t.isLessThan=i;function n(h){return h<=0}t.isLessThanOrEqual=n;function a(h){return h>0}t.isGreaterThan=a;function c(h){return h===0}t.isNeitherLessOrGreaterThan=c,t.greaterThan=1,t.lessThan=-1,t.neitherLessOrGreaterThan=0})(Jb||={});function e1(t,i){let n=this,a=!1,c;return function(){return a||(a=!0,i||(c=t.apply(n,arguments))),c}}var Gv;(t=>{function i(ue){return ue&&typeof ue=="object"&&typeof ue[Symbol.iterator]=="function"}t.is=i;let n=Object.freeze([]);function a(){return n}t.empty=a;function*c(ue){yield ue}t.single=c;function h(ue){return i(ue)?ue:c(ue)}t.wrap=h;function d(ue){return ue||n}t.from=d;function*p(ue){for(let de=ue.length-1;de>=0;de--)yield ue[de]}t.reverse=p;function m(ue){return!ue||ue[Symbol.iterator]().next().done===!0}t.isEmpty=m;function _(ue){return ue[Symbol.iterator]().next().value}t.first=_;function y(ue,de){let _e=0;for(let q of ue)if(de(q,_e++))return!0;return!1}t.some=y;function b(ue,de){for(let _e of ue)if(de(_e))return _e}t.find=b;function*E(ue,de){for(let _e of ue)de(_e)&&(yield _e)}t.filter=E;function*R(ue,de){let _e=0;for(let q of ue)yield de(q,_e++)}t.map=R;function*D(ue,de){let _e=0;for(let q of ue)yield*de(q,_e++)}t.flatMap=D;function*k(...ue){for(let de of ue)yield*de}t.concat=k;function V(ue,de,_e){let q=_e;for(let ge of ue)q=de(q,ge);return q}t.reduce=V;function*X(ue,de,_e=ue.length){for(de<0&&(de+=ue.length),_e<0?_e+=ue.length:_e>ue.length&&(_e=ue.length);de<_e;de++)yield ue[de]}t.slice=X;function he(ue,de=Number.POSITIVE_INFINITY){let _e=[];if(de===0)return[_e,ue];let q=ue[Symbol.iterator]();for(let ge=0;ge<de;ge++){let Y=q.next();if(Y.done)return[_e,t.empty()];_e.push(Y.value)}return[_e,{[Symbol.iterator](){return q}}]}t.consume=he;async function te(ue){let de=[];for await(let _e of ue)de.push(_e);return Promise.resolve(de)}t.asyncToArray=te})(Gv||={});function wr(t){if(Gv.is(t)){let i=[];for(let n of t)if(n)try{n.dispose()}catch(a){i.push(a)}if(i.length===1)throw i[0];if(i.length>1)throw new AggregateError(i,"Encountered errors while disposing of store");return Array.isArray(t)?[]:t}else if(t)return t.dispose(),t}function t1(...t){return nt(()=>wr(t))}function nt(t){return{dispose:e1(()=>{t()})}}var Xv=class Vv{constructor(){this._toDispose=new Set,this._isDisposed=!1}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{wr(this._toDispose)}finally{this._toDispose.clear()}}add(i){if(!i)return i;if(i===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?Vv.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(i),i}delete(i){if(i){if(i===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(i),i.dispose()}}deleteAndLeak(i){i&&this._toDispose.has(i)&&(this._toDispose.delete(i),void 0)}};Xv.DISABLE_DISPOSED_WARNING=!1;var $s=Xv,He=class{constructor(){this._store=new $s,this._store}dispose(){this._store.dispose()}_register(t){if(t===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(t)}};He.None=Object.freeze({dispose(){}});var yn=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(t){this._isDisposed||t===this._value||(this._value?.dispose(),this._value=t)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,this._value?.dispose(),this._value=void 0}clearAndLeak(){let t=this._value;return this._value=void 0,t}},ps=typeof window=="object"?window:globalThis,Bu=class Ou{constructor(i){this.element=i,this.next=Ou.Undefined,this.prev=Ou.Undefined}};Bu.Undefined=new Bu(void 0);var lt=Bu,Qp=class{constructor(){this._first=lt.Undefined,this._last=lt.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===lt.Undefined}clear(){let t=this._first;for(;t!==lt.Undefined;){let i=t.next;t.prev=lt.Undefined,t.next=lt.Undefined,t=i}this._first=lt.Undefined,this._last=lt.Undefined,this._size=0}unshift(t){return this._insert(t,!1)}push(t){return this._insert(t,!0)}_insert(t,i){let n=new lt(t);if(this._first===lt.Undefined)this._first=n,this._last=n;else if(i){let c=this._last;this._last=n,n.prev=c,c.next=n}else{let c=this._first;this._first=n,n.next=c,c.prev=n}this._size+=1;let a=!1;return()=>{a||(a=!0,this._remove(n))}}shift(){if(this._first!==lt.Undefined){let t=this._first.element;return this._remove(this._first),t}}pop(){if(this._last!==lt.Undefined){let t=this._last.element;return this._remove(this._last),t}}_remove(t){if(t.prev!==lt.Undefined&&t.next!==lt.Undefined){let i=t.prev;i.next=t.next,t.next.prev=i}else t.prev===lt.Undefined&&t.next===lt.Undefined?(this._first=lt.Undefined,this._last=lt.Undefined):t.next===lt.Undefined?(this._last=this._last.prev,this._last.next=lt.Undefined):t.prev===lt.Undefined&&(this._first=this._first.next,this._first.prev=lt.Undefined);this._size-=1}*[Symbol.iterator](){let t=this._first;for(;t!==lt.Undefined;)yield t.element,t=t.next}},i1=globalThis.performance&&typeof globalThis.performance.now=="function",s1=class $v{static create(i){return new $v(i)}constructor(i){this._now=i1&&i===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}},jt;(t=>{t.None=()=>He.None;function i(Q,j){return b(Q,()=>{},0,void 0,!0,void 0,j)}t.defer=i;function n(Q){return(j,ne=null,ce)=>{let O=!1,Z;return Z=Q(N=>{if(!O)return Z?Z.dispose():O=!0,j.call(ne,N)},null,ce),O&&Z.dispose(),Z}}t.once=n;function a(Q,j,ne){return _((ce,O=null,Z)=>Q(N=>ce.call(O,j(N)),null,Z),ne)}t.map=a;function c(Q,j,ne){return _((ce,O=null,Z)=>Q(N=>{j(N),ce.call(O,N)},null,Z),ne)}t.forEach=c;function h(Q,j,ne){return _((ce,O=null,Z)=>Q(N=>j(N)&&ce.call(O,N),null,Z),ne)}t.filter=h;function d(Q){return Q}t.signal=d;function p(...Q){return(j,ne=null,ce)=>{let O=t1(...Q.map(Z=>Z(N=>j.call(ne,N))));return y(O,ce)}}t.any=p;function m(Q,j,ne,ce){let O=ne;return a(Q,Z=>(O=j(O,Z),O),ce)}t.reduce=m;function _(Q,j){let ne,ce={onWillAddFirstListener(){ne=Q(O.fire,O)},onDidRemoveLastListener(){ne?.dispose()}},O=new pe(ce);return j?.add(O),O.event}function y(Q,j){return j instanceof Array?j.push(Q):j&&j.add(Q),Q}function b(Q,j,ne=100,ce=!1,O=!1,Z,N){let me,we,A,U=0,L,z={leakWarningThreshold:Z,onWillAddFirstListener(){me=Q(I=>{U++,we=j(we,I),ce&&!A&&($.fire(we),we=void 0),L=()=>{let ae=we;we=void 0,A=void 0,(!ce||U>1)&&$.fire(ae),U=0},typeof ne=="number"?(clearTimeout(A),A=setTimeout(L,ne)):A===void 0&&(A=0,queueMicrotask(L))})},onWillRemoveListener(){O&&U>0&&L?.()},onDidRemoveLastListener(){L=void 0,me.dispose()}},$=new pe(z);return N?.add($),$.event}t.debounce=b;function E(Q,j=0,ne){return t.debounce(Q,(ce,O)=>ce?(ce.push(O),ce):[O],j,void 0,!0,void 0,ne)}t.accumulate=E;function R(Q,j=(ce,O)=>ce===O,ne){let ce=!0,O;return h(Q,Z=>{let N=ce||!j(Z,O);return ce=!1,O=Z,N},ne)}t.latch=R;function D(Q,j,ne){return[t.filter(Q,j,ne),t.filter(Q,ce=>!j(ce),ne)]}t.split=D;function k(Q,j=!1,ne=[],ce){let O=ne.slice(),Z=Q(we=>{O?O.push(we):me.fire(we)});ce&&ce.add(Z);let N=()=>{O?.forEach(we=>me.fire(we)),O=null},me=new pe({onWillAddFirstListener(){Z||(Z=Q(we=>me.fire(we)),ce&&ce.add(Z))},onDidAddFirstListener(){O&&(j?setTimeout(N):N())},onDidRemoveLastListener(){Z&&Z.dispose(),Z=null}});return ce&&ce.add(me),me.event}t.buffer=k;function V(Q,j){return(ne,ce,O)=>{let Z=j(new he);return Q(function(N){let me=Z.evaluate(N);me!==X&&ne.call(ce,me)},void 0,O)}}t.chain=V;let X=Symbol("HaltChainable");class he{constructor(){this.steps=[]}map(j){return this.steps.push(j),this}forEach(j){return this.steps.push(ne=>(j(ne),ne)),this}filter(j){return this.steps.push(ne=>j(ne)?ne:X),this}reduce(j,ne){let ce=ne;return this.steps.push(O=>(ce=j(ce,O),ce)),this}latch(j=(ne,ce)=>ne===ce){let ne=!0,ce;return this.steps.push(O=>{let Z=ne||!j(O,ce);return ne=!1,ce=O,Z?O:X}),this}evaluate(j){for(let ne of this.steps)if(j=ne(j),j===X)break;return j}}function te(Q,j,ne=ce=>ce){let ce=(...me)=>N.fire(ne(...me)),O=()=>Q.on(j,ce),Z=()=>Q.removeListener(j,ce),N=new pe({onWillAddFirstListener:O,onDidRemoveLastListener:Z});return N.event}t.fromNodeEventEmitter=te;function ue(Q,j,ne=ce=>ce){let ce=(...me)=>N.fire(ne(...me)),O=()=>Q.addEventListener(j,ce),Z=()=>Q.removeEventListener(j,ce),N=new pe({onWillAddFirstListener:O,onDidRemoveLastListener:Z});return N.event}t.fromDOMEventEmitter=ue;function de(Q){return new Promise(j=>n(Q)(j))}t.toPromise=de;function _e(Q){let j=new pe;return Q.then(ne=>{j.fire(ne)},()=>{j.fire(void 0)}).finally(()=>{j.dispose()}),j.event}t.fromPromise=_e;function q(Q,j){return Q(ne=>j.fire(ne))}t.forward=q;function ge(Q,j,ne){return j(ne),Q(ce=>j(ce))}t.runAndSubscribe=ge;class Y{constructor(j,ne){this._observable=j,this._counter=0,this._hasChanged=!1;let ce={onWillAddFirstListener:()=>{j.addObserver(this)},onDidRemoveLastListener:()=>{j.removeObserver(this)}};this.emitter=new pe(ce),ne&&ne.add(this.emitter)}beginUpdate(j){this._counter++}handlePossibleChange(j){}handleChange(j,ne){this._hasChanged=!0}endUpdate(j){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function re(Q,j){return new Y(Q,j).emitter.event}t.fromObservable=re;function ee(Q){return(j,ne,ce)=>{let O=0,Z=!1,N={beginUpdate(){O++},endUpdate(){O--,O===0&&(Q.reportChanges(),Z&&(Z=!1,j.call(ne)))},handlePossibleChange(){},handleChange(){Z=!0}};Q.addObserver(N),Q.reportChanges();let me={dispose(){Q.removeObserver(N)}};return ce instanceof $s?ce.add(me):Array.isArray(ce)&&ce.push(me),me}}t.fromObservableLight=ee})(jt||={});var zu=class Nu{constructor(i){this.listenerCount=0,this.invocationCount=0,this.elapsedOverall=0,this.durations=[],this.name=`${i}_${Nu._idPool++}`,Nu.all.add(this)}start(i){this._stopWatch=new s1,this.listenerCount=i}stop(){if(this._stopWatch){let i=this._stopWatch.elapsed();this.durations.push(i),this.elapsedOverall+=i,this.invocationCount+=1,this._stopWatch=void 0}}};zu.all=new Set,zu._idPool=0;var r1=zu,n1=-1,Zv=class Qv{constructor(i,n,a=(Qv._idPool++).toString(16).padStart(3,"0")){this._errorHandler=i,this.threshold=n,this.name=a,this._warnCountdown=0}dispose(){this._stacks?.clear()}check(i,n){let a=this.threshold;if(a<=0||n<a)return;this._stacks||(this._stacks=new Map);let c=this._stacks.get(i.value)||0;if(this._stacks.set(i.value,c+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=a*.5;let[h,d]=this.getMostFrequentStack(),p=`[${this.name}] potential listener LEAK detected, having ${n} listeners already. MOST frequent listener (${d}):`;console.warn(p),console.warn(h);let m=new o1(p,h);this._errorHandler(m)}return()=>{let h=this._stacks.get(i.value)||0;this._stacks.set(i.value,h-1)}}getMostFrequentStack(){if(!this._stacks)return;let i,n=0;for(let[a,c]of this._stacks)(!i||n<c)&&(i=[a,c],n=c);return i}};Zv._idPool=1;var l1=Zv,a1=class Jv{constructor(i){this.value=i}static create(){let i=new Error;return new Jv(i.stack??"")}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}},o1=class extends Error{constructor(t,i){super(t),this.name="ListenerLeakError",this.stack=i}},c1=class extends Error{constructor(t,i){super(t),this.name="ListenerRefusalError",this.stack=i}},h1=0,nu=class{constructor(t){this.value=t,this.id=h1++}},u1=2,d1,pe=class{constructor(t){this._size=0,this._options=t,this._leakageMon=this._options?.leakWarningThreshold?new l1(t?.onListenerError??po,this._options?.leakWarningThreshold??n1):void 0,this._perfMon=this._options?._profName?new r1(this._options._profName):void 0,this._deliveryQueue=this._options?.deliveryQueue}dispose(){this._disposed||(this._disposed=!0,this._deliveryQueue?.current===this&&this._deliveryQueue.reset(),this._listeners&&(this._listeners=void 0,this._size=0),this._options?.onDidRemoveLastListener?.(),this._leakageMon?.dispose())}get event(){return this._event??=(t,i,n)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){let d=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(d);let p=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],m=new c1(`${d}. HINT: Stack shows most frequent listener (${p[1]}-times)`,p[0]);return(this._options?.onListenerError||po)(m),He.None}if(this._disposed)return He.None;i&&(t=t.bind(i));let a=new nu(t),c;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(a.stack=a1.create(),c=this._leakageMon.check(a.stack,this._size+1)),this._listeners?this._listeners instanceof nu?(this._deliveryQueue??=new f1,this._listeners=[this._listeners,a]):this._listeners.push(a):(this._options?.onWillAddFirstListener?.(this),this._listeners=a,this._options?.onDidAddFirstListener?.(this)),this._size++;let h=nt(()=>{c?.(),this._removeListener(a)});return n instanceof $s?n.add(h):Array.isArray(n)&&n.push(h),h},this._event}_removeListener(t){if(this._options?.onWillRemoveListener?.(this),!this._listeners)return;if(this._size===1){this._listeners=void 0,this._options?.onDidRemoveLastListener?.(this),this._size=0;return}let i=this._listeners,n=i.indexOf(t);if(n===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,i[n]=void 0;let a=this._deliveryQueue.current===this;if(this._size*u1<=i.length){let c=0;for(let h=0;h<i.length;h++)i[h]?i[c++]=i[h]:a&&(this._deliveryQueue.end--,c<this._deliveryQueue.i&&this._deliveryQueue.i--);i.length=c}}_deliver(t,i){if(!t)return;let n=this._options?.onListenerError||po;if(!n){t.value(i);return}try{t.value(i)}catch(a){n(a)}}_deliverQueue(t){let i=t.current._listeners;for(;t.i<t.end;)this._deliver(i[t.i++],t.value);t.reset()}fire(t){if(this._deliveryQueue?.current&&(this._deliverQueue(this._deliveryQueue),this._perfMon?.stop()),this._perfMon?.start(this._size),this._listeners)if(this._listeners instanceof nu)this._deliver(this._listeners,t);else{let i=this._deliveryQueue;i.enqueue(this,t,this._listeners.length),this._deliverQueue(i)}this._perfMon?.stop()}hasListeners(){return this._size>0}},f1=class{constructor(){this.i=-1,this.end=0}enqueue(t,i,n){this.i=0,this.end=n,this.current=t,this.value=i}reset(){this.i=this.end,this.current=void 0,this.value=void 0}},Hu=class{constructor(){this.mapWindowIdToZoomLevel=new Map,this._onDidChangeZoomLevel=new pe,this.onDidChangeZoomLevel=this._onDidChangeZoomLevel.event,this.mapWindowIdToZoomFactor=new Map,this._onDidChangeFullscreen=new pe,this.onDidChangeFullscreen=this._onDidChangeFullscreen.event,this.mapWindowIdToFullScreen=new Map}getZoomLevel(i){return this.mapWindowIdToZoomLevel.get(this.getWindowId(i))??0}setZoomLevel(i,n){if(this.getZoomLevel(n)===i)return;let a=this.getWindowId(n);this.mapWindowIdToZoomLevel.set(a,i),this._onDidChangeZoomLevel.fire(a)}getZoomFactor(i){return this.mapWindowIdToZoomFactor.get(this.getWindowId(i))??1}setZoomFactor(i,n){this.mapWindowIdToZoomFactor.set(this.getWindowId(n),i)}setFullscreen(i,n){if(this.isFullscreen(n)===i)return;let a=this.getWindowId(n);this.mapWindowIdToFullScreen.set(a,i),this._onDidChangeFullscreen.fire(a)}isFullscreen(i){return!!this.mapWindowIdToFullScreen.get(this.getWindowId(i))}getWindowId(i){return i.vscodeWindowId}};Hu.INSTANCE=new Hu;var Cd=Hu;function _1(t,i,n){typeof i=="string"&&(i=t.matchMedia(i)),i.addEventListener("change",n)}Cd.INSTANCE.onDidChangeZoomLevel;function g1(t){return Cd.INSTANCE.getZoomFactor(t)}Cd.INSTANCE.onDidChangeFullscreen;var bn=typeof navigator=="object"?navigator.userAgent:"",Uu=bn.indexOf("Firefox")>=0,p1=bn.indexOf("AppleWebKit")>=0,wd=bn.indexOf("Chrome")>=0,m1=!wd&&bn.indexOf("Safari")>=0;bn.indexOf("Electron/")>=0;bn.indexOf("Android")>=0;var lu=!1;if(typeof ps.matchMedia=="function"){let t=ps.matchMedia("(display-mode: standalone) or (display-mode: window-controls-overlay)"),i=ps.matchMedia("(display-mode: fullscreen)");lu=t.matches,_1(ps,t,({matches:n})=>{lu&&i.matches||(lu=n)})}var pn="en",Iu=!1,ju=!1,mo=!1,e0=!1,ro,vo=pn,Jp=pn,v1,_s,Cr=globalThis,pi;typeof Cr.vscode<"u"&&typeof Cr.vscode.process<"u"?pi=Cr.vscode.process:typeof process<"u"&&typeof process?.versions?.node=="string"&&(pi=process);var y1=typeof pi?.versions?.electron=="string",S1=y1&&pi?.type==="renderer";if(typeof pi=="object"){Iu=pi.platform==="win32",ju=pi.platform==="darwin",mo=pi.platform==="linux",mo&&pi.env.SNAP&&pi.env.SNAP_REVISION,pi.env.CI||pi.env.BUILD_ARTIFACTSTAGINGDIRECTORY,ro=pn,vo=pn;let t=pi.env.VSCODE_NLS_CONFIG;if(t)try{let i=JSON.parse(t);ro=i.userLocale,Jp=i.osLocale,vo=i.resolvedLanguage||pn,v1=i.languagePack?.translationsConfigFile}catch{}e0=!0}else typeof navigator=="object"&&!S1?(_s=navigator.userAgent,Iu=_s.indexOf("Windows")>=0,ju=_s.indexOf("Macintosh")>=0,(_s.indexOf("Macintosh")>=0||_s.indexOf("iPad")>=0||_s.indexOf("iPhone")>=0)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0,mo=_s.indexOf("Linux")>=0,_s?.indexOf("Mobi")>=0,vo=globalThis._VSCODE_NLS_LANGUAGE||pn,ro=navigator.language.toLowerCase(),Jp=ro):console.error("Unable to resolve platform.");var t0=Iu,Yi=ju,b1=mo,em=e0,qi=_s,Ys=vo,C1;(t=>{function i(){return Ys}t.value=i;function n(){return Ys.length===2?Ys==="en":Ys.length>=3?Ys[0]==="e"&&Ys[1]==="n"&&Ys[2]==="-":!1}t.isDefaultVariant=n;function a(){return Ys==="en"}t.isDefault=a})(C1||={});var w1=typeof Cr.postMessage=="function"&&!Cr.importScripts;(()=>{if(w1){let t=[];Cr.addEventListener("message",n=>{if(n.data&&n.data.vscodeScheduleAsyncWork)for(let a=0,c=t.length;a<c;a++){let h=t[a];if(h.id===n.data.vscodeScheduleAsyncWork){t.splice(a,1),h.callback();return}}});let i=0;return n=>{let a=++i;t.push({id:a,callback:n}),Cr.postMessage({vscodeScheduleAsyncWork:a},"*")}}return t=>setTimeout(t)})();var x1=!!(qi&&qi.indexOf("Chrome")>=0);qi&&qi.indexOf("Firefox")>=0;!x1&&qi&&qi.indexOf("Safari")>=0;qi&&qi.indexOf("Edg/")>=0;qi&&qi.indexOf("Android")>=0;var fn=typeof navigator=="object"?navigator:{};em||document.queryCommandSupported&&document.queryCommandSupported("copy")||fn&&fn.clipboard&&fn.clipboard.writeText,em||fn&&fn.clipboard&&fn.clipboard.readText;var xd=class{constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(t,i){this._keyCodeToStr[t]=i,this._strToKeyCode[i.toLowerCase()]=t}keyCodeToStr(t){return this._keyCodeToStr[t]}strToKeyCode(t){return this._strToKeyCode[t.toLowerCase()]||0}},au=new xd,tm=new xd,im=new xd,E1=new Array(230),i0;(t=>{function i(p){return au.keyCodeToStr(p)}t.toString=i;function n(p){return au.strToKeyCode(p)}t.fromString=n;function a(p){return tm.keyCodeToStr(p)}t.toUserSettingsUS=a;function c(p){return im.keyCodeToStr(p)}t.toUserSettingsGeneral=c;function h(p){return tm.strToKeyCode(p)||im.strToKeyCode(p)}t.fromUserSettings=h;function d(p){if(p>=98&&p<=113)return null;switch(p){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return au.keyCodeToStr(p)}t.toElectronAccelerator=d})(i0||={});var T1=class s0{constructor(i,n,a,c,h){this.ctrlKey=i,this.shiftKey=n,this.altKey=a,this.metaKey=c,this.keyCode=h}equals(i){return i instanceof s0&&this.ctrlKey===i.ctrlKey&&this.shiftKey===i.shiftKey&&this.altKey===i.altKey&&this.metaKey===i.metaKey&&this.keyCode===i.keyCode}getHashCode(){let i=this.ctrlKey?"1":"0",n=this.shiftKey?"1":"0",a=this.altKey?"1":"0",c=this.metaKey?"1":"0";return`K${i}${n}${a}${c}${this.keyCode}`}isModifierKey(){return this.keyCode===0||this.keyCode===5||this.keyCode===57||this.keyCode===6||this.keyCode===4}toKeybinding(){return new A1([this])}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===5||this.shiftKey&&this.keyCode===4||this.altKey&&this.keyCode===6||this.metaKey&&this.keyCode===57}},A1=class{constructor(t){if(t.length===0)throw Qb("chords");this.chords=t}getHashCode(){let t="";for(let i=0,n=this.chords.length;i<n;i++)i!==0&&(t+=";"),t+=this.chords[i].getHashCode();return t}equals(t){if(t===null||this.chords.length!==t.chords.length)return!1;for(let i=0;i<this.chords.length;i++)if(!this.chords[i].equals(t.chords[i]))return!1;return!0}};function R1(t){if(t.charCode){let n=String.fromCharCode(t.charCode).toUpperCase();return i0.fromString(n)}let i=t.keyCode;if(i===3)return 7;if(Uu)switch(i){case 59:return 85;case 60:if(b1)return 97;break;case 61:return 86;case 107:return 109;case 109:return 111;case 173:return 88;case 224:if(Yi)return 57;break}else if(p1&&(Yi&&i===93||!Yi&&i===92))return 57;return E1[i]||0}var D1=Yi?256:2048,k1=512,M1=1024,L1=Yi?2048:256,sm=class{constructor(t){this._standardKeyboardEventBrand=!0;let i=t;this.browserEvent=i,this.target=i.target,this.ctrlKey=i.ctrlKey,this.shiftKey=i.shiftKey,this.altKey=i.altKey,this.metaKey=i.metaKey,this.altGraphKey=i.getModifierState?.("AltGraph"),this.keyCode=R1(i),this.code=i.code,this.ctrlKey=this.ctrlKey||this.keyCode===5,this.altKey=this.altKey||this.keyCode===6,this.shiftKey=this.shiftKey||this.keyCode===4,this.metaKey=this.metaKey||this.keyCode===57,this._asKeybinding=this._computeKeybinding(),this._asKeyCodeChord=this._computeKeyCodeChord()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeyCodeChord(){return this._asKeyCodeChord}equals(t){return this._asKeybinding===t}_computeKeybinding(){let t=0;this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(t=this.keyCode);let i=0;return this.ctrlKey&&(i|=D1),this.altKey&&(i|=k1),this.shiftKey&&(i|=M1),this.metaKey&&(i|=L1),i|=t,i}_computeKeyCodeChord(){let t=0;return this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(t=this.keyCode),new T1(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,t)}},rm=new WeakMap;function B1(t){if(!t.parent||t.parent===t)return null;try{let i=t.location,n=t.parent.location;if(i.origin!=="null"&&n.origin!=="null"&&i.origin!==n.origin)return null}catch{return null}return t.parent}var O1=class{static getSameOriginWindowChain(t){let i=rm.get(t);if(!i){i=[],rm.set(t,i);let n=t,a;do a=B1(n),a?i.push({window:new WeakRef(n),iframeElement:n.frameElement||null}):i.push({window:new WeakRef(n),iframeElement:null}),n=a;while(n)}return i.slice(0)}static getPositionOfChildWindowRelativeToAncestorWindow(t,i){if(!i||t===i)return{top:0,left:0};let n=0,a=0,c=this.getSameOriginWindowChain(t);for(let h of c){let d=h.window.deref();if(n+=d?.scrollY??0,a+=d?.scrollX??0,d===i||!h.iframeElement)break;let p=h.iframeElement.getBoundingClientRect();n+=p.top,a+=p.left}return{top:n,left:a}}},no=class{constructor(t,i){this.timestamp=Date.now(),this.browserEvent=i,this.leftButton=i.button===0,this.middleButton=i.button===1,this.rightButton=i.button===2,this.buttons=i.buttons,this.target=i.target,this.detail=i.detail||1,i.type==="dblclick"&&(this.detail=2),this.ctrlKey=i.ctrlKey,this.shiftKey=i.shiftKey,this.altKey=i.altKey,this.metaKey=i.metaKey,typeof i.pageX=="number"?(this.posx=i.pageX,this.posy=i.pageY):(this.posx=i.clientX+this.target.ownerDocument.body.scrollLeft+this.target.ownerDocument.documentElement.scrollLeft,this.posy=i.clientY+this.target.ownerDocument.body.scrollTop+this.target.ownerDocument.documentElement.scrollTop);let n=O1.getPositionOfChildWindowRelativeToAncestorWindow(t,i.view);this.posx-=n.left,this.posy-=n.top}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}},nm=class{constructor(t,i=0,n=0){this.browserEvent=t||null,this.target=t?t.target||t.targetNode||t.srcElement:null,this.deltaY=n,this.deltaX=i;let a=!1;if(wd){let c=navigator.userAgent.match(/Chrome\/(\d+)/);a=(c?parseInt(c[1]):123)<=122}if(t){let c=t,h=t,d=t.view?.devicePixelRatio||1;if(typeof c.wheelDeltaY<"u")a?this.deltaY=c.wheelDeltaY/(120*d):this.deltaY=c.wheelDeltaY/120;else if(typeof h.VERTICAL_AXIS<"u"&&h.axis===h.VERTICAL_AXIS)this.deltaY=-h.detail/3;else if(t.type==="wheel"){let p=t;p.deltaMode===p.DOM_DELTA_LINE?Uu&&!Yi?this.deltaY=-t.deltaY/3:this.deltaY=-t.deltaY:this.deltaY=-t.deltaY/40}if(typeof c.wheelDeltaX<"u")m1&&t0?this.deltaX=-(c.wheelDeltaX/120):a?this.deltaX=c.wheelDeltaX/(120*d):this.deltaX=c.wheelDeltaX/120;else if(typeof h.HORIZONTAL_AXIS<"u"&&h.axis===h.HORIZONTAL_AXIS)this.deltaX=-t.detail/3;else if(t.type==="wheel"){let p=t;p.deltaMode===p.DOM_DELTA_LINE?Uu&&!Yi?this.deltaX=-t.deltaX/3:this.deltaX=-t.deltaX:this.deltaX=-t.deltaX/40}this.deltaY===0&&this.deltaX===0&&t.wheelDelta&&(a?this.deltaY=t.wheelDelta/(120*d):this.deltaY=t.wheelDelta/120)}}preventDefault(){this.browserEvent?.preventDefault()}stopPropagation(){this.browserEvent?.stopPropagation()}},r0=Object.freeze(function(t,i){let n=setTimeout(t.bind(i),0);return{dispose(){clearTimeout(n)}}}),z1;(t=>{function i(n){return n===t.None||n===t.Cancelled||n instanceof N1?!0:!n||typeof n!="object"?!1:typeof n.isCancellationRequested=="boolean"&&typeof n.onCancellationRequested=="function"}t.isCancellationToken=i,t.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:jt.None}),t.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:r0})})(z1||={});var N1=class{constructor(){this._isCancelled=!1,this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?r0:(this._emitter||(this._emitter=new pe),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}},Ed=class{constructor(t,i){this._isDisposed=!1,this._token=-1,typeof t=="function"&&typeof i=="number"&&this.setIfNotSet(t,i)}dispose(){this.cancel(),this._isDisposed=!0}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(t,i){if(this._isDisposed)throw new Lu("Calling 'cancelAndSet' on a disposed TimeoutTimer");this.cancel(),this._token=setTimeout(()=>{this._token=-1,t()},i)}setIfNotSet(t,i){if(this._isDisposed)throw new Lu("Calling 'setIfNotSet' on a disposed TimeoutTimer");this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,t()},i))}},H1=class{constructor(){this.disposable=void 0,this.isDisposed=!1}cancel(){this.disposable?.dispose(),this.disposable=void 0}cancelAndSet(t,i,n=globalThis){if(this.isDisposed)throw new Lu("Calling 'cancelAndSet' on a disposed IntervalTimer");this.cancel();let a=n.setInterval(()=>{t()},i);this.disposable=nt(()=>{n.clearInterval(a),this.disposable=void 0})}dispose(){this.cancel(),this.isDisposed=!0}},U1;(t=>{async function i(a){let c,h=await Promise.all(a.map(d=>d.then(p=>p,p=>{c||(c=p)})));if(typeof c<"u")throw c;return h}t.settled=i;function n(a){return new Promise(async(c,h)=>{try{await a(c,h)}catch(d){h(d)}})}t.withAsyncBody=n})(U1||={});var lm=class Ri{static fromArray(i){return new Ri(n=>{n.emitMany(i)})}static fromPromise(i){return new Ri(async n=>{n.emitMany(await i)})}static fromPromises(i){return new Ri(async n=>{await Promise.all(i.map(async a=>n.emitOne(await a)))})}static merge(i){return new Ri(async n=>{await Promise.all(i.map(async a=>{for await(let c of a)n.emitOne(c)}))})}constructor(i,n){this._state=0,this._results=[],this._error=null,this._onReturn=n,this._onStateChanged=new pe,queueMicrotask(async()=>{let a={emitOne:c=>this.emitOne(c),emitMany:c=>this.emitMany(c),reject:c=>this.reject(c)};try{await Promise.resolve(i(a)),this.resolve()}catch(c){this.reject(c)}finally{a.emitOne=void 0,a.emitMany=void 0,a.reject=void 0}})}[Symbol.asyncIterator](){let i=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(i<this._results.length)return{done:!1,value:this._results[i++]};if(this._state===1)return{done:!0,value:void 0};await jt.toPromise(this._onStateChanged.event)}while(!0)},return:async()=>(this._onReturn?.(),{done:!0,value:void 0})}}static map(i,n){return new Ri(async a=>{for await(let c of i)a.emitOne(n(c))})}map(i){return Ri.map(this,i)}static filter(i,n){return new Ri(async a=>{for await(let c of i)n(c)&&a.emitOne(c)})}filter(i){return Ri.filter(this,i)}static coalesce(i){return Ri.filter(i,n=>!!n)}coalesce(){return Ri.coalesce(this)}static async toPromise(i){let n=[];for await(let a of i)n.push(a);return n}toPromise(){return Ri.toPromise(this)}emitOne(i){this._state===0&&(this._results.push(i),this._onStateChanged.fire())}emitMany(i){this._state===0&&(this._results=this._results.concat(i),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(i){this._state===0&&(this._state=2,this._error=i,this._onStateChanged.fire())}};lm.EMPTY=lm.fromArray([]);var{getWindow:Pi,getWindowId:I1,onDidRegisterWindow:j1}=(function(){let t=new Map,i={window:ps,disposables:new $s};t.set(ps.vscodeWindowId,i);let n=new pe,a=new pe,c=new pe;function h(d,p){return(typeof d=="number"?t.get(d):void 0)??(p?i:void 0)}return{onDidRegisterWindow:n.event,onWillUnregisterWindow:c.event,onDidUnregisterWindow:a.event,registerWindow(d){if(t.has(d.vscodeWindowId))return He.None;let p=new $s,m={window:d,disposables:p.add(new $s)};return t.set(d.vscodeWindowId,m),p.add(nt(()=>{t.delete(d.vscodeWindowId),a.fire(d)})),p.add(Me(d,kt.BEFORE_UNLOAD,()=>{c.fire(d)})),n.fire(m),p},getWindows(){return t.values()},getWindowsCount(){return t.size},getWindowId(d){return d.vscodeWindowId},hasWindow(d){return t.has(d)},getWindowById:h,getWindow(d){let p=d;if(p?.ownerDocument?.defaultView)return p.ownerDocument.defaultView.window;let m=d;return m?.view?m.view.window:ps},getDocument(d){return Pi(d).document}}})(),W1=class{constructor(t,i,n,a){this._node=t,this._type=i,this._handler=n,this._options=a||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}};function Me(t,i,n,a){return new W1(t,i,n,a)}var am=function(t,i,n,a){return Me(t,i,n,a)},Td,F1=class extends H1{constructor(t){super(),this.defaultTarget=t&&Pi(t)}cancelAndSet(t,i,n){return super.cancelAndSet(t,i,n??this.defaultTarget)}},om=class{constructor(t,i=0){this._runner=t,this.priority=i,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(t){po(t)}}static sort(t,i){return i.priority-t.priority}};(function(){let t=new Map,i=new Map,n=new Map,a=new Map,c=h=>{n.set(h,!1);let d=t.get(h)??[];for(i.set(h,d),t.set(h,[]),a.set(h,!0);d.length>0;)d.sort(om.sort),d.shift().execute();a.set(h,!1)};Td=(h,d,p=0)=>{let m=I1(h),_=new om(d,p),y=t.get(m);return y||(y=[],t.set(m,y)),y.push(_),n.get(m)||(n.set(m,!0),h.requestAnimationFrame(()=>c(m))),_}})();function P1(t){let i=t.getBoundingClientRect(),n=Pi(t);return{left:i.left+n.scrollX,top:i.top+n.scrollY,width:i.width,height:i.height}}var kt={CLICK:"click",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",KEY_DOWN:"keydown",KEY_UP:"keyup",BEFORE_UNLOAD:"beforeunload",CHANGE:"change",FOCUS:"focus",BLUR:"blur",INPUT:"input"},Y1=class{constructor(t){this.domNode=t,this._maxWidth="",this._width="",this._height="",this._top="",this._left="",this._bottom="",this._right="",this._paddingTop="",this._paddingLeft="",this._paddingBottom="",this._paddingRight="",this._fontFamily="",this._fontWeight="",this._fontSize="",this._fontStyle="",this._fontFeatureSettings="",this._fontVariationSettings="",this._textDecoration="",this._lineHeight="",this._letterSpacing="",this._className="",this._display="",this._position="",this._visibility="",this._color="",this._backgroundColor="",this._layerHint=!1,this._contain="none",this._boxShadow=""}setMaxWidth(t){let i=ti(t);this._maxWidth!==i&&(this._maxWidth=i,this.domNode.style.maxWidth=this._maxWidth)}setWidth(t){let i=ti(t);this._width!==i&&(this._width=i,this.domNode.style.width=this._width)}setHeight(t){let i=ti(t);this._height!==i&&(this._height=i,this.domNode.style.height=this._height)}setTop(t){let i=ti(t);this._top!==i&&(this._top=i,this.domNode.style.top=this._top)}setLeft(t){let i=ti(t);this._left!==i&&(this._left=i,this.domNode.style.left=this._left)}setBottom(t){let i=ti(t);this._bottom!==i&&(this._bottom=i,this.domNode.style.bottom=this._bottom)}setRight(t){let i=ti(t);this._right!==i&&(this._right=i,this.domNode.style.right=this._right)}setPaddingTop(t){let i=ti(t);this._paddingTop!==i&&(this._paddingTop=i,this.domNode.style.paddingTop=this._paddingTop)}setPaddingLeft(t){let i=ti(t);this._paddingLeft!==i&&(this._paddingLeft=i,this.domNode.style.paddingLeft=this._paddingLeft)}setPaddingBottom(t){let i=ti(t);this._paddingBottom!==i&&(this._paddingBottom=i,this.domNode.style.paddingBottom=this._paddingBottom)}setPaddingRight(t){let i=ti(t);this._paddingRight!==i&&(this._paddingRight=i,this.domNode.style.paddingRight=this._paddingRight)}setFontFamily(t){this._fontFamily!==t&&(this._fontFamily=t,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(t){this._fontWeight!==t&&(this._fontWeight=t,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(t){let i=ti(t);this._fontSize!==i&&(this._fontSize=i,this.domNode.style.fontSize=this._fontSize)}setFontStyle(t){this._fontStyle!==t&&(this._fontStyle=t,this.domNode.style.fontStyle=this._fontStyle)}setFontFeatureSettings(t){this._fontFeatureSettings!==t&&(this._fontFeatureSettings=t,this.domNode.style.fontFeatureSettings=this._fontFeatureSettings)}setFontVariationSettings(t){this._fontVariationSettings!==t&&(this._fontVariationSettings=t,this.domNode.style.fontVariationSettings=this._fontVariationSettings)}setTextDecoration(t){this._textDecoration!==t&&(this._textDecoration=t,this.domNode.style.textDecoration=this._textDecoration)}setLineHeight(t){let i=ti(t);this._lineHeight!==i&&(this._lineHeight=i,this.domNode.style.lineHeight=this._lineHeight)}setLetterSpacing(t){let i=ti(t);this._letterSpacing!==i&&(this._letterSpacing=i,this.domNode.style.letterSpacing=this._letterSpacing)}setClassName(t){this._className!==t&&(this._className=t,this.domNode.className=this._className)}toggleClassName(t,i){this.domNode.classList.toggle(t,i),this._className=this.domNode.className}setDisplay(t){this._display!==t&&(this._display=t,this.domNode.style.display=this._display)}setPosition(t){this._position!==t&&(this._position=t,this.domNode.style.position=this._position)}setVisibility(t){this._visibility!==t&&(this._visibility=t,this.domNode.style.visibility=this._visibility)}setColor(t){this._color!==t&&(this._color=t,this.domNode.style.color=this._color)}setBackgroundColor(t){this._backgroundColor!==t&&(this._backgroundColor=t,this.domNode.style.backgroundColor=this._backgroundColor)}setLayerHinting(t){this._layerHint!==t&&(this._layerHint=t,this.domNode.style.transform=this._layerHint?"translate3d(0px, 0px, 0px)":"")}setBoxShadow(t){this._boxShadow!==t&&(this._boxShadow=t,this.domNode.style.boxShadow=t)}setContain(t){this._contain!==t&&(this._contain=t,this.domNode.style.contain=this._contain)}setAttribute(t,i){this.domNode.setAttribute(t,i)}removeAttribute(t){this.domNode.removeAttribute(t)}appendChild(t){this.domNode.appendChild(t.domNode)}removeChild(t){this.domNode.removeChild(t.domNode)}};function ti(t){return typeof t=="number"?`${t}px`:t}function Ll(t){return new Y1(t)}var n0=class{constructor(){this._hooks=new $s,this._pointerMoveCallback=null,this._onStopCallback=null}dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(t,i){if(!this.isMonitoring())return;this._hooks.clear(),this._pointerMoveCallback=null;let n=this._onStopCallback;this._onStopCallback=null,t&&n&&n(i)}isMonitoring(){return!!this._pointerMoveCallback}startMonitoring(t,i,n,a,c){this.isMonitoring()&&this.stopMonitoring(!1),this._pointerMoveCallback=a,this._onStopCallback=c;let h=t;try{t.setPointerCapture(i),this._hooks.add(nt(()=>{try{t.releasePointerCapture(i)}catch{}}))}catch{h=Pi(t)}this._hooks.add(Me(h,kt.POINTER_MOVE,d=>{if(d.buttons!==n){this.stopMonitoring(!0);return}d.preventDefault(),this._pointerMoveCallback(d)})),this._hooks.add(Me(h,kt.POINTER_UP,d=>this.stopMonitoring(!0)))}};function q1(t,i,n){let a=null,c=null;if(typeof n.value=="function"?(a="value",c=n.value,c.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof n.get=="function"&&(a="get",c=n.get),!c)throw new Error("not supported");let h=`$memoize$${i}`;n[a]=function(...d){return this.hasOwnProperty(h)||Object.defineProperty(this,h,{configurable:!1,enumerable:!1,writable:!1,value:c.apply(this,d)}),this[h]}}var Wi;(t=>(t.Tap="-xterm-gesturetap",t.Change="-xterm-gesturechange",t.Start="-xterm-gesturestart",t.End="-xterm-gesturesend",t.Contextmenu="-xterm-gesturecontextmenu"))(Wi||={});var Al=class Pt extends He{constructor(){super(),this.dispatched=!1,this.targets=new Qp,this.ignoreTargets=new Qp,this.activeTouches={},this.handle=null,this._lastSetTapCountTime=0,this._register(jt.runAndSubscribe(j1,({window:i,disposables:n})=>{n.add(Me(i.document,"touchstart",a=>this.onTouchStart(a),{passive:!1})),n.add(Me(i.document,"touchend",a=>this.onTouchEnd(i,a))),n.add(Me(i.document,"touchmove",a=>this.onTouchMove(a),{passive:!1}))},{window:ps,disposables:this._store}))}static addTarget(i){if(!Pt.isTouchDevice())return He.None;Pt.INSTANCE||(Pt.INSTANCE=new Pt);let n=Pt.INSTANCE.targets.push(i);return nt(n)}static ignoreTarget(i){if(!Pt.isTouchDevice())return He.None;Pt.INSTANCE||(Pt.INSTANCE=new Pt);let n=Pt.INSTANCE.ignoreTargets.push(i);return nt(n)}static isTouchDevice(){return"ontouchstart"in ps||navigator.maxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(i){let n=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let a=0,c=i.targetTouches.length;a<c;a++){let h=i.targetTouches.item(a);this.activeTouches[h.identifier]={id:h.identifier,initialTarget:h.target,initialTimeStamp:n,initialPageX:h.pageX,initialPageY:h.pageY,rollingTimestamps:[n],rollingPageX:[h.pageX],rollingPageY:[h.pageY]};let d=this.newGestureEvent(Wi.Start,h.target);d.pageX=h.pageX,d.pageY=h.pageY,this.dispatchEvent(d)}this.dispatched&&(i.preventDefault(),i.stopPropagation(),this.dispatched=!1)}onTouchEnd(i,n){let a=Date.now(),c=Object.keys(this.activeTouches).length;for(let h=0,d=n.changedTouches.length;h<d;h++){let p=n.changedTouches.item(h);if(!this.activeTouches.hasOwnProperty(String(p.identifier))){console.warn("move of an UNKNOWN touch",p);continue}let m=this.activeTouches[p.identifier],_=Date.now()-m.initialTimeStamp;if(_<Pt.HOLD_DELAY&&Math.abs(m.initialPageX-_i(m.rollingPageX))<30&&Math.abs(m.initialPageY-_i(m.rollingPageY))<30){let y=this.newGestureEvent(Wi.Tap,m.initialTarget);y.pageX=_i(m.rollingPageX),y.pageY=_i(m.rollingPageY),this.dispatchEvent(y)}else if(_>=Pt.HOLD_DELAY&&Math.abs(m.initialPageX-_i(m.rollingPageX))<30&&Math.abs(m.initialPageY-_i(m.rollingPageY))<30){let y=this.newGestureEvent(Wi.Contextmenu,m.initialTarget);y.pageX=_i(m.rollingPageX),y.pageY=_i(m.rollingPageY),this.dispatchEvent(y)}else if(c===1){let y=_i(m.rollingPageX),b=_i(m.rollingPageY),E=_i(m.rollingTimestamps)-m.rollingTimestamps[0],R=y-m.rollingPageX[0],D=b-m.rollingPageY[0],k=[...this.targets].filter(V=>m.initialTarget instanceof Node&&V.contains(m.initialTarget));this.inertia(i,k,a,Math.abs(R)/E,R>0?1:-1,y,Math.abs(D)/E,D>0?1:-1,b)}this.dispatchEvent(this.newGestureEvent(Wi.End,m.initialTarget)),delete this.activeTouches[p.identifier]}this.dispatched&&(n.preventDefault(),n.stopPropagation(),this.dispatched=!1)}newGestureEvent(i,n){let a=document.createEvent("CustomEvent");return a.initEvent(i,!1,!0),a.initialTarget=n,a.tapCount=0,a}dispatchEvent(i){if(i.type===Wi.Tap){let n=new Date().getTime(),a=0;n-this._lastSetTapCountTime>Pt.CLEAR_TAP_COUNT_TIME?a=1:a=2,this._lastSetTapCountTime=n,i.tapCount=a}else(i.type===Wi.Change||i.type===Wi.Contextmenu)&&(this._lastSetTapCountTime=0);if(i.initialTarget instanceof Node){for(let a of this.ignoreTargets)if(a.contains(i.initialTarget))return;let n=[];for(let a of this.targets)if(a.contains(i.initialTarget)){let c=0,h=i.initialTarget;for(;h&&h!==a;)c++,h=h.parentElement;n.push([c,a])}n.sort((a,c)=>a[0]-c[0]);for(let[a,c]of n)c.dispatchEvent(i),this.dispatched=!0}}inertia(i,n,a,c,h,d,p,m,_){this.handle=Td(i,()=>{let y=Date.now(),b=y-a,E=0,R=0,D=!0;c+=Pt.SCROLL_FRICTION*b,p+=Pt.SCROLL_FRICTION*b,c>0&&(D=!1,E=h*c*b),p>0&&(D=!1,R=m*p*b);let k=this.newGestureEvent(Wi.Change);k.translationX=E,k.translationY=R,n.forEach(V=>V.dispatchEvent(k)),D||this.inertia(i,n,y,c,h,d+E,p,m,_+R)})}onTouchMove(i){let n=Date.now();for(let a=0,c=i.changedTouches.length;a<c;a++){let h=i.changedTouches.item(a);if(!this.activeTouches.hasOwnProperty(String(h.identifier))){console.warn("end of an UNKNOWN touch",h);continue}let d=this.activeTouches[h.identifier],p=this.newGestureEvent(Wi.Change,d.initialTarget);p.translationX=h.pageX-_i(d.rollingPageX),p.translationY=h.pageY-_i(d.rollingPageY),p.pageX=h.pageX,p.pageY=h.pageY,this.dispatchEvent(p),d.rollingPageX.length>3&&(d.rollingPageX.shift(),d.rollingPageY.shift(),d.rollingTimestamps.shift()),d.rollingPageX.push(h.pageX),d.rollingPageY.push(h.pageY),d.rollingTimestamps.push(n)}this.dispatched&&(i.preventDefault(),i.stopPropagation(),this.dispatched=!1)}};Al.SCROLL_FRICTION=-.005,Al.HOLD_DELAY=700,Al.CLEAR_TAP_COUNT_TIME=400,ft([q1],Al,"isTouchDevice",1);var K1=Al,Ad=class extends He{onclick(t,i){this._register(Me(t,kt.CLICK,n=>i(new no(Pi(t),n))))}onmousedown(t,i){this._register(Me(t,kt.MOUSE_DOWN,n=>i(new no(Pi(t),n))))}onmouseover(t,i){this._register(Me(t,kt.MOUSE_OVER,n=>i(new no(Pi(t),n))))}onmouseleave(t,i){this._register(Me(t,kt.MOUSE_LEAVE,n=>i(new no(Pi(t),n))))}onkeydown(t,i){this._register(Me(t,kt.KEY_DOWN,n=>i(new sm(n))))}onkeyup(t,i){this._register(Me(t,kt.KEY_UP,n=>i(new sm(n))))}oninput(t,i){this._register(Me(t,kt.INPUT,i))}onblur(t,i){this._register(Me(t,kt.BLUR,i))}onfocus(t,i){this._register(Me(t,kt.FOCUS,i))}onchange(t,i){this._register(Me(t,kt.CHANGE,i))}ignoreGesture(t){return K1.ignoreTarget(t)}},cm=11,G1=class extends Ad{constructor(t){super(),this._onActivate=t.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=t.bgWidth+"px",this.bgDomNode.style.height=t.bgHeight+"px",typeof t.top<"u"&&(this.bgDomNode.style.top="0px"),typeof t.left<"u"&&(this.bgDomNode.style.left="0px"),typeof t.bottom<"u"&&(this.bgDomNode.style.bottom="0px"),typeof t.right<"u"&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=t.className,this.domNode.style.position="absolute",this.domNode.style.width=cm+"px",this.domNode.style.height=cm+"px",typeof t.top<"u"&&(this.domNode.style.top=t.top+"px"),typeof t.left<"u"&&(this.domNode.style.left=t.left+"px"),typeof t.bottom<"u"&&(this.domNode.style.bottom=t.bottom+"px"),typeof t.right<"u"&&(this.domNode.style.right=t.right+"px"),this._pointerMoveMonitor=this._register(new n0),this._register(am(this.bgDomNode,kt.POINTER_DOWN,i=>this._arrowPointerDown(i))),this._register(am(this.domNode,kt.POINTER_DOWN,i=>this._arrowPointerDown(i))),this._pointerdownRepeatTimer=this._register(new F1),this._pointerdownScheduleRepeatTimer=this._register(new Ed)}_arrowPointerDown(t){if(!t.target||!(t.target instanceof Element))return;let i=()=>{this._pointerdownRepeatTimer.cancelAndSet(()=>this._onActivate(),1e3/24,Pi(t))};this._onActivate(),this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancelAndSet(i,200),this._pointerMoveMonitor.startMonitoring(t.target,t.pointerId,t.buttons,n=>{},()=>{this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancel()}),t.preventDefault()}},X1=class Wu{constructor(i,n,a,c,h,d,p){this._forceIntegerValues=i,this._scrollStateBrand=void 0,this._forceIntegerValues&&(n=n|0,a=a|0,c=c|0,h=h|0,d=d|0,p=p|0),this.rawScrollLeft=c,this.rawScrollTop=p,n<0&&(n=0),c+n>a&&(c=a-n),c<0&&(c=0),h<0&&(h=0),p+h>d&&(p=d-h),p<0&&(p=0),this.width=n,this.scrollWidth=a,this.scrollLeft=c,this.height=h,this.scrollHeight=d,this.scrollTop=p}equals(i){return this.rawScrollLeft===i.rawScrollLeft&&this.rawScrollTop===i.rawScrollTop&&this.width===i.width&&this.scrollWidth===i.scrollWidth&&this.scrollLeft===i.scrollLeft&&this.height===i.height&&this.scrollHeight===i.scrollHeight&&this.scrollTop===i.scrollTop}withScrollDimensions(i,n){return new Wu(this._forceIntegerValues,typeof i.width<"u"?i.width:this.width,typeof i.scrollWidth<"u"?i.scrollWidth:this.scrollWidth,n?this.rawScrollLeft:this.scrollLeft,typeof i.height<"u"?i.height:this.height,typeof i.scrollHeight<"u"?i.scrollHeight:this.scrollHeight,n?this.rawScrollTop:this.scrollTop)}withScrollPosition(i){return new Wu(this._forceIntegerValues,this.width,this.scrollWidth,typeof i.scrollLeft<"u"?i.scrollLeft:this.rawScrollLeft,this.height,this.scrollHeight,typeof i.scrollTop<"u"?i.scrollTop:this.rawScrollTop)}createScrollEvent(i,n){let a=this.width!==i.width,c=this.scrollWidth!==i.scrollWidth,h=this.scrollLeft!==i.scrollLeft,d=this.height!==i.height,p=this.scrollHeight!==i.scrollHeight,m=this.scrollTop!==i.scrollTop;return{inSmoothScrolling:n,oldWidth:i.width,oldScrollWidth:i.scrollWidth,oldScrollLeft:i.scrollLeft,width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,oldHeight:i.height,oldScrollHeight:i.scrollHeight,oldScrollTop:i.scrollTop,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:a,scrollWidthChanged:c,scrollLeftChanged:h,heightChanged:d,scrollHeightChanged:p,scrollTopChanged:m}}},V1=class extends He{constructor(t){super(),this._scrollableBrand=void 0,this._onScroll=this._register(new pe),this.onScroll=this._onScroll.event,this._smoothScrollDuration=t.smoothScrollDuration,this._scheduleAtNextAnimationFrame=t.scheduleAtNextAnimationFrame,this._state=new X1(t.forceIntegerValues,0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(t){this._smoothScrollDuration=t}validateScrollPosition(t){return this._state.withScrollPosition(t)}getScrollDimensions(){return this._state}setScrollDimensions(t,i){let n=this._state.withScrollDimensions(t,i);this._setState(n,!!this._smoothScrolling),this._smoothScrolling?.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(t){let i=this._state.withScrollPosition(t);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(i,!1)}setScrollPositionSmooth(t,i){if(this._smoothScrollDuration===0)return this.setScrollPositionNow(t);if(this._smoothScrolling){t={scrollLeft:typeof t.scrollLeft>"u"?this._smoothScrolling.to.scrollLeft:t.scrollLeft,scrollTop:typeof t.scrollTop>"u"?this._smoothScrolling.to.scrollTop:t.scrollTop};let n=this._state.withScrollPosition(t);if(this._smoothScrolling.to.scrollLeft===n.scrollLeft&&this._smoothScrolling.to.scrollTop===n.scrollTop)return;let a;i?a=new um(this._smoothScrolling.from,n,this._smoothScrolling.startTime,this._smoothScrolling.duration):a=this._smoothScrolling.combine(this._state,n,this._smoothScrollDuration),this._smoothScrolling.dispose(),this._smoothScrolling=a}else{let n=this._state.withScrollPosition(t);this._smoothScrolling=um.start(this._state,n,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}hasPendingScrollAnimation(){return!!this._smoothScrolling}_performSmoothScrolling(){if(!this._smoothScrolling)return;let t=this._smoothScrolling.tick(),i=this._state.withScrollPosition(t);if(this._setState(i,!0),!!this._smoothScrolling){if(t.isDone){this._smoothScrolling.dispose(),this._smoothScrolling=null;return}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}}_setState(t,i){let n=this._state;n.equals(t)||(this._state=t,this._onScroll.fire(this._state.createScrollEvent(n,i)))}},hm=class{constructor(t,i,n){this.scrollLeft=t,this.scrollTop=i,this.isDone=n}};function ou(t,i){let n=i-t;return function(a){return t+n*Q1(a)}}function $1(t,i,n){return function(a){return a<n?t(a/n):i((a-n)/(1-n))}}var um=class Fu{constructor(i,n,a,c){this.from=i,this.to=n,this.duration=c,this.startTime=a,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(i,n,a){if(Math.abs(i-n)>2.5*a){let c,h;return i<n?(c=i+.75*a,h=n-.75*a):(c=i-.75*a,h=n+.75*a),$1(ou(i,c),ou(h,n),.33)}return ou(i,n)}dispose(){this.animationFrameDisposable!==null&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(i){this.to=i.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(i){let n=(i-this.startTime)/this.duration;if(n<1){let a=this.scrollLeft(n),c=this.scrollTop(n);return new hm(a,c,!1)}return new hm(this.to.scrollLeft,this.to.scrollTop,!0)}combine(i,n,a){return Fu.start(i,n,a)}static start(i,n,a){a=a+10;let c=Date.now()-10;return new Fu(i,n,c,a)}};function Z1(t){return Math.pow(t,3)}function Q1(t){return 1-Z1(1-t)}var J1=class extends He{constructor(t,i,n){super(),this._visibility=t,this._visibleClassName=i,this._invisibleClassName=n,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._rawShouldBeVisible=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new Ed)}setVisibility(t){this._visibility!==t&&(this._visibility=t,this._updateShouldBeVisible())}setShouldBeVisible(t){this._rawShouldBeVisible=t,this._updateShouldBeVisible()}_applyVisibilitySetting(){return this._visibility===2?!1:this._visibility===3?!0:this._rawShouldBeVisible}_updateShouldBeVisible(){let t=this._applyVisibilitySetting();this._shouldBeVisible!==t&&(this._shouldBeVisible=t,this.ensureVisibility())}setIsNeeded(t){this._isNeeded!==t&&(this._isNeeded=t,this.ensureVisibility())}setDomNode(t){this._domNode=t,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){if(!this._isNeeded){this._hide(!1);return}this._shouldBeVisible?this._reveal():this._hide(!0)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet(()=>{this._domNode?.setClassName(this._visibleClassName)},0))}_hide(t){this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,this._domNode?.setClassName(this._invisibleClassName+(t?" fade":"")))}},eC=140,l0=class extends Ad{constructor(t){super(),this._lazyRender=t.lazyRender,this._host=t.host,this._scrollable=t.scrollable,this._scrollByPage=t.scrollByPage,this._scrollbarState=t.scrollbarState,this._visibilityController=this._register(new J1(t.visibility,"visible scrollbar "+t.extraScrollbarClassName,"invisible scrollbar "+t.extraScrollbarClassName)),this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._pointerMoveMonitor=this._register(new n0),this._shouldRender=!0,this.domNode=Ll(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this._register(Me(this.domNode.domNode,kt.POINTER_DOWN,i=>this._domNodePointerDown(i)))}_createArrow(t){let i=this._register(new G1(t));this.domNode.domNode.appendChild(i.bgDomNode),this.domNode.domNode.appendChild(i.domNode)}_createSlider(t,i,n,a){this.slider=Ll(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(t),this.slider.setLeft(i),typeof n=="number"&&this.slider.setWidth(n),typeof a=="number"&&this.slider.setHeight(a),this.slider.setLayerHinting(!0),this.slider.setContain("strict"),this.domNode.domNode.appendChild(this.slider.domNode),this._register(Me(this.slider.domNode,kt.POINTER_DOWN,c=>{c.button===0&&(c.preventDefault(),this._sliderPointerDown(c))})),this.onclick(this.slider.domNode,c=>{c.leftButton&&c.stopPropagation()})}_onElementSize(t){return this._scrollbarState.setVisibleSize(t)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(t){return this._scrollbarState.setScrollSize(t)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(t){return this._scrollbarState.setScrollPosition(t)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodePointerDown(t){t.target===this.domNode.domNode&&this._onPointerDown(t)}delegatePointerDown(t){let i=this.domNode.domNode.getClientRects()[0].top,n=i+this._scrollbarState.getSliderPosition(),a=i+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),c=this._sliderPointerPosition(t);n<=c&&c<=a?t.button===0&&(t.preventDefault(),this._sliderPointerDown(t)):this._onPointerDown(t)}_onPointerDown(t){let i,n;if(t.target===this.domNode.domNode&&typeof t.offsetX=="number"&&typeof t.offsetY=="number")i=t.offsetX,n=t.offsetY;else{let c=P1(this.domNode.domNode);i=t.pageX-c.left,n=t.pageY-c.top}let a=this._pointerDownRelativePosition(i,n);this._setDesiredScrollPositionNow(this._scrollByPage?this._scrollbarState.getDesiredScrollPositionFromOffsetPaged(a):this._scrollbarState.getDesiredScrollPositionFromOffset(a)),t.button===0&&(t.preventDefault(),this._sliderPointerDown(t))}_sliderPointerDown(t){if(!t.target||!(t.target instanceof Element))return;let i=this._sliderPointerPosition(t),n=this._sliderOrthogonalPointerPosition(t),a=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._pointerMoveMonitor.startMonitoring(t.target,t.pointerId,t.buttons,c=>{let h=this._sliderOrthogonalPointerPosition(c),d=Math.abs(h-n);if(t0&&d>eC){this._setDesiredScrollPositionNow(a.getScrollPosition());return}let p=this._sliderPointerPosition(c)-i;this._setDesiredScrollPositionNow(a.getDesiredScrollPositionFromDelta(p))},()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd()}),this._host.onDragStart()}_setDesiredScrollPositionNow(t){let i={};this.writeScrollPosition(i,t),this._scrollable.setScrollPositionNow(i)}updateScrollbarSize(t){this._updateScrollbarSize(t),this._scrollbarState.setScrollbarSize(t),this._shouldRender=!0,this._lazyRender||this.render()}isNeeded(){return this._scrollbarState.isNeeded()}},a0=class Pu{constructor(i,n,a,c,h,d){this._scrollbarSize=Math.round(n),this._oppositeScrollbarSize=Math.round(a),this._arrowSize=Math.round(i),this._visibleSize=c,this._scrollSize=h,this._scrollPosition=d,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){return new Pu(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition)}setVisibleSize(i){let n=Math.round(i);return this._visibleSize!==n?(this._visibleSize=n,this._refreshComputedValues(),!0):!1}setScrollSize(i){let n=Math.round(i);return this._scrollSize!==n?(this._scrollSize=n,this._refreshComputedValues(),!0):!1}setScrollPosition(i){let n=Math.round(i);return this._scrollPosition!==n?(this._scrollPosition=n,this._refreshComputedValues(),!0):!1}setScrollbarSize(i){this._scrollbarSize=Math.round(i)}setOppositeScrollbarSize(i){this._oppositeScrollbarSize=Math.round(i)}static _computeValues(i,n,a,c,h){let d=Math.max(0,a-i),p=Math.max(0,d-2*n),m=c>0&&c>a;if(!m)return{computedAvailableSize:Math.round(d),computedIsNeeded:m,computedSliderSize:Math.round(p),computedSliderRatio:0,computedSliderPosition:0};let _=Math.round(Math.max(20,Math.floor(a*p/c))),y=(p-_)/(c-a),b=h*y;return{computedAvailableSize:Math.round(d),computedIsNeeded:m,computedSliderSize:Math.round(_),computedSliderRatio:y,computedSliderPosition:Math.round(b)}}_refreshComputedValues(){let i=Pu._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=i.computedAvailableSize,this._computedIsNeeded=i.computedIsNeeded,this._computedSliderSize=i.computedSliderSize,this._computedSliderRatio=i.computedSliderRatio,this._computedSliderPosition=i.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getDesiredScrollPositionFromOffset(i){if(!this._computedIsNeeded)return 0;let n=i-this._arrowSize-this._computedSliderSize/2;return Math.round(n/this._computedSliderRatio)}getDesiredScrollPositionFromOffsetPaged(i){if(!this._computedIsNeeded)return 0;let n=i-this._arrowSize,a=this._scrollPosition;return n<this._computedSliderPosition?a-=this._visibleSize:a+=this._visibleSize,a}getDesiredScrollPositionFromDelta(i){if(!this._computedIsNeeded)return 0;let n=this._computedSliderPosition+i;return Math.round(n/this._computedSliderRatio)}},tC=class extends l0{constructor(t,i,n){let a=t.getScrollDimensions(),c=t.getCurrentScrollPosition();if(super({lazyRender:i.lazyRender,host:n,scrollbarState:new a0(i.horizontalHasArrows?i.arrowSize:0,i.horizontal===2?0:i.horizontalScrollbarSize,i.vertical===2?0:i.verticalScrollbarSize,a.width,a.scrollWidth,c.scrollLeft),visibility:i.horizontal,extraScrollbarClassName:"horizontal",scrollable:t,scrollByPage:i.scrollByPage}),i.horizontalHasArrows)throw new Error("horizontalHasArrows is not supported in xterm.js");this._createSlider(Math.floor((i.horizontalScrollbarSize-i.horizontalSliderSize)/2),0,void 0,i.horizontalSliderSize)}_updateSlider(t,i){this.slider.setWidth(t),this.slider.setLeft(i)}_renderDomNode(t,i){this.domNode.setWidth(t),this.domNode.setHeight(i),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(t){return this._shouldRender=this._onElementScrollSize(t.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(t.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(t.width)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(t,i){return t}_sliderPointerPosition(t){return t.pageX}_sliderOrthogonalPointerPosition(t){return t.pageY}_updateScrollbarSize(t){this.slider.setHeight(t)}writeScrollPosition(t,i){t.scrollLeft=i}updateOptions(t){this.updateScrollbarSize(t.horizontal===2?0:t.horizontalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(t.vertical===2?0:t.verticalScrollbarSize),this._visibilityController.setVisibility(t.horizontal),this._scrollByPage=t.scrollByPage}},iC=class extends l0{constructor(t,i,n){let a=t.getScrollDimensions(),c=t.getCurrentScrollPosition();if(super({lazyRender:i.lazyRender,host:n,scrollbarState:new a0(i.verticalHasArrows?i.arrowSize:0,i.vertical===2?0:i.verticalScrollbarSize,0,a.height,a.scrollHeight,c.scrollTop),visibility:i.vertical,extraScrollbarClassName:"vertical",scrollable:t,scrollByPage:i.scrollByPage}),i.verticalHasArrows)throw new Error("horizontalHasArrows is not supported in xterm.js");this._createSlider(0,Math.floor((i.verticalScrollbarSize-i.verticalSliderSize)/2),i.verticalSliderSize,void 0)}_updateSlider(t,i){this.slider.setHeight(t),this.slider.setTop(i)}_renderDomNode(t,i){this.domNode.setWidth(i),this.domNode.setHeight(t),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(t){return this._shouldRender=this._onElementScrollSize(t.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(t.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(t.height)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(t,i){return i}_sliderPointerPosition(t){return t.pageY}_sliderOrthogonalPointerPosition(t){return t.pageX}_updateScrollbarSize(t){this.slider.setWidth(t)}writeScrollPosition(t,i){t.scrollTop=i}updateOptions(t){this.updateScrollbarSize(t.vertical===2?0:t.verticalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(0),this._visibilityController.setVisibility(t.vertical),this._scrollByPage=t.scrollByPage}},sC=500,dm=50,rC=class{constructor(t,i,n){this.timestamp=t,this.deltaX=i,this.deltaY=n,this.score=0}},Yu=class{constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(this._front===-1&&this._rear===-1)return!1;let i=1,n=0,a=1,c=this._rear;do{let h=c===this._front?i:Math.pow(2,-a);if(i-=h,n+=this._memory[c].score*h,c===this._front)break;c=(this._capacity+c-1)%this._capacity,a++}while(!0);return n<=.5}acceptStandardWheelEvent(i){if(wd){let n=Pi(i.browserEvent),a=g1(n);this.accept(Date.now(),i.deltaX*a,i.deltaY*a)}else this.accept(Date.now(),i.deltaX,i.deltaY)}accept(i,n,a){let c=null,h=new rC(i,n,a);this._front===-1&&this._rear===-1?(this._memory[0]=h,this._front=0,this._rear=0):(c=this._memory[this._rear],this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=h),h.score=this._computeScore(h,c)}_computeScore(i,n){if(Math.abs(i.deltaX)>0&&Math.abs(i.deltaY)>0)return 1;let a=.5;if((!this._isAlmostInt(i.deltaX)||!this._isAlmostInt(i.deltaY))&&(a+=.25),n){let c=Math.abs(i.deltaX),h=Math.abs(i.deltaY),d=Math.abs(n.deltaX),p=Math.abs(n.deltaY),m=Math.max(Math.min(c,d),1),_=Math.max(Math.min(h,p),1),y=Math.max(c,d),b=Math.max(h,p);y%m===0&&b%_===0&&(a-=.5)}return Math.min(Math.max(a,0),1)}_isAlmostInt(i){return Math.abs(Math.round(i)-i)<.01}};Yu.INSTANCE=new Yu;var nC=Yu,lC=class extends Ad{constructor(t,i,n){super(),this._onScroll=this._register(new pe),this.onScroll=this._onScroll.event,this._onWillScroll=this._register(new pe),this.onWillScroll=this._onWillScroll.event,this._options=oC(i),this._scrollable=n,this._register(this._scrollable.onScroll(c=>{this._onWillScroll.fire(c),this._onDidScroll(c),this._onScroll.fire(c)}));let a={onMouseWheel:c=>this._onMouseWheel(c),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()};this._verticalScrollbar=this._register(new iC(this._scrollable,this._options,a)),this._horizontalScrollbar=this._register(new tC(this._scrollable,this._options,a)),this._domNode=document.createElement("div"),this._domNode.className="xterm-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.appendChild(t),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows?(this._leftShadowDomNode=Ll(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=Ll(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=Ll(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)):(this._leftShadowDomNode=null,this._topShadowDomNode=null,this._topLeftShadowDomNode=null),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,c=>this._onMouseOver(c)),this.onmouseleave(this._listenOnDomNode,c=>this._onMouseLeave(c)),this._hideTimeout=this._register(new Ed),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0,this._revealOnScroll=!0}get options(){return this._options}dispose(){this._mouseWheelToDispose=wr(this._mouseWheelToDispose),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarPointerDown(t){this._verticalScrollbar.delegatePointerDown(t)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(t){this._scrollable.setScrollDimensions(t,!1)}updateClassName(t){this._options.className=t,Yi&&(this._options.className+=" mac"),this._domNode.className="xterm-scrollable-element "+this._options.className}updateOptions(t){typeof t.handleMouseWheel<"u"&&(this._options.handleMouseWheel=t.handleMouseWheel,this._setListeningToMouseWheel(this._options.handleMouseWheel)),typeof t.mouseWheelScrollSensitivity<"u"&&(this._options.mouseWheelScrollSensitivity=t.mouseWheelScrollSensitivity),typeof t.fastScrollSensitivity<"u"&&(this._options.fastScrollSensitivity=t.fastScrollSensitivity),typeof t.scrollPredominantAxis<"u"&&(this._options.scrollPredominantAxis=t.scrollPredominantAxis),typeof t.horizontal<"u"&&(this._options.horizontal=t.horizontal),typeof t.vertical<"u"&&(this._options.vertical=t.vertical),typeof t.horizontalScrollbarSize<"u"&&(this._options.horizontalScrollbarSize=t.horizontalScrollbarSize),typeof t.verticalScrollbarSize<"u"&&(this._options.verticalScrollbarSize=t.verticalScrollbarSize),typeof t.scrollByPage<"u"&&(this._options.scrollByPage=t.scrollByPage),this._horizontalScrollbar.updateOptions(this._options),this._verticalScrollbar.updateOptions(this._options),this._options.lazyRender||this._render()}setRevealOnScroll(t){this._revealOnScroll=t}delegateScrollFromMouseWheelEvent(t){this._onMouseWheel(new nm(t))}_setListeningToMouseWheel(t){if(this._mouseWheelToDispose.length>0!==t&&(this._mouseWheelToDispose=wr(this._mouseWheelToDispose),t)){let i=n=>{this._onMouseWheel(new nm(n))};this._mouseWheelToDispose.push(Me(this._listenOnDomNode,kt.MOUSE_WHEEL,i,{passive:!1}))}}_onMouseWheel(t){if(t.browserEvent?.defaultPrevented)return;let i=nC.INSTANCE;i.acceptStandardWheelEvent(t);let n=!1;if(t.deltaY||t.deltaX){let c=t.deltaY*this._options.mouseWheelScrollSensitivity,h=t.deltaX*this._options.mouseWheelScrollSensitivity;this._options.scrollPredominantAxis&&(this._options.scrollYToX&&h+c===0?h=c=0:Math.abs(c)>=Math.abs(h)?h=0:c=0),this._options.flipAxes&&([c,h]=[h,c]);let d=!Yi&&t.browserEvent&&t.browserEvent.shiftKey;(this._options.scrollYToX||d)&&!h&&(h=c,c=0),t.browserEvent&&t.browserEvent.altKey&&(h=h*this._options.fastScrollSensitivity,c=c*this._options.fastScrollSensitivity);let p=this._scrollable.getFutureScrollPosition(),m={};if(c){let _=dm*c,y=p.scrollTop-(_<0?Math.floor(_):Math.ceil(_));this._verticalScrollbar.writeScrollPosition(m,y)}if(h){let _=dm*h,y=p.scrollLeft-(_<0?Math.floor(_):Math.ceil(_));this._horizontalScrollbar.writeScrollPosition(m,y)}m=this._scrollable.validateScrollPosition(m),(p.scrollLeft!==m.scrollLeft||p.scrollTop!==m.scrollTop)&&(this._options.mouseWheelSmoothScroll&&i.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(m):this._scrollable.setScrollPositionNow(m),n=!0)}let a=n;!a&&this._options.alwaysConsumeMouseWheel&&(a=!0),!a&&this._options.consumeMouseWheelIfScrollbarIsNeeded&&(this._verticalScrollbar.isNeeded()||this._horizontalScrollbar.isNeeded())&&(a=!0),a&&(t.preventDefault(),t.stopPropagation())}_onDidScroll(t){this._shouldRender=this._horizontalScrollbar.onDidScroll(t)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(t)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){let t=this._scrollable.getCurrentScrollPosition(),i=t.scrollTop>0,n=t.scrollLeft>0,a=n?" left":"",c=i?" top":"",h=n||i?" top-left-corner":"";this._leftShadowDomNode.setClassName(`shadow${a}`),this._topShadowDomNode.setClassName(`shadow${c}`),this._topLeftShadowDomNode.setClassName(`shadow${h}${c}${a}`)}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseLeave(t){this._mouseIsOver=!1,this._hide()}_onMouseOver(t){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){!this._mouseIsOver&&!this._isDragging&&(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){!this._mouseIsOver&&!this._isDragging&&this._hideTimeout.cancelAndSet(()=>this._hide(),sC)}},aC=class extends lC{constructor(t,i,n){super(t,i,n)}setScrollPosition(t){t.reuseAnimation?this._scrollable.setScrollPositionSmooth(t,t.reuseAnimation):this._scrollable.setScrollPositionNow(t)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}};function oC(t){let i={lazyRender:typeof t.lazyRender<"u"?t.lazyRender:!1,className:typeof t.className<"u"?t.className:"",useShadows:typeof t.useShadows<"u"?t.useShadows:!0,handleMouseWheel:typeof t.handleMouseWheel<"u"?t.handleMouseWheel:!0,flipAxes:typeof t.flipAxes<"u"?t.flipAxes:!1,consumeMouseWheelIfScrollbarIsNeeded:typeof t.consumeMouseWheelIfScrollbarIsNeeded<"u"?t.consumeMouseWheelIfScrollbarIsNeeded:!1,alwaysConsumeMouseWheel:typeof t.alwaysConsumeMouseWheel<"u"?t.alwaysConsumeMouseWheel:!1,scrollYToX:typeof t.scrollYToX<"u"?t.scrollYToX:!1,mouseWheelScrollSensitivity:typeof t.mouseWheelScrollSensitivity<"u"?t.mouseWheelScrollSensitivity:1,fastScrollSensitivity:typeof t.fastScrollSensitivity<"u"?t.fastScrollSensitivity:5,scrollPredominantAxis:typeof t.scrollPredominantAxis<"u"?t.scrollPredominantAxis:!0,mouseWheelSmoothScroll:typeof t.mouseWheelSmoothScroll<"u"?t.mouseWheelSmoothScroll:!0,arrowSize:typeof t.arrowSize<"u"?t.arrowSize:11,listenOnDomNode:typeof t.listenOnDomNode<"u"?t.listenOnDomNode:null,horizontal:typeof t.horizontal<"u"?t.horizontal:1,horizontalScrollbarSize:typeof t.horizontalScrollbarSize<"u"?t.horizontalScrollbarSize:10,horizontalSliderSize:typeof t.horizontalSliderSize<"u"?t.horizontalSliderSize:0,horizontalHasArrows:typeof t.horizontalHasArrows<"u"?t.horizontalHasArrows:!1,vertical:typeof t.vertical<"u"?t.vertical:1,verticalScrollbarSize:typeof t.verticalScrollbarSize<"u"?t.verticalScrollbarSize:10,verticalHasArrows:typeof t.verticalHasArrows<"u"?t.verticalHasArrows:!1,verticalSliderSize:typeof t.verticalSliderSize<"u"?t.verticalSliderSize:0,scrollByPage:typeof t.scrollByPage<"u"?t.scrollByPage:!1};return i.horizontalSliderSize=typeof t.horizontalSliderSize<"u"?t.horizontalSliderSize:i.horizontalScrollbarSize,i.verticalSliderSize=typeof t.verticalSliderSize<"u"?t.verticalSliderSize:i.verticalScrollbarSize,Yi&&(i.className+=" mac"),i}var qu=class extends He{constructor(t,i,n,a,c,h,d,p){super(),this._bufferService=n,this._optionsService=d,this._renderService=p,this._onRequestScrollLines=this._register(new pe),this.onRequestScrollLines=this._onRequestScrollLines.event,this._isSyncing=!1,this._isHandlingScroll=!1,this._suppressOnScrollHandler=!1;let m=this._register(new V1({forceIntegerValues:!1,smoothScrollDuration:this._optionsService.rawOptions.smoothScrollDuration,scheduleAtNextAnimationFrame:_=>Td(a.window,_)}));this._register(this._optionsService.onSpecificOptionChange("smoothScrollDuration",()=>{m.setSmoothScrollDuration(this._optionsService.rawOptions.smoothScrollDuration)})),this._scrollableElement=this._register(new aC(i,{vertical:1,horizontal:2,useShadows:!1,mouseWheelSmoothScroll:!0,...this._getChangeOptions()},m)),this._register(this._optionsService.onMultipleOptionChange(["scrollSensitivity","fastScrollSensitivity","overviewRuler"],()=>this._scrollableElement.updateOptions(this._getChangeOptions()))),this._register(c.onProtocolChange(_=>{this._scrollableElement.updateOptions({handleMouseWheel:!(_&16)})})),this._scrollableElement.setScrollDimensions({height:0,scrollHeight:0}),this._register(jt.runAndSubscribe(h.onChangeColors,()=>{this._scrollableElement.getDomNode().style.backgroundColor=h.colors.background.css})),t.appendChild(this._scrollableElement.getDomNode()),this._register(nt(()=>this._scrollableElement.getDomNode().remove())),this._styleElement=a.mainDocument.createElement("style"),i.appendChild(this._styleElement),this._register(nt(()=>this._styleElement.remove())),this._register(jt.runAndSubscribe(h.onChangeColors,()=>{this._styleElement.textContent=[".xterm .xterm-scrollable-element > .scrollbar > .slider {",`  background: ${h.colors.scrollbarSliderBackground.css};`,"}",".xterm .xterm-scrollable-element > .scrollbar > .slider:hover {",`  background: ${h.colors.scrollbarSliderHoverBackground.css};`,"}",".xterm .xterm-scrollable-element > .scrollbar > .slider.active {",`  background: ${h.colors.scrollbarSliderActiveBackground.css};`,"}"].join(`
`)})),this._register(this._bufferService.onResize(()=>this.queueSync())),this._register(this._bufferService.buffers.onBufferActivate(()=>{this._latestYDisp=void 0,this.queueSync()})),this._register(this._bufferService.onScroll(()=>this._sync())),this._register(this._scrollableElement.onScroll(_=>this._handleScroll(_)))}scrollLines(t){let i=this._scrollableElement.getScrollPosition();this._scrollableElement.setScrollPosition({reuseAnimation:!0,scrollTop:i.scrollTop+t*this._renderService.dimensions.css.cell.height})}scrollToLine(t,i){i&&(this._latestYDisp=t),this._scrollableElement.setScrollPosition({reuseAnimation:!i,scrollTop:t*this._renderService.dimensions.css.cell.height})}_getChangeOptions(){return{mouseWheelScrollSensitivity:this._optionsService.rawOptions.scrollSensitivity,fastScrollSensitivity:this._optionsService.rawOptions.fastScrollSensitivity,verticalScrollbarSize:this._optionsService.rawOptions.overviewRuler?.width||14}}queueSync(t){t!==void 0&&(this._latestYDisp=t),this._queuedAnimationFrame===void 0&&(this._queuedAnimationFrame=this._renderService.addRefreshCallback(()=>{this._queuedAnimationFrame=void 0,this._sync(this._latestYDisp)}))}_sync(t=this._bufferService.buffer.ydisp){!this._renderService||this._isSyncing||(this._isSyncing=!0,this._suppressOnScrollHandler=!0,this._scrollableElement.setScrollDimensions({height:this._renderService.dimensions.css.canvas.height,scrollHeight:this._renderService.dimensions.css.cell.height*this._bufferService.buffer.lines.length}),this._suppressOnScrollHandler=!1,t!==this._latestYDisp&&this._scrollableElement.setScrollPosition({scrollTop:t*this._renderService.dimensions.css.cell.height}),this._isSyncing=!1)}_handleScroll(t){if(!this._renderService||this._isHandlingScroll||this._suppressOnScrollHandler)return;this._isHandlingScroll=!0;let i=Math.round(t.scrollTop/this._renderService.dimensions.css.cell.height),n=i-this._bufferService.buffer.ydisp;n!==0&&(this._latestYDisp=i,this._onRequestScrollLines.fire(n)),this._isHandlingScroll=!1}};qu=ft([ve(2,Kt),ve(3,ms),ve(4,Wv),ve(5,Sn),ve(6,Gt),ve(7,vs)],qu);var Ku=class extends He{constructor(t,i,n,a,c){super(),this._screenElement=t,this._bufferService=i,this._coreBrowserService=n,this._decorationService=a,this._renderService=c,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this._register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this._register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this._register(this._coreBrowserService.onDprChange(()=>this._queueRefresh())),this._register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this._register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this._register(this._decorationService.onDecorationRemoved(h=>this._removeDecoration(h))),this._register(nt(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(let t of this._decorationService.decorations)this._renderDecoration(t);this._dimensionsChanged=!1}_renderDecoration(t){this._refreshStyle(t),this._dimensionsChanged&&this._refreshXPosition(t)}_createElement(t){let i=this._coreBrowserService.mainDocument.createElement("div");i.classList.add("xterm-decoration"),i.classList.toggle("xterm-decoration-top-layer",t?.options?.layer==="top"),i.style.width=`${Math.round((t.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,i.style.height=`${(t.options.height||1)*this._renderService.dimensions.css.cell.height}px`,i.style.top=`${(t.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height}px`,i.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;let n=t.options.x??0;return n&&n>this._bufferService.cols&&(i.style.display="none"),this._refreshXPosition(t,i),i}_refreshStyle(t){let i=t.marker.line-this._bufferService.buffers.active.ydisp;if(i<0||i>=this._bufferService.rows)t.element&&(t.element.style.display="none",t.onRenderEmitter.fire(t.element));else{let n=this._decorationElements.get(t);n||(n=this._createElement(t),t.element=n,this._decorationElements.set(t,n),this._container.appendChild(n),t.onDispose(()=>{this._decorationElements.delete(t),n.remove()})),n.style.display=this._altBufferIsActive?"none":"block",this._altBufferIsActive||(n.style.width=`${Math.round((t.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,n.style.height=`${(t.options.height||1)*this._renderService.dimensions.css.cell.height}px`,n.style.top=`${i*this._renderService.dimensions.css.cell.height}px`,n.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`),t.onRenderEmitter.fire(n)}}_refreshXPosition(t,i=t.element){if(!i)return;let n=t.options.x??0;(t.options.anchor||"left")==="right"?i.style.right=n?`${n*this._renderService.dimensions.css.cell.width}px`:"":i.style.left=n?`${n*this._renderService.dimensions.css.cell.width}px`:""}_removeDecoration(t){this._decorationElements.get(t)?.remove(),this._decorationElements.delete(t),t.dispose()}};Ku=ft([ve(1,Kt),ve(2,ms),ve(3,Hl),ve(4,vs)],Ku);var cC=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(t){if(t.options.overviewRulerOptions){for(let i of this._zones)if(i.color===t.options.overviewRulerOptions.color&&i.position===t.options.overviewRulerOptions.position){if(this._lineIntersectsZone(i,t.marker.line))return;if(this._lineAdjacentToZone(i,t.marker.line,t.options.overviewRulerOptions.position)){this._addLineToZone(i,t.marker.line);return}}if(this._zonePoolIndex<this._zonePool.length){this._zonePool[this._zonePoolIndex].color=t.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=t.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=t.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=t.marker.line,this._zones.push(this._zonePool[this._zonePoolIndex++]);return}this._zones.push({color:t.options.overviewRulerOptions.color,position:t.options.overviewRulerOptions.position,startBufferLine:t.marker.line,endBufferLine:t.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(t){this._linePadding=t}_lineIntersectsZone(t,i){return i>=t.startBufferLine&&i<=t.endBufferLine}_lineAdjacentToZone(t,i,n){return i>=t.startBufferLine-this._linePadding[n||"full"]&&i<=t.endBufferLine+this._linePadding[n||"full"]}_addLineToZone(t,i){t.startBufferLine=Math.min(t.startBufferLine,i),t.endBufferLine=Math.max(t.endBufferLine,i)}},Ii={full:0,left:0,center:0,right:0},qs={full:0,left:0,center:0,right:0},ml={full:0,left:0,center:0,right:0},Eo=class extends He{constructor(t,i,n,a,c,h,d,p){super(),this._viewportElement=t,this._screenElement=i,this._bufferService=n,this._decorationService=a,this._renderService=c,this._optionsService=h,this._themeService=d,this._coreBrowserService=p,this._colorZoneStore=new cC,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=this._coreBrowserService.mainDocument.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),this._viewportElement.parentElement?.insertBefore(this._canvas,this._viewportElement),this._register(nt(()=>this._canvas?.remove()));let m=this._canvas.getContext("2d");if(m)this._ctx=m;else throw new Error("Ctx cannot be null");this._register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this._register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0))),this._register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this._register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this._register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())})),this._register(this._renderService.onRender(()=>{(!this._containerHeight||this._containerHeight!==this._screenElement.clientHeight)&&(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this._register(this._coreBrowserService.onDprChange(()=>this._queueRefresh(!0))),this._register(this._optionsService.onSpecificOptionChange("overviewRuler",()=>this._queueRefresh(!0))),this._register(this._themeService.onChangeColors(()=>this._queueRefresh())),this._queueRefresh(!0)}get _width(){return this._optionsService.options.overviewRuler?.width||0}_refreshDrawConstants(){let t=Math.floor((this._canvas.width-1)/3),i=Math.ceil((this._canvas.width-1)/3);qs.full=this._canvas.width,qs.left=t,qs.center=i,qs.right=t,this._refreshDrawHeightConstants(),ml.full=1,ml.left=1,ml.center=1+qs.left,ml.right=1+qs.left+qs.center}_refreshDrawHeightConstants(){Ii.full=Math.round(2*this._coreBrowserService.dpr);let t=this._canvas.height/this._bufferService.buffer.lines.length,i=Math.round(Math.max(Math.min(t,12),6)*this._coreBrowserService.dpr);Ii.left=i,Ii.center=i,Ii.right=i}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*Ii.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*Ii.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*Ii.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*Ii.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowserService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowserService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(let i of this._decorationService.decorations)this._colorZoneStore.addDecoration(i);this._ctx.lineWidth=1,this._renderRulerOutline();let t=this._colorZoneStore.zones;for(let i of t)i.position!=="full"&&this._renderColorZone(i);for(let i of t)i.position==="full"&&this._renderColorZone(i);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderRulerOutline(){this._ctx.fillStyle=this._themeService.colors.overviewRulerBorder.css,this._ctx.fillRect(0,0,1,this._canvas.height),this._optionsService.rawOptions.overviewRuler.showTopBorder&&this._ctx.fillRect(1,0,this._canvas.width-1,1),this._optionsService.rawOptions.overviewRuler.showBottomBorder&&this._ctx.fillRect(1,this._canvas.height-1,this._canvas.width-1,this._canvas.height)}_renderColorZone(t){this._ctx.fillStyle=t.color,this._ctx.fillRect(ml[t.position||"full"],Math.round((this._canvas.height-1)*(t.startBufferLine/this._bufferService.buffers.active.lines.length)-Ii[t.position||"full"]/2),qs[t.position||"full"],Math.round((this._canvas.height-1)*((t.endBufferLine-t.startBufferLine)/this._bufferService.buffers.active.lines.length)+Ii[t.position||"full"]))}_queueRefresh(t,i){this._shouldUpdateDimensions=t||this._shouldUpdateDimensions,this._shouldUpdateAnchor=i||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};Eo=ft([ve(2,Kt),ve(3,Hl),ve(4,vs),ve(5,Gt),ve(6,Sn),ve(7,ms)],Eo);var oe;(t=>(t.NUL="\0",t.SOH="",t.STX="",t.ETX="",t.EOT="",t.ENQ="",t.ACK="",t.BEL="\x07",t.BS="\b",t.HT="	",t.LF=`
`,t.VT="\v",t.FF="\f",t.CR="\r",t.SO="",t.SI="",t.DLE="",t.DC1="",t.DC2="",t.DC3="",t.DC4="",t.NAK="",t.SYN="",t.ETB="",t.CAN="",t.EM="",t.SUB="",t.ESC="\x1B",t.FS="",t.GS="",t.RS="",t.US="",t.SP=" ",t.DEL=""))(oe||={});var yo;(t=>(t.PAD="",t.HOP="",t.BPH="",t.NBH="",t.IND="",t.NEL="",t.SSA="",t.ESA="",t.HTS="",t.HTJ="",t.VTS="",t.PLD="",t.PLU="",t.RI="",t.SS2="",t.SS3="",t.DCS="",t.PU1="",t.PU2="",t.STS="",t.CCH="",t.MW="",t.SPA="",t.EPA="",t.SOS="",t.SGCI="",t.SCI="",t.CSI="",t.ST="",t.OSC="",t.PM="",t.APC=""))(yo||={});var o0;(t=>t.ST=`${oe.ESC}\\`)(o0||={});var Gu=class{constructor(t,i,n,a,c,h){this._textarea=t,this._compositionView=i,this._bufferService=n,this._optionsService=a,this._coreService=c,this._renderService=h,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}get isComposing(){return this._isComposing}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(t){this._compositionView.textContent=t.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(t){if(this._isComposing||this._isSendingComposition){if(t.keyCode===20||t.keyCode===229||t.keyCode===16||t.keyCode===17||t.keyCode===18)return!1;this._finalizeComposition(!1)}return t.keyCode===229?(this._handleAnyTextareaChanges(),!1):!0}_finalizeComposition(t){if(this._compositionView.classList.remove("active"),this._isComposing=!1,t){let i={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){this._isSendingComposition=!1;let n;i.start+=this._dataAlreadySent.length,this._isComposing?n=this._textarea.value.substring(i.start,this._compositionPosition.start):n=this._textarea.value.substring(i.start),n.length>0&&this._coreService.triggerDataEvent(n,!0)}},0)}else{this._isSendingComposition=!1;let i=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(i,!0)}}_handleAnyTextareaChanges(){let t=this._textarea.value;setTimeout(()=>{if(!this._isComposing){let i=this._textarea.value,n=i.replace(t,"");this._dataAlreadySent=n,i.length>t.length?this._coreService.triggerDataEvent(n,!0):i.length<t.length?this._coreService.triggerDataEvent(`${oe.DEL}`,!0):i.length===t.length&&i!==t&&this._coreService.triggerDataEvent(i,!0)}},0)}updateCompositionElements(t){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){let i=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),n=this._renderService.dimensions.css.cell.height,a=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,c=i*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=c+"px",this._compositionView.style.top=a+"px",this._compositionView.style.height=n+"px",this._compositionView.style.lineHeight=n+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";let h=this._compositionView.getBoundingClientRect();this._textarea.style.left=c+"px",this._textarea.style.top=a+"px",this._textarea.style.width=Math.max(h.width,1)+"px",this._textarea.style.height=Math.max(h.height,1)+"px",this._textarea.style.lineHeight=h.height+"px"}t||setTimeout(()=>this.updateCompositionElements(!0),0)}}};Gu=ft([ve(2,Kt),ve(3,Gt),ve(4,Tr),ve(5,vs)],Gu);var Mt=0,Lt=0,Bt=0,dt=0,fm={css:"#00000000",rgba:0},Ct;(t=>{function i(c,h,d,p){return p!==void 0?`#${pr(c)}${pr(h)}${pr(d)}${pr(p)}`:`#${pr(c)}${pr(h)}${pr(d)}`}t.toCss=i;function n(c,h,d,p=255){return(c<<24|h<<16|d<<8|p)>>>0}t.toRgba=n;function a(c,h,d,p){return{css:t.toCss(c,h,d,p),rgba:t.toRgba(c,h,d,p)}}t.toColor=a})(Ct||={});var st;(t=>{function i(m,_){if(dt=(_.rgba&255)/255,dt===1)return{css:_.css,rgba:_.rgba};let y=_.rgba>>24&255,b=_.rgba>>16&255,E=_.rgba>>8&255,R=m.rgba>>24&255,D=m.rgba>>16&255,k=m.rgba>>8&255;Mt=R+Math.round((y-R)*dt),Lt=D+Math.round((b-D)*dt),Bt=k+Math.round((E-k)*dt);let V=Ct.toCss(Mt,Lt,Bt),X=Ct.toRgba(Mt,Lt,Bt);return{css:V,rgba:X}}t.blend=i;function n(m){return(m.rgba&255)===255}t.isOpaque=n;function a(m,_,y){let b=So.ensureContrastRatio(m.rgba,_.rgba,y);if(b)return Ct.toColor(b>>24&255,b>>16&255,b>>8&255)}t.ensureContrastRatio=a;function c(m){let _=(m.rgba|255)>>>0;return[Mt,Lt,Bt]=So.toChannels(_),{css:Ct.toCss(Mt,Lt,Bt),rgba:_}}t.opaque=c;function h(m,_){return dt=Math.round(_*255),[Mt,Lt,Bt]=So.toChannels(m.rgba),{css:Ct.toCss(Mt,Lt,Bt,dt),rgba:Ct.toRgba(Mt,Lt,Bt,dt)}}t.opacity=h;function d(m,_){return dt=m.rgba&255,h(m,dt*_/255)}t.multiplyOpacity=d;function p(m){return[m.rgba>>24&255,m.rgba>>16&255,m.rgba>>8&255]}t.toColorRGB=p})(st||={});var at;(t=>{let i,n;try{let c=document.createElement("canvas");c.width=1,c.height=1;let h=c.getContext("2d",{willReadFrequently:!0});h&&(i=h,i.globalCompositeOperation="copy",n=i.createLinearGradient(0,0,1,1))}catch{}function a(c){if(c.match(/#[\da-f]{3,8}/i))switch(c.length){case 4:return Mt=parseInt(c.slice(1,2).repeat(2),16),Lt=parseInt(c.slice(2,3).repeat(2),16),Bt=parseInt(c.slice(3,4).repeat(2),16),Ct.toColor(Mt,Lt,Bt);case 5:return Mt=parseInt(c.slice(1,2).repeat(2),16),Lt=parseInt(c.slice(2,3).repeat(2),16),Bt=parseInt(c.slice(3,4).repeat(2),16),dt=parseInt(c.slice(4,5).repeat(2),16),Ct.toColor(Mt,Lt,Bt,dt);case 7:return{css:c,rgba:(parseInt(c.slice(1),16)<<8|255)>>>0};case 9:return{css:c,rgba:parseInt(c.slice(1),16)>>>0}}let h=c.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(h)return Mt=parseInt(h[1]),Lt=parseInt(h[2]),Bt=parseInt(h[3]),dt=Math.round((h[5]===void 0?1:parseFloat(h[5]))*255),Ct.toColor(Mt,Lt,Bt,dt);if(!i||!n)throw new Error("css.toColor: Unsupported css format");if(i.fillStyle=n,i.fillStyle=c,typeof i.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(i.fillRect(0,0,1,1),[Mt,Lt,Bt,dt]=i.getImageData(0,0,1,1).data,dt!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:Ct.toRgba(Mt,Lt,Bt,dt),css:c}}t.toColor=a})(at||={});var qt;(t=>{function i(a){return n(a>>16&255,a>>8&255,a&255)}t.relativeLuminance=i;function n(a,c,h){let d=a/255,p=c/255,m=h/255,_=d<=.03928?d/12.92:Math.pow((d+.055)/1.055,2.4),y=p<=.03928?p/12.92:Math.pow((p+.055)/1.055,2.4),b=m<=.03928?m/12.92:Math.pow((m+.055)/1.055,2.4);return _*.2126+y*.7152+b*.0722}t.relativeLuminance2=n})(qt||={});var So;(t=>{function i(d,p){if(dt=(p&255)/255,dt===1)return p;let m=p>>24&255,_=p>>16&255,y=p>>8&255,b=d>>24&255,E=d>>16&255,R=d>>8&255;return Mt=b+Math.round((m-b)*dt),Lt=E+Math.round((_-E)*dt),Bt=R+Math.round((y-R)*dt),Ct.toRgba(Mt,Lt,Bt)}t.blend=i;function n(d,p,m){let _=qt.relativeLuminance(d>>8),y=qt.relativeLuminance(p>>8);if(ds(_,y)<m){if(y<_){let R=a(d,p,m),D=ds(_,qt.relativeLuminance(R>>8));if(D<m){let k=c(d,p,m),V=ds(_,qt.relativeLuminance(k>>8));return D>V?R:k}return R}let b=c(d,p,m),E=ds(_,qt.relativeLuminance(b>>8));if(E<m){let R=a(d,p,m),D=ds(_,qt.relativeLuminance(R>>8));return E>D?b:R}return b}}t.ensureContrastRatio=n;function a(d,p,m){let _=d>>24&255,y=d>>16&255,b=d>>8&255,E=p>>24&255,R=p>>16&255,D=p>>8&255,k=ds(qt.relativeLuminance2(E,R,D),qt.relativeLuminance2(_,y,b));for(;k<m&&(E>0||R>0||D>0);)E-=Math.max(0,Math.ceil(E*.1)),R-=Math.max(0,Math.ceil(R*.1)),D-=Math.max(0,Math.ceil(D*.1)),k=ds(qt.relativeLuminance2(E,R,D),qt.relativeLuminance2(_,y,b));return(E<<24|R<<16|D<<8|255)>>>0}t.reduceLuminance=a;function c(d,p,m){let _=d>>24&255,y=d>>16&255,b=d>>8&255,E=p>>24&255,R=p>>16&255,D=p>>8&255,k=ds(qt.relativeLuminance2(E,R,D),qt.relativeLuminance2(_,y,b));for(;k<m&&(E<255||R<255||D<255);)E=Math.min(255,E+Math.ceil((255-E)*.1)),R=Math.min(255,R+Math.ceil((255-R)*.1)),D=Math.min(255,D+Math.ceil((255-D)*.1)),k=ds(qt.relativeLuminance2(E,R,D),qt.relativeLuminance2(_,y,b));return(E<<24|R<<16|D<<8|255)>>>0}t.increaseLuminance=c;function h(d){return[d>>24&255,d>>16&255,d>>8&255,d&255]}t.toChannels=h})(So||={});function pr(t){let i=t.toString(16);return i.length<2?"0"+i:i}function ds(t,i){return t<i?(i+.05)/(t+.05):(t+.05)/(i+.05)}var hC=class extends Nl{constructor(t,i,n){super(),this.content=0,this.combinedData="",this.fg=t.fg,this.bg=t.bg,this.combinedData=i,this._width=n}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(t){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}},To=class{constructor(t){this._bufferService=t,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new ki}register(t){let i={id:this._nextCharacterJoinerId++,handler:t};return this._characterJoiners.push(i),i.id}deregister(t){for(let i=0;i<this._characterJoiners.length;i++)if(this._characterJoiners[i].id===t)return this._characterJoiners.splice(i,1),!0;return!1}getJoinedCharacters(t){if(this._characterJoiners.length===0)return[];let i=this._bufferService.buffer.lines.get(t);if(!i||i.length===0)return[];let n=[],a=i.translateToString(!0),c=0,h=0,d=0,p=i.getFg(0),m=i.getBg(0);for(let _=0;_<i.getTrimmedLength();_++)if(i.loadCell(_,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==p||this._workCell.bg!==m){if(_-c>1){let y=this._getJoinedRanges(a,d,h,i,c);for(let b=0;b<y.length;b++)n.push(y[b])}c=_,d=h,p=this._workCell.fg,m=this._workCell.bg}h+=this._workCell.getChars().length||Vs.length}if(this._bufferService.cols-c>1){let _=this._getJoinedRanges(a,d,h,i,c);for(let y=0;y<_.length;y++)n.push(_[y])}return n}_getJoinedRanges(t,i,n,a,c){let h=t.substring(i,n),d=[];try{d=this._characterJoiners[0].handler(h)}catch(p){console.error(p)}for(let p=1;p<this._characterJoiners.length;p++)try{let m=this._characterJoiners[p].handler(h);for(let _=0;_<m.length;_++)To._mergeRanges(d,m[_])}catch(m){console.error(m)}return this._stringRangesToCellRanges(d,a,c),d}_stringRangesToCellRanges(t,i,n){let a=0,c=!1,h=0,d=t[a];if(d){for(let p=n;p<this._bufferService.cols;p++){let m=i.getWidth(p),_=i.getString(p).length||Vs.length;if(m!==0){if(!c&&d[0]<=h&&(d[0]=p,c=!0),d[1]<=h){if(d[1]=p,d=t[++a],!d)break;d[0]<=h?(d[0]=p,c=!0):c=!1}h+=_}}d&&(d[1]=this._bufferService.cols)}}static _mergeRanges(t,i){let n=!1;for(let a=0;a<t.length;a++){let c=t[a];if(n){if(i[1]<=c[0])return t[a-1][1]=i[1],t;if(i[1]<=c[1])return t[a-1][1]=Math.max(i[1],c[1]),t.splice(a,1),t;t.splice(a,1),a--}else{if(i[1]<=c[0])return t.splice(a,0,i),t;if(i[1]<=c[1])return c[0]=Math.min(i[0],c[0]),t;i[0]<c[1]&&(c[0]=Math.min(i[0],c[0]),n=!0);continue}}return n?t[t.length-1][1]=i[1]:t.push(i),t}};To=ft([ve(0,Kt)],To);function uC(t){return 57508<=t&&t<=57558}function dC(t){return 9472<=t&&t<=9631}function fC(t){return uC(t)||dC(t)}function _C(){return{css:{canvas:lo(),cell:lo()},device:{canvas:lo(),cell:lo(),char:{width:0,height:0,left:0,top:0}}}}function lo(){return{width:0,height:0}}var Xu=class{constructor(t,i,n,a,c,h,d){this._document=t,this._characterJoinerService=i,this._optionsService=n,this._coreBrowserService=a,this._coreService=c,this._decorationService=h,this._themeService=d,this._workCell=new ki,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(t,i,n){this._selectionStart=t,this._selectionEnd=i,this._columnSelectMode=n}createRow(t,i,n,a,c,h,d,p,m,_,y){let b=[],E=this._characterJoinerService.getJoinedCharacters(i),R=this._themeService.colors,D=t.getNoBgTrimmedLength();n&&D<h+1&&(D=h+1);let k,V=0,X="",he=0,te=0,ue=0,de=0,_e=!1,q=0,ge=!1,Y=0,re=0,ee=[],Q=_!==-1&&y!==-1;for(let j=0;j<D;j++){t.loadCell(j,this._workCell);let ne=this._workCell.getWidth();if(ne===0)continue;let ce=!1,O=j>=re,Z=j,N=this._workCell;if(E.length>0&&j===E[0][0]&&O){let De=E.shift(),Wt=this._isCellInSelection(De[0],i);for(he=De[0]+1;he<De[1];he++)O&&=Wt===this._isCellInSelection(he,i);O&&=!n||h<De[0]||h>=De[1],O?(ce=!0,N=new hC(this._workCell,t.translateToString(!0,De[0],De[1]),De[1]-De[0]),Z=De[1]-1,ne=N.getWidth()):re=De[1]}let me=this._isCellInSelection(j,i),we=n&&j===h,A=Q&&j>=_&&j<=y,U=!1;this._decorationService.forEachDecorationAtCell(j,i,void 0,De=>{U=!0});let L=N.getChars()||Vs;if(L===" "&&(N.isUnderline()||N.isOverline())&&(L=""),Y=ne*p-m.get(L,N.isBold(),N.isItalic()),!k)k=this._document.createElement("span");else if(V&&(me&&ge||!me&&!ge&&N.bg===te)&&(me&&ge&&R.selectionForeground||N.fg===ue)&&N.extended.ext===de&&A===_e&&Y===q&&!we&&!ce&&!U&&O){N.isInvisible()?X+=Vs:X+=L,V++;continue}else V&&(k.textContent=X),k=this._document.createElement("span"),V=0,X="";if(te=N.bg,ue=N.fg,de=N.extended.ext,_e=A,q=Y,ge=me,ce&&h>=j&&h<=Z&&(h=j),!this._coreService.isCursorHidden&&we&&this._coreService.isCursorInitialized){if(ee.push("xterm-cursor"),this._coreBrowserService.isFocused)d&&ee.push("xterm-cursor-blink"),ee.push(a==="bar"?"xterm-cursor-bar":a==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(c)switch(c){case"outline":ee.push("xterm-cursor-outline");break;case"block":ee.push("xterm-cursor-block");break;case"bar":ee.push("xterm-cursor-bar");break;case"underline":ee.push("xterm-cursor-underline");break}}if(N.isBold()&&ee.push("xterm-bold"),N.isItalic()&&ee.push("xterm-italic"),N.isDim()&&ee.push("xterm-dim"),N.isInvisible()?X=Vs:X=N.getChars()||Vs,N.isUnderline()&&(ee.push(`xterm-underline-${N.extended.underlineStyle}`),X===" "&&(X=""),!N.isUnderlineColorDefault()))if(N.isUnderlineColorRGB())k.style.textDecorationColor=`rgb(${Nl.toColorRGB(N.getUnderlineColor()).join(",")})`;else{let De=N.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&N.isBold()&&De<8&&(De+=8),k.style.textDecorationColor=R.ansi[De].css}N.isOverline()&&(ee.push("xterm-overline"),X===" "&&(X="")),N.isStrikethrough()&&ee.push("xterm-strikethrough"),A&&(k.style.textDecoration="underline");let z=N.getFgColor(),$=N.getFgColorMode(),I=N.getBgColor(),ae=N.getBgColorMode(),ye=!!N.isInverse();if(ye){let De=z;z=I,I=De;let Wt=$;$=ae,ae=Wt}let fe,Ae,Se=!1;this._decorationService.forEachDecorationAtCell(j,i,void 0,De=>{De.options.layer!=="top"&&Se||(De.backgroundColorRGB&&(ae=50331648,I=De.backgroundColorRGB.rgba>>8&16777215,fe=De.backgroundColorRGB),De.foregroundColorRGB&&($=50331648,z=De.foregroundColorRGB.rgba>>8&16777215,Ae=De.foregroundColorRGB),Se=De.options.layer==="top")}),!Se&&me&&(fe=this._coreBrowserService.isFocused?R.selectionBackgroundOpaque:R.selectionInactiveBackgroundOpaque,I=fe.rgba>>8&16777215,ae=50331648,Se=!0,R.selectionForeground&&($=50331648,z=R.selectionForeground.rgba>>8&16777215,Ae=R.selectionForeground)),Se&&ee.push("xterm-decoration-top");let Be;switch(ae){case 16777216:case 33554432:Be=R.ansi[I],ee.push(`xterm-bg-${I}`);break;case 50331648:Be=Ct.toColor(I>>16,I>>8&255,I&255),this._addStyle(k,`background-color:#${_m((I>>>0).toString(16),"0",6)}`);break;default:ye?(Be=R.foreground,ee.push("xterm-bg-257")):Be=R.background}switch(fe||N.isDim()&&(fe=st.multiplyOpacity(Be,.5)),$){case 16777216:case 33554432:N.isBold()&&z<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(z+=8),this._applyMinimumContrast(k,Be,R.ansi[z],N,fe,void 0)||ee.push(`xterm-fg-${z}`);break;case 50331648:let De=Ct.toColor(z>>16&255,z>>8&255,z&255);this._applyMinimumContrast(k,Be,De,N,fe,Ae)||this._addStyle(k,`color:#${_m(z.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(k,Be,R.foreground,N,fe,Ae)||ye&&ee.push("xterm-fg-257")}ee.length&&(k.className=ee.join(" "),ee.length=0),!we&&!ce&&!U&&O?V++:k.textContent=X,Y!==this.defaultSpacing&&(k.style.letterSpacing=`${Y}px`),b.push(k),j=Z}return k&&V&&(k.textContent=X),b}_applyMinimumContrast(t,i,n,a,c,h){if(this._optionsService.rawOptions.minimumContrastRatio===1||fC(a.getCode()))return!1;let d=this._getContrastCache(a),p;if(!c&&!h&&(p=d.getColor(i.rgba,n.rgba)),p===void 0){let m=this._optionsService.rawOptions.minimumContrastRatio/(a.isDim()?2:1);p=st.ensureContrastRatio(c||i,h||n,m),d.setColor((c||i).rgba,(h||n).rgba,p??null)}return p?(this._addStyle(t,`color:${p.css}`),!0):!1}_getContrastCache(t){return t.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(t,i){t.setAttribute("style",`${t.getAttribute("style")||""}${i};`)}_isCellInSelection(t,i){let n=this._selectionStart,a=this._selectionEnd;return!n||!a?!1:this._columnSelectMode?n[0]<=a[0]?t>=n[0]&&i>=n[1]&&t<a[0]&&i<=a[1]:t<n[0]&&i>=n[1]&&t>=a[0]&&i<=a[1]:i>n[1]&&i<a[1]||n[1]===a[1]&&i===n[1]&&t>=n[0]&&t<a[0]||n[1]<a[1]&&i===a[1]&&t<a[0]||n[1]<a[1]&&i===n[1]&&t>=n[0]}};Xu=ft([ve(1,Yv),ve(2,Gt),ve(3,ms),ve(4,Tr),ve(5,Hl),ve(6,Sn)],Xu);function _m(t,i,n){for(;t.length<n;)t=i+t;return t}var gC=class{constructor(t,i){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=t.createElement("div"),this._container.classList.add("xterm-width-cache-measure-container"),this._container.setAttribute("aria-hidden","true"),this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";let n=t.createElement("span");n.classList.add("xterm-char-measure-element");let a=t.createElement("span");a.classList.add("xterm-char-measure-element"),a.style.fontWeight="bold";let c=t.createElement("span");c.classList.add("xterm-char-measure-element"),c.style.fontStyle="italic";let h=t.createElement("span");h.classList.add("xterm-char-measure-element"),h.style.fontWeight="bold",h.style.fontStyle="italic",this._measureElements=[n,a,c,h],this._container.appendChild(n),this._container.appendChild(a),this._container.appendChild(c),this._container.appendChild(h),i.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(t,i,n,a){t===this._font&&i===this._fontSize&&n===this._weight&&a===this._weightBold||(this._font=t,this._fontSize=i,this._weight=n,this._weightBold=a,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${n}`,this._measureElements[1].style.fontWeight=`${a}`,this._measureElements[2].style.fontWeight=`${n}`,this._measureElements[3].style.fontWeight=`${a}`,this.clear())}get(t,i,n){let a=0;if(!i&&!n&&t.length===1&&(a=t.charCodeAt(0))<256){if(this._flat[a]!==-9999)return this._flat[a];let d=this._measure(t,0);return d>0&&(this._flat[a]=d),d}let c=t;i&&(c+="B"),n&&(c+="I");let h=this._holey.get(c);if(h===void 0){let d=0;i&&(d|=1),n&&(d|=2),h=this._measure(t,d),h>0&&this._holey.set(c,h)}return h}_measure(t,i){let n=this._measureElements[i];return n.textContent=t.repeat(32),n.offsetWidth/32}},pC=class{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(t,i,n,a=!1){if(this.selectionStart=i,this.selectionEnd=n,!i||!n||i[0]===n[0]&&i[1]===n[1]){this.clear();return}let c=t.buffers.active.ydisp,h=i[1]-c,d=n[1]-c,p=Math.max(h,0),m=Math.min(d,t.rows-1);if(p>=t.rows||m<0){this.clear();return}this.hasSelection=!0,this.columnSelectMode=a,this.viewportStartRow=h,this.viewportEndRow=d,this.viewportCappedStartRow=p,this.viewportCappedEndRow=m,this.startCol=i[0],this.endCol=n[0]}isCellSelected(t,i,n){return this.hasSelection?(n-=t.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?i>=this.startCol&&n>=this.viewportCappedStartRow&&i<this.endCol&&n<=this.viewportCappedEndRow:i<this.startCol&&n>=this.viewportCappedStartRow&&i>=this.endCol&&n<=this.viewportCappedEndRow:n>this.viewportStartRow&&n<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&n===this.viewportStartRow&&i>=this.startCol&&i<this.endCol||this.viewportStartRow<this.viewportEndRow&&n===this.viewportEndRow&&i<this.endCol||this.viewportStartRow<this.viewportEndRow&&n===this.viewportStartRow&&i>=this.startCol):!1}};function mC(){return new pC}var cu="xterm-dom-renderer-owner-",Ai="xterm-rows",ao="xterm-fg-",gm="xterm-bg-",vl="xterm-focus",oo="xterm-selection",vC=1,Vu=class extends He{constructor(t,i,n,a,c,h,d,p,m,_,y,b,E,R){super(),this._terminal=t,this._document=i,this._element=n,this._screenElement=a,this._viewportElement=c,this._helperContainer=h,this._linkifier2=d,this._charSizeService=m,this._optionsService=_,this._bufferService=y,this._coreService=b,this._coreBrowserService=E,this._themeService=R,this._terminalClass=vC++,this._rowElements=[],this._selectionRenderModel=mC(),this.onRequestRedraw=this._register(new pe).event,this._rowContainer=this._document.createElement("div"),this._rowContainer.classList.add(Ai),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=this._document.createElement("div"),this._selectionContainer.classList.add(oo),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=_C(),this._updateDimensions(),this._register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this._register(this._themeService.onChangeColors(D=>this._injectCss(D))),this._injectCss(this._themeService.colors),this._rowFactory=p.createInstance(Xu,document),this._element.classList.add(cu+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this._register(this._linkifier2.onShowLinkUnderline(D=>this._handleLinkHover(D))),this._register(this._linkifier2.onHideLinkUnderline(D=>this._handleLinkLeave(D))),this._register(nt(()=>{this._element.classList.remove(cu+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new gC(this._document,this._helperContainer),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){let t=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*t,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*t),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/t),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/t),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(let n of this._rowElements)n.style.width=`${this.dimensions.css.canvas.width}px`,n.style.height=`${this.dimensions.css.cell.height}px`,n.style.lineHeight=`${this.dimensions.css.cell.height}px`,n.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));let i=`${this._terminalSelector} .${Ai} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=i,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(t){this._themeStyleElement||(this._themeStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let i=`${this._terminalSelector} .${Ai} { pointer-events: none; color: ${t.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;i+=`${this._terminalSelector} .${Ai} .xterm-dim { color: ${st.multiplyOpacity(t.foreground,.5).css};}`,i+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`;let n=`blink_underline_${this._terminalClass}`,a=`blink_bar_${this._terminalClass}`,c=`blink_block_${this._terminalClass}`;i+=`@keyframes ${n} { 50% {  border-bottom-style: hidden; }}`,i+=`@keyframes ${a} { 50% {  box-shadow: none; }}`,i+=`@keyframes ${c} { 0% {  background-color: ${t.cursor.css};  color: ${t.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${t.cursor.css}; }}`,i+=`${this._terminalSelector} .${Ai}.${vl} .xterm-cursor.xterm-cursor-blink.xterm-cursor-underline { animation: ${n} 1s step-end infinite;}${this._terminalSelector} .${Ai}.${vl} .xterm-cursor.xterm-cursor-blink.xterm-cursor-bar { animation: ${a} 1s step-end infinite;}${this._terminalSelector} .${Ai}.${vl} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: ${c} 1s step-end infinite;}${this._terminalSelector} .${Ai} .xterm-cursor.xterm-cursor-block { background-color: ${t.cursor.css}; color: ${t.cursorAccent.css};}${this._terminalSelector} .${Ai} .xterm-cursor.xterm-cursor-block:not(.xterm-cursor-blink) { background-color: ${t.cursor.css} !important; color: ${t.cursorAccent.css} !important;}${this._terminalSelector} .${Ai} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${t.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${Ai} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${t.cursor.css} inset;}${this._terminalSelector} .${Ai} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${t.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,i+=`${this._terminalSelector} .${oo} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${oo} div { position: absolute; background-color: ${t.selectionBackgroundOpaque.css};}${this._terminalSelector} .${oo} div { position: absolute; background-color: ${t.selectionInactiveBackgroundOpaque.css};}`;for(let[h,d]of t.ansi.entries())i+=`${this._terminalSelector} .${ao}${h} { color: ${d.css}; }${this._terminalSelector} .${ao}${h}.xterm-dim { color: ${st.multiplyOpacity(d,.5).css}; }${this._terminalSelector} .${gm}${h} { background-color: ${d.css}; }`;i+=`${this._terminalSelector} .${ao}257 { color: ${st.opaque(t.background).css}; }${this._terminalSelector} .${ao}257.xterm-dim { color: ${st.multiplyOpacity(st.opaque(t.background),.5).css}; }${this._terminalSelector} .${gm}257 { background-color: ${t.foreground.css}; }`,this._themeStyleElement.textContent=i}_setDefaultSpacing(){let t=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${t}px`,this._rowFactory.defaultSpacing=t}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(t,i){for(let n=this._rowElements.length;n<=i;n++){let a=this._document.createElement("div");this._rowContainer.appendChild(a),this._rowElements.push(a)}for(;this._rowElements.length>i;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(t,i){this._refreshRowElements(t,i),this._updateDimensions(),this.handleSelectionChanged(this._selectionRenderModel.selectionStart,this._selectionRenderModel.selectionEnd,this._selectionRenderModel.columnSelectMode)}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(vl),this.renderRows(0,this._bufferService.rows-1)}handleFocus(){this._rowContainer.classList.add(vl),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(t,i,n){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(t,i,n),this.renderRows(0,this._bufferService.rows-1),!t||!i||(this._selectionRenderModel.update(this._terminal,t,i,n),!this._selectionRenderModel.hasSelection))return;let a=this._selectionRenderModel.viewportStartRow,c=this._selectionRenderModel.viewportEndRow,h=this._selectionRenderModel.viewportCappedStartRow,d=this._selectionRenderModel.viewportCappedEndRow,p=this._document.createDocumentFragment();if(n){let m=t[0]>i[0];p.appendChild(this._createSelectionElement(h,m?i[0]:t[0],m?t[0]:i[0],d-h+1))}else{let m=a===h?t[0]:0,_=h===c?i[0]:this._bufferService.cols;p.appendChild(this._createSelectionElement(h,m,_));let y=d-h-1;if(p.appendChild(this._createSelectionElement(h+1,0,this._bufferService.cols,y)),h!==d){let b=c===d?i[0]:this._bufferService.cols;p.appendChild(this._createSelectionElement(d,0,b))}}this._selectionContainer.appendChild(p)}_createSelectionElement(t,i,n,a=1){let c=this._document.createElement("div"),h=i*this.dimensions.css.cell.width,d=this.dimensions.css.cell.width*(n-i);return h+d>this.dimensions.css.canvas.width&&(d=this.dimensions.css.canvas.width-h),c.style.height=`${a*this.dimensions.css.cell.height}px`,c.style.top=`${t*this.dimensions.css.cell.height}px`,c.style.left=`${h}px`,c.style.width=`${d}px`,c}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(let t of this._rowElements)t.replaceChildren()}renderRows(t,i){let n=this._bufferService.buffer,a=n.ybase+n.y,c=Math.min(n.x,this._bufferService.cols-1),h=this._coreService.decPrivateModes.cursorBlink??this._optionsService.rawOptions.cursorBlink,d=this._coreService.decPrivateModes.cursorStyle??this._optionsService.rawOptions.cursorStyle,p=this._optionsService.rawOptions.cursorInactiveStyle;for(let m=t;m<=i;m++){let _=m+n.ydisp,y=this._rowElements[m],b=n.lines.get(_);if(!y||!b)break;y.replaceChildren(...this._rowFactory.createRow(b,_,_===a,d,p,c,h,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${cu}${this._terminalClass}`}_handleLinkHover(t){this._setCellUnderline(t.x1,t.x2,t.y1,t.y2,t.cols,!0)}_handleLinkLeave(t){this._setCellUnderline(t.x1,t.x2,t.y1,t.y2,t.cols,!1)}_setCellUnderline(t,i,n,a,c,h){n<0&&(t=0),a<0&&(i=0);let d=this._bufferService.rows-1;n=Math.max(Math.min(n,d),0),a=Math.max(Math.min(a,d),0),c=Math.min(c,this._bufferService.cols);let p=this._bufferService.buffer,m=p.ybase+p.y,_=Math.min(p.x,c-1),y=this._optionsService.rawOptions.cursorBlink,b=this._optionsService.rawOptions.cursorStyle,E=this._optionsService.rawOptions.cursorInactiveStyle;for(let R=n;R<=a;++R){let D=R+p.ydisp,k=this._rowElements[R],V=p.lines.get(D);if(!k||!V)break;k.replaceChildren(...this._rowFactory.createRow(V,D,D===m,b,E,_,y,this.dimensions.css.cell.width,this._widthCache,h?R===n?t:0:-1,h?(R===a?i:c)-1:-1))}}};Vu=ft([ve(7,Sd),ve(8,Lo),ve(9,Gt),ve(10,Kt),ve(11,Tr),ve(12,ms),ve(13,Sn)],Vu);var $u=class extends He{constructor(t,i,n){super(),this._optionsService=n,this.width=0,this.height=0,this._onCharSizeChange=this._register(new pe),this.onCharSizeChange=this._onCharSizeChange.event;try{this._measureStrategy=this._register(new SC(this._optionsService))}catch{this._measureStrategy=this._register(new yC(t,i,this._optionsService))}this._register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}get hasValidSize(){return this.width>0&&this.height>0}measure(){let t=this._measureStrategy.measure();(t.width!==this.width||t.height!==this.height)&&(this.width=t.width,this.height=t.height,this._onCharSizeChange.fire())}};$u=ft([ve(2,Gt)],$u);var c0=class extends He{constructor(){super(...arguments),this._result={width:0,height:0}}_validateAndSet(t,i){t!==void 0&&t>0&&i!==void 0&&i>0&&(this._result.width=t,this._result.height=i)}},yC=class extends c0{constructor(t,i,n){super(),this._document=t,this._parentElement=i,this._optionsService=n,this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){return this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`,this._validateAndSet(Number(this._measureElement.offsetWidth)/32,Number(this._measureElement.offsetHeight)),this._result}},SC=class extends c0{constructor(t){super(),this._optionsService=t,this._canvas=new OffscreenCanvas(100,100),this._ctx=this._canvas.getContext("2d");let i=this._ctx.measureText("W");if(!("width"in i&&"fontBoundingBoxAscent"in i&&"fontBoundingBoxDescent"in i))throw new Error("Required font metrics not supported")}measure(){this._ctx.font=`${this._optionsService.rawOptions.fontSize}px ${this._optionsService.rawOptions.fontFamily}`;let t=this._ctx.measureText("W");return this._validateAndSet(t.width,t.fontBoundingBoxAscent+t.fontBoundingBoxDescent),this._result}},bC=class extends He{constructor(t,i,n){super(),this._textarea=t,this._window=i,this.mainDocument=n,this._isFocused=!1,this._cachedIsFocused=void 0,this._screenDprMonitor=this._register(new CC(this._window)),this._onDprChange=this._register(new pe),this.onDprChange=this._onDprChange.event,this._onWindowChange=this._register(new pe),this.onWindowChange=this._onWindowChange.event,this._register(this.onWindowChange(a=>this._screenDprMonitor.setWindow(a))),this._register(jt.forward(this._screenDprMonitor.onDprChange,this._onDprChange)),this._register(Me(this._textarea,"focus",()=>this._isFocused=!0)),this._register(Me(this._textarea,"blur",()=>this._isFocused=!1))}get window(){return this._window}set window(t){this._window!==t&&(this._window=t,this._onWindowChange.fire(this._window))}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}},CC=class extends He{constructor(t){super(),this._parentWindow=t,this._windowResizeListener=this._register(new yn),this._onDprChange=this._register(new pe),this.onDprChange=this._onDprChange.event,this._outerListener=()=>this._setDprAndFireIfDiffers(),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._updateDpr(),this._setWindowResizeListener(),this._register(nt(()=>this.clearListener()))}setWindow(t){this._parentWindow=t,this._setWindowResizeListener(),this._setDprAndFireIfDiffers()}_setWindowResizeListener(){this._windowResizeListener.value=Me(this._parentWindow,"resize",()=>this._setDprAndFireIfDiffers())}_setDprAndFireIfDiffers(){this._parentWindow.devicePixelRatio!==this._currentDevicePixelRatio&&this._onDprChange.fire(this._parentWindow.devicePixelRatio),this._updateDpr()}_updateDpr(){this._outerListener&&(this._resolutionMediaMatchList?.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){!this._resolutionMediaMatchList||!this._outerListener||(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._outerListener=void 0)}},wC=class extends He{constructor(){super(),this.linkProviders=[],this._register(nt(()=>this.linkProviders.length=0))}registerLinkProvider(t){return this.linkProviders.push(t),{dispose:()=>{let i=this.linkProviders.indexOf(t);i!==-1&&this.linkProviders.splice(i,1)}}}};function Rd(t,i,n){let a=n.getBoundingClientRect(),c=t.getComputedStyle(n),h=parseInt(c.getPropertyValue("padding-left")),d=parseInt(c.getPropertyValue("padding-top"));return[i.clientX-a.left-h,i.clientY-a.top-d]}function xC(t,i,n,a,c,h,d,p,m){if(!h)return;let _=Rd(t,i,n);if(_)return _[0]=Math.ceil((_[0]+(m?d/2:0))/d),_[1]=Math.ceil(_[1]/p),_[0]=Math.min(Math.max(_[0],1),a+(m?1:0)),_[1]=Math.min(Math.max(_[1],1),c),_}var Zu=class{constructor(t,i){this._renderService=t,this._charSizeService=i}getCoords(t,i,n,a,c){return xC(window,t,i,n,a,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,c)}getMouseReportCoords(t,i){let n=Rd(window,t,i);if(this._charSizeService.hasValidSize)return n[0]=Math.min(Math.max(n[0],0),this._renderService.dimensions.css.canvas.width-1),n[1]=Math.min(Math.max(n[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(n[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(n[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(n[0]),y:Math.floor(n[1])}}};Zu=ft([ve(0,vs),ve(1,Lo)],Zu);var EC=class{constructor(t,i){this._renderCallback=t,this._coreBrowserService=i,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(t){return this._refreshCallbacks.push(t),this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(t,i,n){this._rowCount=n,t=t!==void 0?t:0,i=i!==void 0?i:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,t):t,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,i):i,!this._animationFrame&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0){this._runRefreshCallbacks();return}let t=Math.max(this._rowStart,0),i=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(t,i),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(let t of this._refreshCallbacks)t(0);this._refreshCallbacks=[]}},h0={};zb(h0,{getSafariVersion:()=>AC,isChromeOS:()=>_0,isFirefox:()=>u0,isIpad:()=>RC,isIphone:()=>DC,isLegacyEdge:()=>TC,isLinux:()=>Dd,isMac:()=>Ao,isNode:()=>Bo,isSafari:()=>d0,isWindows:()=>f0});var Bo=typeof process<"u"&&"title"in process,Ul=Bo?"node":navigator.userAgent,Il=Bo?"node":navigator.platform,u0=Ul.includes("Firefox"),TC=Ul.includes("Edge"),d0=/^((?!chrome|android).)*safari/i.test(Ul);function AC(){if(!d0)return 0;let t=Ul.match(/Version\/(\d+)/);return t===null||t.length<2?0:parseInt(t[1])}var Ao=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(Il),RC=Il==="iPad",DC=Il==="iPhone",f0=["Windows","Win16","Win32","WinCE"].includes(Il),Dd=Il.indexOf("Linux")>=0,_0=/\bCrOS\b/.test(Ul),g0=class{constructor(){this._tasks=[],this._i=0}enqueue(t){this._tasks.push(t),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(t){this._idleCallback=void 0;let i=0,n=0,a=t.timeRemaining(),c=0;for(;this._i<this._tasks.length;){if(i=performance.now(),this._tasks[this._i]()||this._i++,i=Math.max(1,performance.now()-i),n=Math.max(i,n),c=t.timeRemaining(),n*1.5>c){a-i<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(a-i))}ms`),this._start();return}a=c}this.clear()}},kC=class extends g0{_requestCallback(t){return setTimeout(()=>t(this._createDeadline(16)))}_cancelCallback(t){clearTimeout(t)}_createDeadline(t){let i=performance.now()+t;return{timeRemaining:()=>Math.max(0,i-performance.now())}}},MC=class extends g0{_requestCallback(t){return requestIdleCallback(t)}_cancelCallback(t){cancelIdleCallback(t)}},Ro=!Bo&&"requestIdleCallback"in window?MC:kC,LC=class{constructor(){this._queue=new Ro}set(t){this._queue.clear(),this._queue.enqueue(t)}flush(){this._queue.flush()}},Qu=class extends He{constructor(t,i,n,a,c,h,d,p,m){super(),this._rowCount=t,this._optionsService=n,this._charSizeService=a,this._coreService=c,this._coreBrowserService=p,this._renderer=this._register(new yn),this._pausedResizeTask=new LC,this._observerDisposable=this._register(new yn),this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this._register(new pe),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this._register(new pe),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this._register(new pe),this.onRender=this._onRender.event,this._onRefreshRequest=this._register(new pe),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new EC((_,y)=>this._renderRows(_,y),this._coreBrowserService),this._register(this._renderDebouncer),this._syncOutputHandler=new BC(this._coreBrowserService,this._coreService,()=>this._fullRefresh()),this._register(nt(()=>this._syncOutputHandler.dispose())),this._register(this._coreBrowserService.onDprChange(()=>this.handleDevicePixelRatioChange())),this._register(d.onResize(()=>this._fullRefresh())),this._register(d.buffers.onBufferActivate(()=>this._renderer.value?.clear())),this._register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this._register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this._register(h.onDecorationRegistered(()=>this._fullRefresh())),this._register(h.onDecorationRemoved(()=>this._fullRefresh())),this._register(this._optionsService.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio","rescaleOverlappingGlyphs"],()=>{this.clear(),this.handleResize(d.cols,d.rows),this._fullRefresh()})),this._register(this._optionsService.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(d.buffer.y,d.buffer.y,!0))),this._register(m.onChangeColors(()=>this._fullRefresh())),this._registerIntersectionObserver(this._coreBrowserService.window,i),this._register(this._coreBrowserService.onWindowChange(_=>this._registerIntersectionObserver(_,i)))}get dimensions(){return this._renderer.value.dimensions}_registerIntersectionObserver(t,i){if("IntersectionObserver"in t){let n=new t.IntersectionObserver(a=>this._handleIntersectionChange(a[a.length-1]),{threshold:0});n.observe(i),this._observerDisposable.value=nt(()=>n.disconnect())}}_handleIntersectionChange(t){this._isPaused=t.isIntersecting===void 0?t.intersectionRatio===0:!t.isIntersecting,!this._isPaused&&!this._charSizeService.hasValidSize&&this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(t,i,n=!1){if(this._isPaused){this._needsFullRefresh=!0;return}if(this._coreService.decPrivateModes.synchronizedOutput){this._syncOutputHandler.bufferRows(t,i);return}let a=this._syncOutputHandler.flush();a&&(t=Math.min(t,a.start),i=Math.max(i,a.end)),n||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(t,i,this._rowCount)}_renderRows(t,i){if(this._renderer.value){if(this._coreService.decPrivateModes.synchronizedOutput){this._syncOutputHandler.bufferRows(t,i);return}t=Math.min(t,this._rowCount-1),i=Math.min(i,this._rowCount-1),this._renderer.value.renderRows(t,i),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:t,end:i}),this._onRender.fire({start:t,end:i}),this._isNextRenderRedrawOnly=!0}}resize(t,i){this._rowCount=i,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(t){this._renderer.value=t,this._renderer.value&&(this._renderer.value.onRequestRedraw(i=>this.refreshRows(i.start,i.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh())}addRefreshCallback(t){return this._renderDebouncer.addRefreshCallback(t)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){this._renderer.value&&(this._renderer.value.clearTextureAtlas?.(),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(t,i){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.value?.handleResize(t,i)):this._renderer.value.handleResize(t,i),this._fullRefresh())}handleCharSizeChanged(){this._renderer.value?.handleCharSizeChanged()}handleBlur(){this._renderer.value?.handleBlur()}handleFocus(){this._renderer.value?.handleFocus()}handleSelectionChanged(t,i,n){this._selectionState.start=t,this._selectionState.end=i,this._selectionState.columnSelectMode=n,this._renderer.value?.handleSelectionChanged(t,i,n)}handleCursorMove(){this._renderer.value?.handleCursorMove()}clear(){this._renderer.value?.clear()}};Qu=ft([ve(2,Gt),ve(3,Lo),ve(4,Tr),ve(5,Hl),ve(6,Kt),ve(7,ms),ve(8,Sn)],Qu);var BC=class{constructor(t,i,n){this._coreBrowserService=t,this._coreService=i,this._onTimeout=n,this._start=0,this._end=0,this._isBuffering=!1}bufferRows(t,i){this._isBuffering?(this._start=Math.min(this._start,t),this._end=Math.max(this._end,i)):(this._start=t,this._end=i,this._isBuffering=!0),this._timeout===void 0&&(this._timeout=this._coreBrowserService.window.setTimeout(()=>{this._timeout=void 0,this._coreService.decPrivateModes.synchronizedOutput=!1,this._onTimeout()},1e3))}flush(){if(this._timeout!==void 0&&(this._coreBrowserService.window.clearTimeout(this._timeout),this._timeout=void 0),!this._isBuffering)return;let t={start:this._start,end:this._end};return this._isBuffering=!1,t}dispose(){this._timeout!==void 0&&(this._coreBrowserService.window.clearTimeout(this._timeout),this._timeout=void 0)}};function OC(t,i,n,a){let c=n.buffer.x,h=n.buffer.y;if(!n.buffer.hasScrollback)return HC(c,h,t,i,n,a)+Oo(h,i,n,a)+UC(c,h,t,i,n,a);let d;if(h===i)return d=c>t?"D":"C",Ol(Math.abs(c-t),Bl(d,a));d=h>i?"D":"C";let p=Math.abs(h-i),m=NC(h>i?t:c,n)+(p-1)*n.cols+1+zC(h>i?c:t);return Ol(m,Bl(d,a))}function zC(t,i){return t-1}function NC(t,i){return i.cols-t}function HC(t,i,n,a,c,h){return Oo(i,a,c,h).length===0?"":Ol(m0(t,i,t,i-xr(i,c),!1,c).length,Bl("D",h))}function Oo(t,i,n,a){let c=t-xr(t,n),h=i-xr(i,n),d=Math.abs(c-h)-IC(t,i,n);return Ol(d,Bl(p0(t,i),a))}function UC(t,i,n,a,c,h){let d;Oo(i,a,c,h).length>0?d=a-xr(a,c):d=i;let p=a,m=jC(t,i,n,a,c,h);return Ol(m0(t,d,n,p,m==="C",c).length,Bl(m,h))}function IC(t,i,n){let a=0,c=t-xr(t,n),h=i-xr(i,n);for(let d=0;d<Math.abs(c-h);d++){let p=p0(t,i)==="A"?-1:1;n.buffer.lines.get(c+p*d)?.isWrapped&&a++}return a}function xr(t,i){let n=0,a=i.buffer.lines.get(t),c=a?.isWrapped;for(;c&&t>=0&&t<i.rows;)n++,a=i.buffer.lines.get(--t),c=a?.isWrapped;return n}function jC(t,i,n,a,c,h){let d;return Oo(n,a,c,h).length>0?d=a-xr(a,c):d=i,t<n&&d<=a||t>=n&&d<a?"C":"D"}function p0(t,i){return t>i?"A":"B"}function m0(t,i,n,a,c,h){let d=t,p=i,m="";for(;(d!==n||p!==a)&&p>=0&&p<h.buffer.lines.length;)d+=c?1:-1,c&&d>h.cols-1?(m+=h.buffer.translateBufferLineToString(p,!1,t,d),d=0,t=0,p++):!c&&d<0&&(m+=h.buffer.translateBufferLineToString(p,!1,0,t+1),d=h.cols-1,t=d,p--);return m+h.buffer.translateBufferLineToString(p,!1,t,d)}function Bl(t,i){let n=i?"O":"[";return oe.ESC+n+t}function Ol(t,i){t=Math.floor(t);let n="";for(let a=0;a<t;a++)n+=i;return n}var WC=class{constructor(t){this._bufferService=t,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:!this.selectionEnd||!this.selectionStart?this.selectionStart:this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){let t=this.selectionStart[0]+this.selectionStartLength;return t>this._bufferService.cols?t%this._bufferService.cols===0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(t/this._bufferService.cols)-1]:[t%this._bufferService.cols,this.selectionStart[1]+Math.floor(t/this._bufferService.cols)]:[t,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){let t=this.selectionStart[0]+this.selectionStartLength;return t>this._bufferService.cols?[t%this._bufferService.cols,this.selectionStart[1]+Math.floor(t/this._bufferService.cols)]:[Math.max(t,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){let t=this.selectionStart,i=this.selectionEnd;return!t||!i?!1:t[1]>i[1]||t[1]===i[1]&&t[0]>i[0]}handleTrim(t){return this.selectionStart&&(this.selectionStart[1]-=t),this.selectionEnd&&(this.selectionEnd[1]-=t),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}};function pm(t,i){if(t.start.y>t.end.y)throw new Error(`Buffer range end (${t.end.x}, ${t.end.y}) cannot be before start (${t.start.x}, ${t.start.y})`);return i*(t.end.y-t.start.y)+(t.end.x-t.start.x+1)}var hu=50,FC=15,PC=50,YC=500,qC="",KC=new RegExp(qC,"g"),Ju=class extends He{constructor(t,i,n,a,c,h,d,p,m){super(),this._element=t,this._screenElement=i,this._linkifier=n,this._bufferService=a,this._coreService=c,this._mouseService=h,this._optionsService=d,this._renderService=p,this._coreBrowserService=m,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new ki,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this._register(new pe),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this._register(new pe),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this._register(new pe),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this._register(new pe),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=_=>this._handleMouseMove(_),this._mouseUpListener=_=>this._handleMouseUp(_),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(_=>this._handleTrim(_)),this._register(this._bufferService.buffers.onBufferActivate(_=>this._handleBufferActivate(_))),this.enable(),this._model=new WC(this._bufferService),this._activeSelectionMode=0,this._register(nt(()=>{this._removeMouseDownListeners()})),this._register(this._bufferService.onResize(_=>{_.rowsChanged&&this.clearSelection()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){let t=this._model.finalSelectionStart,i=this._model.finalSelectionEnd;return!t||!i?!1:t[0]!==i[0]||t[1]!==i[1]}get selectionText(){let t=this._model.finalSelectionStart,i=this._model.finalSelectionEnd;if(!t||!i)return"";let n=this._bufferService.buffer,a=[];if(this._activeSelectionMode===3){if(t[0]===i[0])return"";let c=t[0]<i[0]?t[0]:i[0],h=t[0]<i[0]?i[0]:t[0];for(let d=t[1];d<=i[1];d++){let p=n.translateBufferLineToString(d,!0,c,h);a.push(p)}}else{let c=t[1]===i[1]?i[0]:void 0;a.push(n.translateBufferLineToString(t[1],!0,t[0],c));for(let h=t[1]+1;h<=i[1]-1;h++){let d=n.lines.get(h),p=n.translateBufferLineToString(h,!0);d?.isWrapped?a[a.length-1]+=p:a.push(p)}if(t[1]!==i[1]){let h=n.lines.get(i[1]),d=n.translateBufferLineToString(i[1],!0,0,i[0]);h&&h.isWrapped?a[a.length-1]+=d:a.push(d)}}return a.map(c=>c.replace(KC," ")).join(f0?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(t){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),Dd&&t&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(t){let i=this._getMouseBufferCoords(t),n=this._model.finalSelectionStart,a=this._model.finalSelectionEnd;return!n||!a||!i?!1:this._areCoordsInSelection(i,n,a)}isCellInSelection(t,i){let n=this._model.finalSelectionStart,a=this._model.finalSelectionEnd;return!n||!a?!1:this._areCoordsInSelection([t,i],n,a)}_areCoordsInSelection(t,i,n){return t[1]>i[1]&&t[1]<n[1]||i[1]===n[1]&&t[1]===i[1]&&t[0]>=i[0]&&t[0]<n[0]||i[1]<n[1]&&t[1]===n[1]&&t[0]<n[0]||i[1]<n[1]&&t[1]===i[1]&&t[0]>=i[0]}_selectWordAtCursor(t,i){let n=this._linkifier.currentLink?.link?.range;if(n)return this._model.selectionStart=[n.start.x-1,n.start.y-1],this._model.selectionStartLength=pm(n,this._bufferService.cols),this._model.selectionEnd=void 0,!0;let a=this._getMouseBufferCoords(t);return a?(this._selectWordAt(a,i),this._model.selectionEnd=void 0,!0):!1}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(t,i){this._model.clearSelection(),t=Math.max(t,0),i=Math.min(i,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,t],this._model.selectionEnd=[this._bufferService.cols,i],this.refresh(),this._onSelectionChange.fire()}_handleTrim(t){this._model.handleTrim(t)&&this.refresh()}_getMouseBufferCoords(t){let i=this._mouseService.getCoords(t,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(i)return i[0]--,i[1]--,i[1]+=this._bufferService.buffer.ydisp,i}_getMouseEventScrollAmount(t){let i=Rd(this._coreBrowserService.window,t,this._screenElement)[1],n=this._renderService.dimensions.css.canvas.height;return i>=0&&i<=n?0:(i>n&&(i-=n),i=Math.min(Math.max(i,-hu),hu),i/=hu,i/Math.abs(i)+Math.round(i*(FC-1)))}shouldForceSelection(t){return Ao?t.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:t.shiftKey}handleMouseDown(t){if(this._mouseDownTimeStamp=t.timeStamp,!(t.button===2&&this.hasSelection)&&t.button===0){if(!this._enabled){if(!this.shouldForceSelection(t))return;t.stopPropagation()}t.preventDefault(),this._dragScrollAmount=0,this._enabled&&t.shiftKey?this._handleIncrementalClick(t):t.detail===1?this._handleSingleClick(t):t.detail===2?this._handleDoubleClick(t):t.detail===3&&this._handleTripleClick(t),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),PC)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(t){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(t))}_handleSingleClick(t){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(t)?3:0,this._model.selectionStart=this._getMouseBufferCoords(t),!this._model.selectionStart)return;this._model.selectionEnd=void 0;let i=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);i&&i.length!==this._model.selectionStart[0]&&i.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(t){this._selectWordAtCursor(t,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(t){let i=this._getMouseBufferCoords(t);i&&(this._activeSelectionMode=2,this._selectLineAt(i[1]))}shouldColumnSelect(t){return t.altKey&&!(Ao&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(t){if(t.stopImmediatePropagation(),!this._model.selectionStart)return;let i=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(t),!this._model.selectionEnd){this.refresh(!0);return}this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(t),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));let n=this._bufferService.buffer;if(this._model.selectionEnd[1]<n.lines.length){let a=n.lines.get(this._model.selectionEnd[1]);a&&a.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]<this._bufferService.cols&&this._model.selectionEnd[0]++}(!i||i[0]!==this._model.selectionEnd[0]||i[1]!==this._model.selectionEnd[1])&&this.refresh(!0)}_dragScroll(){if(!(!this._model.selectionEnd||!this._model.selectionStart)&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});let t=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(t.ydisp+this._bufferService.rows,t.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=t.ydisp),this.refresh()}}_handleMouseUp(t){let i=t.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&i<YC&&t.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){let n=this._mouseService.getCoords(t,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(n&&n[0]!==void 0&&n[1]!==void 0){let a=OC(n[0]-1,n[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(a,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){let t=this._model.finalSelectionStart,i=this._model.finalSelectionEnd,n=!!t&&!!i&&(t[0]!==i[0]||t[1]!==i[1]);if(!n){this._oldHasSelection&&this._fireOnSelectionChange(t,i,n);return}!t||!i||(!this._oldSelectionStart||!this._oldSelectionEnd||t[0]!==this._oldSelectionStart[0]||t[1]!==this._oldSelectionStart[1]||i[0]!==this._oldSelectionEnd[0]||i[1]!==this._oldSelectionEnd[1])&&this._fireOnSelectionChange(t,i,n)}_fireOnSelectionChange(t,i,n){this._oldSelectionStart=t,this._oldSelectionEnd=i,this._oldHasSelection=n,this._onSelectionChange.fire()}_handleBufferActivate(t){this.clearSelection(),this._trimListener.dispose(),this._trimListener=t.activeBuffer.lines.onTrim(i=>this._handleTrim(i))}_convertViewportColToCharacterIndex(t,i){let n=i;for(let a=0;i>=a;a++){let c=t.loadCell(a,this._workCell).getChars().length;this._workCell.getWidth()===0?n--:c>1&&i!==a&&(n+=c-1)}return n}setSelection(t,i,n){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[t,i],this._model.selectionStartLength=n,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(t){this._isClickInSelection(t)||(this._selectWordAtCursor(t,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(t,i,n=!0,a=!0){if(t[0]>=this._bufferService.cols)return;let c=this._bufferService.buffer,h=c.lines.get(t[1]);if(!h)return;let d=c.translateBufferLineToString(t[1],!1),p=this._convertViewportColToCharacterIndex(h,t[0]),m=p,_=t[0]-p,y=0,b=0,E=0,R=0;if(d.charAt(p)===" "){for(;p>0&&d.charAt(p-1)===" ";)p--;for(;m<d.length&&d.charAt(m+1)===" ";)m++}else{let V=t[0],X=t[0];h.getWidth(V)===0&&(y++,V--),h.getWidth(X)===2&&(b++,X++);let he=h.getString(X).length;for(he>1&&(R+=he-1,m+=he-1);V>0&&p>0&&!this._isCharWordSeparator(h.loadCell(V-1,this._workCell));){h.loadCell(V-1,this._workCell);let te=this._workCell.getChars().length;this._workCell.getWidth()===0?(y++,V--):te>1&&(E+=te-1,p-=te-1),p--,V--}for(;X<h.length&&m+1<d.length&&!this._isCharWordSeparator(h.loadCell(X+1,this._workCell));){h.loadCell(X+1,this._workCell);let te=this._workCell.getChars().length;this._workCell.getWidth()===2?(b++,X++):te>1&&(R+=te-1,m+=te-1),m++,X++}}m++;let D=p+_-y+E,k=Math.min(this._bufferService.cols,m-p+y+b-E-R);if(!(!i&&d.slice(p,m).trim()==="")){if(n&&D===0&&h.getCodePoint(0)!==32){let V=c.lines.get(t[1]-1);if(V&&h.isWrapped&&V.getCodePoint(this._bufferService.cols-1)!==32){let X=this._getWordAt([this._bufferService.cols-1,t[1]-1],!1,!0,!1);if(X){let he=this._bufferService.cols-X.start;D-=he,k+=he}}}if(a&&D+k===this._bufferService.cols&&h.getCodePoint(this._bufferService.cols-1)!==32){let V=c.lines.get(t[1]+1);if(V?.isWrapped&&V.getCodePoint(0)!==32){let X=this._getWordAt([0,t[1]+1],!1,!1,!0);X&&(k+=X.length)}}return{start:D,length:k}}}_selectWordAt(t,i){let n=this._getWordAt(t,i);if(n){for(;n.start<0;)n.start+=this._bufferService.cols,t[1]--;this._model.selectionStart=[n.start,t[1]],this._model.selectionStartLength=n.length}}_selectToWordAt(t){let i=this._getWordAt(t,!0);if(i){let n=t[1];for(;i.start<0;)i.start+=this._bufferService.cols,n--;if(!this._model.areSelectionValuesReversed())for(;i.start+i.length>this._bufferService.cols;)i.length-=this._bufferService.cols,n++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?i.start:i.start+i.length,n]}}_isCharWordSeparator(t){return t.getWidth()===0?!1:this._optionsService.rawOptions.wordSeparator.indexOf(t.getChars())>=0}_selectLineAt(t){let i=this._bufferService.buffer.getWrappedRangeForLine(t),n={start:{x:0,y:i.first},end:{x:this._bufferService.cols-1,y:i.last}};this._model.selectionStart=[0,i.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=pm(n,this._bufferService.cols)}};Ju=ft([ve(3,Kt),ve(4,Tr),ve(5,bd),ve(6,Gt),ve(7,vs),ve(8,ms)],Ju);var mm=class{constructor(){this._data={}}set(t,i,n){this._data[t]||(this._data[t]={}),this._data[t][i]=n}get(t,i){return this._data[t]?this._data[t][i]:void 0}clear(){this._data={}}},vm=class{constructor(){this._color=new mm,this._css=new mm}setCss(t,i,n){this._css.set(t,i,n)}getCss(t,i){return this._css.get(t,i)}setColor(t,i,n){this._color.set(t,i,n)}getColor(t,i){return this._color.get(t,i)}clear(){this._color.clear(),this._css.clear()}},xt=Object.freeze((()=>{let t=[at.toColor("#2e3436"),at.toColor("#cc0000"),at.toColor("#4e9a06"),at.toColor("#c4a000"),at.toColor("#3465a4"),at.toColor("#75507b"),at.toColor("#06989a"),at.toColor("#d3d7cf"),at.toColor("#555753"),at.toColor("#ef2929"),at.toColor("#8ae234"),at.toColor("#fce94f"),at.toColor("#729fcf"),at.toColor("#ad7fa8"),at.toColor("#34e2e2"),at.toColor("#eeeeec")],i=[0,95,135,175,215,255];for(let n=0;n<216;n++){let a=i[n/36%6|0],c=i[n/6%6|0],h=i[n%6];t.push({css:Ct.toCss(a,c,h),rgba:Ct.toRgba(a,c,h)})}for(let n=0;n<24;n++){let a=8+n*10;t.push({css:Ct.toCss(a,a,a),rgba:Ct.toRgba(a,a,a)})}return t})()),mr=at.toColor("#ffffff"),Rl=at.toColor("#000000"),ym=at.toColor("#ffffff"),Sm=Rl,yl={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117},GC=mr,ed=class extends He{constructor(t){super(),this._optionsService=t,this._contrastCache=new vm,this._halfContrastCache=new vm,this._onChangeColors=this._register(new pe),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:mr,background:Rl,cursor:ym,cursorAccent:Sm,selectionForeground:void 0,selectionBackgroundTransparent:yl,selectionBackgroundOpaque:st.blend(Rl,yl),selectionInactiveBackgroundTransparent:yl,selectionInactiveBackgroundOpaque:st.blend(Rl,yl),scrollbarSliderBackground:st.opacity(mr,.2),scrollbarSliderHoverBackground:st.opacity(mr,.4),scrollbarSliderActiveBackground:st.opacity(mr,.5),overviewRulerBorder:mr,ansi:xt.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this._register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this._register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}get colors(){return this._colors}_setTheme(t={}){let i=this._colors;if(i.foreground=Qe(t.foreground,mr),i.background=Qe(t.background,Rl),i.cursor=st.blend(i.background,Qe(t.cursor,ym)),i.cursorAccent=st.blend(i.background,Qe(t.cursorAccent,Sm)),i.selectionBackgroundTransparent=Qe(t.selectionBackground,yl),i.selectionBackgroundOpaque=st.blend(i.background,i.selectionBackgroundTransparent),i.selectionInactiveBackgroundTransparent=Qe(t.selectionInactiveBackground,i.selectionBackgroundTransparent),i.selectionInactiveBackgroundOpaque=st.blend(i.background,i.selectionInactiveBackgroundTransparent),i.selectionForeground=t.selectionForeground?Qe(t.selectionForeground,fm):void 0,i.selectionForeground===fm&&(i.selectionForeground=void 0),st.isOpaque(i.selectionBackgroundTransparent)&&(i.selectionBackgroundTransparent=st.opacity(i.selectionBackgroundTransparent,.3)),st.isOpaque(i.selectionInactiveBackgroundTransparent)&&(i.selectionInactiveBackgroundTransparent=st.opacity(i.selectionInactiveBackgroundTransparent,.3)),i.scrollbarSliderBackground=Qe(t.scrollbarSliderBackground,st.opacity(i.foreground,.2)),i.scrollbarSliderHoverBackground=Qe(t.scrollbarSliderHoverBackground,st.opacity(i.foreground,.4)),i.scrollbarSliderActiveBackground=Qe(t.scrollbarSliderActiveBackground,st.opacity(i.foreground,.5)),i.overviewRulerBorder=Qe(t.overviewRulerBorder,GC),i.ansi=xt.slice(),i.ansi[0]=Qe(t.black,xt[0]),i.ansi[1]=Qe(t.red,xt[1]),i.ansi[2]=Qe(t.green,xt[2]),i.ansi[3]=Qe(t.yellow,xt[3]),i.ansi[4]=Qe(t.blue,xt[4]),i.ansi[5]=Qe(t.magenta,xt[5]),i.ansi[6]=Qe(t.cyan,xt[6]),i.ansi[7]=Qe(t.white,xt[7]),i.ansi[8]=Qe(t.brightBlack,xt[8]),i.ansi[9]=Qe(t.brightRed,xt[9]),i.ansi[10]=Qe(t.brightGreen,xt[10]),i.ansi[11]=Qe(t.brightYellow,xt[11]),i.ansi[12]=Qe(t.brightBlue,xt[12]),i.ansi[13]=Qe(t.brightMagenta,xt[13]),i.ansi[14]=Qe(t.brightCyan,xt[14]),i.ansi[15]=Qe(t.brightWhite,xt[15]),t.extendedAnsi){let n=Math.min(i.ansi.length-16,t.extendedAnsi.length);for(let a=0;a<n;a++)i.ansi[a+16]=Qe(t.extendedAnsi[a],xt[a+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(t){this._restoreColor(t),this._onChangeColors.fire(this.colors)}_restoreColor(t){if(t===void 0){for(let i=0;i<this._restoreColors.ansi.length;++i)this._colors.ansi[i]=this._restoreColors.ansi[i];return}switch(t){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[t]=this._restoreColors.ansi[t]}}modifyColors(t){t(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};ed=ft([ve(0,Gt)],ed);function Qe(t,i){if(t!==void 0)try{return at.toColor(t)}catch{}return i}var XC=class{constructor(...t){this._entries=new Map;for(let[i,n]of t)this.set(i,n)}set(t,i){let n=this._entries.get(t);return this._entries.set(t,i),n}forEach(t){for(let[i,n]of this._entries.entries())t(i,n)}has(t){return this._entries.has(t)}get(t){return this._entries.get(t)}},VC=class{constructor(){this._services=new XC,this._services.set(Sd,this)}setService(t,i){this._services.set(t,i)}getService(t){return this._services.get(t)}createInstance(t,...i){let n=Fb(t).sort((h,d)=>h.index-d.index),a=[];for(let h of n){let d=this._services.get(h.id);if(!d)throw new Error(`[createInstance] ${t.name} depends on UNKNOWN service ${h.id._id}.`);a.push(d)}let c=n.length>0?n[0].index:i.length;if(i.length!==c)throw new Error(`[createInstance] First service dependency of ${t.name} at position ${c+1} conflicts with ${i.length} static arguments`);return new t(...i,...a)}},$C={trace:0,debug:1,info:2,warn:3,error:4,off:5},ZC="xterm.js: ",td=class extends He{constructor(t){super(),this._optionsService=t,this._logLevel=5,this._updateLogLevel(),this._register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel()))}get logLevel(){return this._logLevel}_updateLogLevel(){this._logLevel=$C[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(t){for(let i=0;i<t.length;i++)typeof t[i]=="function"&&(t[i]=t[i]())}_log(t,i,n){this._evalLazyOptionalParams(n),t.call(console,(this._optionsService.options.logger?"":ZC)+i,...n)}trace(t,...i){this._logLevel<=0&&this._log(this._optionsService.options.logger?.trace.bind(this._optionsService.options.logger)??console.log,t,i)}debug(t,...i){this._logLevel<=1&&this._log(this._optionsService.options.logger?.debug.bind(this._optionsService.options.logger)??console.log,t,i)}info(t,...i){this._logLevel<=2&&this._log(this._optionsService.options.logger?.info.bind(this._optionsService.options.logger)??console.info,t,i)}warn(t,...i){this._logLevel<=3&&this._log(this._optionsService.options.logger?.warn.bind(this._optionsService.options.logger)??console.warn,t,i)}error(t,...i){this._logLevel<=4&&this._log(this._optionsService.options.logger?.error.bind(this._optionsService.options.logger)??console.error,t,i)}};td=ft([ve(0,Gt)],td);var bm=class extends He{constructor(t){super(),this._maxLength=t,this.onDeleteEmitter=this._register(new pe),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this._register(new pe),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this._register(new pe),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(t){if(this._maxLength===t)return;let i=new Array(t);for(let n=0;n<Math.min(t,this.length);n++)i[n]=this._array[this._getCyclicIndex(n)];this._array=i,this._maxLength=t,this._startIndex=0}get length(){return this._length}set length(t){if(t>this._length)for(let i=this._length;i<t;i++)this._array[i]=void 0;this._length=t}get(t){return this._array[this._getCyclicIndex(t)]}set(t,i){this._array[this._getCyclicIndex(t)]=i}push(t){this._array[this._getCyclicIndex(this._length)]=t,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(t,i,...n){if(i){for(let a=t;a<this._length-i;a++)this._array[this._getCyclicIndex(a)]=this._array[this._getCyclicIndex(a+i)];this._length-=i,this.onDeleteEmitter.fire({index:t,amount:i})}for(let a=this._length-1;a>=t;a--)this._array[this._getCyclicIndex(a+n.length)]=this._array[this._getCyclicIndex(a)];for(let a=0;a<n.length;a++)this._array[this._getCyclicIndex(t+a)]=n[a];if(n.length&&this.onInsertEmitter.fire({index:t,amount:n.length}),this._length+n.length>this._maxLength){let a=this._length+n.length-this._maxLength;this._startIndex+=a,this._length=this._maxLength,this.onTrimEmitter.fire(a)}else this._length+=n.length}trimStart(t){t>this._length&&(t=this._length),this._startIndex+=t,this._length-=t,this.onTrimEmitter.fire(t)}shiftElements(t,i,n){if(!(i<=0)){if(t<0||t>=this._length)throw new Error("start argument out of range");if(t+n<0)throw new Error("Cannot shift elements in list beyond index 0");if(n>0){for(let c=i-1;c>=0;c--)this.set(t+c+n,this.get(t+c));let a=t+i+n-this._length;if(a>0)for(this._length+=a;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let a=0;a<i;a++)this.set(t+a+n,this.get(t+a))}}_getCyclicIndex(t){return(this._startIndex+t)%this._maxLength}},Ne=3,bt=Object.freeze(new Nl),co=0,uu=2,Dl=class v0{constructor(i,n,a=!1){this.isWrapped=a,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(i*Ne);let c=n||ki.fromCharData([0,Hv,1,0]);for(let h=0;h<i;++h)this.setCell(h,c);this.length=i}get(i){let n=this._data[i*Ne+0],a=n&2097151;return[this._data[i*Ne+1],n&2097152?this._combined[i]:a?Xs(a):"",n>>22,n&2097152?this._combined[i].charCodeAt(this._combined[i].length-1):a]}set(i,n){this._data[i*Ne+1]=n[0],n[1].length>1?(this._combined[i]=n[1],this._data[i*Ne+0]=i|2097152|n[2]<<22):this._data[i*Ne+0]=n[1].charCodeAt(0)|n[2]<<22}getWidth(i){return this._data[i*Ne+0]>>22}hasWidth(i){return this._data[i*Ne+0]&12582912}getFg(i){return this._data[i*Ne+1]}getBg(i){return this._data[i*Ne+2]}hasContent(i){return this._data[i*Ne+0]&4194303}getCodePoint(i){let n=this._data[i*Ne+0];return n&2097152?this._combined[i].charCodeAt(this._combined[i].length-1):n&2097151}isCombined(i){return this._data[i*Ne+0]&2097152}getString(i){let n=this._data[i*Ne+0];return n&2097152?this._combined[i]:n&2097151?Xs(n&2097151):""}isProtected(i){return this._data[i*Ne+2]&536870912}loadCell(i,n){return co=i*Ne,n.content=this._data[co+0],n.fg=this._data[co+1],n.bg=this._data[co+2],n.content&2097152&&(n.combinedData=this._combined[i]),n.bg&268435456&&(n.extended=this._extendedAttrs[i]),n}setCell(i,n){n.content&2097152&&(this._combined[i]=n.combinedData),n.bg&268435456&&(this._extendedAttrs[i]=n.extended),this._data[i*Ne+0]=n.content,this._data[i*Ne+1]=n.fg,this._data[i*Ne+2]=n.bg}setCellFromCodepoint(i,n,a,c){c.bg&268435456&&(this._extendedAttrs[i]=c.extended),this._data[i*Ne+0]=n|a<<22,this._data[i*Ne+1]=c.fg,this._data[i*Ne+2]=c.bg}addCodepointToCell(i,n,a){let c=this._data[i*Ne+0];c&2097152?this._combined[i]+=Xs(n):c&2097151?(this._combined[i]=Xs(c&2097151)+Xs(n),c&=-2097152,c|=2097152):c=n|1<<22,a&&(c&=-12582913,c|=a<<22),this._data[i*Ne+0]=c}insertCells(i,n,a){if(i%=this.length,i&&this.getWidth(i-1)===2&&this.setCellFromCodepoint(i-1,0,1,a),n<this.length-i){let c=new ki;for(let h=this.length-i-n-1;h>=0;--h)this.setCell(i+n+h,this.loadCell(i+h,c));for(let h=0;h<n;++h)this.setCell(i+h,a)}else for(let c=i;c<this.length;++c)this.setCell(c,a);this.getWidth(this.length-1)===2&&this.setCellFromCodepoint(this.length-1,0,1,a)}deleteCells(i,n,a){if(i%=this.length,n<this.length-i){let c=new ki;for(let h=0;h<this.length-i-n;++h)this.setCell(i+h,this.loadCell(i+n+h,c));for(let h=this.length-n;h<this.length;++h)this.setCell(h,a)}else for(let c=i;c<this.length;++c)this.setCell(c,a);i&&this.getWidth(i-1)===2&&this.setCellFromCodepoint(i-1,0,1,a),this.getWidth(i)===0&&!this.hasContent(i)&&this.setCellFromCodepoint(i,0,1,a)}replaceCells(i,n,a,c=!1){if(c){for(i&&this.getWidth(i-1)===2&&!this.isProtected(i-1)&&this.setCellFromCodepoint(i-1,0,1,a),n<this.length&&this.getWidth(n-1)===2&&!this.isProtected(n)&&this.setCellFromCodepoint(n,0,1,a);i<n&&i<this.length;)this.isProtected(i)||this.setCell(i,a),i++;return}for(i&&this.getWidth(i-1)===2&&this.setCellFromCodepoint(i-1,0,1,a),n<this.length&&this.getWidth(n-1)===2&&this.setCellFromCodepoint(n,0,1,a);i<n&&i<this.length;)this.setCell(i++,a)}resize(i,n){if(i===this.length)return this._data.length*4*uu<this._data.buffer.byteLength;let a=i*Ne;if(i>this.length){if(this._data.buffer.byteLength>=a*4)this._data=new Uint32Array(this._data.buffer,0,a);else{let c=new Uint32Array(a);c.set(this._data),this._data=c}for(let c=this.length;c<i;++c)this.setCell(c,n)}else{this._data=this._data.subarray(0,a);let c=Object.keys(this._combined);for(let d=0;d<c.length;d++){let p=parseInt(c[d],10);p>=i&&delete this._combined[p]}let h=Object.keys(this._extendedAttrs);for(let d=0;d<h.length;d++){let p=parseInt(h[d],10);p>=i&&delete this._extendedAttrs[p]}}return this.length=i,a*4*uu<this._data.buffer.byteLength}cleanupMemory(){if(this._data.length*4*uu<this._data.buffer.byteLength){let i=new Uint32Array(this._data.length);return i.set(this._data),this._data=i,1}return 0}fill(i,n=!1){if(n){for(let a=0;a<this.length;++a)this.isProtected(a)||this.setCell(a,i);return}this._combined={},this._extendedAttrs={};for(let a=0;a<this.length;++a)this.setCell(a,i)}copyFrom(i){this.length!==i.length?this._data=new Uint32Array(i._data):this._data.set(i._data),this.length=i.length,this._combined={};for(let n in i._combined)this._combined[n]=i._combined[n];this._extendedAttrs={};for(let n in i._extendedAttrs)this._extendedAttrs[n]=i._extendedAttrs[n];this.isWrapped=i.isWrapped}clone(){let i=new v0(0);i._data=new Uint32Array(this._data),i.length=this.length;for(let n in this._combined)i._combined[n]=this._combined[n];for(let n in this._extendedAttrs)i._extendedAttrs[n]=this._extendedAttrs[n];return i.isWrapped=this.isWrapped,i}getTrimmedLength(){for(let i=this.length-1;i>=0;--i)if(this._data[i*Ne+0]&4194303)return i+(this._data[i*Ne+0]>>22);return 0}getNoBgTrimmedLength(){for(let i=this.length-1;i>=0;--i)if(this._data[i*Ne+0]&4194303||this._data[i*Ne+2]&50331648)return i+(this._data[i*Ne+0]>>22);return 0}copyCellsFrom(i,n,a,c,h){let d=i._data;if(h)for(let m=c-1;m>=0;m--){for(let _=0;_<Ne;_++)this._data[(a+m)*Ne+_]=d[(n+m)*Ne+_];d[(n+m)*Ne+2]&268435456&&(this._extendedAttrs[a+m]=i._extendedAttrs[n+m])}else for(let m=0;m<c;m++){for(let _=0;_<Ne;_++)this._data[(a+m)*Ne+_]=d[(n+m)*Ne+_];d[(n+m)*Ne+2]&268435456&&(this._extendedAttrs[a+m]=i._extendedAttrs[n+m])}let p=Object.keys(i._combined);for(let m=0;m<p.length;m++){let _=parseInt(p[m],10);_>=n&&(this._combined[_-n+a]=i._combined[_])}}translateToString(i,n,a,c){n=n??0,a=a??this.length,i&&(a=Math.min(a,this.getTrimmedLength())),c&&(c.length=0);let h="";for(;n<a;){let d=this._data[n*Ne+0],p=d&2097151,m=d&2097152?this._combined[n]:p?Xs(p):Vs;if(h+=m,c)for(let _=0;_<m.length;++_)c.push(n);n+=d>>22||1}return c&&c.push(n),h}};function QC(t,i,n,a,c,h){let d=[];for(let p=0;p<t.length-1;p++){let m=p,_=t.get(++m);if(!_.isWrapped)continue;let y=[t.get(p)];for(;m<t.length&&_.isWrapped;)y.push(_),_=t.get(++m);if(!h&&a>=p&&a<m){p+=y.length-1;continue}let b=0,E=zl(y,b,i),R=1,D=0;for(;R<y.length;){let V=zl(y,R,i),X=V-D,he=n-E,te=Math.min(X,he);y[b].copyCellsFrom(y[R],D,E,te,!1),E+=te,E===n&&(b++,E=0),D+=te,D===V&&(R++,D=0),E===0&&b!==0&&y[b-1].getWidth(n-1)===2&&(y[b].copyCellsFrom(y[b-1],n-1,E++,1,!1),y[b-1].setCell(n-1,c))}y[b].replaceCells(E,n,c);let k=0;for(let V=y.length-1;V>0&&(V>b||y[V].getTrimmedLength()===0);V--)k++;k>0&&(d.push(p+y.length-k),d.push(k)),p+=y.length-1}return d}function JC(t,i){let n=[],a=0,c=i[a],h=0;for(let d=0;d<t.length;d++)if(c===d){let p=i[++a];t.onDeleteEmitter.fire({index:d-h,amount:p}),d+=p-1,h+=p,c=i[++a]}else n.push(d);return{layout:n,countRemoved:h}}function ew(t,i){let n=[];for(let a=0;a<i.length;a++)n.push(t.get(i[a]));for(let a=0;a<n.length;a++)t.set(a,n[a]);t.length=i.length}function tw(t,i,n){let a=[],c=t.map((m,_)=>zl(t,_,i)).reduce((m,_)=>m+_),h=0,d=0,p=0;for(;p<c;){if(c-p<n){a.push(c-p);break}h+=n;let m=zl(t,d,i);h>m&&(h-=m,d++);let _=t[d].getWidth(h-1)===2;_&&h--;let y=_?n-1:n;a.push(y),p+=y}return a}function zl(t,i,n){if(i===t.length-1)return t[i].getTrimmedLength();let a=!t[i].hasContent(n-1)&&t[i].getWidth(n-1)===1,c=t[i+1].getWidth(0)===2;return a&&c?n-1:n}var y0=class S0{constructor(i){this.line=i,this.isDisposed=!1,this._disposables=[],this._id=S0._nextId++,this._onDispose=this.register(new pe),this.onDispose=this._onDispose.event}get id(){return this._id}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),wr(this._disposables),this._disposables.length=0)}register(i){return this._disposables.push(i),i}};y0._nextId=1;var iw=y0,At={},vr=At.B;At[0]={"`":"",a:"",b:"",c:"",d:"",e:"",f:"",g:"",h:"",i:"",j:"",k:"",l:"",m:"",n:"",o:"",p:"",q:"",r:"",s:"",t:"",u:"",v:"",w:"",x:"",y:"",z:"","{":"","|":"","}":"","~":""};At.A={"#":""};At.B=void 0;At[4]={"#":"","@":"","[":"ij","\\":"","]":"|","{":"","|":"f","}":"","~":""};At.C=At[5]={"[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""};At.R={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""};At.Q={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""};At.K={"@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""};At.Y={"#":"","@":"","[":"","\\":"","]":"","`":"","{":"","|":"","}":"","~":""};At.E=At[6]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""};At.Z={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":""};At.H=At[7]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""};At["="]={"#":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":""};var Cm=4294967295,wm=class{constructor(t,i,n){this._hasScrollback=t,this._optionsService=i,this._bufferService=n,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=bt.clone(),this.savedCharset=vr,this.markers=[],this._nullCell=ki.fromCharData([0,Hv,1,0]),this._whitespaceCell=ki.fromCharData([0,Vs,1,32]),this._isClearing=!1,this._memoryCleanupQueue=new Ro,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new bm(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(t){return t?(this._nullCell.fg=t.fg,this._nullCell.bg=t.bg,this._nullCell.extended=t.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new xo),this._nullCell}getWhitespaceCell(t){return t?(this._whitespaceCell.fg=t.fg,this._whitespaceCell.bg=t.bg,this._whitespaceCell.extended=t.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new xo),this._whitespaceCell}getBlankLine(t,i){return new Dl(this._bufferService.cols,this.getNullCell(t),i)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){let t=this.ybase+this.y-this.ydisp;return t>=0&&t<this._rows}_getCorrectBufferLength(t){if(!this._hasScrollback)return t;let i=t+this._optionsService.rawOptions.scrollback;return i>Cm?Cm:i}fillViewportRows(t){if(this.lines.length===0){t===void 0&&(t=bt);let i=this._rows;for(;i--;)this.lines.push(this.getBlankLine(t))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new bm(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(t,i){let n=this.getNullCell(bt),a=0,c=this._getCorrectBufferLength(i);if(c>this.lines.maxLength&&(this.lines.maxLength=c),this.lines.length>0){if(this._cols<t)for(let d=0;d<this.lines.length;d++)a+=+this.lines.get(d).resize(t,n);let h=0;if(this._rows<i)for(let d=this._rows;d<i;d++)this.lines.length<i+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new Dl(t,n)):this.ybase>0&&this.lines.length<=this.ybase+this.y+h+1?(this.ybase--,h++,this.ydisp>0&&this.ydisp--):this.lines.push(new Dl(t,n)));else for(let d=this._rows;d>i;d--)this.lines.length>i+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(c<this.lines.maxLength){let d=this.lines.length-c;d>0&&(this.lines.trimStart(d),this.ybase=Math.max(this.ybase-d,0),this.ydisp=Math.max(this.ydisp-d,0),this.savedY=Math.max(this.savedY-d,0)),this.lines.maxLength=c}this.x=Math.min(this.x,t-1),this.y=Math.min(this.y,i-1),h&&(this.y+=h),this.savedX=Math.min(this.savedX,t-1),this.scrollTop=0}if(this.scrollBottom=i-1,this._isReflowEnabled&&(this._reflow(t,i),this._cols>t))for(let h=0;h<this.lines.length;h++)a+=+this.lines.get(h).resize(t,n);this._cols=t,this._rows=i,this._memoryCleanupQueue.clear(),a>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let t=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,t=!1);let i=0;for(;this._memoryCleanupPosition<this.lines.length;)if(i+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),i>100)return!0;return t}get _isReflowEnabled(){let t=this._optionsService.rawOptions.windowsPty;return t&&t.buildNumber?this._hasScrollback&&t.backend==="conpty"&&t.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(t,i){this._cols!==t&&(t>this._cols?this._reflowLarger(t,i):this._reflowSmaller(t,i))}_reflowLarger(t,i){let n=this._optionsService.rawOptions.reflowCursorLine,a=QC(this.lines,this._cols,t,this.ybase+this.y,this.getNullCell(bt),n);if(a.length>0){let c=JC(this.lines,a);ew(this.lines,c.layout),this._reflowLargerAdjustViewport(t,i,c.countRemoved)}}_reflowLargerAdjustViewport(t,i,n){let a=this.getNullCell(bt),c=n;for(;c-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<i&&this.lines.push(new Dl(t,a))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-n,0)}_reflowSmaller(t,i){let n=this._optionsService.rawOptions.reflowCursorLine,a=this.getNullCell(bt),c=[],h=0;for(let d=this.lines.length-1;d>=0;d--){let p=this.lines.get(d);if(!p||!p.isWrapped&&p.getTrimmedLength()<=t)continue;let m=[p];for(;p.isWrapped&&d>0;)p=this.lines.get(--d),m.unshift(p);if(!n){let te=this.ybase+this.y;if(te>=d&&te<d+m.length)continue}let _=m[m.length-1].getTrimmedLength(),y=tw(m,this._cols,t),b=y.length-m.length,E;this.ybase===0&&this.y!==this.lines.length-1?E=Math.max(0,this.y-this.lines.maxLength+b):E=Math.max(0,this.lines.length-this.lines.maxLength+b);let R=[];for(let te=0;te<b;te++){let ue=this.getBlankLine(bt,!0);R.push(ue)}R.length>0&&(c.push({start:d+m.length+h,newLines:R}),h+=R.length),m.push(...R);let D=y.length-1,k=y[D];k===0&&(D--,k=y[D]);let V=m.length-b-1,X=_;for(;V>=0;){let te=Math.min(X,k);if(m[D]===void 0)break;if(m[D].copyCellsFrom(m[V],X-te,k-te,te,!0),k-=te,k===0&&(D--,k=y[D]),X-=te,X===0){V--;let ue=Math.max(V,0);X=zl(m,ue,this._cols)}}for(let te=0;te<m.length;te++)y[te]<t&&m[te].setCell(y[te],a);let he=b-E;for(;he-- >0;)this.ybase===0?this.y<i-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+h)-i&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+b,this.ybase+i-1)}if(c.length>0){let d=[],p=[];for(let k=0;k<this.lines.length;k++)p.push(this.lines.get(k));let m=this.lines.length,_=m-1,y=0,b=c[y];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+h);let E=0;for(let k=Math.min(this.lines.maxLength-1,m+h-1);k>=0;k--)if(b&&b.start>_+E){for(let V=b.newLines.length-1;V>=0;V--)this.lines.set(k--,b.newLines[V]);k++,d.push({index:_+1,amount:b.newLines.length}),E+=b.newLines.length,b=c[++y]}else this.lines.set(k,p[_--]);let R=0;for(let k=d.length-1;k>=0;k--)d[k].index+=R,this.lines.onInsertEmitter.fire(d[k]),R+=d[k].amount;let D=Math.max(0,m+h-this.lines.maxLength);D>0&&this.lines.onTrimEmitter.fire(D)}}translateBufferLineToString(t,i,n=0,a){let c=this.lines.get(t);return c?c.translateToString(i,n,a):""}getWrappedRangeForLine(t){let i=t,n=t;for(;i>0&&this.lines.get(i).isWrapped;)i--;for(;n+1<this.lines.length&&this.lines.get(n+1).isWrapped;)n++;return{first:i,last:n}}setupTabStops(t){for(t!=null?this.tabs[t]||(t=this.prevStop(t)):(this.tabs={},t=0);t<this._cols;t+=this._optionsService.rawOptions.tabStopWidth)this.tabs[t]=!0}prevStop(t){for(t==null&&(t=this.x);!this.tabs[--t]&&t>0;);return t>=this._cols?this._cols-1:t<0?0:t}nextStop(t){for(t==null&&(t=this.x);!this.tabs[++t]&&t<this._cols;);return t>=this._cols?this._cols-1:t<0?0:t}clearMarkers(t){this._isClearing=!0;for(let i=0;i<this.markers.length;i++)this.markers[i].line===t&&(this.markers[i].dispose(),this.markers.splice(i--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let t=0;t<this.markers.length;t++)this.markers[t].dispose();this.markers.length=0,this._isClearing=!1}addMarker(t){let i=new iw(t);return this.markers.push(i),i.register(this.lines.onTrim(n=>{i.line-=n,i.line<0&&i.dispose()})),i.register(this.lines.onInsert(n=>{i.line>=n.index&&(i.line+=n.amount)})),i.register(this.lines.onDelete(n=>{i.line>=n.index&&i.line<n.index+n.amount&&i.dispose(),i.line>n.index&&(i.line-=n.amount)})),i.register(i.onDispose(()=>this._removeMarker(i))),i}_removeMarker(t){this._isClearing||this.markers.splice(this.markers.indexOf(t),1)}},sw=class extends He{constructor(t,i){super(),this._optionsService=t,this._bufferService=i,this._onBufferActivate=this._register(new pe),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this._register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this._register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new wm(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new wm(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(t){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(t),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(t,i){this._normal.resize(t,i),this._alt.resize(t,i),this.setupTabStops(t)}setupTabStops(t){this._normal.setupTabStops(t),this._alt.setupTabStops(t)}},b0=2,C0=1,id=class extends He{constructor(t){super(),this.isUserScrolling=!1,this._onResize=this._register(new pe),this.onResize=this._onResize.event,this._onScroll=this._register(new pe),this.onScroll=this._onScroll.event,this.cols=Math.max(t.rawOptions.cols||0,b0),this.rows=Math.max(t.rawOptions.rows||0,C0),this.buffers=this._register(new sw(t,this)),this._register(this.buffers.onBufferActivate(i=>{this._onScroll.fire(i.activeBuffer.ydisp)}))}get buffer(){return this.buffers.active}resize(t,i){let n=this.cols!==t,a=this.rows!==i;this.cols=t,this.rows=i,this.buffers.resize(t,i),this._onResize.fire({cols:t,rows:i,colsChanged:n,rowsChanged:a})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(t,i=!1){let n=this.buffer,a;a=this._cachedBlankLine,(!a||a.length!==this.cols||a.getFg(0)!==t.fg||a.getBg(0)!==t.bg)&&(a=n.getBlankLine(t,i),this._cachedBlankLine=a),a.isWrapped=i;let c=n.ybase+n.scrollTop,h=n.ybase+n.scrollBottom;if(n.scrollTop===0){let d=n.lines.isFull;h===n.lines.length-1?d?n.lines.recycle().copyFrom(a):n.lines.push(a.clone()):n.lines.splice(h+1,0,a.clone()),d?this.isUserScrolling&&(n.ydisp=Math.max(n.ydisp-1,0)):(n.ybase++,this.isUserScrolling||n.ydisp++)}else{let d=h-c+1;n.lines.shiftElements(c+1,d-1,-1),n.lines.set(h,a.clone())}this.isUserScrolling||(n.ydisp=n.ybase),this._onScroll.fire(n.ydisp)}scrollLines(t,i){let n=this.buffer;if(t<0){if(n.ydisp===0)return;this.isUserScrolling=!0}else t+n.ydisp>=n.ybase&&(this.isUserScrolling=!1);let a=n.ydisp;n.ydisp=Math.max(Math.min(n.ydisp+t,n.ybase),0),a!==n.ydisp&&(i||this._onScroll.fire(n.ydisp))}};id=ft([ve(0,Gt)],id);var _n={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,documentOverride:null,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnEraseInDisplay:!1,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},reflowCursorLine:!1,rescaleOverlappingGlyphs:!1,rightClickSelectsWord:Ao,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRuler:{}},rw=["normal","bold","100","200","300","400","500","600","700","800","900"],nw=class extends He{constructor(t){super(),this._onOptionChange=this._register(new pe),this.onOptionChange=this._onOptionChange.event;let i={..._n};for(let n in t)if(n in i)try{let a=t[n];i[n]=this._sanitizeAndValidateOption(n,a)}catch(a){console.error(a)}this.rawOptions=i,this.options={...i},this._setupOptions(),this._register(nt(()=>{this.rawOptions.linkHandler=null,this.rawOptions.documentOverride=null}))}onSpecificOptionChange(t,i){return this.onOptionChange(n=>{n===t&&i(this.rawOptions[t])})}onMultipleOptionChange(t,i){return this.onOptionChange(n=>{t.indexOf(n)!==-1&&i()})}_setupOptions(){let t=n=>{if(!(n in _n))throw new Error(`No option with key "${n}"`);return this.rawOptions[n]},i=(n,a)=>{if(!(n in _n))throw new Error(`No option with key "${n}"`);a=this._sanitizeAndValidateOption(n,a),this.rawOptions[n]!==a&&(this.rawOptions[n]=a,this._onOptionChange.fire(n))};for(let n in this.rawOptions){let a={get:t.bind(this,n),set:i.bind(this,n)};Object.defineProperty(this.options,n,a)}}_sanitizeAndValidateOption(t,i){switch(t){case"cursorStyle":if(i||(i=_n[t]),!lw(i))throw new Error(`"${i}" is not a valid value for ${t}`);break;case"wordSeparator":i||(i=_n[t]);break;case"fontWeight":case"fontWeightBold":if(typeof i=="number"&&1<=i&&i<=1e3)break;i=rw.includes(i)?i:_n[t];break;case"cursorWidth":i=Math.floor(i);case"lineHeight":case"tabStopWidth":if(i<1)throw new Error(`${t} cannot be less than 1, value: ${i}`);break;case"minimumContrastRatio":i=Math.max(1,Math.min(21,Math.round(i*10)/10));break;case"scrollback":if(i=Math.min(i,4294967295),i<0)throw new Error(`${t} cannot be less than 0, value: ${i}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(i<=0)throw new Error(`${t} cannot be less than or equal to 0, value: ${i}`);break;case"rows":case"cols":if(!i&&i!==0)throw new Error(`${t} must be numeric, value: ${i}`);break;case"windowsPty":i=i??{};break}return i}};function lw(t){return t==="block"||t==="underline"||t==="bar"}function kl(t,i=5){if(typeof t!="object")return t;let n=Array.isArray(t)?[]:{};for(let a in t)n[a]=i<=1?t[a]:t[a]&&kl(t[a],i-1);return n}var xm=Object.freeze({insertMode:!1}),Em=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,cursorBlink:void 0,cursorStyle:void 0,origin:!1,reverseWraparound:!1,sendFocus:!1,synchronizedOutput:!1,wraparound:!0}),sd=class extends He{constructor(t,i,n){super(),this._bufferService=t,this._logService=i,this._optionsService=n,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this._register(new pe),this.onData=this._onData.event,this._onUserInput=this._register(new pe),this.onUserInput=this._onUserInput.event,this._onBinary=this._register(new pe),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this._register(new pe),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=kl(xm),this.decPrivateModes=kl(Em)}reset(){this.modes=kl(xm),this.decPrivateModes=kl(Em)}triggerDataEvent(t,i=!1){if(this._optionsService.rawOptions.disableStdin)return;let n=this._bufferService.buffer;i&&this._optionsService.rawOptions.scrollOnUserInput&&n.ybase!==n.ydisp&&this._onRequestScrollToBottom.fire(),i&&this._onUserInput.fire(),this._logService.debug(`sending data "${t}"`),this._logService.trace("sending data (codes)",()=>t.split("").map(a=>a.charCodeAt(0))),this._onData.fire(t)}triggerBinaryEvent(t){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${t}"`),this._logService.trace("sending binary (codes)",()=>t.split("").map(i=>i.charCodeAt(0))),this._onBinary.fire(t))}};sd=ft([ve(0,Kt),ve(1,Fv),ve(2,Gt)],sd);var Tm={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:t=>t.button===4||t.action!==1?!1:(t.ctrl=!1,t.alt=!1,t.shift=!1,!0)},VT200:{events:19,restrict:t=>t.action!==32},DRAG:{events:23,restrict:t=>!(t.action===32&&t.button===3)},ANY:{events:31,restrict:t=>!0}};function du(t,i){let n=(t.ctrl?16:0)|(t.shift?4:0)|(t.alt?8:0);return t.button===4?(n|=64,n|=t.action):(n|=t.button&3,t.button&4&&(n|=64),t.button&8&&(n|=128),t.action===32?n|=32:t.action===0&&!i&&(n|=3)),n}var fu=String.fromCharCode,Am={DEFAULT:t=>{let i=[du(t,!1)+32,t.col+32,t.row+32];return i[0]>255||i[1]>255||i[2]>255?"":`\x1B[M${fu(i[0])}${fu(i[1])}${fu(i[2])}`},SGR:t=>{let i=t.action===0&&t.button!==4?"m":"M";return`\x1B[<${du(t,!0)};${t.col};${t.row}${i}`},SGR_PIXELS:t=>{let i=t.action===0&&t.button!==4?"m":"M";return`\x1B[<${du(t,!0)};${t.x};${t.y}${i}`}},rd=class extends He{constructor(t,i,n){super(),this._bufferService=t,this._coreService=i,this._optionsService=n,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._wheelPartialScroll=0,this._onProtocolChange=this._register(new pe),this.onProtocolChange=this._onProtocolChange.event;for(let a of Object.keys(Tm))this.addProtocol(a,Tm[a]);for(let a of Object.keys(Am))this.addEncoding(a,Am[a]);this.reset()}addProtocol(t,i){this._protocols[t]=i}addEncoding(t,i){this._encodings[t]=i}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(t){if(!this._protocols[t])throw new Error(`unknown protocol "${t}"`);this._activeProtocol=t,this._onProtocolChange.fire(this._protocols[t].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(t){if(!this._encodings[t])throw new Error(`unknown encoding "${t}"`);this._activeEncoding=t}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null,this._wheelPartialScroll=0}consumeWheelEvent(t,i,n){if(t.deltaY===0||t.shiftKey||i===void 0||n===void 0)return 0;let a=i/n,c=this._applyScrollModifier(t.deltaY,t);return t.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(c/=a+0,Math.abs(t.deltaY)<50&&(c*=.3),this._wheelPartialScroll+=c,c=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):t.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(c*=this._bufferService.rows),c}_applyScrollModifier(t,i){return i.altKey||i.ctrlKey||i.shiftKey?t*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:t*this._optionsService.rawOptions.scrollSensitivity}triggerMouseEvent(t){if(t.col<0||t.col>=this._bufferService.cols||t.row<0||t.row>=this._bufferService.rows||t.button===4&&t.action===32||t.button===3&&t.action!==32||t.button!==4&&(t.action===2||t.action===3)||(t.col++,t.row++,t.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,t,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(t))return!1;let i=this._encodings[this._activeEncoding](t);return i&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(i):this._coreService.triggerDataEvent(i,!0)),this._lastEvent=t,!0}explainEvents(t){return{down:!!(t&1),up:!!(t&2),drag:!!(t&4),move:!!(t&8),wheel:!!(t&16)}}_equalEvents(t,i,n){if(n){if(t.x!==i.x||t.y!==i.y)return!1}else if(t.col!==i.col||t.row!==i.row)return!1;return!(t.button!==i.button||t.action!==i.action||t.ctrl!==i.ctrl||t.alt!==i.alt||t.shift!==i.shift)}};rd=ft([ve(0,Kt),ve(1,Tr),ve(2,Gt)],rd);var _u=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],aw=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]],Et;function ow(t,i){let n=0,a=i.length-1,c;if(t<i[0][0]||t>i[a][1])return!1;for(;a>=n;)if(c=n+a>>1,t>i[c][1])n=c+1;else if(t<i[c][0])a=c-1;else return!0;return!1}var cw=class{constructor(){if(this.version="6",!Et){Et=new Uint8Array(65536),Et.fill(1),Et[0]=0,Et.fill(0,1,32),Et.fill(0,127,160),Et.fill(2,4352,4448),Et[9001]=2,Et[9002]=2,Et.fill(2,11904,42192),Et[12351]=1,Et.fill(2,44032,55204),Et.fill(2,63744,64256),Et.fill(2,65040,65050),Et.fill(2,65072,65136),Et.fill(2,65280,65377),Et.fill(2,65504,65511);for(let t=0;t<_u.length;++t)Et.fill(0,_u[t][0],_u[t][1]+1)}}wcwidth(t){return t<32?0:t<127?1:t<65536?Et[t]:ow(t,aw)?0:t>=131072&&t<=196605||t>=196608&&t<=262141?2:1}charProperties(t,i){let n=this.wcwidth(t),a=n===0&&i!==0;if(a){let c=Sr.extractWidth(i);c===0?a=!1:c>n&&(n=c)}return Sr.createPropertyValue(0,n,a)}},Sr=class bo{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new pe,this.onChange=this._onChange.event;let i=new cw;this.register(i),this._active=i.version,this._activeProvider=i}static extractShouldJoin(i){return(i&1)!==0}static extractWidth(i){return i>>1&3}static extractCharKind(i){return i>>3}static createPropertyValue(i,n,a=!1){return(i&16777215)<<3|(n&3)<<1|(a?1:0)}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(i){if(!this._providers[i])throw new Error(`unknown Unicode version "${i}"`);this._active=i,this._activeProvider=this._providers[i],this._onChange.fire(i)}register(i){this._providers[i.version]=i}wcwidth(i){return this._activeProvider.wcwidth(i)}getStringCellWidth(i){let n=0,a=0,c=i.length;for(let h=0;h<c;++h){let d=i.charCodeAt(h);if(55296<=d&&d<=56319){if(++h>=c)return n+this.wcwidth(d);let _=i.charCodeAt(h);56320<=_&&_<=57343?d=(d-55296)*1024+_-56320+65536:n+=this.wcwidth(_)}let p=this.charProperties(d,a),m=bo.extractWidth(p);bo.extractShouldJoin(p)&&(m-=bo.extractWidth(a)),n+=m,a=p}return n}charProperties(i,n){return this._activeProvider.charProperties(i,n)}},hw=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(t){this.glevel=t,this.charset=this._charsets[t]}setgCharset(t,i){this._charsets[t]=i,this.glevel===t&&(this.charset=i)}};function Rm(t){let i=t.buffer.lines.get(t.buffer.ybase+t.buffer.y-1)?.get(t.cols-1),n=t.buffer.lines.get(t.buffer.ybase+t.buffer.y);n&&i&&(n.isWrapped=i[3]!==0&&i[3]!==32)}var Sl=2147483647,uw=256,w0=class nd{constructor(i=32,n=32){if(this.maxLength=i,this.maxSubParamsLength=n,n>uw)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(i),this.length=0,this._subParams=new Int32Array(n),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(i),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}static fromArray(i){let n=new nd;if(!i.length)return n;for(let a=Array.isArray(i[0])?1:0;a<i.length;++a){let c=i[a];if(Array.isArray(c))for(let h=0;h<c.length;++h)n.addSubParam(c[h]);else n.addParam(c)}return n}clone(){let i=new nd(this.maxLength,this.maxSubParamsLength);return i.params.set(this.params),i.length=this.length,i._subParams.set(this._subParams),i._subParamsLength=this._subParamsLength,i._subParamsIdx.set(this._subParamsIdx),i._rejectDigits=this._rejectDigits,i._rejectSubDigits=this._rejectSubDigits,i._digitIsSub=this._digitIsSub,i}toArray(){let i=[];for(let n=0;n<this.length;++n){i.push(this.params[n]);let a=this._subParamsIdx[n]>>8,c=this._subParamsIdx[n]&255;c-a>0&&i.push(Array.prototype.slice.call(this._subParams,a,c))}return i}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(i){if(this._digitIsSub=!1,this.length>=this.maxLength){this._rejectDigits=!0;return}if(i<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=i>Sl?Sl:i}addSubParam(i){if(this._digitIsSub=!0,!!this.length){if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength){this._rejectSubDigits=!0;return}if(i<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=i>Sl?Sl:i,this._subParamsIdx[this.length-1]++}}hasSubParams(i){return(this._subParamsIdx[i]&255)-(this._subParamsIdx[i]>>8)>0}getSubParams(i){let n=this._subParamsIdx[i]>>8,a=this._subParamsIdx[i]&255;return a-n>0?this._subParams.subarray(n,a):null}getSubParamsAll(){let i={};for(let n=0;n<this.length;++n){let a=this._subParamsIdx[n]>>8,c=this._subParamsIdx[n]&255;c-a>0&&(i[n]=this._subParams.slice(a,c))}return i}addDigit(i){let n;if(this._rejectDigits||!(n=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;let a=this._digitIsSub?this._subParams:this.params,c=a[n-1];a[n-1]=~c?Math.min(c*10+i,Sl):i}},bl=[],dw=class{constructor(){this._state=0,this._active=bl,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(t,i){this._handlers[t]===void 0&&(this._handlers[t]=[]);let n=this._handlers[t];return n.push(i),{dispose:()=>{let a=n.indexOf(i);a!==-1&&n.splice(a,1)}}}clearHandler(t){this._handlers[t]&&delete this._handlers[t]}setHandlerFallback(t){this._handlerFb=t}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=bl}reset(){if(this._state===2)for(let t=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;t>=0;--t)this._active[t].end(!1);this._stack.paused=!1,this._active=bl,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||bl,!this._active.length)this._handlerFb(this._id,"START");else for(let t=this._active.length-1;t>=0;t--)this._active[t].start()}_put(t,i,n){if(!this._active.length)this._handlerFb(this._id,"PUT",Mo(t,i,n));else for(let a=this._active.length-1;a>=0;a--)this._active[a].put(t,i,n)}start(){this.reset(),this._state=1}put(t,i,n){if(this._state!==3){if(this._state===1)for(;i<n;){let a=t[i++];if(a===59){this._state=2,this._start();break}if(a<48||57<a){this._state=3;return}this._id===-1&&(this._id=0),this._id=this._id*10+a-48}this._state===2&&n-i>0&&this._put(t,i,n)}}end(t,i=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),!this._active.length)this._handlerFb(this._id,"END",t);else{let n=!1,a=this._active.length-1,c=!1;if(this._stack.paused&&(a=this._stack.loopPosition-1,n=i,c=this._stack.fallThrough,this._stack.paused=!1),!c&&n===!1){for(;a>=0&&(n=this._active[a].end(t),n!==!0);a--)if(n instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=a,this._stack.fallThrough=!1,n;a--}for(;a>=0;a--)if(n=this._active[a].end(!1),n instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=a,this._stack.fallThrough=!0,n}this._active=bl,this._id=-1,this._state=0}}},gi=class{constructor(t){this._handler=t,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(t,i,n){this._hitLimit||(this._data+=Mo(t,i,n),this._data.length>1e7&&(this._data="",this._hitLimit=!0))}end(t){let i=!1;if(this._hitLimit)i=!1;else if(t&&(i=this._handler(this._data),i instanceof Promise))return i.then(n=>(this._data="",this._hitLimit=!1,n));return this._data="",this._hitLimit=!1,i}},Cl=[],fw=class{constructor(){this._handlers=Object.create(null),this._active=Cl,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=Cl}registerHandler(t,i){this._handlers[t]===void 0&&(this._handlers[t]=[]);let n=this._handlers[t];return n.push(i),{dispose:()=>{let a=n.indexOf(i);a!==-1&&n.splice(a,1)}}}clearHandler(t){this._handlers[t]&&delete this._handlers[t]}setHandlerFallback(t){this._handlerFb=t}reset(){if(this._active.length)for(let t=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;t>=0;--t)this._active[t].unhook(!1);this._stack.paused=!1,this._active=Cl,this._ident=0}hook(t,i){if(this.reset(),this._ident=t,this._active=this._handlers[t]||Cl,!this._active.length)this._handlerFb(this._ident,"HOOK",i);else for(let n=this._active.length-1;n>=0;n--)this._active[n].hook(i)}put(t,i,n){if(!this._active.length)this._handlerFb(this._ident,"PUT",Mo(t,i,n));else for(let a=this._active.length-1;a>=0;a--)this._active[a].put(t,i,n)}unhook(t,i=!0){if(!this._active.length)this._handlerFb(this._ident,"UNHOOK",t);else{let n=!1,a=this._active.length-1,c=!1;if(this._stack.paused&&(a=this._stack.loopPosition-1,n=i,c=this._stack.fallThrough,this._stack.paused=!1),!c&&n===!1){for(;a>=0&&(n=this._active[a].unhook(t),n!==!0);a--)if(n instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=a,this._stack.fallThrough=!1,n;a--}for(;a>=0;a--)if(n=this._active[a].unhook(!1),n instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=a,this._stack.fallThrough=!0,n}this._active=Cl,this._ident=0}},Ml=new w0;Ml.addParam(0);var Dm=class{constructor(t){this._handler=t,this._data="",this._params=Ml,this._hitLimit=!1}hook(t){this._params=t.length>1||t.params[0]?t.clone():Ml,this._data="",this._hitLimit=!1}put(t,i,n){this._hitLimit||(this._data+=Mo(t,i,n),this._data.length>1e7&&(this._data="",this._hitLimit=!0))}unhook(t){let i=!1;if(this._hitLimit)i=!1;else if(t&&(i=this._handler(this._data,this._params),i instanceof Promise))return i.then(n=>(this._params=Ml,this._data="",this._hitLimit=!1,n));return this._params=Ml,this._data="",this._hitLimit=!1,i}},_w=class{constructor(t){this.table=new Uint8Array(t)}setDefault(t,i){this.table.fill(t<<4|i)}add(t,i,n,a){this.table[i<<8|t]=n<<4|a}addMany(t,i,n,a){for(let c=0;c<t.length;c++)this.table[i<<8|t[c]]=n<<4|a}},Di=160,gw=(function(){let t=new _w(4095),i=Array.apply(null,Array(256)).map((p,m)=>m),n=(p,m)=>i.slice(p,m),a=n(32,127),c=n(0,24);c.push(25),c.push.apply(c,n(28,32));let h=n(0,14),d;t.setDefault(1,0),t.addMany(a,0,2,0);for(d in h)t.addMany([24,26,153,154],d,3,0),t.addMany(n(128,144),d,3,0),t.addMany(n(144,152),d,3,0),t.add(156,d,0,0),t.add(27,d,11,1),t.add(157,d,4,8),t.addMany([152,158,159],d,0,7),t.add(155,d,11,3),t.add(144,d,11,9);return t.addMany(c,0,3,0),t.addMany(c,1,3,1),t.add(127,1,0,1),t.addMany(c,8,0,8),t.addMany(c,3,3,3),t.add(127,3,0,3),t.addMany(c,4,3,4),t.add(127,4,0,4),t.addMany(c,6,3,6),t.addMany(c,5,3,5),t.add(127,5,0,5),t.addMany(c,2,3,2),t.add(127,2,0,2),t.add(93,1,4,8),t.addMany(a,8,5,8),t.add(127,8,5,8),t.addMany([156,27,24,26,7],8,6,0),t.addMany(n(28,32),8,0,8),t.addMany([88,94,95],1,0,7),t.addMany(a,7,0,7),t.addMany(c,7,0,7),t.add(156,7,0,0),t.add(127,7,0,7),t.add(91,1,11,3),t.addMany(n(64,127),3,7,0),t.addMany(n(48,60),3,8,4),t.addMany([60,61,62,63],3,9,4),t.addMany(n(48,60),4,8,4),t.addMany(n(64,127),4,7,0),t.addMany([60,61,62,63],4,0,6),t.addMany(n(32,64),6,0,6),t.add(127,6,0,6),t.addMany(n(64,127),6,0,0),t.addMany(n(32,48),3,9,5),t.addMany(n(32,48),5,9,5),t.addMany(n(48,64),5,0,6),t.addMany(n(64,127),5,7,0),t.addMany(n(32,48),4,9,5),t.addMany(n(32,48),1,9,2),t.addMany(n(32,48),2,9,2),t.addMany(n(48,127),2,10,0),t.addMany(n(48,80),1,10,0),t.addMany(n(81,88),1,10,0),t.addMany([89,90,92],1,10,0),t.addMany(n(96,127),1,10,0),t.add(80,1,11,9),t.addMany(c,9,0,9),t.add(127,9,0,9),t.addMany(n(28,32),9,0,9),t.addMany(n(32,48),9,9,12),t.addMany(n(48,60),9,8,10),t.addMany([60,61,62,63],9,9,10),t.addMany(c,11,0,11),t.addMany(n(32,128),11,0,11),t.addMany(n(28,32),11,0,11),t.addMany(c,10,0,10),t.add(127,10,0,10),t.addMany(n(28,32),10,0,10),t.addMany(n(48,60),10,8,10),t.addMany([60,61,62,63],10,0,11),t.addMany(n(32,48),10,9,12),t.addMany(c,12,0,12),t.add(127,12,0,12),t.addMany(n(28,32),12,0,12),t.addMany(n(32,48),12,9,12),t.addMany(n(48,64),12,0,11),t.addMany(n(64,127),12,12,13),t.addMany(n(64,127),10,12,13),t.addMany(n(64,127),9,12,13),t.addMany(c,13,13,13),t.addMany(a,13,13,13),t.add(127,13,0,13),t.addMany([27,156,24,26],13,14,0),t.add(Di,0,2,0),t.add(Di,8,5,8),t.add(Di,6,0,6),t.add(Di,11,0,11),t.add(Di,13,13,13),t})(),pw=class extends He{constructor(t=gw){super(),this._transitions=t,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new w0,this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._printHandlerFb=(i,n,a)=>{},this._executeHandlerFb=i=>{},this._csiHandlerFb=(i,n)=>{},this._escHandlerFb=i=>{},this._errorHandlerFb=i=>i,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this._register(nt(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this._register(new dw),this._dcsParser=this._register(new fw),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(t,i=[64,126]){let n=0;if(t.prefix){if(t.prefix.length>1)throw new Error("only one byte as prefix supported");if(n=t.prefix.charCodeAt(0),n&&60>n||n>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(t.intermediates){if(t.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let c=0;c<t.intermediates.length;++c){let h=t.intermediates.charCodeAt(c);if(32>h||h>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");n<<=8,n|=h}}if(t.final.length!==1)throw new Error("final must be a single byte");let a=t.final.charCodeAt(0);if(i[0]>a||a>i[1])throw new Error(`final must be in range ${i[0]} .. ${i[1]}`);return n<<=8,n|=a,n}identToString(t){let i=[];for(;t;)i.push(String.fromCharCode(t&255)),t>>=8;return i.reverse().join("")}setPrintHandler(t){this._printHandler=t}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(t,i){let n=this._identifier(t,[48,126]);this._escHandlers[n]===void 0&&(this._escHandlers[n]=[]);let a=this._escHandlers[n];return a.push(i),{dispose:()=>{let c=a.indexOf(i);c!==-1&&a.splice(c,1)}}}clearEscHandler(t){this._escHandlers[this._identifier(t,[48,126])]&&delete this._escHandlers[this._identifier(t,[48,126])]}setEscHandlerFallback(t){this._escHandlerFb=t}setExecuteHandler(t,i){this._executeHandlers[t.charCodeAt(0)]=i}clearExecuteHandler(t){this._executeHandlers[t.charCodeAt(0)]&&delete this._executeHandlers[t.charCodeAt(0)]}setExecuteHandlerFallback(t){this._executeHandlerFb=t}registerCsiHandler(t,i){let n=this._identifier(t);this._csiHandlers[n]===void 0&&(this._csiHandlers[n]=[]);let a=this._csiHandlers[n];return a.push(i),{dispose:()=>{let c=a.indexOf(i);c!==-1&&a.splice(c,1)}}}clearCsiHandler(t){this._csiHandlers[this._identifier(t)]&&delete this._csiHandlers[this._identifier(t)]}setCsiHandlerFallback(t){this._csiHandlerFb=t}registerDcsHandler(t,i){return this._dcsParser.registerHandler(this._identifier(t),i)}clearDcsHandler(t){this._dcsParser.clearHandler(this._identifier(t))}setDcsHandlerFallback(t){this._dcsParser.setHandlerFallback(t)}registerOscHandler(t,i){return this._oscParser.registerHandler(t,i)}clearOscHandler(t){this._oscParser.clearHandler(t)}setOscHandlerFallback(t){this._oscParser.setHandlerFallback(t)}setErrorHandler(t){this._errorHandler=t}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(t,i,n,a,c){this._parseStack.state=t,this._parseStack.handlers=i,this._parseStack.handlerPos=n,this._parseStack.transition=a,this._parseStack.chunkPos=c}parse(t,i,n){let a=0,c=0,h=0,d;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,h=this._parseStack.chunkPos+1;else{if(n===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");let p=this._parseStack.handlers,m=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(n===!1&&m>-1){for(;m>=0&&(d=p[m](this._params),d!==!0);m--)if(d instanceof Promise)return this._parseStack.handlerPos=m,d}this._parseStack.handlers=[];break;case 4:if(n===!1&&m>-1){for(;m>=0&&(d=p[m](),d!==!0);m--)if(d instanceof Promise)return this._parseStack.handlerPos=m,d}this._parseStack.handlers=[];break;case 6:if(a=t[this._parseStack.chunkPos],d=this._dcsParser.unhook(a!==24&&a!==26,n),d)return d;a===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(a=t[this._parseStack.chunkPos],d=this._oscParser.end(a!==24&&a!==26,n),d)return d;a===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break}this._parseStack.state=0,h=this._parseStack.chunkPos+1,this.precedingJoinState=0,this.currentState=this._parseStack.transition&15}for(let p=h;p<i;++p){switch(a=t[p],c=this._transitions.table[this.currentState<<8|(a<160?a:Di)],c>>4){case 2:for(let E=p+1;;++E){if(E>=i||(a=t[E])<32||a>126&&a<Di){this._printHandler(t,p,E),p=E-1;break}if(++E>=i||(a=t[E])<32||a>126&&a<Di){this._printHandler(t,p,E),p=E-1;break}if(++E>=i||(a=t[E])<32||a>126&&a<Di){this._printHandler(t,p,E),p=E-1;break}if(++E>=i||(a=t[E])<32||a>126&&a<Di){this._printHandler(t,p,E),p=E-1;break}}break;case 3:this._executeHandlers[a]?this._executeHandlers[a]():this._executeHandlerFb(a),this.precedingJoinState=0;break;case 0:break;case 1:if(this._errorHandler({position:p,code:a,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:let m=this._csiHandlers[this._collect<<8|a],_=m?m.length-1:-1;for(;_>=0&&(d=m[_](this._params),d!==!0);_--)if(d instanceof Promise)return this._preserveStack(3,m,_,c,p),d;_<0&&this._csiHandlerFb(this._collect<<8|a,this._params),this.precedingJoinState=0;break;case 8:do switch(a){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(a-48)}while(++p<i&&(a=t[p])>47&&a<60);p--;break;case 9:this._collect<<=8,this._collect|=a;break;case 10:let y=this._escHandlers[this._collect<<8|a],b=y?y.length-1:-1;for(;b>=0&&(d=y[b](),d!==!0);b--)if(d instanceof Promise)return this._preserveStack(4,y,b,c,p),d;b<0&&this._escHandlerFb(this._collect<<8|a),this.precedingJoinState=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|a,this._params);break;case 13:for(let E=p+1;;++E)if(E>=i||(a=t[E])===24||a===26||a===27||a>127&&a<Di){this._dcsParser.put(t,p,E),p=E-1;break}break;case 14:if(d=this._dcsParser.unhook(a!==24&&a!==26),d)return this._preserveStack(6,[],0,c,p),d;a===27&&(c|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break;case 4:this._oscParser.start();break;case 5:for(let E=p+1;;E++)if(E>=i||(a=t[E])<32||a>127&&a<Di){this._oscParser.put(t,p,E),p=E-1;break}break;case 6:if(d=this._oscParser.end(a!==24&&a!==26),d)return this._preserveStack(5,[],0,c,p),d;a===27&&(c|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break}this.currentState=c&15}}},mw=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,vw=/^[\da-f]+$/;function km(t){if(!t)return;let i=t.toLowerCase();if(i.indexOf("rgb:")===0){i=i.slice(4);let n=mw.exec(i);if(n){let a=n[1]?15:n[4]?255:n[7]?4095:65535;return[Math.round(parseInt(n[1]||n[4]||n[7]||n[10],16)/a*255),Math.round(parseInt(n[2]||n[5]||n[8]||n[11],16)/a*255),Math.round(parseInt(n[3]||n[6]||n[9]||n[12],16)/a*255)]}}else if(i.indexOf("#")===0&&(i=i.slice(1),vw.exec(i)&&[3,6,9,12].includes(i.length))){let n=i.length/3,a=[0,0,0];for(let c=0;c<3;++c){let h=parseInt(i.slice(n*c,n*c+n),16);a[c]=n===1?h<<4:n===2?h:n===3?h>>4:h>>8}return a}}function gu(t,i){let n=t.toString(16),a=n.length<2?"0"+n:n;switch(i){case 4:return n[0];case 8:return a;case 12:return(a+a).slice(0,3);default:return a+a}}function yw(t,i=16){let[n,a,c]=t;return`rgb:${gu(n,i)}/${gu(a,i)}/${gu(c,i)}`}var Sw={"(":0,")":1,"*":2,"+":3,"-":1,".":2},Ks=131072,Mm=10;function Lm(t,i){if(t>24)return i.setWinLines||!1;switch(t){case 1:return!!i.restoreWin;case 2:return!!i.minimizeWin;case 3:return!!i.setWinPosition;case 4:return!!i.setWinSizePixels;case 5:return!!i.raiseWin;case 6:return!!i.lowerWin;case 7:return!!i.refreshWin;case 8:return!!i.setWinSizeChars;case 9:return!!i.maximizeWin;case 10:return!!i.fullscreenWin;case 11:return!!i.getWinState;case 13:return!!i.getWinPosition;case 14:return!!i.getWinSizePixels;case 15:return!!i.getScreenSizePixels;case 16:return!!i.getCellSizePixels;case 18:return!!i.getWinSizeChars;case 19:return!!i.getScreenSizeChars;case 20:return!!i.getIconTitle;case 21:return!!i.getWinTitle;case 22:return!!i.pushTitle;case 23:return!!i.popTitle;case 24:return!!i.setWinLines}return!1}var Bm=5e3,Om=0,bw=class extends He{constructor(t,i,n,a,c,h,d,p,m=new pw){super(),this._bufferService=t,this._charsetService=i,this._coreService=n,this._logService=a,this._optionsService=c,this._oscLinkService=h,this._coreMouseService=d,this._unicodeService=p,this._parser=m,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new jb,this._utf8Decoder=new Wb,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=bt.clone(),this._eraseAttrDataInternal=bt.clone(),this._onRequestBell=this._register(new pe),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this._register(new pe),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this._register(new pe),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this._register(new pe),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this._register(new pe),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this._register(new pe),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this._register(new pe),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this._register(new pe),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this._register(new pe),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this._register(new pe),this.onLineFeed=this._onLineFeed.event,this._onScroll=this._register(new pe),this.onScroll=this._onScroll.event,this._onTitleChange=this._register(new pe),this.onTitleChange=this._onTitleChange.event,this._onColor=this._register(new pe),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this._register(this._parser),this._dirtyRowTracker=new ld(this._bufferService),this._activeBuffer=this._bufferService.buffer,this._register(this._bufferService.buffers.onBufferActivate(_=>this._activeBuffer=_.activeBuffer)),this._parser.setCsiHandlerFallback((_,y)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(_),params:y.toArray()})}),this._parser.setEscHandlerFallback(_=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(_)})}),this._parser.setExecuteHandlerFallback(_=>{this._logService.debug("Unknown EXECUTE code: ",{code:_})}),this._parser.setOscHandlerFallback((_,y,b)=>{this._logService.debug("Unknown OSC code: ",{identifier:_,action:y,data:b})}),this._parser.setDcsHandlerFallback((_,y,b)=>{y==="HOOK"&&(b=b.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(_),action:y,payload:b})}),this._parser.setPrintHandler((_,y,b)=>this.print(_,y,b)),this._parser.registerCsiHandler({final:"@"},_=>this.insertChars(_)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},_=>this.scrollLeft(_)),this._parser.registerCsiHandler({final:"A"},_=>this.cursorUp(_)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},_=>this.scrollRight(_)),this._parser.registerCsiHandler({final:"B"},_=>this.cursorDown(_)),this._parser.registerCsiHandler({final:"C"},_=>this.cursorForward(_)),this._parser.registerCsiHandler({final:"D"},_=>this.cursorBackward(_)),this._parser.registerCsiHandler({final:"E"},_=>this.cursorNextLine(_)),this._parser.registerCsiHandler({final:"F"},_=>this.cursorPrecedingLine(_)),this._parser.registerCsiHandler({final:"G"},_=>this.cursorCharAbsolute(_)),this._parser.registerCsiHandler({final:"H"},_=>this.cursorPosition(_)),this._parser.registerCsiHandler({final:"I"},_=>this.cursorForwardTab(_)),this._parser.registerCsiHandler({final:"J"},_=>this.eraseInDisplay(_,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},_=>this.eraseInDisplay(_,!0)),this._parser.registerCsiHandler({final:"K"},_=>this.eraseInLine(_,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},_=>this.eraseInLine(_,!0)),this._parser.registerCsiHandler({final:"L"},_=>this.insertLines(_)),this._parser.registerCsiHandler({final:"M"},_=>this.deleteLines(_)),this._parser.registerCsiHandler({final:"P"},_=>this.deleteChars(_)),this._parser.registerCsiHandler({final:"S"},_=>this.scrollUp(_)),this._parser.registerCsiHandler({final:"T"},_=>this.scrollDown(_)),this._parser.registerCsiHandler({final:"X"},_=>this.eraseChars(_)),this._parser.registerCsiHandler({final:"Z"},_=>this.cursorBackwardTab(_)),this._parser.registerCsiHandler({final:"`"},_=>this.charPosAbsolute(_)),this._parser.registerCsiHandler({final:"a"},_=>this.hPositionRelative(_)),this._parser.registerCsiHandler({final:"b"},_=>this.repeatPrecedingCharacter(_)),this._parser.registerCsiHandler({final:"c"},_=>this.sendDeviceAttributesPrimary(_)),this._parser.registerCsiHandler({prefix:">",final:"c"},_=>this.sendDeviceAttributesSecondary(_)),this._parser.registerCsiHandler({final:"d"},_=>this.linePosAbsolute(_)),this._parser.registerCsiHandler({final:"e"},_=>this.vPositionRelative(_)),this._parser.registerCsiHandler({final:"f"},_=>this.hVPosition(_)),this._parser.registerCsiHandler({final:"g"},_=>this.tabClear(_)),this._parser.registerCsiHandler({final:"h"},_=>this.setMode(_)),this._parser.registerCsiHandler({prefix:"?",final:"h"},_=>this.setModePrivate(_)),this._parser.registerCsiHandler({final:"l"},_=>this.resetMode(_)),this._parser.registerCsiHandler({prefix:"?",final:"l"},_=>this.resetModePrivate(_)),this._parser.registerCsiHandler({final:"m"},_=>this.charAttributes(_)),this._parser.registerCsiHandler({final:"n"},_=>this.deviceStatus(_)),this._parser.registerCsiHandler({prefix:"?",final:"n"},_=>this.deviceStatusPrivate(_)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},_=>this.softReset(_)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},_=>this.setCursorStyle(_)),this._parser.registerCsiHandler({final:"r"},_=>this.setScrollRegion(_)),this._parser.registerCsiHandler({final:"s"},_=>this.saveCursor(_)),this._parser.registerCsiHandler({final:"t"},_=>this.windowOptions(_)),this._parser.registerCsiHandler({final:"u"},_=>this.restoreCursor(_)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},_=>this.insertColumns(_)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},_=>this.deleteColumns(_)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},_=>this.selectProtected(_)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},_=>this.requestMode(_,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},_=>this.requestMode(_,!1)),this._parser.setExecuteHandler(oe.BEL,()=>this.bell()),this._parser.setExecuteHandler(oe.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(oe.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(oe.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(oe.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(oe.BS,()=>this.backspace()),this._parser.setExecuteHandler(oe.HT,()=>this.tab()),this._parser.setExecuteHandler(oe.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(oe.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(yo.IND,()=>this.index()),this._parser.setExecuteHandler(yo.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(yo.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new gi(_=>(this.setTitle(_),this.setIconName(_),!0))),this._parser.registerOscHandler(1,new gi(_=>this.setIconName(_))),this._parser.registerOscHandler(2,new gi(_=>this.setTitle(_))),this._parser.registerOscHandler(4,new gi(_=>this.setOrReportIndexedColor(_))),this._parser.registerOscHandler(8,new gi(_=>this.setHyperlink(_))),this._parser.registerOscHandler(10,new gi(_=>this.setOrReportFgColor(_))),this._parser.registerOscHandler(11,new gi(_=>this.setOrReportBgColor(_))),this._parser.registerOscHandler(12,new gi(_=>this.setOrReportCursorColor(_))),this._parser.registerOscHandler(104,new gi(_=>this.restoreIndexedColor(_))),this._parser.registerOscHandler(110,new gi(_=>this.restoreFgColor(_))),this._parser.registerOscHandler(111,new gi(_=>this.restoreBgColor(_))),this._parser.registerOscHandler(112,new gi(_=>this.restoreCursorColor(_))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(let _ in At)this._parser.registerEscHandler({intermediates:"(",final:_},()=>this.selectCharset("("+_)),this._parser.registerEscHandler({intermediates:")",final:_},()=>this.selectCharset(")"+_)),this._parser.registerEscHandler({intermediates:"*",final:_},()=>this.selectCharset("*"+_)),this._parser.registerEscHandler({intermediates:"+",final:_},()=>this.selectCharset("+"+_)),this._parser.registerEscHandler({intermediates:"-",final:_},()=>this.selectCharset("-"+_)),this._parser.registerEscHandler({intermediates:".",final:_},()=>this.selectCharset("."+_)),this._parser.registerEscHandler({intermediates:"/",final:_},()=>this.selectCharset("/"+_));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(_=>(this._logService.error("Parsing error: ",_),_)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new Dm((_,y)=>this.requestStatusString(_,y)))}getAttrData(){return this._curAttrData}_preserveStack(t,i,n,a){this._parseStack.paused=!0,this._parseStack.cursorStartX=t,this._parseStack.cursorStartY=i,this._parseStack.decodedLength=n,this._parseStack.position=a}_logSlowResolvingAsync(t){this._logService.logLevel<=3&&Promise.race([t,new Promise((i,n)=>setTimeout(()=>n("#SLOW_TIMEOUT"),Bm))]).catch(i=>{if(i!=="#SLOW_TIMEOUT")throw i;console.warn(`async parser handler taking longer than ${Bm} ms`)})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(t,i){let n,a=this._activeBuffer.x,c=this._activeBuffer.y,h=0,d=this._parseStack.paused;if(d){if(n=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,i))return this._logSlowResolvingAsync(n),n;a=this._parseStack.cursorStartX,c=this._parseStack.cursorStartY,this._parseStack.paused=!1,t.length>Ks&&(h=this._parseStack.position+Ks)}if(this._logService.logLevel<=1&&this._logService.debug(`parsing data ${typeof t=="string"?` "${t}"`:` "${Array.prototype.map.call(t,_=>String.fromCharCode(_)).join("")}"`}`),this._logService.logLevel===0&&this._logService.trace("parsing data (codes)",typeof t=="string"?t.split("").map(_=>_.charCodeAt(0)):t),this._parseBuffer.length<t.length&&this._parseBuffer.length<Ks&&(this._parseBuffer=new Uint32Array(Math.min(t.length,Ks))),d||this._dirtyRowTracker.clearRange(),t.length>Ks)for(let _=h;_<t.length;_+=Ks){let y=_+Ks<t.length?_+Ks:t.length,b=typeof t=="string"?this._stringDecoder.decode(t.substring(_,y),this._parseBuffer):this._utf8Decoder.decode(t.subarray(_,y),this._parseBuffer);if(n=this._parser.parse(this._parseBuffer,b))return this._preserveStack(a,c,b,_),this._logSlowResolvingAsync(n),n}else if(!d){let _=typeof t=="string"?this._stringDecoder.decode(t,this._parseBuffer):this._utf8Decoder.decode(t,this._parseBuffer);if(n=this._parser.parse(this._parseBuffer,_))return this._preserveStack(a,c,_,0),this._logSlowResolvingAsync(n),n}(this._activeBuffer.x!==a||this._activeBuffer.y!==c)&&this._onCursorMove.fire();let p=this._dirtyRowTracker.end+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp),m=this._dirtyRowTracker.start+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp);m<this._bufferService.rows&&this._onRequestRefreshRows.fire({start:Math.min(m,this._bufferService.rows-1),end:Math.min(p,this._bufferService.rows-1)})}print(t,i,n){let a,c,h=this._charsetService.charset,d=this._optionsService.rawOptions.screenReaderMode,p=this._bufferService.cols,m=this._coreService.decPrivateModes.wraparound,_=this._coreService.modes.insertMode,y=this._curAttrData,b=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&n-i>0&&b.getWidth(this._activeBuffer.x-1)===2&&b.setCellFromCodepoint(this._activeBuffer.x-1,0,1,y);let E=this._parser.precedingJoinState;for(let R=i;R<n;++R){if(a=t[R],a<127&&h){let X=h[String.fromCharCode(a)];X&&(a=X.charCodeAt(0))}let D=this._unicodeService.charProperties(a,E);c=Sr.extractWidth(D);let k=Sr.extractShouldJoin(D),V=k?Sr.extractWidth(E):0;if(E=D,d&&this._onA11yChar.fire(Xs(a)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),this._activeBuffer.x+c-V>p){if(m){let X=b,he=this._activeBuffer.x-V;for(this._activeBuffer.x=V,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),b=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y),V>0&&b instanceof Dl&&b.copyCellsFrom(X,he,0,V,!1);he<p;)X.setCellFromCodepoint(he++,0,1,y)}else if(this._activeBuffer.x=p-1,c===2)continue}if(k&&this._activeBuffer.x){let X=b.getWidth(this._activeBuffer.x-1)?1:2;b.addCodepointToCell(this._activeBuffer.x-X,a,c);for(let he=c-V;--he>=0;)b.setCellFromCodepoint(this._activeBuffer.x++,0,0,y);continue}if(_&&(b.insertCells(this._activeBuffer.x,c-V,this._activeBuffer.getNullCell(y)),b.getWidth(p-1)===2&&b.setCellFromCodepoint(p-1,0,1,y)),b.setCellFromCodepoint(this._activeBuffer.x++,a,c,y),c>0)for(;--c;)b.setCellFromCodepoint(this._activeBuffer.x++,0,0,y)}this._parser.precedingJoinState=E,this._activeBuffer.x<p&&n-i>0&&b.getWidth(this._activeBuffer.x)===0&&!b.hasContent(this._activeBuffer.x)&&b.setCellFromCodepoint(this._activeBuffer.x,0,1,y),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(t,i){return t.final==="t"&&!t.prefix&&!t.intermediates?this._parser.registerCsiHandler(t,n=>Lm(n.params[0],this._optionsService.rawOptions.windowOptions)?i(n):!0):this._parser.registerCsiHandler(t,i)}registerDcsHandler(t,i){return this._parser.registerDcsHandler(t,new Dm(i))}registerEscHandler(t,i){return this._parser.registerEscHandler(t,i)}registerOscHandler(t,i){return this._parser.registerOscHandler(t,new gi(i))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)?.isWrapped){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;let t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);t.hasWidth(this._activeBuffer.x)&&!t.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let t=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-t),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(t=this._bufferService.cols-1){this._activeBuffer.x=Math.min(t,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(t,i){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=t,this._activeBuffer.y=this._activeBuffer.scrollTop+i):(this._activeBuffer.x=t,this._activeBuffer.y=i),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(t,i){this._restrictCursor(),this._setCursor(this._activeBuffer.x+t,this._activeBuffer.y+i)}cursorUp(t){let i=this._activeBuffer.y-this._activeBuffer.scrollTop;return i>=0?this._moveCursor(0,-Math.min(i,t.params[0]||1)):this._moveCursor(0,-(t.params[0]||1)),!0}cursorDown(t){let i=this._activeBuffer.scrollBottom-this._activeBuffer.y;return i>=0?this._moveCursor(0,Math.min(i,t.params[0]||1)):this._moveCursor(0,t.params[0]||1),!0}cursorForward(t){return this._moveCursor(t.params[0]||1,0),!0}cursorBackward(t){return this._moveCursor(-(t.params[0]||1),0),!0}cursorNextLine(t){return this.cursorDown(t),this._activeBuffer.x=0,!0}cursorPrecedingLine(t){return this.cursorUp(t),this._activeBuffer.x=0,!0}cursorCharAbsolute(t){return this._setCursor((t.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(t){return this._setCursor(t.length>=2?(t.params[1]||1)-1:0,(t.params[0]||1)-1),!0}charPosAbsolute(t){return this._setCursor((t.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(t){return this._moveCursor(t.params[0]||1,0),!0}linePosAbsolute(t){return this._setCursor(this._activeBuffer.x,(t.params[0]||1)-1),!0}vPositionRelative(t){return this._moveCursor(0,t.params[0]||1),!0}hVPosition(t){return this.cursorPosition(t),!0}tabClear(t){let i=t.params[0];return i===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:i===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(t){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let i=t.params[0]||1;for(;i--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(t){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let i=t.params[0]||1;for(;i--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(t){let i=t.params[0];return i===1&&(this._curAttrData.bg|=536870912),(i===2||i===0)&&(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(t,i,n,a=!1,c=!1){let h=this._activeBuffer.lines.get(this._activeBuffer.ybase+t);h.replaceCells(i,n,this._activeBuffer.getNullCell(this._eraseAttrData()),c),a&&(h.isWrapped=!1)}_resetBufferLine(t,i=!1){let n=this._activeBuffer.lines.get(this._activeBuffer.ybase+t);n&&(n.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),i),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+t),n.isWrapped=!1)}eraseInDisplay(t,i=!1){this._restrictCursor(this._bufferService.cols);let n;switch(t.params[0]){case 0:for(n=this._activeBuffer.y,this._dirtyRowTracker.markDirty(n),this._eraseInBufferLine(n++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,i);n<this._bufferService.rows;n++)this._resetBufferLine(n,i);this._dirtyRowTracker.markDirty(n);break;case 1:for(n=this._activeBuffer.y,this._dirtyRowTracker.markDirty(n),this._eraseInBufferLine(n,0,this._activeBuffer.x+1,!0,i),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(n+1).isWrapped=!1);n--;)this._resetBufferLine(n,i);this._dirtyRowTracker.markDirty(0);break;case 2:if(this._optionsService.rawOptions.scrollOnEraseInDisplay){for(n=this._bufferService.rows,this._dirtyRowTracker.markRangeDirty(0,n-1);n--&&!this._activeBuffer.lines.get(this._activeBuffer.ybase+n)?.getTrimmedLength(););for(;n>=0;n--)this._bufferService.scroll(this._eraseAttrData())}else{for(n=this._bufferService.rows,this._dirtyRowTracker.markDirty(n-1);n--;)this._resetBufferLine(n,i);this._dirtyRowTracker.markDirty(0)}break;case 3:let a=this._activeBuffer.lines.length-this._bufferService.rows;a>0&&(this._activeBuffer.lines.trimStart(a),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-a,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-a,0),this._onScroll.fire(0));break}return!0}eraseInLine(t,i=!1){switch(this._restrictCursor(this._bufferService.cols),t.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,i);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,i);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,i);break}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(t){this._restrictCursor();let i=t.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let n=this._activeBuffer.ybase+this._activeBuffer.y,a=this._bufferService.rows-1-this._activeBuffer.scrollBottom,c=this._bufferService.rows-1+this._activeBuffer.ybase-a+1;for(;i--;)this._activeBuffer.lines.splice(c-1,1),this._activeBuffer.lines.splice(n,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(t){this._restrictCursor();let i=t.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let n=this._activeBuffer.ybase+this._activeBuffer.y,a;for(a=this._bufferService.rows-1-this._activeBuffer.scrollBottom,a=this._bufferService.rows-1+this._activeBuffer.ybase-a;i--;)this._activeBuffer.lines.splice(n,1),this._activeBuffer.lines.splice(a,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(t){this._restrictCursor();let i=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return i&&(i.insertCells(this._activeBuffer.x,t.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(t){this._restrictCursor();let i=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return i&&(i.deleteCells(this._activeBuffer.x,t.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(t){let i=t.params[0]||1;for(;i--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(t){let i=t.params[0]||1;for(;i--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(bt));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(t){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let i=t.params[0]||1;for(let n=this._activeBuffer.scrollTop;n<=this._activeBuffer.scrollBottom;++n){let a=this._activeBuffer.lines.get(this._activeBuffer.ybase+n);a.deleteCells(0,i,this._activeBuffer.getNullCell(this._eraseAttrData())),a.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(t){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let i=t.params[0]||1;for(let n=this._activeBuffer.scrollTop;n<=this._activeBuffer.scrollBottom;++n){let a=this._activeBuffer.lines.get(this._activeBuffer.ybase+n);a.insertCells(0,i,this._activeBuffer.getNullCell(this._eraseAttrData())),a.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(t){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let i=t.params[0]||1;for(let n=this._activeBuffer.scrollTop;n<=this._activeBuffer.scrollBottom;++n){let a=this._activeBuffer.lines.get(this._activeBuffer.ybase+n);a.insertCells(this._activeBuffer.x,i,this._activeBuffer.getNullCell(this._eraseAttrData())),a.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(t){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let i=t.params[0]||1;for(let n=this._activeBuffer.scrollTop;n<=this._activeBuffer.scrollBottom;++n){let a=this._activeBuffer.lines.get(this._activeBuffer.ybase+n);a.deleteCells(this._activeBuffer.x,i,this._activeBuffer.getNullCell(this._eraseAttrData())),a.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(t){this._restrictCursor();let i=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return i&&(i.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(t.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(t){let i=this._parser.precedingJoinState;if(!i)return!0;let n=t.params[0]||1,a=Sr.extractWidth(i),c=this._activeBuffer.x-a,h=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).getString(c),d=new Uint32Array(h.length*n),p=0;for(let _=0;_<h.length;){let y=h.codePointAt(_)||0;d[p++]=y,_+=y>65535?2:1}let m=p;for(let _=1;_<n;++_)d.copyWithin(m,0,p),m+=p;return this.print(d,0,m),!0}sendDeviceAttributesPrimary(t){return t.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(oe.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(oe.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(t){return t.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(oe.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(oe.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(t.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(oe.ESC+"[>83;40003;0c")),!0}_is(t){return(this._optionsService.rawOptions.termName+"").indexOf(t)===0}setMode(t){for(let i=0;i<t.length;i++)switch(t.params[i]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0;break}return!0}setModePrivate(t){for(let i=0;i<t.length;i++)switch(t.params[i]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,vr),this._charsetService.setgCharset(1,vr),this._charsetService.setgCharset(2,vr),this._charsetService.setgCharset(3,vr);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(void 0),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0;break;case 2026:this._coreService.decPrivateModes.synchronizedOutput=!0;break}return!0}resetMode(t){for(let i=0;i<t.length;i++)switch(t.params[i]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1;break}return!0}resetModePrivate(t){for(let i=0;i<t.length;i++)switch(t.params[i]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),t.params[i]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(void 0),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1;break;case 2026:this._coreService.decPrivateModes.synchronizedOutput=!1,this._onRequestRefreshRows.fire(void 0);break}return!0}requestMode(t,i){let n;(k=>(k[k.NOT_RECOGNIZED=0]="NOT_RECOGNIZED",k[k.SET=1]="SET",k[k.RESET=2]="RESET",k[k.PERMANENTLY_SET=3]="PERMANENTLY_SET",k[k.PERMANENTLY_RESET=4]="PERMANENTLY_RESET"))(n||={});let a=this._coreService.decPrivateModes,{activeProtocol:c,activeEncoding:h}=this._coreMouseService,d=this._coreService,{buffers:p,cols:m}=this._bufferService,{active:_,alt:y}=p,b=this._optionsService.rawOptions,E=(k,V)=>(d.triggerDataEvent(`${oe.ESC}[${i?"":"?"}${k};${V}$y`),!0),R=k=>k?1:2,D=t.params[0];return i?D===2?E(D,4):D===4?E(D,R(d.modes.insertMode)):D===12?E(D,3):D===20?E(D,R(b.convertEol)):E(D,0):D===1?E(D,R(a.applicationCursorKeys)):D===3?E(D,b.windowOptions.setWinLines?m===80?2:m===132?1:0:0):D===6?E(D,R(a.origin)):D===7?E(D,R(a.wraparound)):D===8?E(D,3):D===9?E(D,R(c==="X10")):D===12?E(D,R(b.cursorBlink)):D===25?E(D,R(!d.isCursorHidden)):D===45?E(D,R(a.reverseWraparound)):D===66?E(D,R(a.applicationKeypad)):D===67?E(D,4):D===1e3?E(D,R(c==="VT200")):D===1002?E(D,R(c==="DRAG")):D===1003?E(D,R(c==="ANY")):D===1004?E(D,R(a.sendFocus)):D===1005?E(D,4):D===1006?E(D,R(h==="SGR")):D===1015?E(D,4):D===1016?E(D,R(h==="SGR_PIXELS")):D===1048?E(D,1):D===47||D===1047||D===1049?E(D,R(_===y)):D===2004?E(D,R(a.bracketedPasteMode)):D===2026?E(D,R(a.synchronizedOutput)):E(D,0)}_updateAttrColor(t,i,n,a,c){return i===2?(t|=50331648,t&=-16777216,t|=Nl.fromColorRGB([n,a,c])):i===5&&(t&=-50331904,t|=33554432|n&255),t}_extractColor(t,i,n){let a=[0,0,-1,0,0,0],c=0,h=0;do{if(a[h+c]=t.params[i+h],t.hasSubParams(i+h)){let d=t.getSubParams(i+h),p=0;do a[1]===5&&(c=1),a[h+p+1+c]=d[p];while(++p<d.length&&p+h+1+c<a.length);break}if(a[1]===5&&h+c>=2||a[1]===2&&h+c>=5)break;a[1]&&(c=1)}while(++h+i<t.length&&h+c<a.length);for(let d=2;d<a.length;++d)a[d]===-1&&(a[d]=0);switch(a[0]){case 38:n.fg=this._updateAttrColor(n.fg,a[1],a[3],a[4],a[5]);break;case 48:n.bg=this._updateAttrColor(n.bg,a[1],a[3],a[4],a[5]);break;case 58:n.extended=n.extended.clone(),n.extended.underlineColor=this._updateAttrColor(n.extended.underlineColor,a[1],a[3],a[4],a[5])}return h}_processUnderline(t,i){i.extended=i.extended.clone(),(!~t||t>5)&&(t=1),i.extended.underlineStyle=t,i.fg|=268435456,t===0&&(i.fg&=-268435457),i.updateExtended()}_processSGR0(t){t.fg=bt.fg,t.bg=bt.bg,t.extended=t.extended.clone(),t.extended.underlineStyle=0,t.extended.underlineColor&=-67108864,t.updateExtended()}charAttributes(t){if(t.length===1&&t.params[0]===0)return this._processSGR0(this._curAttrData),!0;let i=t.length,n,a=this._curAttrData;for(let c=0;c<i;c++)n=t.params[c],n>=30&&n<=37?(a.fg&=-50331904,a.fg|=16777216|n-30):n>=40&&n<=47?(a.bg&=-50331904,a.bg|=16777216|n-40):n>=90&&n<=97?(a.fg&=-50331904,a.fg|=16777216|n-90|8):n>=100&&n<=107?(a.bg&=-50331904,a.bg|=16777216|n-100|8):n===0?this._processSGR0(a):n===1?a.fg|=134217728:n===3?a.bg|=67108864:n===4?(a.fg|=268435456,this._processUnderline(t.hasSubParams(c)?t.getSubParams(c)[0]:1,a)):n===5?a.fg|=536870912:n===7?a.fg|=67108864:n===8?a.fg|=1073741824:n===9?a.fg|=2147483648:n===2?a.bg|=134217728:n===21?this._processUnderline(2,a):n===22?(a.fg&=-134217729,a.bg&=-134217729):n===23?a.bg&=-67108865:n===24?(a.fg&=-268435457,this._processUnderline(0,a)):n===25?a.fg&=-536870913:n===27?a.fg&=-67108865:n===28?a.fg&=-1073741825:n===29?a.fg&=2147483647:n===39?(a.fg&=-67108864,a.fg|=bt.fg&16777215):n===49?(a.bg&=-67108864,a.bg|=bt.bg&16777215):n===38||n===48||n===58?c+=this._extractColor(t,c,a):n===53?a.bg|=1073741824:n===55?a.bg&=-1073741825:n===59?(a.extended=a.extended.clone(),a.extended.underlineColor=-1,a.updateExtended()):n===100?(a.fg&=-67108864,a.fg|=bt.fg&16777215,a.bg&=-67108864,a.bg|=bt.bg&16777215):this._logService.debug("Unknown SGR attribute: %d.",n);return!0}deviceStatus(t){switch(t.params[0]){case 5:this._coreService.triggerDataEvent(`${oe.ESC}[0n`);break;case 6:let i=this._activeBuffer.y+1,n=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${oe.ESC}[${i};${n}R`);break}return!0}deviceStatusPrivate(t){if(t.params[0]===6){let i=this._activeBuffer.y+1,n=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${oe.ESC}[?${i};${n}R`)}return!0}softReset(t){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=bt.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(t){let i=t.length===0?1:t.params[0];if(i===0)this._coreService.decPrivateModes.cursorStyle=void 0,this._coreService.decPrivateModes.cursorBlink=void 0;else{switch(i){case 1:case 2:this._coreService.decPrivateModes.cursorStyle="block";break;case 3:case 4:this._coreService.decPrivateModes.cursorStyle="underline";break;case 5:case 6:this._coreService.decPrivateModes.cursorStyle="bar";break}let n=i%2===1;this._coreService.decPrivateModes.cursorBlink=n}return!0}setScrollRegion(t){let i=t.params[0]||1,n;return(t.length<2||(n=t.params[1])>this._bufferService.rows||n===0)&&(n=this._bufferService.rows),n>i&&(this._activeBuffer.scrollTop=i-1,this._activeBuffer.scrollBottom=n-1,this._setCursor(0,0)),!0}windowOptions(t){if(!Lm(t.params[0],this._optionsService.rawOptions.windowOptions))return!0;let i=t.length>1?t.params[1]:0;switch(t.params[0]){case 14:i!==2&&this._onRequestWindowsOptionsReport.fire(0);break;case 16:this._onRequestWindowsOptionsReport.fire(1);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${oe.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:(i===0||i===2)&&(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>Mm&&this._windowTitleStack.shift()),(i===0||i===1)&&(this._iconNameStack.push(this._iconName),this._iconNameStack.length>Mm&&this._iconNameStack.shift());break;case 23:(i===0||i===2)&&this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),(i===0||i===1)&&this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop());break}return!0}saveCursor(t){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(t){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(t){return this._windowTitle=t,this._onTitleChange.fire(t),!0}setIconName(t){return this._iconName=t,!0}setOrReportIndexedColor(t){let i=[],n=t.split(";");for(;n.length>1;){let a=n.shift(),c=n.shift();if(/^\d+$/.exec(a)){let h=parseInt(a);if(zm(h))if(c==="?")i.push({type:0,index:h});else{let d=km(c);d&&i.push({type:1,index:h,color:d})}}}return i.length&&this._onColor.fire(i),!0}setHyperlink(t){let i=t.indexOf(";");if(i===-1)return!0;let n=t.slice(0,i).trim(),a=t.slice(i+1);return a?this._createHyperlink(n,a):n.trim()?!1:this._finishHyperlink()}_createHyperlink(t,i){this._getCurrentLinkId()&&this._finishHyperlink();let n=t.split(":"),a,c=n.findIndex(h=>h.startsWith("id="));return c!==-1&&(a=n[c].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:a,uri:i}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(t,i){let n=t.split(";");for(let a=0;a<n.length&&!(i>=this._specialColors.length);++a,++i)if(n[a]==="?")this._onColor.fire([{type:0,index:this._specialColors[i]}]);else{let c=km(n[a]);c&&this._onColor.fire([{type:1,index:this._specialColors[i],color:c}])}return!0}setOrReportFgColor(t){return this._setOrReportSpecialColor(t,0)}setOrReportBgColor(t){return this._setOrReportSpecialColor(t,1)}setOrReportCursorColor(t){return this._setOrReportSpecialColor(t,2)}restoreIndexedColor(t){if(!t)return this._onColor.fire([{type:2}]),!0;let i=[],n=t.split(";");for(let a=0;a<n.length;++a)if(/^\d+$/.exec(n[a])){let c=parseInt(n[a]);zm(c)&&i.push({type:2,index:c})}return i.length&&this._onColor.fire(i),!0}restoreFgColor(t){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(t){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(t){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,vr),!0}selectCharset(t){return t.length!==2?(this.selectDefaultCharset(),!0):(t[0]==="/"||this._charsetService.setgCharset(Sw[t[0]],At[t[1]]||vr),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){let t=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,t,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=bt.clone(),this._eraseAttrDataInternal=bt.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=this._curAttrData.bg&67108863,this._eraseAttrDataInternal}setgLevel(t){return this._charsetService.setgLevel(t),!0}screenAlignmentPattern(){let t=new ki;t.content=1<<22|69,t.fg=this._curAttrData.fg,t.bg=this._curAttrData.bg,this._setCursor(0,0);for(let i=0;i<this._bufferService.rows;++i){let n=this._activeBuffer.ybase+this._activeBuffer.y+i,a=this._activeBuffer.lines.get(n);a&&(a.fill(t),a.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(t,i){let n=d=>(this._coreService.triggerDataEvent(`${oe.ESC}${d}${oe.ESC}\\`),!0),a=this._bufferService.buffer,c=this._optionsService.rawOptions;return n(t==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:t==='"p'?'P1$r61;1"p':t==="r"?`P1$r${a.scrollTop+1};${a.scrollBottom+1}r`:t==="m"?"P1$r0m":t===" q"?`P1$r${{block:2,underline:4,bar:6}[c.cursorStyle]-(c.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(t,i){this._dirtyRowTracker.markRangeDirty(t,i)}},ld=class{constructor(t){this._bufferService=t,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(t){t<this.start?this.start=t:t>this.end&&(this.end=t)}markRangeDirty(t,i){t>i&&(Om=t,t=i,i=Om),t<this.start&&(this.start=t),i>this.end&&(this.end=i)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};ld=ft([ve(0,Kt)],ld);function zm(t){return 0<=t&&t<256}var Cw=5e7,Nm=12,ww=50,xw=class extends He{constructor(t){super(),this._action=t,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this._register(new pe),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(t,i){if(i!==void 0&&this._syncCalls>i){this._syncCalls=0;return}if(this._pendingData+=t.length,this._writeBuffer.push(t),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;this._isSyncWriting=!0;let n;for(;n=this._writeBuffer.shift();){this._action(n);let a=this._callbacks.shift();a&&a()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(t,i){if(this._pendingData>Cw)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput){this._didUserInput=!1,this._pendingData+=t.length,this._writeBuffer.push(t),this._callbacks.push(i),this._innerWrite();return}setTimeout(()=>this._innerWrite())}this._pendingData+=t.length,this._writeBuffer.push(t),this._callbacks.push(i)}_innerWrite(t=0,i=!0){let n=t||performance.now();for(;this._writeBuffer.length>this._bufferOffset;){let a=this._writeBuffer[this._bufferOffset],c=this._action(a,i);if(c){let d=p=>performance.now()-n>=Nm?setTimeout(()=>this._innerWrite(0,p)):this._innerWrite(n,p);c.catch(p=>(queueMicrotask(()=>{throw p}),Promise.resolve(!1))).then(d);return}let h=this._callbacks[this._bufferOffset];if(h&&h(),this._bufferOffset++,this._pendingData-=a.length,performance.now()-n>=Nm)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>ww&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}},ad=class{constructor(t){this._bufferService=t,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(t){let i=this._bufferService.buffer;if(t.id===void 0){let p=i.addMarker(i.ybase+i.y),m={data:t,id:this._nextId++,lines:[p]};return p.onDispose(()=>this._removeMarkerFromLink(m,p)),this._dataByLinkId.set(m.id,m),m.id}let n=t,a=this._getEntryIdKey(n),c=this._entriesWithId.get(a);if(c)return this.addLineToLink(c.id,i.ybase+i.y),c.id;let h=i.addMarker(i.ybase+i.y),d={id:this._nextId++,key:this._getEntryIdKey(n),data:n,lines:[h]};return h.onDispose(()=>this._removeMarkerFromLink(d,h)),this._entriesWithId.set(d.key,d),this._dataByLinkId.set(d.id,d),d.id}addLineToLink(t,i){let n=this._dataByLinkId.get(t);if(n&&n.lines.every(a=>a.line!==i)){let a=this._bufferService.buffer.addMarker(i);n.lines.push(a),a.onDispose(()=>this._removeMarkerFromLink(n,a))}}getLinkData(t){return this._dataByLinkId.get(t)?.data}_getEntryIdKey(t){return`${t.id};;${t.uri}`}_removeMarkerFromLink(t,i){let n=t.lines.indexOf(i);n!==-1&&(t.lines.splice(n,1),t.lines.length===0&&(t.data.id!==void 0&&this._entriesWithId.delete(t.key),this._dataByLinkId.delete(t.id)))}};ad=ft([ve(0,Kt)],ad);var Hm=!1,Ew=class extends He{constructor(t){super(),this._windowsWrappingHeuristics=this._register(new yn),this._onBinary=this._register(new pe),this.onBinary=this._onBinary.event,this._onData=this._register(new pe),this.onData=this._onData.event,this._onLineFeed=this._register(new pe),this.onLineFeed=this._onLineFeed.event,this._onResize=this._register(new pe),this.onResize=this._onResize.event,this._onWriteParsed=this._register(new pe),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this._register(new pe),this._instantiationService=new VC,this.optionsService=this._register(new nw(t)),this._instantiationService.setService(Gt,this.optionsService),this._bufferService=this._register(this._instantiationService.createInstance(id)),this._instantiationService.setService(Kt,this._bufferService),this._logService=this._register(this._instantiationService.createInstance(td)),this._instantiationService.setService(Fv,this._logService),this.coreService=this._register(this._instantiationService.createInstance(sd)),this._instantiationService.setService(Tr,this.coreService),this.coreMouseService=this._register(this._instantiationService.createInstance(rd)),this._instantiationService.setService(Wv,this.coreMouseService),this.unicodeService=this._register(this._instantiationService.createInstance(Sr)),this._instantiationService.setService(qb,this.unicodeService),this._charsetService=this._instantiationService.createInstance(hw),this._instantiationService.setService(Yb,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(ad),this._instantiationService.setService(Pv,this._oscLinkService),this._inputHandler=this._register(new bw(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this._register(jt.forward(this._inputHandler.onLineFeed,this._onLineFeed)),this._register(this._inputHandler),this._register(jt.forward(this._bufferService.onResize,this._onResize)),this._register(jt.forward(this.coreService.onData,this._onData)),this._register(jt.forward(this.coreService.onBinary,this._onBinary)),this._register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom(!0))),this._register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this._register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this._register(this._bufferService.onScroll(()=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this._register(new xw((i,n)=>this._inputHandler.parse(i,n))),this._register(jt.forward(this._writeBuffer.onWriteParsed,this._onWriteParsed))}get onScroll(){return this._onScrollApi||(this._onScrollApi=this._register(new pe),this._onScroll.event(t=>{this._onScrollApi?.fire(t.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(t){for(let i in t)this.optionsService.options[i]=t[i]}write(t,i){this._writeBuffer.write(t,i)}writeSync(t,i){this._logService.logLevel<=3&&!Hm&&(this._logService.warn("writeSync is unreliable and will be removed soon."),Hm=!0),this._writeBuffer.writeSync(t,i)}input(t,i=!0){this.coreService.triggerDataEvent(t,i)}resize(t,i){isNaN(t)||isNaN(i)||(t=Math.max(t,b0),i=Math.max(i,C0),this._bufferService.resize(t,i))}scroll(t,i=!1){this._bufferService.scroll(t,i)}scrollLines(t,i){this._bufferService.scrollLines(t,i)}scrollPages(t){this.scrollLines(t*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(t){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(t){let i=t-this._bufferService.buffer.ydisp;i!==0&&this.scrollLines(i)}registerEscHandler(t,i){return this._inputHandler.registerEscHandler(t,i)}registerDcsHandler(t,i){return this._inputHandler.registerDcsHandler(t,i)}registerCsiHandler(t,i){return this._inputHandler.registerCsiHandler(t,i)}registerOscHandler(t,i){return this._inputHandler.registerOscHandler(t,i)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let t=!1,i=this.optionsService.rawOptions.windowsPty;i&&i.buildNumber!==void 0&&i.buildNumber!==void 0?t=i.backend==="conpty"&&i.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(t=!0),t?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){let t=[];t.push(this.onLineFeed(Rm.bind(null,this._bufferService))),t.push(this.registerCsiHandler({final:"H"},()=>(Rm(this._bufferService),!1))),this._windowsWrappingHeuristics.value=nt(()=>{for(let i of t)i.dispose()})}}},Tw={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};function Aw(t,i,n,a){let c={type:0,cancel:!1,key:void 0},h=(t.shiftKey?1:0)|(t.altKey?2:0)|(t.ctrlKey?4:0)|(t.metaKey?8:0);switch(t.keyCode){case 0:t.key==="UIKeyInputUpArrow"?i?c.key=oe.ESC+"OA":c.key=oe.ESC+"[A":t.key==="UIKeyInputLeftArrow"?i?c.key=oe.ESC+"OD":c.key=oe.ESC+"[D":t.key==="UIKeyInputRightArrow"?i?c.key=oe.ESC+"OC":c.key=oe.ESC+"[C":t.key==="UIKeyInputDownArrow"&&(i?c.key=oe.ESC+"OB":c.key=oe.ESC+"[B");break;case 8:c.key=t.ctrlKey?"\b":oe.DEL,t.altKey&&(c.key=oe.ESC+c.key);break;case 9:if(t.shiftKey){c.key=oe.ESC+"[Z";break}c.key=oe.HT,c.cancel=!0;break;case 13:c.key=t.altKey?oe.ESC+oe.CR:oe.CR,c.cancel=!0;break;case 27:c.key=oe.ESC,t.altKey&&(c.key=oe.ESC+oe.ESC),c.cancel=!0;break;case 37:if(t.metaKey)break;h?c.key=oe.ESC+"[1;"+(h+1)+"D":i?c.key=oe.ESC+"OD":c.key=oe.ESC+"[D";break;case 39:if(t.metaKey)break;h?c.key=oe.ESC+"[1;"+(h+1)+"C":i?c.key=oe.ESC+"OC":c.key=oe.ESC+"[C";break;case 38:if(t.metaKey)break;h?c.key=oe.ESC+"[1;"+(h+1)+"A":i?c.key=oe.ESC+"OA":c.key=oe.ESC+"[A";break;case 40:if(t.metaKey)break;h?c.key=oe.ESC+"[1;"+(h+1)+"B":i?c.key=oe.ESC+"OB":c.key=oe.ESC+"[B";break;case 45:!t.shiftKey&&!t.ctrlKey&&(c.key=oe.ESC+"[2~");break;case 46:h?c.key=oe.ESC+"[3;"+(h+1)+"~":c.key=oe.ESC+"[3~";break;case 36:h?c.key=oe.ESC+"[1;"+(h+1)+"H":i?c.key=oe.ESC+"OH":c.key=oe.ESC+"[H";break;case 35:h?c.key=oe.ESC+"[1;"+(h+1)+"F":i?c.key=oe.ESC+"OF":c.key=oe.ESC+"[F";break;case 33:t.shiftKey?c.type=2:t.ctrlKey?c.key=oe.ESC+"[5;"+(h+1)+"~":c.key=oe.ESC+"[5~";break;case 34:t.shiftKey?c.type=3:t.ctrlKey?c.key=oe.ESC+"[6;"+(h+1)+"~":c.key=oe.ESC+"[6~";break;case 112:h?c.key=oe.ESC+"[1;"+(h+1)+"P":c.key=oe.ESC+"OP";break;case 113:h?c.key=oe.ESC+"[1;"+(h+1)+"Q":c.key=oe.ESC+"OQ";break;case 114:h?c.key=oe.ESC+"[1;"+(h+1)+"R":c.key=oe.ESC+"OR";break;case 115:h?c.key=oe.ESC+"[1;"+(h+1)+"S":c.key=oe.ESC+"OS";break;case 116:h?c.key=oe.ESC+"[15;"+(h+1)+"~":c.key=oe.ESC+"[15~";break;case 117:h?c.key=oe.ESC+"[17;"+(h+1)+"~":c.key=oe.ESC+"[17~";break;case 118:h?c.key=oe.ESC+"[18;"+(h+1)+"~":c.key=oe.ESC+"[18~";break;case 119:h?c.key=oe.ESC+"[19;"+(h+1)+"~":c.key=oe.ESC+"[19~";break;case 120:h?c.key=oe.ESC+"[20;"+(h+1)+"~":c.key=oe.ESC+"[20~";break;case 121:h?c.key=oe.ESC+"[21;"+(h+1)+"~":c.key=oe.ESC+"[21~";break;case 122:h?c.key=oe.ESC+"[23;"+(h+1)+"~":c.key=oe.ESC+"[23~";break;case 123:h?c.key=oe.ESC+"[24;"+(h+1)+"~":c.key=oe.ESC+"[24~";break;default:if(t.ctrlKey&&!t.shiftKey&&!t.altKey&&!t.metaKey)t.keyCode>=65&&t.keyCode<=90?c.key=String.fromCharCode(t.keyCode-64):t.keyCode===32?c.key=oe.NUL:t.keyCode>=51&&t.keyCode<=55?c.key=String.fromCharCode(t.keyCode-51+27):t.keyCode===56?c.key=oe.DEL:t.keyCode===219?c.key=oe.ESC:t.keyCode===220?c.key=oe.FS:t.keyCode===221&&(c.key=oe.GS);else if((!n||a)&&t.altKey&&!t.metaKey){let d=Tw[t.keyCode]?.[t.shiftKey?1:0];if(d)c.key=oe.ESC+d;else if(t.keyCode>=65&&t.keyCode<=90){let p=t.ctrlKey?t.keyCode-64:t.keyCode+32,m=String.fromCharCode(p);t.shiftKey&&(m=m.toUpperCase()),c.key=oe.ESC+m}else if(t.keyCode===32)c.key=oe.ESC+(t.ctrlKey?oe.NUL:" ");else if(t.key==="Dead"&&t.code.startsWith("Key")){let p=t.code.slice(3,4);t.shiftKey||(p=p.toLowerCase()),c.key=oe.ESC+p,c.cancel=!0}}else n&&!t.altKey&&!t.ctrlKey&&!t.shiftKey&&t.metaKey?t.keyCode===65&&(c.type=1):t.key&&!t.ctrlKey&&!t.altKey&&!t.metaKey&&t.keyCode>=48&&t.key.length===1?c.key=t.key:t.key&&t.ctrlKey&&(t.key==="_"&&(c.key=oe.US),t.key==="@"&&(c.key=oe.NUL));break}return c}var pt=0,Rw=class{constructor(t){this._getKey=t,this._array=[],this._insertedValues=[],this._flushInsertedTask=new Ro,this._isFlushingInserted=!1,this._deletedIndices=[],this._flushDeletedTask=new Ro,this._isFlushingDeleted=!1}clear(){this._array.length=0,this._insertedValues.length=0,this._flushInsertedTask.clear(),this._isFlushingInserted=!1,this._deletedIndices.length=0,this._flushDeletedTask.clear(),this._isFlushingDeleted=!1}insert(t){this._flushCleanupDeleted(),this._insertedValues.length===0&&this._flushInsertedTask.enqueue(()=>this._flushInserted()),this._insertedValues.push(t)}_flushInserted(){let t=this._insertedValues.sort((c,h)=>this._getKey(c)-this._getKey(h)),i=0,n=0,a=new Array(this._array.length+this._insertedValues.length);for(let c=0;c<a.length;c++)n>=this._array.length||this._getKey(t[i])<=this._getKey(this._array[n])?(a[c]=t[i],i++):a[c]=this._array[n++];this._array=a,this._insertedValues.length=0}_flushCleanupInserted(){!this._isFlushingInserted&&this._insertedValues.length>0&&this._flushInsertedTask.flush()}delete(t){if(this._flushCleanupInserted(),this._array.length===0)return!1;let i=this._getKey(t);if(i===void 0||(pt=this._search(i),pt===-1)||this._getKey(this._array[pt])!==i)return!1;do if(this._array[pt]===t)return this._deletedIndices.length===0&&this._flushDeletedTask.enqueue(()=>this._flushDeleted()),this._deletedIndices.push(pt),!0;while(++pt<this._array.length&&this._getKey(this._array[pt])===i);return!1}_flushDeleted(){this._isFlushingDeleted=!0;let t=this._deletedIndices.sort((c,h)=>c-h),i=0,n=new Array(this._array.length-t.length),a=0;for(let c=0;c<this._array.length;c++)t[i]===c?i++:n[a++]=this._array[c];this._array=n,this._deletedIndices.length=0,this._isFlushingDeleted=!1}_flushCleanupDeleted(){!this._isFlushingDeleted&&this._deletedIndices.length>0&&this._flushDeletedTask.flush()}*getKeyIterator(t){if(this._flushCleanupInserted(),this._flushCleanupDeleted(),this._array.length!==0&&(pt=this._search(t),!(pt<0||pt>=this._array.length)&&this._getKey(this._array[pt])===t))do yield this._array[pt];while(++pt<this._array.length&&this._getKey(this._array[pt])===t)}forEachByKey(t,i){if(this._flushCleanupInserted(),this._flushCleanupDeleted(),this._array.length!==0&&(pt=this._search(t),!(pt<0||pt>=this._array.length)&&this._getKey(this._array[pt])===t))do i(this._array[pt]);while(++pt<this._array.length&&this._getKey(this._array[pt])===t)}values(){return this._flushCleanupInserted(),this._flushCleanupDeleted(),[...this._array].values()}_search(t){let i=0,n=this._array.length-1;for(;n>=i;){let a=i+n>>1,c=this._getKey(this._array[a]);if(c>t)n=a-1;else if(c<t)i=a+1;else{for(;a>0&&this._getKey(this._array[a-1])===t;)a--;return a}}return i}},pu=0,Um=0,Dw=class extends He{constructor(){super(),this._decorations=new Rw(t=>t?.marker.line),this._onDecorationRegistered=this._register(new pe),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this._register(new pe),this.onDecorationRemoved=this._onDecorationRemoved.event,this._register(nt(()=>this.reset()))}get decorations(){return this._decorations.values()}registerDecoration(t){if(t.marker.isDisposed)return;let i=new kw(t);if(i){let n=i.marker.onDispose(()=>i.dispose()),a=i.onDispose(()=>{a.dispose(),i&&(this._decorations.delete(i)&&this._onDecorationRemoved.fire(i),n.dispose())});this._decorations.insert(i),this._onDecorationRegistered.fire(i)}return i}reset(){for(let t of this._decorations.values())t.dispose();this._decorations.clear()}*getDecorationsAtCell(t,i,n){let a=0,c=0;for(let h of this._decorations.getKeyIterator(i))a=h.options.x??0,c=a+(h.options.width??1),t>=a&&t<c&&(!n||(h.options.layer??"bottom")===n)&&(yield h)}forEachDecorationAtCell(t,i,n,a){this._decorations.forEachByKey(i,c=>{pu=c.options.x??0,Um=pu+(c.options.width??1),t>=pu&&t<Um&&(!n||(c.options.layer??"bottom")===n)&&a(c)})}},kw=class extends $s{constructor(t){super(),this.options=t,this.onRenderEmitter=this.add(new pe),this.onRender=this.onRenderEmitter.event,this._onDispose=this.add(new pe),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=t.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=at.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=at.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}dispose(){this._onDispose.fire(),super.dispose()}},Mw=1e3,Lw=class{constructor(t,i=Mw){this._renderCallback=t,this._debounceThresholdMS=i,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(t,i,n){this._rowCount=n,t=t!==void 0?t:0,i=i!==void 0?i:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,t):t,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,i):i;let a=performance.now();if(a-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=a,this._innerRefresh();else if(!this._additionalRefreshRequested){let c=a-this._lastRefreshMs,h=this._debounceThresholdMS-c;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=performance.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},h)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;let t=Math.max(this._rowStart,0),i=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(t,i)}},Im=20,Do=class extends He{constructor(t,i,n,a){super(),this._terminal=t,this._coreBrowserService=n,this._renderService=a,this._rowColumns=new WeakMap,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="";let c=this._coreBrowserService.mainDocument;this._accessibilityContainer=c.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=c.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let h=0;h<this._terminal.rows;h++)this._rowElements[h]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[h]);if(this._topBoundaryFocusListener=h=>this._handleBoundaryFocus(h,0),this._bottomBoundaryFocusListener=h=>this._handleBoundaryFocus(h,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=c.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this._register(new Lw(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this._register(this._terminal.onResize(h=>this._handleResize(h.rows))),this._register(this._terminal.onRender(h=>this._refreshRows(h.start,h.end))),this._register(this._terminal.onScroll(()=>this._refreshRows())),this._register(this._terminal.onA11yChar(h=>this._handleChar(h))),this._register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this._register(this._terminal.onA11yTab(h=>this._handleTab(h))),this._register(this._terminal.onKey(h=>this._handleKey(h.key))),this._register(this._terminal.onBlur(()=>this._clearLiveRegion())),this._register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._register(Me(c,"selectionchange",()=>this._handleSelectionChange())),this._register(this._coreBrowserService.onDprChange(()=>this._refreshRowsDimensions())),this._refreshRowsDimensions(),this._refreshRows(),this._register(nt(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(t){for(let i=0;i<t;i++)this._handleChar(" ")}_handleChar(t){this._liveRegionLineCount<Im+1&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==t&&(this._charsToAnnounce+=t):this._charsToAnnounce+=t,t===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===Im+1&&(this._liveRegion.textContent+=Au.get())))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0}_handleKey(t){this._clearLiveRegion(),new RegExp("\\p{Control}","u").test(t)||this._charsToConsume.push(t)}_refreshRows(t,i){this._liveRegionDebouncer.refresh(t,i,this._terminal.rows)}_renderRows(t,i){let n=this._terminal.buffer,a=n.lines.length.toString();for(let c=t;c<=i;c++){let h=n.lines.get(n.ydisp+c),d=[],p=h?.translateToString(!0,void 0,void 0,d)||"",m=(n.ydisp+c+1).toString(),_=this._rowElements[c];_&&(p.length===0?(_.textContent="",this._rowColumns.set(_,[0,1])):(_.textContent=p,this._rowColumns.set(_,d)),_.setAttribute("aria-posinset",m),_.setAttribute("aria-setsize",a),this._alignRowWidth(_))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(t,i){let n=t.target,a=this._rowElements[i===0?1:this._rowElements.length-2],c=n.getAttribute("aria-posinset"),h=i===0?"1":`${this._terminal.buffer.lines.length}`;if(c===h||t.relatedTarget!==a)return;let d,p;if(i===0?(d=n,p=this._rowElements.pop(),this._rowContainer.removeChild(p)):(d=this._rowElements.shift(),p=n,this._rowContainer.removeChild(d)),d.removeEventListener("focus",this._topBoundaryFocusListener),p.removeEventListener("focus",this._bottomBoundaryFocusListener),i===0){let m=this._createAccessibilityTreeNode();this._rowElements.unshift(m),this._rowContainer.insertAdjacentElement("afterbegin",m)}else{let m=this._createAccessibilityTreeNode();this._rowElements.push(m),this._rowContainer.appendChild(m)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(i===0?-1:1),this._rowElements[i===0?1:this._rowElements.length-2].focus(),t.preventDefault(),t.stopImmediatePropagation()}_handleSelectionChange(){if(this._rowElements.length===0)return;let t=this._coreBrowserService.mainDocument.getSelection();if(!t)return;if(t.isCollapsed){this._rowContainer.contains(t.anchorNode)&&this._terminal.clearSelection();return}if(!t.anchorNode||!t.focusNode){console.error("anchorNode and/or focusNode are null");return}let i={node:t.anchorNode,offset:t.anchorOffset},n={node:t.focusNode,offset:t.focusOffset};if((i.node.compareDocumentPosition(n.node)&Node.DOCUMENT_POSITION_PRECEDING||i.node===n.node&&i.offset>n.offset)&&([i,n]=[n,i]),i.node.compareDocumentPosition(this._rowElements[0])&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_FOLLOWING)&&(i={node:this._rowElements[0].childNodes[0],offset:0}),!this._rowContainer.contains(i.node))return;let a=this._rowElements.slice(-1)[0];if(n.node.compareDocumentPosition(a)&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_PRECEDING)&&(n={node:a,offset:a.textContent?.length??0}),!this._rowContainer.contains(n.node))return;let c=({node:p,offset:m})=>{let _=p instanceof Text?p.parentNode:p,y=parseInt(_?.getAttribute("aria-posinset"),10)-1;if(isNaN(y))return console.warn("row is invalid. Race condition?"),null;let b=this._rowColumns.get(_);if(!b)return console.warn("columns is null. Race condition?"),null;let E=m<b.length?b[m]:b.slice(-1)[0]+1;return E>=this._terminal.cols&&(++y,E=0),{row:y,column:E}},h=c(i),d=c(n);if(!(!h||!d)){if(h.row>d.row||h.row===d.row&&h.column>=d.column)throw new Error("invalid range");this._terminal.select(h.column,h.row,(d.row-h.row)*this._terminal.cols-h.column+d.column)}}_handleResize(t){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let i=this._rowContainer.children.length;i<this._terminal.rows;i++)this._rowElements[i]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[i]);for(;this._rowElements.length>t;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){let t=this._coreBrowserService.mainDocument.createElement("div");return t.setAttribute("role","listitem"),t.tabIndex=-1,this._refreshRowDimensions(t),t}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){Object.assign(this._accessibilityContainer.style,{width:`${this._renderService.dimensions.css.canvas.width}px`,fontSize:`${this._terminal.options.fontSize}px`}),this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let t=0;t<this._terminal.rows;t++)this._refreshRowDimensions(this._rowElements[t]),this._alignRowWidth(this._rowElements[t])}}_refreshRowDimensions(t){t.style.height=`${this._renderService.dimensions.css.cell.height}px`}_alignRowWidth(t){t.style.transform="";let i=t.getBoundingClientRect().width,n=this._rowColumns.get(t)?.slice(-1)?.[0];if(!n)return;let a=n*this._renderService.dimensions.css.cell.width;t.style.transform=`scaleX(${a/i})`}};Do=ft([ve(1,Sd),ve(2,ms),ve(3,vs)],Do);var od=class extends He{constructor(t,i,n,a,c){super(),this._element=t,this._mouseService=i,this._renderService=n,this._bufferService=a,this._linkProviderService=c,this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this._register(new pe),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this._register(new pe),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this._register(nt(()=>{wr(this._linkCacheDisposables),this._linkCacheDisposables.length=0,this._lastMouseEvent=void 0,this._activeProviderReplies?.clear()})),this._register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0})),this._register(Me(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this._register(Me(this._element,"mousemove",this._handleMouseMove.bind(this))),this._register(Me(this._element,"mousedown",this._handleMouseDown.bind(this))),this._register(Me(this._element,"mouseup",this._handleMouseUp.bind(this)))}get currentLink(){return this._currentLink}_handleMouseMove(t){this._lastMouseEvent=t;let i=this._positionFromMouseEvent(t,this._element,this._mouseService);if(!i)return;this._isMouseOut=!1;let n=t.composedPath();for(let a=0;a<n.length;a++){let c=n[a];if(c.classList.contains("xterm"))break;if(c.classList.contains("xterm-hover"))return}(!this._lastBufferCell||i.x!==this._lastBufferCell.x||i.y!==this._lastBufferCell.y)&&(this._handleHover(i),this._lastBufferCell=i)}_handleHover(t){if(this._activeLine!==t.y||this._wasResized){this._clearCurrentLink(),this._askForLink(t,!1),this._wasResized=!1;return}this._currentLink&&this._linkAtPosition(this._currentLink.link,t)||(this._clearCurrentLink(),this._askForLink(t,!0))}_askForLink(t,i){(!this._activeProviderReplies||!i)&&(this._activeProviderReplies?.forEach(a=>{a?.forEach(c=>{c.link.dispose&&c.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=t.y);let n=!1;for(let[a,c]of this._linkProviderService.linkProviders.entries())i?this._activeProviderReplies?.get(a)&&(n=this._checkLinkProviderResult(a,t,n)):c.provideLinks(t.y,h=>{if(this._isMouseOut)return;let d=h?.map(p=>({link:p}));this._activeProviderReplies?.set(a,d),n=this._checkLinkProviderResult(a,t,n),this._activeProviderReplies?.size===this._linkProviderService.linkProviders.length&&this._removeIntersectingLinks(t.y,this._activeProviderReplies)})}_removeIntersectingLinks(t,i){let n=new Set;for(let a=0;a<i.size;a++){let c=i.get(a);if(c)for(let h=0;h<c.length;h++){let d=c[h],p=d.link.range.start.y<t?0:d.link.range.start.x,m=d.link.range.end.y>t?this._bufferService.cols:d.link.range.end.x;for(let _=p;_<=m;_++){if(n.has(_)){c.splice(h--,1);break}n.add(_)}}}}_checkLinkProviderResult(t,i,n){if(!this._activeProviderReplies)return n;let a=this._activeProviderReplies.get(t),c=!1;for(let h=0;h<t;h++)(!this._activeProviderReplies.has(h)||this._activeProviderReplies.get(h))&&(c=!0);if(!c&&a){let h=a.find(d=>this._linkAtPosition(d.link,i));h&&(n=!0,this._handleNewLink(h))}if(this._activeProviderReplies.size===this._linkProviderService.linkProviders.length&&!n)for(let h=0;h<this._activeProviderReplies.size;h++){let d=this._activeProviderReplies.get(h)?.find(p=>this._linkAtPosition(p.link,i));if(d){n=!0,this._handleNewLink(d);break}}return n}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(t){if(!this._currentLink)return;let i=this._positionFromMouseEvent(t,this._element,this._mouseService);i&&this._mouseDownLink&&Bw(this._mouseDownLink.link,this._currentLink.link)&&this._linkAtPosition(this._currentLink.link,i)&&this._currentLink.link.activate(t,this._currentLink.link.text)}_clearCurrentLink(t,i){!this._currentLink||!this._lastMouseEvent||(!t||!i||this._currentLink.link.range.start.y>=t&&this._currentLink.link.range.end.y<=i)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,wr(this._linkCacheDisposables),this._linkCacheDisposables.length=0)}_handleNewLink(t){if(!this._lastMouseEvent)return;let i=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);i&&this._linkAtPosition(t.link,i)&&(this._currentLink=t,this._currentLink.state={decorations:{underline:t.link.decorations===void 0?!0:t.link.decorations.underline,pointerCursor:t.link.decorations===void 0?!0:t.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,t.link,this._lastMouseEvent),t.link.decorations={},Object.defineProperties(t.link.decorations,{pointerCursor:{get:()=>this._currentLink?.state?.decorations.pointerCursor,set:n=>{this._currentLink?.state&&this._currentLink.state.decorations.pointerCursor!==n&&(this._currentLink.state.decorations.pointerCursor=n,this._currentLink.state.isHovered&&this._element.classList.toggle("xterm-cursor-pointer",n))}},underline:{get:()=>this._currentLink?.state?.decorations.underline,set:n=>{this._currentLink?.state&&this._currentLink?.state?.decorations.underline!==n&&(this._currentLink.state.decorations.underline=n,this._currentLink.state.isHovered&&this._fireUnderlineEvent(t.link,n))}}}),this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(n=>{if(!this._currentLink)return;let a=n.start===0?0:n.start+1+this._bufferService.buffer.ydisp,c=this._bufferService.buffer.ydisp+1+n.end;if(this._currentLink.link.range.start.y>=a&&this._currentLink.link.range.end.y<=c&&(this._clearCurrentLink(a,c),this._lastMouseEvent)){let h=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);h&&this._askForLink(h,!1)}})))}_linkHover(t,i,n){this._currentLink?.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(i,!0),this._currentLink.state.decorations.pointerCursor&&t.classList.add("xterm-cursor-pointer")),i.hover&&i.hover(n,i.text)}_fireUnderlineEvent(t,i){let n=t.range,a=this._bufferService.buffer.ydisp,c=this._createLinkUnderlineEvent(n.start.x-1,n.start.y-a-1,n.end.x,n.end.y-a-1,void 0);(i?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(c)}_linkLeave(t,i,n){this._currentLink?.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(i,!1),this._currentLink.state.decorations.pointerCursor&&t.classList.remove("xterm-cursor-pointer")),i.leave&&i.leave(n,i.text)}_linkAtPosition(t,i){let n=t.range.start.y*this._bufferService.cols+t.range.start.x,a=t.range.end.y*this._bufferService.cols+t.range.end.x,c=i.y*this._bufferService.cols+i.x;return n<=c&&c<=a}_positionFromMouseEvent(t,i,n){let a=n.getCoords(t,i,this._bufferService.cols,this._bufferService.rows);if(a)return{x:a[0],y:a[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(t,i,n,a,c){return{x1:t,y1:i,x2:n,y2:a,cols:this._bufferService.cols,fg:c}}};od=ft([ve(1,bd),ve(2,vs),ve(3,Kt),ve(4,qv)],od);function Bw(t,i){return t.text===i.text&&t.range.start.x===i.range.start.x&&t.range.start.y===i.range.start.y&&t.range.end.x===i.range.end.x&&t.range.end.y===i.range.end.y}var Ow=class extends Ew{constructor(t={}){super(t),this._linkifier=this._register(new yn),this.browser=h0,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this._register(new yn),this._onCursorMove=this._register(new pe),this.onCursorMove=this._onCursorMove.event,this._onKey=this._register(new pe),this.onKey=this._onKey.event,this._onRender=this._register(new pe),this.onRender=this._onRender.event,this._onSelectionChange=this._register(new pe),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this._register(new pe),this.onTitleChange=this._onTitleChange.event,this._onBell=this._register(new pe),this.onBell=this._onBell.event,this._onFocus=this._register(new pe),this._onBlur=this._register(new pe),this._onA11yCharEmitter=this._register(new pe),this._onA11yTabEmitter=this._register(new pe),this._onWillOpen=this._register(new pe),this._setup(),this._decorationService=this._instantiationService.createInstance(Dw),this._instantiationService.setService(Hl,this._decorationService),this._linkProviderService=this._instantiationService.createInstance(wC),this._instantiationService.setService(qv,this._linkProviderService),this._linkProviderService.registerLinkProvider(this._instantiationService.createInstance(Du)),this._register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this._register(this._inputHandler.onRequestRefreshRows(i=>this.refresh(i?.start??0,i?.end??this.rows-1))),this._register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this._register(this._inputHandler.onRequestReset(()=>this.reset())),this._register(this._inputHandler.onRequestWindowsOptionsReport(i=>this._reportWindowsOptions(i))),this._register(this._inputHandler.onColor(i=>this._handleColorEvent(i))),this._register(jt.forward(this._inputHandler.onCursorMove,this._onCursorMove)),this._register(jt.forward(this._inputHandler.onTitleChange,this._onTitleChange)),this._register(jt.forward(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this._register(jt.forward(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this._register(this._bufferService.onResize(i=>this._afterResize(i.cols,i.rows))),this._register(nt(()=>{this._customKeyEventHandler=void 0,this.element?.parentNode?.removeChild(this.element)}))}get linkifier(){return this._linkifier.value}get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}_handleColorEvent(t){if(this._themeService)for(let i of t){let n,a="";switch(i.index){case 256:n="foreground",a="10";break;case 257:n="background",a="11";break;case 258:n="cursor",a="12";break;default:n="ansi",a="4;"+i.index}switch(i.type){case 0:let c=st.toColorRGB(n==="ansi"?this._themeService.colors.ansi[i.index]:this._themeService.colors[n]);this.coreService.triggerDataEvent(`${oe.ESC}]${a};${yw(c)}${o0.ST}`);break;case 1:if(n==="ansi")this._themeService.modifyColors(h=>h.ansi[i.index]=Ct.toColor(...i.color));else{let h=n;this._themeService.modifyColors(d=>d[h]=Ct.toColor(...i.color))}break;case 2:this._themeService.restoreColor(i.index);break}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(t){t?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(Do,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(t){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(oe.ESC+"[I"),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){return this.textarea?.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(oe.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;let t=this.buffer.ybase+this.buffer.y,i=this.buffer.lines.get(t);if(!i)return;let n=Math.min(this.buffer.x,this.cols-1),a=this._renderService.dimensions.css.cell.height,c=i.getWidth(n),h=this._renderService.dimensions.css.cell.width*c,d=this.buffer.y*this._renderService.dimensions.css.cell.height,p=n*this._renderService.dimensions.css.cell.width;this.textarea.style.left=p+"px",this.textarea.style.top=d+"px",this.textarea.style.width=h+"px",this.textarea.style.height=a+"px",this.textarea.style.lineHeight=a+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this._register(Me(this.element,"copy",i=>{this.hasSelection()&&Ub(i,this._selectionService)}));let t=i=>Ib(i,this.textarea,this.coreService,this.optionsService);this._register(Me(this.textarea,"paste",t)),this._register(Me(this.element,"paste",t)),u0?this._register(Me(this.element,"mousedown",i=>{i.button===2&&Vp(i,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this._register(Me(this.element,"contextmenu",i=>{Vp(i,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),Dd&&this._register(Me(this.element,"auxclick",i=>{i.button===1&&Nv(i,this.textarea,this.screenElement)}))}_bindKeys(){this._register(Me(this.textarea,"keyup",t=>this._keyUp(t),!0)),this._register(Me(this.textarea,"keydown",t=>this._keyDown(t),!0)),this._register(Me(this.textarea,"keypress",t=>this._keyPress(t),!0)),this._register(Me(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this._register(Me(this.textarea,"compositionupdate",t=>this._compositionHelper.compositionupdate(t))),this._register(Me(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this._register(Me(this.textarea,"input",t=>this._inputEvent(t),!0)),this._register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(t){if(!t)throw new Error("Terminal requires a parent element.");if(t.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this.element?.ownerDocument.defaultView&&this._coreBrowserService){this.element.ownerDocument.defaultView!==this._coreBrowserService.window&&(this._coreBrowserService.window=this.element.ownerDocument.defaultView);return}this._document=t.ownerDocument,this.options.documentOverride&&this.options.documentOverride instanceof Document&&(this._document=this.optionsService.rawOptions.documentOverride),this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),t.appendChild(this.element);let i=this._document.createDocumentFragment();this._viewportElement=this._document.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),i.appendChild(this._viewportElement),this.screenElement=this._document.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._register(Me(this.screenElement,"mousemove",c=>this.updateCursorStyle(c))),this._helperContainer=this._document.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),i.appendChild(this.screenElement);let n=this.textarea=this._document.createElement("textarea");this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",Tu.get()),_0||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._register(this.optionsService.onSpecificOptionChange("disableStdin",()=>n.readOnly=this.optionsService.rawOptions.disableStdin)),this.textarea.readOnly=this.optionsService.rawOptions.disableStdin,this._coreBrowserService=this._register(this._instantiationService.createInstance(bC,this.textarea,t.ownerDocument.defaultView??window,this._document??typeof window<"u"?window.document:null)),this._instantiationService.setService(ms,this._coreBrowserService),this._register(Me(this.textarea,"focus",c=>this._handleTextAreaFocus(c))),this._register(Me(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance($u,this._document,this._helperContainer),this._instantiationService.setService(Lo,this._charSizeService),this._themeService=this._instantiationService.createInstance(ed),this._instantiationService.setService(Sn,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(To),this._instantiationService.setService(Yv,this._characterJoinerService),this._renderService=this._register(this._instantiationService.createInstance(Qu,this.rows,this.screenElement)),this._instantiationService.setService(vs,this._renderService),this._register(this._renderService.onRenderedViewportChange(c=>this._onRender.fire(c))),this.onResize(c=>this._renderService.resize(c.cols,c.rows)),this._compositionView=this._document.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(Gu,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this._mouseService=this._instantiationService.createInstance(Zu),this._instantiationService.setService(bd,this._mouseService);let a=this._linkifier.value=this._register(this._instantiationService.createInstance(od,this.screenElement));this.element.appendChild(i);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this._register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this._register(this.onBlur(()=>this._renderService.handleBlur())),this._register(this.onFocus(()=>this._renderService.handleFocus())),this._viewport=this._register(this._instantiationService.createInstance(qu,this.element,this.screenElement)),this._register(this._viewport.onRequestScrollLines(c=>{super.scrollLines(c,!1),this.refresh(0,this.rows-1)})),this._selectionService=this._register(this._instantiationService.createInstance(Ju,this.element,this.screenElement,a)),this._instantiationService.setService(Gb,this._selectionService),this._register(this._selectionService.onRequestScrollLines(c=>this.scrollLines(c.amount,c.suppressScrollEvent))),this._register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this._register(this._selectionService.onRequestRedraw(c=>this._renderService.handleSelectionChanged(c.start,c.end,c.columnSelectMode))),this._register(this._selectionService.onLinuxMouseSelection(c=>{this.textarea.value=c,this.textarea.focus(),this.textarea.select()})),this._register(jt.any(this._onScroll.event,this._inputHandler.onScroll)(()=>{this._selectionService.refresh(),this._viewport?.queueSync()})),this._register(this._instantiationService.createInstance(Ku,this.screenElement)),this._register(Me(this.element,"mousedown",c=>this._selectionService.handleMouseDown(c))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(Do,this)),this._register(this.optionsService.onSpecificOptionChange("screenReaderMode",c=>this._handleScreenReaderModeOptionChange(c))),this.options.overviewRuler.width&&(this._overviewRulerRenderer=this._register(this._instantiationService.createInstance(Eo,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRuler",c=>{!this._overviewRulerRenderer&&c&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this._register(this._instantiationService.createInstance(Eo,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(Vu,this,this._document,this.element,this.screenElement,this._viewportElement,this._helperContainer,this.linkifier)}bindMouse(){let t=this,i=this.element;function n(h){let d=t._mouseService.getMouseReportCoords(h,t.screenElement);if(!d)return!1;let p,m;switch(h.overrideType||h.type){case"mousemove":m=32,h.buttons===void 0?(p=3,h.button!==void 0&&(p=h.button<3?h.button:3)):p=h.buttons&1?0:h.buttons&4?1:h.buttons&2?2:3;break;case"mouseup":m=0,p=h.button<3?h.button:3;break;case"mousedown":m=1,p=h.button<3?h.button:3;break;case"wheel":if(t._customWheelEventHandler&&t._customWheelEventHandler(h)===!1)return!1;let _=h.deltaY;if(_===0||t.coreMouseService.consumeWheelEvent(h,t._renderService?.dimensions?.device?.cell?.height,t._coreBrowserService?.dpr)===0)return!1;m=_<0?0:1,p=4;break;default:return!1}return m===void 0||p===void 0||p>4?!1:t.coreMouseService.triggerMouseEvent({col:d.col,row:d.row,x:d.x,y:d.y,button:p,action:m,ctrl:h.ctrlKey,alt:h.altKey,shift:h.shiftKey})}let a={mouseup:null,wheel:null,mousedrag:null,mousemove:null},c={mouseup:h=>(n(h),h.buttons||(this._document.removeEventListener("mouseup",a.mouseup),a.mousedrag&&this._document.removeEventListener("mousemove",a.mousedrag)),this.cancel(h)),wheel:h=>(n(h),this.cancel(h,!0)),mousedrag:h=>{h.buttons&&n(h)},mousemove:h=>{h.buttons||n(h)}};this._register(this.coreMouseService.onProtocolChange(h=>{h?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(h)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),h&8?a.mousemove||(i.addEventListener("mousemove",c.mousemove),a.mousemove=c.mousemove):(i.removeEventListener("mousemove",a.mousemove),a.mousemove=null),h&16?a.wheel||(i.addEventListener("wheel",c.wheel,{passive:!1}),a.wheel=c.wheel):(i.removeEventListener("wheel",a.wheel),a.wheel=null),h&2?a.mouseup||(a.mouseup=c.mouseup):(this._document.removeEventListener("mouseup",a.mouseup),a.mouseup=null),h&4?a.mousedrag||(a.mousedrag=c.mousedrag):(this._document.removeEventListener("mousemove",a.mousedrag),a.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this._register(Me(i,"mousedown",h=>{if(h.preventDefault(),this.focus(),!(!this.coreMouseService.areMouseEventsActive||this._selectionService.shouldForceSelection(h)))return n(h),a.mouseup&&this._document.addEventListener("mouseup",a.mouseup),a.mousedrag&&this._document.addEventListener("mousemove",a.mousedrag),this.cancel(h)})),this._register(Me(i,"wheel",h=>{if(!a.wheel){if(this._customWheelEventHandler&&this._customWheelEventHandler(h)===!1)return!1;if(!this.buffer.hasScrollback){if(h.deltaY===0)return!1;if(t.coreMouseService.consumeWheelEvent(h,t._renderService?.dimensions?.device?.cell?.height,t._coreBrowserService?.dpr)===0)return this.cancel(h,!0);let d=oe.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(h.deltaY<0?"A":"B");return this.coreService.triggerDataEvent(d,!0),this.cancel(h,!0)}}},{passive:!1}))}refresh(t,i){this._renderService?.refreshRows(t,i)}updateCursorStyle(t){this._selectionService?.shouldColumnSelect(t)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(t,i){this._viewport?this._viewport.scrollLines(t):super.scrollLines(t,i),this.refresh(0,this.rows-1)}scrollPages(t){this.scrollLines(t*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(t){t&&this._viewport?this._viewport.scrollToLine(this.buffer.ybase,!0):this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(t){let i=t-this._bufferService.buffer.ydisp;i!==0&&this.scrollLines(i)}paste(t){zv(t,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(t){this._customKeyEventHandler=t}attachCustomWheelEventHandler(t){this._customWheelEventHandler=t}registerLinkProvider(t){return this._linkProviderService.registerLinkProvider(t)}registerCharacterJoiner(t){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");let i=this._characterJoinerService.register(t);return this.refresh(0,this.rows-1),i}deregisterCharacterJoiner(t){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(t)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(t){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+t)}registerDecoration(t){return this._decorationService.registerDecoration(t)}hasSelection(){return this._selectionService?this._selectionService.hasSelection:!1}select(t,i,n){this._selectionService.setSelection(t,i,n)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(!(!this._selectionService||!this._selectionService.hasSelection))return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){this._selectionService?.clearSelection()}selectAll(){this._selectionService?.selectAll()}selectLines(t,i){this._selectionService?.selectLines(t,i)}_keyDown(t){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(t)===!1)return!1;let i=this.browser.isMac&&this.options.macOptionIsMeta&&t.altKey;if(!i&&!this._compositionHelper.keydown(t))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(!0),!1;!i&&(t.key==="Dead"||t.key==="AltGraph")&&(this._unprocessedDeadKey=!0);let n=Aw(t,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(t),n.type===3||n.type===2){let a=this.rows-1;return this.scrollLines(n.type===2?-a:a),this.cancel(t,!0)}if(n.type===1&&this.selectAll(),this._isThirdLevelShift(this.browser,t)||(n.cancel&&this.cancel(t,!0),!n.key)||t.key&&!t.ctrlKey&&!t.altKey&&!t.metaKey&&t.key.length===1&&t.key.charCodeAt(0)>=65&&t.key.charCodeAt(0)<=90)return!0;if(this._unprocessedDeadKey)return this._unprocessedDeadKey=!1,!0;if((n.key===oe.ETX||n.key===oe.CR)&&(this.textarea.value=""),this._onKey.fire({key:n.key,domEvent:t}),this._showCursor(),this.coreService.triggerDataEvent(n.key,!0),!this.optionsService.rawOptions.screenReaderMode||t.altKey||t.ctrlKey)return this.cancel(t,!0);this._keyDownHandled=!0}_isThirdLevelShift(t,i){let n=t.isMac&&!this.options.macOptionIsMeta&&i.altKey&&!i.ctrlKey&&!i.metaKey||t.isWindows&&i.altKey&&i.ctrlKey&&!i.metaKey||t.isWindows&&i.getModifierState("AltGraph");return i.type==="keypress"?n:n&&(!i.keyCode||i.keyCode>47)}_keyUp(t){this._keyDownSeen=!1,!(this._customKeyEventHandler&&this._customKeyEventHandler(t)===!1)&&(zw(t)||this.focus(),this.updateCursorStyle(t),this._keyPressHandled=!1)}_keyPress(t){let i;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(t)===!1)return!1;if(this.cancel(t),t.charCode)i=t.charCode;else if(t.which===null||t.which===void 0)i=t.keyCode;else if(t.which!==0&&t.charCode!==0)i=t.which;else return!1;return!i||(t.altKey||t.ctrlKey||t.metaKey)&&!this._isThirdLevelShift(this.browser,t)?!1:(i=String.fromCharCode(i),this._onKey.fire({key:i,domEvent:t}),this._showCursor(),this.coreService.triggerDataEvent(i,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,!0)}_inputEvent(t){if(t.data&&t.inputType==="insertText"&&(!t.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;let i=t.data;return this.coreService.triggerDataEvent(i,!0),this.cancel(t),!0}return!1}resize(t,i){if(t===this.cols&&i===this.rows){this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure();return}super.resize(t,i)}_afterResize(t,i){this._charSizeService?.measure()}clear(){if(!(this.buffer.ybase===0&&this.buffer.y===0)){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let t=1;t<this.rows;t++)this.buffer.lines.push(this.buffer.getBlankLine(bt));this._onScroll.fire({position:this.buffer.ydisp}),this.refresh(0,this.rows-1)}}reset(){this.options.rows=this.rows,this.options.cols=this.cols;let t=this._customKeyEventHandler;this._setup(),super.reset(),this._selectionService?.reset(),this._decorationService.reset(),this._customKeyEventHandler=t,this.refresh(0,this.rows-1)}clearTextureAtlas(){this._renderService?.clearTextureAtlas()}_reportFocus(){this.element?.classList.contains("focus")?this.coreService.triggerDataEvent(oe.ESC+"[I"):this.coreService.triggerDataEvent(oe.ESC+"[O")}_reportWindowsOptions(t){if(this._renderService)switch(t){case 0:let i=this._renderService.dimensions.css.canvas.width.toFixed(0),n=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${oe.ESC}[4;${n};${i}t`);break;case 1:let a=this._renderService.dimensions.css.cell.width.toFixed(0),c=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${oe.ESC}[6;${c};${a}t`);break}}cancel(t,i){if(!(!this.options.cancelEvents&&!i))return t.preventDefault(),t.stopPropagation(),!1}};function zw(t){return t.keyCode===16||t.keyCode===17||t.keyCode===18}var Nw=class{constructor(){this._addons=[]}dispose(){for(let t=this._addons.length-1;t>=0;t--)this._addons[t].instance.dispose()}loadAddon(t,i){let n={instance:i,dispose:i.dispose,isDisposed:!1};this._addons.push(n),i.dispose=()=>this._wrappedAddonDispose(n),i.activate(t)}_wrappedAddonDispose(t){if(t.isDisposed)return;let i=-1;for(let n=0;n<this._addons.length;n++)if(this._addons[n]===t){i=n;break}if(i===-1)throw new Error("Could not dispose an addon that has not been loaded");t.isDisposed=!0,t.dispose.apply(t.instance),this._addons.splice(i,1)}},Hw=class{constructor(t){this._line=t}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(t,i){if(!(t<0||t>=this._line.length))return i?(this._line.loadCell(t,i),i):this._line.loadCell(t,new ki)}translateToString(t,i,n){return this._line.translateToString(t,i,n)}},jm=class{constructor(t,i){this._buffer=t,this.type=i}init(t){return this._buffer=t,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(t){let i=this._buffer.lines.get(t);if(i)return new Hw(i)}getNullCell(){return new ki}},Uw=class extends He{constructor(t){super(),this._core=t,this._onBufferChange=this._register(new pe),this.onBufferChange=this._onBufferChange.event,this._normal=new jm(this._core.buffers.normal,"normal"),this._alternate=new jm(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}},Iw=class{constructor(t){this._core=t}registerCsiHandler(t,i){return this._core.registerCsiHandler(t,n=>i(n.toArray()))}addCsiHandler(t,i){return this.registerCsiHandler(t,i)}registerDcsHandler(t,i){return this._core.registerDcsHandler(t,(n,a)=>i(n,a.toArray()))}addDcsHandler(t,i){return this.registerDcsHandler(t,i)}registerEscHandler(t,i){return this._core.registerEscHandler(t,i)}addEscHandler(t,i){return this.registerEscHandler(t,i)}registerOscHandler(t,i){return this._core.registerOscHandler(t,i)}addOscHandler(t,i){return this.registerOscHandler(t,i)}},jw=class{constructor(t){this._core=t}register(t){this._core.unicodeService.register(t)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(t){this._core.unicodeService.activeVersion=t}},Ww=["cols","rows"],ji=0,Fw=class extends He{constructor(t){super(),this._core=this._register(new Ow(t)),this._addonManager=this._register(new Nw),this._publicOptions={...this._core.options};let i=a=>this._core.options[a],n=(a,c)=>{this._checkReadonlyOptions(a),this._core.options[a]=c};for(let a in this._core.options){let c={get:i.bind(this,a),set:n.bind(this,a)};Object.defineProperty(this._publicOptions,a,c)}}_checkReadonlyOptions(t){if(Ww.includes(t))throw new Error(`Option "${t}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new Iw(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new jw(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this._register(new Uw(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){let t=this._core.coreService.decPrivateModes,i="none";switch(this._core.coreMouseService.activeProtocol){case"X10":i="x10";break;case"VT200":i="vt200";break;case"DRAG":i="drag";break;case"ANY":i="any";break}return{applicationCursorKeysMode:t.applicationCursorKeys,applicationKeypadMode:t.applicationKeypad,bracketedPasteMode:t.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:i,originMode:t.origin,reverseWraparoundMode:t.reverseWraparound,sendFocusMode:t.sendFocus,synchronizedOutputMode:t.synchronizedOutput,wraparoundMode:t.wraparound}}get options(){return this._publicOptions}set options(t){for(let i in t)this._publicOptions[i]=t[i]}blur(){this._core.blur()}focus(){this._core.focus()}input(t,i=!0){this._core.input(t,i)}resize(t,i){this._verifyIntegers(t,i),this._core.resize(t,i)}open(t){this._core.open(t)}attachCustomKeyEventHandler(t){this._core.attachCustomKeyEventHandler(t)}attachCustomWheelEventHandler(t){this._core.attachCustomWheelEventHandler(t)}registerLinkProvider(t){return this._core.registerLinkProvider(t)}registerCharacterJoiner(t){return this._checkProposedApi(),this._core.registerCharacterJoiner(t)}deregisterCharacterJoiner(t){this._checkProposedApi(),this._core.deregisterCharacterJoiner(t)}registerMarker(t=0){return this._verifyIntegers(t),this._core.registerMarker(t)}registerDecoration(t){return this._checkProposedApi(),this._verifyPositiveIntegers(t.x??0,t.width??0,t.height??0),this._core.registerDecoration(t)}hasSelection(){return this._core.hasSelection()}select(t,i,n){this._verifyIntegers(t,i,n),this._core.select(t,i,n)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(t,i){this._verifyIntegers(t,i),this._core.selectLines(t,i)}dispose(){super.dispose()}scrollLines(t){this._verifyIntegers(t),this._core.scrollLines(t)}scrollPages(t){this._verifyIntegers(t),this._core.scrollPages(t)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(t){this._verifyIntegers(t),this._core.scrollToLine(t)}clear(){this._core.clear()}write(t,i){this._core.write(t,i)}writeln(t,i){this._core.write(t),this._core.write(`\r
`,i)}paste(t){this._core.paste(t)}refresh(t,i){this._verifyIntegers(t,i),this._core.refresh(t,i)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(t){this._addonManager.loadAddon(this,t)}static get strings(){return{get promptLabel(){return Tu.get()},set promptLabel(t){Tu.set(t)},get tooMuchOutput(){return Au.get()},set tooMuchOutput(t){Au.set(t)}}}_verifyIntegers(...t){for(ji of t)if(ji===1/0||isNaN(ji)||ji%1!==0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...t){for(ji of t)if(ji&&(ji===1/0||isNaN(ji)||ji%1!==0||ji<0))throw new Error("This API only accepts positive integers")}};var Pw=2,Yw=1,qw=class{activate(t){this._terminal=t}dispose(){}fit(){let t=this.proposeDimensions();if(!t||!this._terminal||isNaN(t.cols)||isNaN(t.rows))return;let i=this._terminal._core;(this._terminal.rows!==t.rows||this._terminal.cols!==t.cols)&&(i._renderService.clear(),this._terminal.resize(t.cols,t.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;let t=this._terminal._core._renderService.dimensions;if(t.css.cell.width===0||t.css.cell.height===0)return;let i=this._terminal.options.scrollback===0?0:this._terminal.options.overviewRuler?.width||14,n=window.getComputedStyle(this._terminal.element.parentElement),a=parseInt(n.getPropertyValue("height")),c=Math.max(0,parseInt(n.getPropertyValue("width"))),h=window.getComputedStyle(this._terminal.element),d={top:parseInt(h.getPropertyValue("padding-top")),bottom:parseInt(h.getPropertyValue("padding-bottom")),right:parseInt(h.getPropertyValue("padding-right")),left:parseInt(h.getPropertyValue("padding-left"))},p=d.top+d.bottom,m=d.right+d.left,_=a-p,y=c-m-i;return{cols:Math.max(Pw,Math.floor(y/t.css.cell.width)),rows:Math.max(Yw,Math.floor(_/t.css.cell.height))}}};function Kw({machineId:t,sessionId:i,ws:n}){const a=K.useRef(null),c=K.useRef(n);return K.useEffect(()=>{c.current=n},[n]),K.useEffect(()=>{const h=new Fw({theme:{background:"#0d1117",foreground:"#e6edf3",cursor:"#58a6ff",selectionBackground:"#264f78"},cursorBlink:!0,fontSize:14,fontFamily:'"Cascadia Code", "Fira Code", monospace'}),d=new qw;h.loadAddon(d),h.open(a.current),d.fit(),h.focus();const p=h.onData(y=>{const b=c.current;b?.readyState===WebSocket.OPEN&&b.send(JSON.stringify({type:"terminal_input",machineId:t,sessionId:i,data:btoa(String.fromCharCode(...new TextEncoder().encode(y)))}))});function m(y){try{const b=JSON.parse(y.data);if(b.type==="pty_data"&&b.sessionId===i&&b.data){const E=Uint8Array.from(atob(b.data),R=>R.charCodeAt(0));h.write(E)}}catch{}}c.current?.addEventListener("message",m);const _=new ResizeObserver(()=>{try{d.fit();const y=c.current;y?.readyState===WebSocket.OPEN&&y.send(JSON.stringify({type:"terminal_resize",machineId:t,sessionId:i,cols:h.cols,rows:h.rows}))}catch{}});return a.current&&_.observe(a.current),()=>{p.dispose(),c.current?.removeEventListener("message",m),_.disconnect(),h.dispose()}},[]),T.jsx("div",{ref:a,style:{flex:1,height:"100%",padding:"4px",background:"#0d1117",overflow:"hidden"}})}function Gw({token:t,onClose:i}){const n=Ki(),a=yd(n),[c,h]=K.useState(""),[d,p]=K.useState(""),[m,_]=K.useState(""),[y,b]=K.useState(""),[E,R]=K.useState(!1),[D,k]=K.useState("");async function V(X){X.preventDefault(),_(""),b(""),R(!0);try{const he=await fetch("/api/admin/users",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({username:c,password:d})}),te=await he.json();he.ok?(b(` "${te.username}" `),h(""),p("")):_(te.error||"")}catch{_("")}finally{R(!1)}}return T.jsxs("div",{onClick:X=>X.target===X.currentTarget&&i(),style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.7)",backdropFilter:"blur(4px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:100,fontFamily:n.fontSans,animation:"fadeIn 0.15s ease"},children:[T.jsx("style",{children:`
        @keyframes fadeIn { from{opacity:0} to{opacity:1} }
        @keyframes slideUp { from{opacity:0;transform:translateY(12px)} to{opacity:1;transform:translateY(0)} }
        .modal-input:focus { border-color: ${n.borderAccent} !important; box-shadow: 0 0 0 3px ${n.accentDim}; }
        .modal-submit:hover:not(:disabled) { background: ${n.accentHover} !important; }
        .modal-cancel:hover { background: ${n.bgHover} !important; color: ${n.textPrimary} !important; }
      `}),T.jsxs("div",{style:{background:n.bgCard,border:`1px solid ${n.border}`,borderRadius:n.radiusLg,padding:"1.75rem",width:"100%",maxWidth:"340px",boxShadow:"0 24px 64px rgba(0,0,0,0.6)",animation:"slideUp 0.2s ease"},children:[T.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.25rem"},children:[T.jsxs("div",{children:[T.jsx("div",{style:{color:n.textPrimary,fontWeight:600,fontSize:"0.95rem"},children:""}),T.jsx("div",{style:{color:n.textMuted,fontSize:"0.75rem",marginTop:"2px"},children:""})]}),T.jsx("button",{onClick:i,style:{background:n.bgHover,border:`1px solid ${n.border}`,color:n.textMuted,borderRadius:"6px",cursor:"pointer",width:"28px",height:"28px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.85rem"},children:""})]}),m&&T.jsx("div",{style:{background:n.dangerDim,border:"1px solid rgba(239,68,68,0.25)",borderRadius:n.radiusSm,padding:"0.5rem 0.75rem",color:"#fca5a5",fontSize:"0.82rem",marginBottom:"1rem"},children:m}),y&&T.jsx("div",{style:{background:n.successDim,border:"1px solid rgba(16,185,129,0.25)",borderRadius:n.radiusSm,padding:"0.5rem 0.75rem",color:"#6ee7b7",fontSize:"0.82rem",marginBottom:"1rem"},children:y}),T.jsxs("form",{onSubmit:V,children:[T.jsxs("div",{style:{marginBottom:"0.75rem"},children:[T.jsx("label",{style:{display:"block",color:n.textSecondary,fontSize:"0.75rem",marginBottom:"0.3rem",fontWeight:500},children:""}),T.jsx("input",{className:"modal-input",placeholder:"",value:c,onChange:X=>h(X.target.value),autoFocus:!0,style:{...a,border:`1px solid ${D==="u"?n.borderAccent:n.border}`},onFocus:()=>k("u"),onBlur:()=>k("")})]}),T.jsxs("div",{style:{marginBottom:"1.25rem"},children:[T.jsx("label",{style:{display:"block",color:n.textSecondary,fontSize:"0.75rem",marginBottom:"0.3rem",fontWeight:500},children:""}),T.jsx("input",{className:"modal-input",type:"password",placeholder:" 6 ",value:d,onChange:X=>p(X.target.value),style:{...a,border:`1px solid ${D==="p"?n.borderAccent:n.border}`},onFocus:()=>k("p"),onBlur:()=>k("")})]}),T.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[T.jsx("button",{className:"modal-submit",type:"submit",disabled:E,style:{flex:1,padding:"0.55rem",background:E?n.bgHover:n.accent,color:"#fff",border:"none",borderRadius:n.radiusSm,cursor:E?"not-allowed":"pointer",fontSize:"0.85rem",fontWeight:600,fontFamily:n.fontSans,opacity:E?.7:1,transition:"background 0.15s"},children:E?"":""}),T.jsx("button",{className:"modal-cancel",type:"button",onClick:i,style:{flex:1,padding:"0.55rem",background:"none",color:n.textMuted,border:`1px solid ${n.border}`,borderRadius:n.radiusSm,cursor:"pointer",fontSize:"0.85rem",fontFamily:n.fontSans,transition:"all 0.15s"},children:""})]})]})]})]})}function Xw(t){if(!t)return"";const i=Date.now()-new Date(t).getTime(),n=Math.floor(i/6e4);if(n<1)return"";if(n<60)return`${n}m`;const a=Math.floor(n/60);return a<24?`${a}h`:`${Math.floor(a/24)}d`}const kd=(t,i)=>({padding:"0.35rem 0.6rem",cursor:"pointer",borderRadius:t.radiusSm,fontSize:"0.78rem",background:i?t.accentDim:"transparent",color:i?t.accent:t.textSecondary,borderLeft:`2px solid ${i?t.accent:"transparent"}`,transition:"all 0.12s",display:"flex",alignItems:"center",gap:"6px"}),x0=t=>({display:"inline-flex",alignItems:"center",gap:"4px",padding:"2px 7px",borderRadius:t.radiusPill,background:t.successDim,border:"1px solid rgba(16,185,129,0.2)",color:t.success,fontSize:"0.65rem",fontWeight:600,marginBottom:"4px",marginTop:"2px"});function Vw({sessions:t,active:i,onOpen:n}){const a=Ki(),c=t.reduce((h,d)=>((h[d.machineId]=h[d.machineId]||[]).push(d),h),{});return T.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"0.5rem"},children:[T.jsx("style",{children:`.sess-item:hover { background: ${a.bgHover} !important; color: ${a.textPrimary} !important; }`}),Object.entries(c).map(([h,d])=>T.jsxs("div",{style:{marginBottom:"0.75rem"},children:[T.jsxs("div",{style:x0(a),children:[T.jsx("span",{style:{width:"5px",height:"5px",borderRadius:"50%",background:a.success,display:"inline-block"}}),h]}),d.map(p=>T.jsxs("div",{className:"sess-item",onClick:()=>n(h,p.id,["claude"],p.cwd),style:kd(a,i?.sessionId===p.id&&i?.machineId===h),children:[T.jsx("span",{style:{fontFamily:a.fontMono,fontSize:"0.72rem",opacity:.7},children:p.id.slice(0,7)}),p.cwd&&T.jsx("span",{style:{color:a.textMuted,fontSize:"0.72rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:p.cwd.split("/").pop()||"/"})]},p.id))]},h)),t.length===0&&T.jsx(Md,{text:""})]})}function $w({activeSessions:t,active:i,onOpen:n}){const a=Ki(),c=t.reduce((h,d)=>{const p=d.machineId||"local";return(h[p]=h[p]||[]).push(d),h},{});return T.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"0.5rem"},children:[T.jsx("style",{children:`.sess-item:hover { background: ${a.bgHover} !important; color: ${a.textPrimary} !important; }`}),Object.entries(c).map(([h,d])=>T.jsxs("div",{style:{marginBottom:"0.75rem"},children:[T.jsxs("div",{style:x0(a),children:[T.jsx("span",{style:{width:"5px",height:"5px",borderRadius:"50%",background:a.success,display:"inline-block"}}),h]}),d.map(p=>T.jsxs("div",{className:"sess-item",onClick:()=>n(h,p.sessionId,["claude","--resume",p.sessionId],p.cwd),style:kd(a,i?.sessionId===p.sessionId),children:[T.jsx("span",{style:{fontFamily:a.fontMono,fontSize:"0.72rem",opacity:.7},children:p.sessionId.slice(0,7)}),T.jsx("span",{style:{color:a.textMuted,fontSize:"0.72rem",flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:p.cwd?.split("/").pop()||"/"}),T.jsx("span",{style:{color:a.textMuted,fontSize:"0.65rem",flexShrink:0},children:Xw(p.mtime)})]},p.sessionId))]},h)),t.length===0&&T.jsx(Md,{text:" CC session"})]})}function Zw({historySessions:t,active:i,onOpen:n}){const a=Ki(),[c,h]=K.useState(null);return T.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"0.5rem"},children:[T.jsx("style",{children:`
        .hist-item:hover { background: ${a.bgHover} !important; }
        .hist-actions { opacity: 0; transition: opacity 0.15s; }
        .hist-item:hover .hist-actions { opacity: 1 !important; }
        .hist-btn:hover { background: ${a.bgBase} !important; }
      `}),t.map(d=>T.jsxs("div",{className:"hist-item",onMouseEnter:()=>h(d.sessionId),onMouseLeave:()=>h(null),style:{...kd(a,i?.sessionId===d.sessionId),flexDirection:"column",alignItems:"stretch",gap:"2px",padding:"0.4rem 0.6rem"},children:[T.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[T.jsx("span",{style:{color:a.textPrimary,fontSize:"0.78rem",fontWeight:500,flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:d.cwd?.split("/").pop()||"/"}),d.gitBranch&&T.jsx("span",{style:{background:a.accentDim,color:a.accent,borderRadius:a.radiusPill,padding:"1px 6px",fontSize:"0.62rem",fontWeight:500,flexShrink:0},children:d.gitBranch}),T.jsx("span",{style:{color:a.textMuted,fontSize:"0.62rem",flexShrink:0},children:d.timestamp?.slice(0,10)})]}),d.summary&&T.jsx("div",{style:{color:a.textMuted,fontSize:"0.68rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:d.summary}),T.jsxs("div",{className:"hist-actions",style:{display:"flex",gap:"4px",marginTop:"3px"},children:[T.jsx("button",{className:"hist-btn",title:" claude",onClick:p=>{p.stopPropagation(),n(d.machineId||"local",d.sessionId,["claude"],d.cwd)},style:{background:a.bgCard,border:`1px solid ${a.border}`,color:a.success,borderRadius:"4px",cursor:"pointer",padding:"1px 7px",fontSize:"0.7rem",fontFamily:a.fontSans,transition:"background 0.12s"},children:" "}),T.jsx("button",{className:"hist-btn",title:`claude --resume ${d.sessionId}`,onClick:p=>{p.stopPropagation(),n(d.machineId||"local",d.sessionId,["claude","--resume",d.sessionId],d.cwd)},style:{background:a.bgCard,border:`1px solid ${a.border}`,color:a.accent,borderRadius:"4px",cursor:"pointer",padding:"1px 7px",fontSize:"0.7rem",fontFamily:a.fontSans,transition:"background 0.12s"},children:" "})]})]},d.sessionId)),t.length===0&&T.jsx(Md,{text:" session"})]})}function Md({text:t}){const i=Ki();return T.jsx("div",{style:{textAlign:"center",padding:"1.5rem 0.5rem",color:i.textMuted,fontSize:"0.75rem"},children:t})}function Qw({sessions:t,activeSessions:i,historySessions:n,active:a,onOpen:c}){const h=Ki(),[d,p]=K.useState("active"),m=[{key:"active",label:"",count:t.length},{key:"running",label:"",count:i.length},{key:"history",label:"",count:n.length}];return T.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[T.jsx("style",{children:`.tab-btn:hover { color: ${h.textPrimary} !important; }`}),T.jsx("div",{style:{display:"flex",gap:"2px",padding:"6px 8px",borderBottom:`1px solid ${h.border}`,flexShrink:0},children:m.map(({key:_,label:y,count:b})=>T.jsxs("button",{className:"tab-btn",onClick:()=>p(_),style:{flex:1,padding:"4px 0",background:d===_?h.bgHover:"none",border:`1px solid ${d===_?h.border:"transparent"}`,borderRadius:h.radiusSm,color:d===_?h.textPrimary:h.textMuted,cursor:"pointer",fontSize:"0.72rem",fontWeight:d===_?600:400,fontFamily:h.fontSans,transition:"all 0.12s",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px"},children:[y,b>0&&T.jsx("span",{style:{background:d===_?h.accentDim:"rgba(128,128,128,0.12)",color:d===_?h.accent:h.textMuted,borderRadius:h.radiusPill,padding:"0 5px",fontSize:"0.62rem",fontWeight:600},children:b})]},_))}),d==="active"&&T.jsx(Vw,{sessions:t,active:a,onOpen:c}),d==="running"&&T.jsx($w,{activeSessions:i,active:a,onOpen:c}),d==="history"&&T.jsx(Zw,{historySessions:n,active:a,onOpen:c})]})}function E0({ws:t,machineId:i,rootPath:n,onLaunch:a}){const c=Ki(),[h,d]=K.useState(null),[p,m]=K.useState({});return K.useEffect(()=>{if(!t||!i)return;const _=y=>{try{const b=JSON.parse(y.data);b.type==="dir_entries"&&b.path===n&&d(b.entries||[])}catch{}};return t.addEventListener("message",_),t.send(JSON.stringify({type:"list_dir",machineId:i,path:n})),()=>t.removeEventListener("message",_)},[t,i,n]),h?T.jsxs("div",{children:[T.jsx("style",{children:`.dir-row:hover { background: ${c.bgHover} !important; } .dir-launch:hover { background: ${c.accentDim} !important; color: ${c.accent} !important; }`}),h.map(_=>T.jsxs("div",{children:[T.jsxs("div",{className:"dir-row",style:{display:"flex",alignItems:"center",padding:"0.2rem 0.4rem",gap:"4px",borderRadius:c.radiusSm,cursor:"pointer",transition:"background 0.1s"},children:[T.jsx("span",{onClick:()=>m(y=>({...y,[_.path]:!y[_.path]})),style:{color:c.textMuted,fontSize:"0.6rem",width:"10px",userSelect:"none",flexShrink:0},children:p[_.path]?"":""}),T.jsx("span",{style:{fontSize:"0.72rem"},children:""}),T.jsx("span",{style:{flex:1,color:c.textSecondary,fontSize:"0.75rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},onClick:()=>m(y=>({...y,[_.path]:!y[_.path]})),children:_.name}),T.jsx("button",{className:"dir-launch",title:` ${_.path} `,onClick:()=>a(_.path),style:{background:"none",border:`1px solid ${c.border}`,color:c.textMuted,borderRadius:"4px",cursor:"pointer",padding:"1px 5px",fontSize:"0.65rem",flexShrink:0,transition:"all 0.12s"},children:""})]}),p[_.path]&&T.jsx("div",{style:{paddingLeft:"14px"},children:T.jsx(E0,{ws:t,machineId:i,rootPath:_.path,onLaunch:a})})]},_.path))]}):T.jsx("div",{style:{color:c.textMuted,fontSize:"0.72rem",padding:"0.25rem 0.75rem"},children:""})}function Jw({ws:t,machineId:i,historySessions:n,onLaunch:a,onClose:c}){const h=Ki(),[d,p]=K.useState(""),m=[...new Set((n||[]).map(_=>_.cwd).filter(Boolean))].slice(0,5);return T.jsxs("div",{style:{background:h.bgCard,border:`1px solid ${h.border}`,borderRadius:h.radiusMd,margin:"0.5rem",padding:"0.75rem",fontSize:"0.78rem"},children:[T.jsx("style",{children:`.recent-tag:hover { background: ${h.accentDim} !important; border-color: ${h.borderAccent} !important; color: ${h.accent} !important; } .path-input:focus { border-color: ${h.borderAccent} !important; box-shadow: 0 0 0 2px ${h.accentDim}; }`}),T.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.6rem"},children:[T.jsx("span",{style:{color:h.textSecondary,fontWeight:600,fontSize:"0.75rem"},children:""}),T.jsx("button",{onClick:c,style:{background:"none",border:"none",color:h.textMuted,cursor:"pointer",fontSize:"0.9rem",lineHeight:1,padding:"2px"},children:""})]}),m.length>0&&T.jsxs("div",{style:{marginBottom:"0.6rem"},children:[T.jsx("div",{style:{color:h.textMuted,fontSize:"0.65rem",fontWeight:600,letterSpacing:"0.05em",textTransform:"uppercase",marginBottom:"0.35rem"},children:""}),T.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"4px"},children:m.map(_=>T.jsx("button",{className:"recent-tag",onClick:()=>a(_),title:_,style:{background:h.bgHover,border:`1px solid ${h.border}`,color:h.textSecondary,borderRadius:h.radiusPill,cursor:"pointer",padding:"2px 8px",fontSize:"0.68rem",fontFamily:h.fontSans,transition:"all 0.12s",maxWidth:"120px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:_.split("/").pop()||_},_))})]}),T.jsxs("div",{style:{borderTop:`1px solid ${h.border}`,paddingTop:"0.5rem",marginBottom:"0.5rem"},children:[T.jsx("div",{style:{color:h.textMuted,fontSize:"0.65rem",fontWeight:600,letterSpacing:"0.05em",textTransform:"uppercase",marginBottom:"0.35rem"},children:""}),T.jsx("div",{style:{maxHeight:"160px",overflowY:"auto"},children:T.jsx(E0,{ws:t,machineId:i,rootPath:"/",onLaunch:a})})]}),T.jsxs("div",{style:{borderTop:`1px solid ${h.border}`,paddingTop:"0.5rem",display:"flex",gap:"4px"},children:[T.jsx("input",{className:"path-input",value:d,onChange:_=>p(_.target.value),onKeyDown:_=>_.key==="Enter"&&d&&a(d),placeholder:"",style:{flex:1,background:h.bgInput,border:`1px solid ${h.border}`,color:h.textPrimary,borderRadius:h.radiusSm,padding:"4px 8px",fontSize:"0.75rem",outline:"none",fontFamily:h.fontMono,transition:"border-color 0.15s"}}),T.jsx("button",{onClick:()=>d&&a(d),style:{background:h.accent,border:"none",color:"#fff",borderRadius:h.radiusSm,cursor:"pointer",padding:"4px 10px",fontSize:"0.75rem"},children:""})]})]})}const Ee=16,mu=20,vu=11,e2=64,t2=64,i2=48,Wm=.15,Fm=.3,yu=2,Su=20,cd=3,hd=6,s2=120,r2=240,T0=.3,wl=6,A0=16,Pm=24,n2=30,l2=180,Ym=.3,qm="#ccffcc",a2=.6,Km=.5,Gm=.33,Xm=.66,Ld=6,o2=.5,c2=.001,h2=1,u2=.5,d2=.5,f2=.25,_2=[4,3],R0=6,D0=3,k0=.45,M0=1.5,L0=.5,Vm=.5,g2=10,p2=24,B0="#808080",m2="rgba(0, 127, 212, 0.35)",v2="rgba(0, 200, 80, 0.35)",y2="rgba(220, 50, 50, 0.35)",S2="rgba(255,255,255,0.12)",b2="rgba(255,255,255,0.08)",O0=[2,2],C2="rgba(60, 130, 220, 0.25)",w2="rgba(60, 130, 220, 0.5)",x2="rgba(255, 255, 255, 0.06)",E2="#00ff00",T2="#ff0000",A2="#007fd4",R2="rgba(200, 50, 50, 0.85)",D2="rgba(50, 120, 200, 0.85)",$m=.1,Zm=.5,zo=1,Bd=10,k2=2,M2=1500,L2=2e3,B2=.5,O2=50,Qm=.25,Jm=50,z2=500,N2={h:35,s:30,b:15,c:0},H2={h:240,s:25,b:0,c:0},U2={h:0,s:0,b:0,c:0},I2=659.25,j2=1318.51,W2=0,F2=.1,ev=.18,P2=.14,Y2=.1,q2=2,K2=.3,tv=3,iv=2,sv=6,G2=45,X2=271,V2=3,$2=2,rv=8,Z2=24,Q2=32,J2=1.5,Ue={WALL:0,FLOOR_1:1,FLOOR_2:2,FLOOR_3:3,FLOOR_4:4,VOID:8},et={IDLE:"idle",WALK:"walk",TYPE:"type"},be={DOWN:0,LEFT:1,RIGHT:2,UP:3},ot={DESK:"desk",BOOKSHELF:"bookshelf",PLANT:"plant",COOLER:"cooler",WHITEBOARD:"whiteboard",CHAIR:"chair",PC:"pc",LAMP:"lamp"},Te={TILE_PAINT:"tile_paint",WALL_PAINT:"wall_paint",FURNITURE_PLACE:"furniture_place",FURNITURE_PICK:"furniture_pick",SELECT:"select",EYEDROPPER:"eyedropper",ERASE:"erase"};function ko(t,i,n,a){const c=n.length,h=c>0?n[0].length:0;if(i<0||i>=c||t<0||t>=h)return!1;const d=n[i][t];return!(d===Ue.WALL||d===Ue.VOID||a.has(`${t},${i}`))}function nv(t,i){const n=t.length,a=n>0?t[0].length:0,c=[];for(let h=0;h<n;h++)for(let d=0;d<a;d++)ko(d,h,t,i)&&c.push({col:d,row:h});return c}function br(t,i,n,a,c,h){if(t===n&&i===a)return[];const d=(D,k)=>`${D},${k}`,p=d(t,i),m=d(n,a);if(!ko(n,a,c,h))return[];const y=new Set;y.add(p);const b=new Map,E=[{col:t,row:i}],R=[{dc:0,dr:-1},{dc:0,dr:1},{dc:-1,dr:0},{dc:1,dr:0}];for(;E.length>0;){const D=E.shift(),k=d(D.col,D.row);if(k===m){const V=[];let X=m;for(;X!==p;){const[he,te]=X.split(",").map(Number);V.unshift({col:he,row:te}),X=b.get(X)}return V}for(const V of R){const X=D.col+V.dc,he=D.row+V.dr,te=d(X,he);y.has(te)||ko(X,he,c,h)&&(y.add(te),b.set(te,k),E.push({col:X,row:he}))}}return[]}const ex=new Set(["Read","Grep","Glob","WebFetch","WebSearch"]);function tx(t){return t?ex.has(t):!1}function Co(t,i){return{x:t*Ee+Ee/2,y:i*Ee+Ee/2}}function ix(t,i,n,a){const c=n-t,h=a-i;return c>0?be.RIGHT:c<0?be.LEFT:h>0?be.DOWN:be.UP}function ho(t,i,n,a,c=0){const h=a?a.seatCol:1,d=a?a.seatRow:1,p=Co(h,d);return{id:t,state:et.TYPE,dir:a?a.facingDir:be.DOWN,x:p.x,y:p.y,tileCol:h,tileRow:d,path:[],moveProgress:0,currentTool:null,palette:i,hueShift:c,frame:0,frameTimer:0,wanderTimer:0,wanderCount:0,wanderLimit:ud(cd,hd),isActive:!0,seatId:n,bubbleType:null,bubbleTimer:0,seatTimer:0,isSubagent:!1,parentAgentId:null,matrixEffect:null,matrixEffectTimer:0,matrixEffectSeeds:[]}}function sx(t,i,n,a,c,h){switch(t.frameTimer+=i,t.state){case et.TYPE:{if(t.frameTimer>=Fm&&(t.frameTimer-=Fm,t.frame=(t.frame+1)%2),!t.isActive){if(t.seatTimer>0){t.seatTimer-=i;break}t.seatTimer=0,t.state=et.IDLE,t.frame=0,t.frameTimer=0,t.wanderTimer=uo(yu,Su),t.wanderCount=0,t.wanderLimit=ud(cd,hd)}break}case et.IDLE:{if(t.frame=0,t.seatTimer<0&&(t.seatTimer=0),t.isActive){if(!t.seatId){t.state=et.TYPE,t.frame=0,t.frameTimer=0;break}const d=a.get(t.seatId);if(d){const p=br(t.tileCol,t.tileRow,d.seatCol,d.seatRow,c,h);p.length>0?(t.path=p,t.moveProgress=0,t.state=et.WALK,t.frame=0,t.frameTimer=0):(t.state=et.TYPE,t.dir=d.facingDir,t.frame=0,t.frameTimer=0)}break}if(t.wanderTimer-=i,t.wanderTimer<=0){if(t.wanderCount>=t.wanderLimit&&t.seatId){const d=a.get(t.seatId);if(d){const p=br(t.tileCol,t.tileRow,d.seatCol,d.seatRow,c,h);if(p.length>0){t.path=p,t.moveProgress=0,t.state=et.WALK,t.frame=0,t.frameTimer=0;break}}}if(n.length>0){const d=n[Math.floor(Math.random()*n.length)],p=br(t.tileCol,t.tileRow,d.col,d.row,c,h);p.length>0&&(t.path=p,t.moveProgress=0,t.state=et.WALK,t.frame=0,t.frameTimer=0,t.wanderCount++)}t.wanderTimer=uo(yu,Su)}break}case et.WALK:{if(t.frameTimer>=Wm&&(t.frameTimer-=Wm,t.frame=(t.frame+1)%4),t.path.length===0){const y=Co(t.tileCol,t.tileRow);if(t.x=y.x,t.y=y.y,t.isActive)if(!t.seatId)t.state=et.TYPE;else{const b=a.get(t.seatId);b&&t.tileCol===b.seatCol&&t.tileRow===b.seatRow?(t.state=et.TYPE,t.dir=b.facingDir):t.state=et.IDLE}else{if(t.seatId){const b=a.get(t.seatId);if(b&&t.tileCol===b.seatCol&&t.tileRow===b.seatRow){t.state=et.TYPE,t.dir=b.facingDir,t.seatTimer<0?t.seatTimer=0:t.seatTimer=uo(s2,r2),t.wanderCount=0,t.wanderLimit=ud(cd,hd),t.frame=0,t.frameTimer=0;break}}t.state=et.IDLE,t.wanderTimer=uo(yu,Su)}t.frame=0,t.frameTimer=0;break}const d=t.path[0];t.dir=ix(t.tileCol,t.tileRow,d.col,d.row),t.moveProgress+=i2/Ee*i;const p=Co(t.tileCol,t.tileRow),m=Co(d.col,d.row),_=Math.min(t.moveProgress,1);if(t.x=p.x+(m.x-p.x)*_,t.y=p.y+(m.y-p.y)*_,t.moveProgress>=1&&(t.tileCol=d.col,t.tileRow=d.row,t.x=m.x,t.y=m.y,t.path.shift(),t.moveProgress=0),t.isActive&&t.seatId){const y=a.get(t.seatId);if(y){const b=t.path[t.path.length-1];if(!b||b.col!==y.seatCol||b.row!==y.seatRow){const E=br(t.tileCol,t.tileRow,y.seatCol,y.seatRow,c,h);E.length>0&&(t.path=E,t.moveProgress=0)}}}break}}}function rx(t,i){switch(t.state){case et.TYPE:return tx(t.currentTool)?i.reading[t.dir][t.frame%2]:i.typing[t.dir][t.frame%2];case et.WALK:return i.walk[t.dir][t.frame%4];case et.IDLE:return i.walk[t.dir][1];default:return i.walk[t.dir][1]}}function uo(t,i){return t+Math.random()*(i-t)}function ud(t,i){return t+Math.floor(Math.random()*(i-t+1))}function bu(t,i,n){const a=Math.floor(n*n2);return(t*7+i*13+a*31&255)<l2}function xl(){const t=[];for(let i=0;i<A0;i++)t.push(Math.random());return t}function nx(t,i,n,a,c,h){const d=i.matrixEffectTimer/T0,p=i.matrixEffect==="spawn",m=i.matrixEffectTimer,_=Pm+wl;for(let y=0;y<A0;y++){const b=(i.matrixEffectSeeds[y]??0)*Ym,R=Math.max(0,Math.min(1,(d-b)/(1-Ym)))*_;for(let D=0;D<Pm;D++){const k=n[D]?.[y],V=k&&k!=="",X=R-D,he=a+y*h,te=c+D*h;if(p){if(X<0)continue;if(X<1)t.fillStyle=qm,t.fillRect(he,te,h,h);else if(X<wl){const ue=X/wl;if(V){t.fillStyle=k,t.fillRect(he,te,h,h);const de=(1-ue)*a2;bu(y,D,m)&&(t.fillStyle=`rgba(0, 255, 65, ${de})`,t.fillRect(he,te,h,h))}else if(bu(y,D,m)){const de=(1-ue)*Km;t.fillStyle=ue<Gm?`rgba(0, 255, 65, ${de})`:ue<Xm?`rgba(0, 170, 40, ${de})`:`rgba(0, 85, 20, ${de})`,t.fillRect(he,te,h,h)}}else V&&(t.fillStyle=k,t.fillRect(he,te,h,h))}else if(X<0)V&&(t.fillStyle=k,t.fillRect(he,te,h,h));else if(X<1)t.fillStyle=qm,t.fillRect(he,te,h,h);else if(X<wl&&bu(y,D,m)){const ue=X/wl,de=(1-ue)*Km;t.fillStyle=ue<Gm?`rgba(0, 255, 65, ${de})`:ue<Xm?`rgba(0, 170, 40, ${de})`:`rgba(0, 85, 20, ${de})`,t.fillRect(he,te,h,h)}}}}const dd=new Map;function Od(t,i,n){const a=dd.get(t);if(a)return a;const c=n.colorize?ax(i,n):N0(i,n);return dd.set(t,c),c}function lx(){dd.clear()}function ax(t,i){const{h:n,s:a,b:c,c:h}=i,d=[];for(const p of t){const m=[];for(const _ of p){if(_===""){m.push("");continue}const y=parseInt(_.slice(1,3),16),b=parseInt(_.slice(3,5),16),E=parseInt(_.slice(5,7),16);let R=(.299*y+.587*b+.114*E)/255;if(h!==0){const V=(100+h)/100;R=.5+(R-.5)*V}c!==0&&(R=R+c/200),R=Math.max(0,Math.min(1,R));const D=a/100,k=z0(n,D,R);m.push(k)}d.push(m)}return d}function z0(t,i,n){const a=(1-Math.abs(2*n-1))*i,c=t/60,h=a*(1-Math.abs(c%2-1));let d=0,p=0,m=0;c<1?(d=a,p=h,m=0):c<2?(d=h,p=a,m=0):c<3?(d=0,p=a,m=h):c<4?(d=0,p=h,m=a):c<5?(d=h,p=0,m=a):(d=a,p=0,m=h);const _=n-a/2,y=Math.round((d+_)*255),b=Math.round((p+_)*255),E=Math.round((m+_)*255);return`#${Cu(y).toString(16).padStart(2,"0")}${Cu(b).toString(16).padStart(2,"0")}${Cu(E).toString(16).padStart(2,"0")}`.toUpperCase()}function Cu(t){return Math.max(0,Math.min(255,t))}function ox(t,i,n){const a=t/255,c=i/255,h=n/255,d=Math.max(a,c,h),p=Math.min(a,c,h),m=(d+p)/2;if(d===p)return[0,0,m];const _=d-p,y=m>.5?_/(2-d-p):_/(d+p);let b=0;return d===a?b=((c-h)/_+(c<h?6:0))*60:d===c?b=((h-a)/_+2)*60:b=((a-c)/_+4)*60,[b,y,m]}function N0(t,i){const{h:n,s:a,b:c,c:h}=i,d=[];for(const p of t){const m=[];for(const _ of p){if(_===""){m.push("");continue}const y=parseInt(_.slice(1,3),16),b=parseInt(_.slice(3,5),16),E=parseInt(_.slice(5,7),16),[R,D,k]=ox(y,b,E),V=((R+n)%360+360)%360,X=Math.max(0,Math.min(1,D+a/100));let he=k;if(h!==0){const ue=(100+h)/100;he=.5+(he-.5)*ue}c!==0&&(he=he+c/200),he=Math.max(0,Math.min(1,he));const te=z0(V,X,he);m.push(te)}d.push(m)}return d}const e="",cx=(()=>{const t="#8B6914",i="#A07828",n="#B8922E",a="#6B4E0A",c=[];c.push(new Array(32).fill(e)),c.push([e,...new Array(30).fill(t),e]);for(let h=0;h<4;h++)c.push([e,t,...new Array(28).fill(h<1?i:n),t,e]);c.push([e,a,...new Array(28).fill(t),a,e]);for(let h=0;h<6;h++)c.push([e,t,...new Array(28).fill(n),t,e]);c.push([e,t,...new Array(28).fill(i),t,e]);for(let h=0;h<6;h++)c.push([e,t,...new Array(28).fill(n),t,e]);c.push([e,a,...new Array(28).fill(t),a,e]);for(let h=0;h<4;h++)c.push([e,t,...new Array(28).fill(h>2?i:n),t,e]);c.push([e,...new Array(30).fill(t),e]);for(let h=0;h<4;h++){const d=new Array(32).fill(e);d[1]=a,d[2]=a,d[29]=a,d[30]=a,c.push(d)}return c.push(new Array(32).fill(e)),c.push(new Array(32).fill(e)),c})(),hx=(()=>{const t="#3D8B37",i="#2D6B27",n="#6B4E0A",a="#B85C3A",c="#8B4422";return[[e,e,e,e,e,e,t,t,e,e,e,e,e,e,e,e],[e,e,e,e,e,t,t,t,t,e,e,e,e,e,e,e],[e,e,e,e,t,t,i,t,t,t,e,e,e,e,e,e],[e,e,e,t,t,i,t,t,i,t,t,e,e,e,e,e],[e,e,t,t,t,t,t,t,t,t,t,t,e,e,e,e],[e,t,t,i,t,t,t,t,t,t,i,t,t,e,e,e],[e,t,t,t,t,i,t,t,i,t,t,t,t,e,e,e],[e,e,t,t,t,t,t,t,t,t,t,t,e,e,e,e],[e,e,e,t,t,t,i,t,t,t,t,e,e,e,e,e],[e,e,e,e,t,t,t,t,t,t,e,e,e,e,e,e],[e,e,e,e,e,t,t,t,t,e,e,e,e,e,e,e],[e,e,e,e,e,e,n,n,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,n,n,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,n,n,e,e,e,e,e,e,e,e],[e,e,e,e,e,c,c,c,c,c,e,e,e,e,e,e],[e,e,e,e,c,a,a,a,a,a,c,e,e,e,e,e],[e,e,e,e,c,a,a,a,a,a,c,e,e,e,e,e],[e,e,e,e,c,a,a,a,a,a,c,e,e,e,e,e],[e,e,e,e,c,a,a,a,a,a,c,e,e,e,e,e],[e,e,e,e,c,a,a,a,a,a,c,e,e,e,e,e],[e,e,e,e,c,a,a,a,a,a,c,e,e,e,e,e],[e,e,e,e,e,c,a,a,a,c,e,e,e,e,e,e],[e,e,e,e,e,e,c,c,c,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e]]})(),ux=(()=>{const t="#8B6914",i="#6B4E0A",n="#CC4444",a="#4477AA",c="#44AA66",h="#CCAA33",d="#9955AA";return[[e,t,t,t,t,t,t,t,t,t,t,t,t,t,t,e],[t,i,i,i,i,i,i,i,i,i,i,i,i,i,i,t],[t,i,n,n,a,a,c,c,h,h,n,n,a,a,i,t],[t,i,n,n,a,a,c,c,h,h,n,n,a,a,i,t],[t,i,n,n,a,a,c,c,h,h,n,n,a,a,i,t],[t,i,n,n,a,a,c,c,h,h,n,n,a,a,i,t],[t,i,n,n,a,a,c,c,h,h,n,n,a,a,i,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,i,i,i,i,i,i,i,i,i,i,i,i,i,i,t],[t,i,d,d,h,h,a,a,c,c,d,d,n,n,i,t],[t,i,d,d,h,h,a,a,c,c,d,d,n,n,i,t],[t,i,d,d,h,h,a,a,c,c,d,d,n,n,i,t],[t,i,d,d,h,h,a,a,c,c,d,d,n,n,i,t],[t,i,d,d,h,h,a,a,c,c,d,d,n,n,i,t],[t,i,d,d,h,h,a,a,c,c,d,d,n,n,i,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,i,i,i,i,i,i,i,i,i,i,i,i,i,i,t],[t,i,c,c,n,n,d,d,a,a,h,h,c,c,i,t],[t,i,c,c,n,n,d,d,a,a,h,h,c,c,i,t],[t,i,c,c,n,n,d,d,a,a,h,h,c,c,i,t],[t,i,c,c,n,n,d,d,a,a,h,h,c,c,i,t],[t,i,c,c,n,n,d,d,a,a,h,h,c,c,i,t],[t,i,c,c,n,n,d,d,a,a,h,h,c,c,i,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,i,i,i,i,i,i,i,i,i,i,i,i,i,i,t],[t,i,i,i,i,i,i,i,i,i,i,i,i,i,i,t],[t,i,i,i,i,i,i,i,i,i,i,i,i,i,i,t],[t,i,i,i,i,i,i,i,i,i,i,i,i,i,i,t],[t,i,i,i,i,i,i,i,i,i,i,i,i,i,i,t],[t,i,i,i,i,i,i,i,i,i,i,i,i,i,i,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[e,t,t,t,t,t,t,t,t,t,t,t,t,t,t,e]]})(),dx=(()=>{const t="#CCDDEE",i="#88BBDD",n="#999999",a="#666666";return[[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,n,n,n,n,n,n,e,e,e,e,e],[e,e,e,e,n,i,i,i,i,i,i,n,e,e,e,e],[e,e,e,e,n,i,i,i,i,i,i,n,e,e,e,e],[e,e,e,e,n,i,i,i,i,i,i,n,e,e,e,e],[e,e,e,e,n,i,i,i,i,i,i,n,e,e,e,e],[e,e,e,e,n,i,i,i,i,i,i,n,e,e,e,e],[e,e,e,e,e,n,n,n,n,n,n,e,e,e,e,e],[e,e,e,e,e,n,t,t,t,t,n,e,e,e,e,e],[e,e,e,e,e,n,t,t,t,t,n,e,e,e,e,e],[e,e,e,e,e,n,t,t,t,t,n,e,e,e,e,e],[e,e,e,e,e,n,t,t,t,t,n,e,e,e,e,e],[e,e,e,e,e,n,t,t,t,t,n,e,e,e,e,e],[e,e,e,e,n,n,t,t,t,t,n,n,e,e,e,e],[e,e,e,e,n,t,t,t,t,t,t,n,e,e,e,e],[e,e,e,e,n,t,t,t,t,t,t,n,e,e,e,e],[e,e,e,e,n,n,n,n,n,n,n,n,e,e,e,e],[e,e,e,e,e,n,a,a,a,a,n,e,e,e,e,e],[e,e,e,e,e,n,a,a,a,a,n,e,e,e,e,e],[e,e,e,e,e,n,a,a,a,a,n,e,e,e,e,e],[e,e,e,e,n,n,a,a,a,a,n,n,e,e,e,e],[e,e,e,e,n,a,a,a,a,a,a,n,e,e,e,e],[e,e,e,e,n,n,n,n,n,n,n,n,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e]]})(),fx=(()=>{const t="#AAAAAA",i="#EEEEFF",n="#CC4444",a="#4477AA";return[[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,e],[e,t,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,t,e],[e,t,i,i,n,n,n,i,i,i,i,i,a,a,a,a,i,i,i,i,i,i,i,n,i,i,i,i,i,i,t,e],[e,t,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,a,a,i,i,n,i,i,i,i,i,i,t,e],[e,t,i,i,i,i,n,n,n,n,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,a,a,i,i,t,e],[e,t,i,i,i,i,i,i,i,i,i,i,i,a,a,a,i,i,i,i,i,i,i,i,i,i,i,i,i,i,t,e],[e,t,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,n,n,n,i,i,i,i,i,i,i,t,e],[e,t,i,n,n,i,i,i,i,i,i,i,i,i,i,i,a,a,i,i,i,i,i,i,i,i,i,i,i,i,t,e],[e,t,i,i,i,i,i,i,a,a,a,i,i,i,i,i,i,i,i,i,i,i,i,i,n,n,n,n,i,i,t,e],[e,t,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,t,e],[e,t,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,t,e],[e,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e]]})(),_x=(()=>{const t="#8B6914",i="#6B4E0A",n="#5C3D0A",a="#A07828";return[[e,e,e,e,e,i,i,i,i,i,i,e,e,e,e,e],[e,e,e,e,i,n,n,n,n,n,n,i,e,e,e,e],[e,e,e,e,i,n,a,a,a,a,n,i,e,e,e,e],[e,e,e,e,i,n,a,a,a,a,n,i,e,e,e,e],[e,e,e,e,i,n,a,a,a,a,n,i,e,e,e,e],[e,e,e,e,i,n,a,a,a,a,n,i,e,e,e,e],[e,e,e,e,i,n,a,a,a,a,n,i,e,e,e,e],[e,e,e,e,i,n,a,a,a,a,n,i,e,e,e,e],[e,e,e,e,i,n,a,a,a,a,n,i,e,e,e,e],[e,e,e,e,i,n,n,n,n,n,n,i,e,e,e,e],[e,e,e,e,e,i,i,i,i,i,i,e,e,e,e,e],[e,e,e,e,e,e,i,t,t,i,e,e,e,e,e,e],[e,e,e,e,e,e,i,t,t,i,e,e,e,e,e,e],[e,e,e,e,e,i,i,i,i,i,i,e,e,e,e,e],[e,e,e,e,e,i,e,e,e,e,i,e,e,e,e,e],[e,e,e,e,e,i,e,e,e,e,i,e,e,e,e,e]]})(),gx=(()=>{const t="#555555",i="#3A3A5C",n="#6688CC",a="#444444";return[[e,e,e,t,t,t,t,t,t,t,t,t,t,e,e,e],[e,e,e,t,i,i,i,i,i,i,i,i,t,e,e,e],[e,e,e,t,i,n,n,n,n,n,n,i,t,e,e,e],[e,e,e,t,i,n,n,n,n,n,n,i,t,e,e,e],[e,e,e,t,i,n,n,n,n,n,n,i,t,e,e,e],[e,e,e,t,i,n,n,n,n,n,n,i,t,e,e,e],[e,e,e,t,i,n,n,n,n,n,n,i,t,e,e,e],[e,e,e,t,i,n,n,n,n,n,n,i,t,e,e,e],[e,e,e,t,i,i,i,i,i,i,i,i,t,e,e,e],[e,e,e,t,t,t,t,t,t,t,t,t,t,e,e,e],[e,e,e,e,e,e,e,a,a,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,a,a,e,e,e,e,e,e,e],[e,e,e,e,e,e,a,a,a,a,e,e,e,e,e,e],[e,e,e,e,e,a,a,a,a,a,a,e,e,e,e,e],[e,e,e,e,e,a,a,a,a,a,a,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e]]})(),px=(()=>{const t="#FFDD55",i="#FFEE88",n="#888888",a="#555555",c="#FFFFCC";return[[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,c,c,c,c,e,e,e,e,e,e],[e,e,e,e,e,c,t,t,t,t,c,e,e,e,e,e],[e,e,e,e,c,t,t,i,i,t,t,c,e,e,e,e],[e,e,e,e,t,t,i,i,i,i,t,t,e,e,e,e],[e,e,e,e,t,t,i,i,i,i,t,t,e,e,e,e],[e,e,e,e,e,t,t,t,t,t,t,e,e,e,e,e],[e,e,e,e,e,e,n,n,n,n,e,e,e,e,e,e],[e,e,e,e,e,e,e,n,n,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,n,n,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,n,n,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,n,n,e,e,e,e,e,e,e],[e,e,e,e,e,e,n,n,n,n,e,e,e,e,e,e],[e,e,e,e,e,a,a,a,a,a,a,e,e,e,e,e],[e,e,e,e,e,a,a,a,a,a,a,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e]]})(),mx=(()=>{const t="#555566",i="#EEEEFF",n="#CCA700";return[[t,t,t,t,t,t,t,t,t,t,t],[t,i,i,i,i,i,i,i,i,i,t],[t,i,i,i,i,i,i,i,i,i,t],[t,i,i,i,i,i,i,i,i,i,t],[t,i,i,i,i,i,i,i,i,i,t],[t,i,i,n,i,n,i,n,i,i,t],[t,i,i,i,i,i,i,i,i,i,t],[t,i,i,i,i,i,i,i,i,i,t],[t,i,i,i,i,i,i,i,i,i,t],[t,t,t,t,t,t,t,t,t,t,t],[e,e,e,e,t,t,t,e,e,e,e],[e,e,e,e,e,t,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e]]})(),vx=(()=>{const t="#555566",i="#EEEEFF",n="#44BB66";return[[e,t,t,t,t,t,t,t,t,t,e],[t,i,i,i,i,i,i,i,i,i,t],[t,i,i,i,i,i,i,i,i,i,t],[t,i,i,i,i,i,i,i,n,i,t],[t,i,i,i,i,i,i,n,i,i,t],[t,i,i,n,i,i,n,i,i,i,t],[t,i,i,i,n,n,i,i,i,i,t],[t,i,i,i,i,i,i,i,i,i,t],[t,i,i,i,i,i,i,i,i,i,t],[e,t,t,t,t,t,t,t,t,t,e],[e,e,e,e,t,t,t,e,e,e,e],[e,e,e,e,e,t,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e]]})(),lv=[{skin:"#FFCC99",shirt:"#4488CC",pants:"#334466",hair:"#553322",shoes:"#222222"},{skin:"#FFCC99",shirt:"#CC4444",pants:"#333333",hair:"#FFD700",shoes:"#222222"},{skin:"#DEB887",shirt:"#44AA66",pants:"#334444",hair:"#222222",shoes:"#333333"},{skin:"#FFCC99",shirt:"#AA55CC",pants:"#443355",hair:"#AA4422",shoes:"#222222"},{skin:"#DEB887",shirt:"#CCAA33",pants:"#444433",hair:"#553322",shoes:"#333333"},{skin:"#FFCC99",shirt:"#FF8844",pants:"#443322",hair:"#111111",shoes:"#222222"}],w="hair",S="skin",g="shirt",C="pants",se="shoes",ct="#FFFFFF";function av(t,i){return t.map(n=>n.map(a=>a===e?"":a===ct?ct:a===w?i.hair:a===S?i.skin:a===g?i.shirt:a===C?i.pants:a===se?i.shoes:a))}function yx(t){return t.map(i=>[...i].reverse())}const Sx=[[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,w,w,w,w,e,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,S,ct,S,S,ct,S,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,e,g,g,g,g,e,e,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,g,g,g,g,g,g,g,g,e,e,e,e],[e,e,e,e,g,g,g,g,g,g,g,g,e,e,e,e],[e,e,e,e,S,g,g,g,g,g,g,S,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,e,e,C,C,C,C,e,e,e,e,e,e],[e,e,e,e,e,C,C,C,C,C,C,e,e,e,e,e],[e,e,e,e,e,C,C,C,C,C,C,e,e,e,e,e],[e,e,e,e,C,C,e,e,e,e,C,C,e,e,e,e],[e,e,e,e,C,C,e,e,e,e,C,C,e,e,e,e],[e,e,e,e,se,se,e,e,e,e,e,se,se,e,e,e],[e,e,e,e,se,se,e,e,e,e,e,se,se,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e]],ov=[[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,w,w,w,w,e,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,S,ct,S,S,ct,S,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,e,g,g,g,g,e,e,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,g,g,g,g,g,g,g,g,e,e,e,e],[e,e,e,e,g,g,g,g,g,g,g,g,e,e,e,e],[e,e,e,e,S,g,g,g,g,g,g,S,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,e,e,C,C,C,C,e,e,e,e,e,e],[e,e,e,e,e,C,C,C,C,C,C,e,e,e,e,e],[e,e,e,e,e,C,C,e,e,C,C,e,e,e,e,e],[e,e,e,e,e,C,C,e,e,C,C,e,e,e,e,e],[e,e,e,e,e,C,C,e,e,C,C,e,e,e,e,e],[e,e,e,e,e,se,se,e,e,se,se,e,e,e,e,e],[e,e,e,e,e,se,se,e,e,se,se,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e]],bx=[[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,w,w,w,w,e,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,S,ct,S,S,ct,S,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,e,g,g,g,g,e,e,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,g,g,g,g,g,g,g,g,e,e,e,e],[e,e,e,e,g,g,g,g,g,g,g,g,e,e,e,e],[e,e,e,e,S,g,g,g,g,g,g,S,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,e,e,C,C,C,C,e,e,e,e,e,e],[e,e,e,e,e,C,C,C,C,C,C,e,e,e,e,e],[e,e,e,e,e,C,C,C,C,C,C,e,e,e,e,e],[e,e,e,se,se,e,e,e,e,e,e,C,C,e,e,e],[e,e,e,se,se,e,e,e,e,e,e,C,C,e,e,e],[e,e,e,e,e,e,e,e,e,e,se,se,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,se,se,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e]],Cx=[[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,w,w,w,w,e,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,S,ct,S,S,ct,S,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,e,g,g,g,g,e,e,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,g,g,g,g,g,g,g,g,e,e,e,e],[e,e,e,S,S,g,g,g,g,g,g,S,S,e,e,e],[e,e,e,e,S,g,g,g,g,g,g,S,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,e,e,C,C,C,C,e,e,e,e,e,e],[e,e,e,e,e,C,C,C,C,C,C,e,e,e,e,e],[e,e,e,e,e,C,C,C,C,C,C,e,e,e,e,e],[e,e,e,e,e,C,C,e,e,C,C,e,e,e,e,e],[e,e,e,e,e,se,se,e,e,se,se,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e]],wx=[[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,w,w,w,w,e,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,S,ct,S,S,ct,S,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,e,g,g,g,g,e,e,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,g,g,g,g,g,g,g,g,e,e,e,e],[e,e,e,e,S,g,g,g,g,g,g,S,S,e,e,e],[e,e,e,e,S,g,g,g,g,g,g,e,S,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,e,e,C,C,C,C,e,e,e,e,e,e],[e,e,e,e,e,C,C,C,C,C,C,e,e,e,e,e],[e,e,e,e,e,C,C,C,C,C,C,e,e,e,e,e],[e,e,e,e,e,C,C,e,e,C,C,e,e,e,e,e],[e,e,e,e,e,se,se,e,e,se,se,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e]],xx=[[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,w,w,w,w,e,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,S,ct,S,S,ct,S,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,e,g,g,g,g,e,e,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,g,g,g,g,g,g,g,g,e,e,e,e],[e,e,e,e,g,g,g,g,g,g,g,g,e,e,e,e],[e,e,e,e,S,g,g,g,g,g,g,S,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,e,e,C,C,C,C,e,e,e,e,e,e],[e,e,e,e,e,C,C,C,C,C,C,e,e,e,e,e],[e,e,e,e,e,C,C,C,C,C,C,e,e,e,e,e],[e,e,e,e,e,C,C,e,e,C,C,e,e,e,e,e],[e,e,e,e,e,se,se,e,e,se,se,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e]],Ex=[[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,w,w,w,w,e,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,S,ct,S,S,ct,S,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,e,g,g,g,g,e,e,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,g,g,g,g,g,g,g,g,e,e,e,e],[e,e,e,e,g,g,g,g,g,g,g,g,e,e,e,e],[e,e,e,e,S,g,g,g,g,g,g,S,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,e,e,C,C,C,C,e,e,e,e,e,e],[e,e,e,e,e,C,C,C,C,C,C,e,e,e,e,e],[e,e,e,e,e,C,C,e,e,C,C,e,e,e,e,e],[e,e,e,e,e,se,se,e,e,se,se,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e]],Tx=[[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,w,w,w,w,e,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,e,g,g,g,g,e,e,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,g,g,g,g,g,g,g,g,e,e,e,e],[e,e,e,e,g,g,g,g,g,g,g,g,e,e,e,e],[e,e,e,e,S,g,g,g,g,g,g,S,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,e,e,C,C,C,C,e,e,e,e,e,e],[e,e,e,e,e,C,C,C,C,C,C,e,e,e,e,e],[e,e,e,e,e,C,C,C,C,C,C,e,e,e,e,e],[e,e,e,e,C,C,e,e,e,e,C,C,e,e,e,e],[e,e,e,e,C,C,e,e,e,e,C,C,e,e,e,e],[e,e,e,se,se,e,e,e,e,e,e,se,se,e,e,e],[e,e,e,se,se,e,e,e,e,e,e,se,se,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e]],cv=[[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,w,w,w,w,e,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,e,g,g,g,g,e,e,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,g,g,g,g,g,g,g,g,e,e,e,e],[e,e,e,e,g,g,g,g,g,g,g,g,e,e,e,e],[e,e,e,e,S,g,g,g,g,g,g,S,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,e,e,C,C,C,C,e,e,e,e,e,e],[e,e,e,e,e,C,C,C,C,C,C,e,e,e,e,e],[e,e,e,e,e,C,C,e,e,C,C,e,e,e,e,e],[e,e,e,e,e,C,C,e,e,C,C,e,e,e,e,e],[e,e,e,e,e,C,C,e,e,C,C,e,e,e,e,e],[e,e,e,e,e,se,se,e,e,se,se,e,e,e,e,e],[e,e,e,e,e,se,se,e,e,se,se,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e]],Ax=[[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,w,w,w,w,e,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,e,g,g,g,g,e,e,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,g,g,g,g,g,g,g,g,e,e,e,e],[e,e,e,e,g,g,g,g,g,g,g,g,e,e,e,e],[e,e,e,e,S,g,g,g,g,g,g,S,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,e,e,C,C,C,C,e,e,e,e,e,e],[e,e,e,e,e,C,C,C,C,C,C,e,e,e,e,e],[e,e,e,e,e,C,C,C,C,C,C,e,e,e,e,e],[e,e,e,se,se,e,e,e,e,e,e,C,C,e,e,e],[e,e,e,se,se,e,e,e,e,e,e,C,C,e,e,e],[e,e,e,e,e,e,e,e,e,e,se,se,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,se,se,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e]],Rx=[[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,w,w,w,w,e,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,e,g,g,g,g,e,e,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,g,g,g,g,g,g,g,g,e,e,e,e],[e,e,e,S,S,g,g,g,g,g,g,S,S,e,e,e],[e,e,e,e,S,g,g,g,g,g,g,S,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,e,e,C,C,C,C,e,e,e,e,e,e],[e,e,e,e,e,C,C,C,C,C,C,e,e,e,e,e],[e,e,e,e,e,C,C,C,C,C,C,e,e,e,e,e],[e,e,e,e,e,C,C,e,e,C,C,e,e,e,e,e],[e,e,e,e,e,se,se,e,e,se,se,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e]],Dx=[[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,w,w,w,w,e,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,e,g,g,g,g,e,e,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,g,g,g,g,g,g,g,g,e,e,e,e],[e,e,e,e,S,g,g,g,g,g,g,S,S,e,e,e],[e,e,e,e,S,g,g,g,g,g,g,e,S,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,e,e,C,C,C,C,e,e,e,e,e,e],[e,e,e,e,e,C,C,C,C,C,C,e,e,e,e,e],[e,e,e,e,e,C,C,C,C,C,C,e,e,e,e,e],[e,e,e,e,e,C,C,e,e,C,C,e,e,e,e,e],[e,e,e,e,e,se,se,e,e,se,se,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e]],kx=[[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,w,w,w,w,e,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,e,g,g,g,g,e,e,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,g,g,g,g,g,g,g,g,e,e,e,e],[e,e,e,e,g,g,g,g,g,g,g,g,e,e,e,e],[e,e,e,e,S,g,g,g,g,g,g,S,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,e,e,C,C,C,C,e,e,e,e,e,e],[e,e,e,e,e,C,C,C,C,C,C,e,e,e,e,e],[e,e,e,e,e,C,C,C,C,C,C,e,e,e,e,e],[e,e,e,e,e,C,C,e,e,C,C,e,e,e,e,e],[e,e,e,e,e,se,se,e,e,se,se,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e]],Mx=[[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,w,w,w,w,e,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,w,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,S,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,e,g,g,g,g,e,e,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,g,g,g,g,g,g,g,g,e,e,e,e],[e,e,e,e,g,g,g,g,g,g,g,g,e,e,e,e],[e,e,e,e,S,g,g,g,g,g,g,S,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,e,e,C,C,C,C,e,e,e,e,e,e],[e,e,e,e,e,C,C,C,C,C,C,e,e,e,e,e],[e,e,e,e,e,C,C,e,e,C,C,e,e,e,e,e],[e,e,e,e,e,se,se,e,e,se,se,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e]],hv=[[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,e,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,e,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,e,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,e,S,S,S,ct,S,e,e,e,e,e],[e,e,e,e,e,e,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,e,S,S,S,S,e,e,e,e,e,e],[e,e,e,e,e,e,e,g,g,g,e,e,e,e,e,e],[e,e,e,e,e,e,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,e,S,g,g,g,g,S,e,e,e,e,e],[e,e,e,e,e,e,g,g,g,g,e,e,e,e,e,e],[e,e,e,e,e,e,e,C,C,e,e,e,e,e,e,e],[e,e,e,e,e,e,C,C,C,C,e,e,e,e,e,e],[e,e,e,e,e,e,C,C,C,C,e,e,e,e,e,e],[e,e,e,e,e,C,C,e,e,e,C,C,e,e,e,e],[e,e,e,e,e,C,C,e,e,e,C,C,e,e,e,e],[e,e,e,e,e,se,se,e,e,e,e,se,se,e,e,e],[e,e,e,e,e,se,se,e,e,e,e,se,se,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e]],fo=[[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,e,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,e,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,e,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,e,S,S,S,ct,S,e,e,e,e,e],[e,e,e,e,e,e,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,e,S,S,S,S,e,e,e,e,e,e],[e,e,e,e,e,e,e,g,g,g,e,e,e,e,e,e],[e,e,e,e,e,e,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,e,S,g,g,g,g,S,e,e,e,e,e],[e,e,e,e,e,e,g,g,g,g,e,e,e,e,e,e],[e,e,e,e,e,e,e,C,C,e,e,e,e,e,e,e],[e,e,e,e,e,e,C,C,C,C,e,e,e,e,e,e],[e,e,e,e,e,e,C,C,e,C,C,e,e,e,e,e],[e,e,e,e,e,e,C,C,e,C,C,e,e,e,e,e],[e,e,e,e,e,e,C,C,e,C,C,e,e,e,e,e],[e,e,e,e,e,e,se,se,e,se,se,e,e,e,e,e],[e,e,e,e,e,e,se,se,e,se,se,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e]],uv=[[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,e,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,e,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,e,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,e,S,S,S,ct,S,e,e,e,e,e],[e,e,e,e,e,e,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,e,S,S,S,S,e,e,e,e,e,e],[e,e,e,e,e,e,e,g,g,g,e,e,e,e,e,e],[e,e,e,e,e,e,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,e,S,g,g,g,g,S,e,e,e,e,e],[e,e,e,e,e,e,g,g,g,g,e,e,e,e,e,e],[e,e,e,e,e,e,e,C,C,e,e,e,e,e,e,e],[e,e,e,e,e,e,C,C,C,C,e,e,e,e,e,e],[e,e,e,e,e,e,C,C,C,C,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,C,C,C,e,e,e,e,e],[e,e,e,e,e,e,e,e,C,C,C,e,e,e,e,e],[e,e,e,e,e,se,se,e,e,se,se,e,e,e,e,e],[e,e,e,e,e,se,se,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e]],dv=[[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,e,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,e,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,e,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,e,S,S,S,ct,S,e,e,e,e,e],[e,e,e,e,e,e,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,e,S,S,S,S,e,e,e,e,e,e],[e,e,e,e,e,e,e,g,g,g,e,e,e,e,e,e],[e,e,e,e,e,e,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,S,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,S,e,e,e,e,e],[e,e,e,e,e,e,g,g,g,g,e,e,e,e,e,e],[e,e,e,e,e,e,g,g,g,g,e,e,e,e,e,e],[e,e,e,e,e,e,e,C,C,e,e,e,e,e,e,e],[e,e,e,e,e,e,C,C,C,C,e,e,e,e,e,e],[e,e,e,e,e,e,C,C,C,C,e,e,e,e,e,e],[e,e,e,e,e,e,C,C,e,C,C,e,e,e,e,e],[e,e,e,e,e,e,se,se,e,se,se,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e]],fv=[[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,e,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,e,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,e,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,e,S,S,S,ct,S,e,e,e,e,e],[e,e,e,e,e,e,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,e,S,S,S,S,e,e,e,e,e,e],[e,e,e,e,e,e,e,g,g,g,e,e,e,e,e,e],[e,e,e,e,e,e,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,S,e,e,e],[e,e,e,e,e,g,g,g,g,g,e,e,S,e,e,e],[e,e,e,e,e,e,g,g,g,g,e,e,e,e,e,e],[e,e,e,e,e,e,g,g,g,g,e,e,e,e,e,e],[e,e,e,e,e,e,e,C,C,e,e,e,e,e,e,e],[e,e,e,e,e,e,C,C,C,C,e,e,e,e,e,e],[e,e,e,e,e,e,C,C,C,C,e,e,e,e,e,e],[e,e,e,e,e,e,C,C,e,C,C,e,e,e,e,e],[e,e,e,e,e,e,se,se,e,se,se,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e]],_v=[[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,e,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,e,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,e,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,e,S,S,S,ct,S,e,e,e,e,e],[e,e,e,e,e,e,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,e,S,S,S,S,e,e,e,e,e,e],[e,e,e,e,e,e,e,g,g,g,e,e,e,e,e,e],[e,e,e,e,e,e,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,e,S,g,g,g,g,S,e,e,e,e,e],[e,e,e,e,e,e,g,g,g,g,e,e,e,e,e,e],[e,e,e,e,e,e,e,C,C,e,e,e,e,e,e,e],[e,e,e,e,e,e,C,C,C,C,e,e,e,e,e,e],[e,e,e,e,e,e,C,C,C,C,e,e,e,e,e,e],[e,e,e,e,e,e,C,C,e,C,C,e,e,e,e,e],[e,e,e,e,e,e,se,se,e,se,se,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e]],gv=[[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,e,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,e,w,w,w,w,w,e,e,e,e,e],[e,e,e,e,e,e,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,e,S,S,S,ct,S,e,e,e,e,e],[e,e,e,e,e,e,S,S,S,S,S,e,e,e,e,e],[e,e,e,e,e,e,S,S,S,S,e,e,e,e,e,e],[e,e,e,e,e,e,e,g,g,g,e,e,e,e,e,e],[e,e,e,e,e,e,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,e,g,g,g,g,g,g,e,e,e,e,e],[e,e,e,e,e,S,g,g,g,g,S,e,e,e,e,e],[e,e,e,e,e,e,g,g,g,g,e,e,e,e,e,e],[e,e,e,e,e,e,e,C,C,e,e,e,e,e,e,e],[e,e,e,e,e,e,C,C,C,C,e,e,e,e,e,e],[e,e,e,e,e,e,C,C,e,C,C,e,e,e,e,e],[e,e,e,e,e,e,se,se,e,se,se,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e]];let wo=null;function Lx(t){wo=t,fd.clear()}function Bx(t){return t.map(i=>[...i].reverse())}const fd=new Map;function Ox(t,i){const n={h:i,s:0,b:0,c:0},a=d=>N0(d,n),c=d=>[a(d[0]),a(d[1]),a(d[2]),a(d[3])],h=d=>[a(d[0]),a(d[1])];return{walk:{[be.DOWN]:c(t.walk[be.DOWN]),[be.UP]:c(t.walk[be.UP]),[be.RIGHT]:c(t.walk[be.RIGHT]),[be.LEFT]:c(t.walk[be.LEFT])},typing:{[be.DOWN]:h(t.typing[be.DOWN]),[be.UP]:h(t.typing[be.UP]),[be.RIGHT]:h(t.typing[be.RIGHT]),[be.LEFT]:h(t.typing[be.LEFT])},reading:{[be.DOWN]:h(t.reading[be.DOWN]),[be.UP]:h(t.reading[be.UP]),[be.RIGHT]:h(t.reading[be.RIGHT]),[be.LEFT]:h(t.reading[be.LEFT])}}}function zx(t,i=0){const n=`${t}:${i}`,a=fd.get(n);if(a)return a;let c;if(wo){const h=wo[t%wo.length],d=h.down,p=h.up,m=h.right,_=Bx;c={walk:{[be.DOWN]:[d[0],d[1],d[2],d[1]],[be.UP]:[p[0],p[1],p[2],p[1]],[be.RIGHT]:[m[0],m[1],m[2],m[1]],[be.LEFT]:[_(m[0]),_(m[1]),_(m[2]),_(m[1])]},typing:{[be.DOWN]:[d[3],d[4]],[be.UP]:[p[3],p[4]],[be.RIGHT]:[m[3],m[4]],[be.LEFT]:[_(m[3]),_(m[4])]},reading:{[be.DOWN]:[d[5],d[6]],[be.UP]:[p[5],p[6]],[be.RIGHT]:[m[5],m[6]],[be.LEFT]:[_(m[5]),_(m[6])]}}}else{const h=lv[t%lv.length],d=m=>av(m,h),p=m=>av(yx(m),h);c={walk:{[be.DOWN]:[d(Sx),d(ov),d(bx),d(ov)],[be.UP]:[d(Tx),d(cv),d(Ax),d(cv)],[be.RIGHT]:[d(hv),d(fo),d(uv),d(fo)],[be.LEFT]:[p(hv),p(fo),p(uv),p(fo)]},typing:{[be.DOWN]:[d(Cx),d(wx)],[be.UP]:[d(Rx),d(Dx)],[be.RIGHT]:[d(dv),d(fv)],[be.LEFT]:[p(dv),p(fv)]},reading:{[be.DOWN]:[d(xx),d(Ex)],[be.UP]:[d(kx),d(Mx)],[be.RIGHT]:[d(_v),d(gv)],[be.LEFT]:[p(_v),p(gv)]}}}return i!==0&&(c=Ox(c,i)),fd.set(n,c),c}const H0=[{type:ot.DESK,label:"Desk",footprintW:2,footprintH:2,sprite:cx,isDesk:!0,category:"desks"},{type:ot.BOOKSHELF,label:"Bookshelf",footprintW:1,footprintH:2,sprite:ux,isDesk:!1,category:"storage"},{type:ot.PLANT,label:"Plant",footprintW:1,footprintH:1,sprite:hx,isDesk:!1,category:"decor"},{type:ot.COOLER,label:"Cooler",footprintW:1,footprintH:1,sprite:dx,isDesk:!1,category:"misc"},{type:ot.WHITEBOARD,label:"Whiteboard",footprintW:2,footprintH:1,sprite:fx,isDesk:!1,category:"decor"},{type:ot.CHAIR,label:"Chair",footprintW:1,footprintH:1,sprite:_x,isDesk:!1,category:"chairs"},{type:ot.PC,label:"PC",footprintW:1,footprintH:1,sprite:gx,isDesk:!1,category:"electronics"},{type:ot.LAMP,label:"Lamp",footprintW:1,footprintH:1,sprite:px,isDesk:!1,category:"decor"}],gs=new Map,Gs=new Map,_d=new Map,pv=new Map;let gd=null,zd=null,U0=null;function I0(t){if(!t?.catalog||!t?.sprites)return!1;const i=t.catalog.map(_=>{const y=t.sprites[_.id];return y?{type:_.id,label:_.label,footprintW:_.footprintW,footprintH:_.footprintH,sprite:y,isDesk:_.isDesk,category:_.category,..._.orientation?{orientation:_.orientation}:{},..._.canPlaceOnSurfaces?{canPlaceOnSurfaces:!0}:{},..._.backgroundTiles?{backgroundTiles:_.backgroundTiles}:{},..._.canPlaceOnWalls?{canPlaceOnWalls:!0}:{}}:(console.warn(`No sprite data for asset ${_.id}`),null)}).filter(_=>_!==null);if(i.length===0)return!1;gs.clear(),Gs.clear(),_d.clear(),pv.clear();const n=new Map;for(const _ of t.catalog)if(_.groupId&&_.orientation){if(_.state&&_.state!=="off")continue;let y=n.get(_.groupId);y||(y=new Map,n.set(_.groupId,y)),y.set(_.orientation,_.id)}const a=new Set,c=["front","right","back","left"];for(const _ of n.values()){if(_.size<2)continue;const y=c.filter(R=>_.has(R));if(y.length<2)continue;const b={};for(const R of y)b[R]=_.get(R);const E={orientations:y,members:b};for(const R of Object.values(b))gs.set(R,E);for(const[R,D]of Object.entries(b))R!=="front"&&a.add(D)}const h=new Map;for(const _ of t.catalog)if(_.groupId&&_.state){const y=`${_.groupId}|${_.orientation||""}`;let b=h.get(y);b||(b=new Map,h.set(y,b)),b.set(_.state,_.id)}for(const _ of h.values()){const y=_.get("on"),b=_.get("off");y&&b&&(Gs.set(y,b),Gs.set(b,y),_d.set(b,y),pv.set(y,b))}for(const _ of t.catalog)if(_.groupId&&_.orientation&&_.state==="on"){const y=Gs.get(_.id);if(y){const b=gs.get(y);if(b){const E={};for(const D of b.orientations){const k=b.members[D],V=Gs.get(k);E[D]=V??k}const R={orientations:b.orientations,members:E};for(const D of Object.values(E))gs.has(D)||gs.set(D,R)}}}const d=new Set;for(const _ of t.catalog)_.state==="on"&&d.add(_.id);gd=i;const p=i.filter(_=>!a.has(_.type)&&!d.has(_.type));for(const _ of p)(gs.has(_.type)||Gs.has(_.type))&&(_.label=_.label.replace(/ - Front - Off$/,"").replace(/ - Front$/,"").replace(/ - Off$/,""));zd=p,U0=Array.from(new Set(p.map(_=>_.category))).filter(_=>!!_).sort();const m=new Set(Array.from(gs.values())).size;return console.log(` Built dynamic catalog with ${i.length} assets (${p.length} visible, ${m} rotation groups, ${Gs.size/2} state pairs)`),!0}function Tt(t){return gd?gd.find(n=>n.type===t):(zd||H0).find(n=>n.type===t)}function Nx(t){return(zd||H0).filter(n=>n.category===t)}function mv(){const t=U0||vv.map(i=>i.id);return vv.filter(i=>t.includes(i.id))}const vv=[{id:"desks",label:"Desks"},{id:"chairs",label:"Chairs"},{id:"storage",label:"Storage"},{id:"electronics",label:"Tech"},{id:"decor",label:"Decor"},{id:"wall",label:"Wall"},{id:"misc",label:"Misc"}];function j0(t,i){const n=gs.get(t);if(!n)return null;const a=n.orientations.map(p=>n.members[p]),c=a.indexOf(t);if(c===-1)return null;const d=(c+1+a.length)%a.length;return a[d]}function W0(t){return Gs.get(t)??null}function Hx(t){return _d.get(t)??t}function pd(t){return gs.has(t)}function yv(t){const i=[];for(let n=0;n<t.rows;n++){const a=[];for(let c=0;c<t.cols;c++)a.push(t.tiles[n*t.cols+c]);i.push(a)}return i}function wu(t){const i=new Map;for(const a of t){const c=Tt(a.type);if(!c||!c.isDesk)continue;const h=a.row*Ee+c.sprite.length;for(let d=0;d<c.footprintH;d++)for(let p=0;p<c.footprintW;p++){const m=`${a.col+p},${a.row+d}`,_=i.get(m);(_===void 0||h>_)&&i.set(m,h)}}const n=[];for(const a of t){const c=Tt(a.type);if(!c)continue;const h=a.col*Ee,d=a.row*Ee,p=c.sprite.length;let m=d+p;if(c.category==="chairs"&&(c.orientation==="back"?m=(a.row+1)*Ee+1:m=(a.row+1)*Ee),c.canPlaceOnSurfaces)for(let y=0;y<c.footprintH;y++)for(let b=0;b<c.footprintW;b++){const E=i.get(`${a.col+b},${a.row+y}`);E!==void 0&&E+.5>m&&(m=E+.5)}let _=c.sprite;if(a.color){const{h:y,s:b,b:E,c:R}=a.color;_=Od(`furn-${a.type}-${y}-${b}-${E}-${R}-${a.color.colorize?1:0}`,c.sprite,a.color)}n.push({sprite:_,x:h,y:d,zY:m})}return n}function Sv(t,i){const n=new Set;for(const a of t){const c=Tt(a.type);if(!c)continue;const h=c.backgroundTiles||0;for(let d=0;d<c.footprintH;d++)if(!(d<h))for(let p=0;p<c.footprintW;p++){const m=`${a.col+p},${a.row+d}`;n.add(m)}}return n}function Ux(t,i){const n=new Set;for(const a of t){if(a.uid===i)continue;const c=Tt(a.type);if(!c)continue;const h=c.backgroundTiles||0;for(let d=0;d<c.footprintH;d++)if(!(d<h))for(let p=0;p<c.footprintW;p++)n.add(`${a.col+p},${a.row+d}`)}return n}function Ix(t){switch(t){case"front":return be.DOWN;case"back":return be.UP;case"left":return be.LEFT;case"right":return be.RIGHT;default:return be.DOWN}}function bv(t){const i=new Map,n=new Set;for(const c of t){const h=Tt(c.type);if(!(!h||!h.isDesk))for(let d=0;d<h.footprintH;d++)for(let p=0;p<h.footprintW;p++)n.add(`${c.col+p},${c.row+d}`)}const a=[{dc:0,dr:-1,facing:be.UP},{dc:0,dr:1,facing:be.DOWN},{dc:-1,dr:0,facing:be.LEFT},{dc:1,dr:0,facing:be.RIGHT}];for(const c of t){const h=Tt(c.type);if(!h||h.category!=="chairs")continue;let d=0;for(let p=0;p<h.footprintH;p++)for(let m=0;m<h.footprintW;m++){const _=c.col+m,y=c.row+p;let b=be.DOWN;if(h.orientation)b=Ix(h.orientation);else for(const R of a)if(n.has(`${_+R.dc},${y+R.dr}`)){b=R.facing;break}const E=d===0?c.uid:`${c.uid}:${d}`;i.set(E,{uid:E,seatCol:_,seatRow:y,facingDir:b,assigned:!1}),d++}}return i}const F0={h:35,s:30,b:15,c:0},P0={h:25,s:45,b:5,c:10},Y0={h:280,s:40,b:-5,c:0},q0={h:35,s:25,b:10,c:0};function jx(){const t=Ue.WALL,i=Ue.FLOOR_1,n=Ue.FLOOR_2,a=Ue.FLOOR_3,c=Ue.FLOOR_4,h=[],d=[];for(let m=0;m<vu;m++)for(let _=0;_<mu;_++){if(m===0||m===vu-1){h.push(t),d.push(null);continue}if(_===0||_===mu-1){h.push(t),d.push(null);continue}if(_===10){m>=4&&m<=6?(h.push(c),d.push(q0)):(h.push(t),d.push(null));continue}if(_>=15&&_<=18&&m>=7&&m<=9){h.push(a),d.push(Y0);continue}_<10?(h.push(i),d.push(F0)):(h.push(n),d.push(P0))}const p=[{uid:"desk-left",type:ot.DESK,col:4,row:3},{uid:"desk-right",type:ot.DESK,col:13,row:3},{uid:"bookshelf-1",type:ot.BOOKSHELF,col:1,row:5},{uid:"plant-left",type:ot.PLANT,col:1,row:1},{uid:"cooler-1",type:ot.COOLER,col:17,row:7},{uid:"plant-right",type:ot.PLANT,col:18,row:1},{uid:"whiteboard-1",type:ot.WHITEBOARD,col:15,row:0},{uid:"chair-l-top",type:ot.CHAIR,col:4,row:2},{uid:"chair-l-bottom",type:ot.CHAIR,col:5,row:5},{uid:"chair-l-left",type:ot.CHAIR,col:3,row:4},{uid:"chair-l-right",type:ot.CHAIR,col:6,row:3},{uid:"chair-r-top",type:ot.CHAIR,col:13,row:2},{uid:"chair-r-bottom",type:ot.CHAIR,col:14,row:5},{uid:"chair-r-left",type:ot.CHAIR,col:12,row:4},{uid:"chair-r-right",type:ot.CHAIR,col:15,row:3}];return{version:1,cols:mu,rows:vu,tiles:h,tileColors:d,furniture:p}}function Wx(t){return Fx(t)}function Fx(t){if(t.tileColors&&t.tileColors.length===t.tiles.length)return t;const i=[];for(const n of t.tiles)switch(n){case 0:i.push(null);break;case 1:i.push(F0);break;case 2:i.push(P0);break;case 3:i.push(Y0);break;case 4:i.push(q0);break;default:i.push(n>0?{h:0,s:0,b:0,c:0}:null)}return{...t,tileColors:i}}class Px{constructor(i){this.characters=new Map,this.selectedAgentId=null,this.cameraFollowId=null,this.hoveredAgentId=null,this.hoveredTile=null,this.subagentIdMap=new Map,this.subagentMeta=new Map,this.nextSubagentId=-1,this.layout=i||jx(),this.tileMap=yv(this.layout),this.seats=bv(this.layout.furniture),this.blockedTiles=Sv(this.layout.furniture),this.furniture=wu(this.layout.furniture),this.walkableTiles=nv(this.tileMap,this.blockedTiles)}rebuildFromLayout(i,n){if(this.layout=i,this.tileMap=yv(i),this.seats=bv(i.furniture),this.blockedTiles=Sv(i.furniture),this.rebuildFurnitureInstances(),this.walkableTiles=nv(this.tileMap,this.blockedTiles),n&&(n.col!==0||n.row!==0))for(const a of this.characters.values())a.tileCol+=n.col,a.tileRow+=n.row,a.x+=n.col*Ee,a.y+=n.row*Ee,a.path=[],a.moveProgress=0;for(const a of this.seats.values())a.assigned=!1;for(const a of this.characters.values()){if(a.seatId&&this.seats.has(a.seatId)){const c=this.seats.get(a.seatId);if(!c.assigned){c.assigned=!0,a.tileCol=c.seatCol,a.tileRow=c.seatRow;const h=c.seatCol*Ee+Ee/2,d=c.seatRow*Ee+Ee/2;a.x=h,a.y=d,a.dir=c.facingDir;continue}}a.seatId=null}for(const a of this.characters.values()){if(a.seatId)continue;const c=this.findFreeSeat();if(c){this.seats.get(c).assigned=!0,a.seatId=c;const h=this.seats.get(c);a.tileCol=h.seatCol,a.tileRow=h.seatRow,a.x=h.seatCol*Ee+Ee/2,a.y=h.seatRow*Ee+Ee/2,a.dir=h.facingDir}}for(const a of this.characters.values())a.seatId||(a.tileCol<0||a.tileCol>=i.cols||a.tileRow<0||a.tileRow>=i.rows)&&this.relocateCharacterToWalkable(a)}relocateCharacterToWalkable(i){if(this.walkableTiles.length===0)return;const n=this.walkableTiles[Math.floor(Math.random()*this.walkableTiles.length)];i.tileCol=n.col,i.tileRow=n.row,i.x=n.col*Ee+Ee/2,i.y=n.row*Ee+Ee/2,i.path=[],i.moveProgress=0}getLayout(){return this.layout}ownSeatKey(i){if(!i.seatId)return null;const n=this.seats.get(i.seatId);return n?`${n.seatCol},${n.seatRow}`:null}withOwnSeatUnblocked(i,n){const a=this.ownSeatKey(i);a&&this.blockedTiles.delete(a);const c=n();return a&&this.blockedTiles.add(a),c}findFreeSeat(){for(const[i,n]of this.seats)if(!n.assigned)return i;return null}pickDiversePalette(){const i=new Array(sv).fill(0);for(const d of this.characters.values())d.isSubagent||i[d.palette]++;const n=Math.min(...i),a=[];for(let d=0;d<sv;d++)i[d]===n&&a.push(d);const c=a[Math.floor(Math.random()*a.length)];let h=0;return n>0&&(h=G2+Math.floor(Math.random()*X2)),{palette:c,hueShift:h}}addAgent(i,n,a,c,h){if(this.characters.has(i))return;let d,p;if(n!==void 0)d=n,p=a??0;else{const y=this.pickDiversePalette();d=y.palette,p=y.hueShift}let m=null;c&&this.seats.has(c)&&(this.seats.get(c).assigned||(m=c)),m||(m=this.findFreeSeat());let _;if(m){const y=this.seats.get(m);y.assigned=!0,_=ho(i,d,m,y,p)}else{const y=this.walkableTiles.length>0?this.walkableTiles[Math.floor(Math.random()*this.walkableTiles.length)]:{col:1,row:1};_=ho(i,d,null,null,p),_.x=y.col*Ee+Ee/2,_.y=y.row*Ee+Ee/2,_.tileCol=y.col,_.tileRow=y.row}h||(_.matrixEffect="spawn",_.matrixEffectTimer=0,_.matrixEffectSeeds=xl()),this.characters.set(i,_)}removeAgent(i){const n=this.characters.get(i);if(n&&n.matrixEffect!=="despawn"){if(n.seatId){const a=this.seats.get(n.seatId);a&&(a.assigned=!1)}this.selectedAgentId===i&&(this.selectedAgentId=null),this.cameraFollowId===i&&(this.cameraFollowId=null),n.matrixEffect="despawn",n.matrixEffectTimer=0,n.matrixEffectSeeds=xl(),n.bubbleType=null}}getSeatAtTile(i,n){for(const[a,c]of this.seats)if(c.seatCol===i&&c.seatRow===n)return a;return null}reassignSeat(i,n){const a=this.characters.get(i);if(!a)return;if(a.seatId){const d=this.seats.get(a.seatId);d&&(d.assigned=!1)}const c=this.seats.get(n);if(!c||c.assigned)return;c.assigned=!0,a.seatId=n;const h=this.withOwnSeatUnblocked(a,()=>br(a.tileCol,a.tileRow,c.seatCol,c.seatRow,this.tileMap,this.blockedTiles));h.length>0?(a.path=h,a.moveProgress=0,a.state=et.WALK,a.frame=0,a.frameTimer=0):(a.state=et.TYPE,a.dir=c.facingDir,a.frame=0,a.frameTimer=0,a.isActive||(a.seatTimer=tv+Math.random()*iv))}sendToSeat(i){const n=this.characters.get(i);if(!n||!n.seatId)return;const a=this.seats.get(n.seatId);if(!a)return;const c=this.withOwnSeatUnblocked(n,()=>br(n.tileCol,n.tileRow,a.seatCol,a.seatRow,this.tileMap,this.blockedTiles));c.length>0?(n.path=c,n.moveProgress=0,n.state=et.WALK,n.frame=0,n.frameTimer=0):(n.state=et.TYPE,n.dir=a.facingDir,n.frame=0,n.frameTimer=0,n.isActive||(n.seatTimer=tv+Math.random()*iv))}walkToTile(i,n,a){const c=this.characters.get(i);if(!c||c.isSubagent)return!1;if(!ko(n,a,this.tileMap,this.blockedTiles)){const d=this.ownSeatKey(c);if(!d||d!==`${n},${a}`)return!1}const h=this.withOwnSeatUnblocked(c,()=>br(c.tileCol,c.tileRow,n,a,this.tileMap,this.blockedTiles));return h.length===0?!1:(c.path=h,c.moveProgress=0,c.state=et.WALK,c.frame=0,c.frameTimer=0,!0)}addSubagent(i,n){const a=`${i}:${n}`;if(this.subagentIdMap.has(a))return this.subagentIdMap.get(a);const c=this.nextSubagentId--,h=this.characters.get(i),d=h?h.palette:0,p=h?h.hueShift:0,m=h?h.tileCol:0,_=h?h.tileRow:0,y=(D,k)=>Math.abs(D-m)+Math.abs(k-_);let b=null,E=1/0;for(const[D,k]of this.seats)if(!k.assigned){const V=y(k.seatCol,k.seatRow);V<E&&(E=V,b=D)}let R;if(b){const D=this.seats.get(b);D.assigned=!0,R=ho(c,d,b,D,p)}else{let D={col:1,row:1};if(this.walkableTiles.length>0){let k=this.walkableTiles[0],V=y(k.col,k.row);for(let X=1;X<this.walkableTiles.length;X++){const he=y(this.walkableTiles[X].col,this.walkableTiles[X].row);he<V&&(k=this.walkableTiles[X],V=he)}D=k}R=ho(c,d,null,null,p),R.x=D.col*Ee+Ee/2,R.y=D.row*Ee+Ee/2,R.tileCol=D.col,R.tileRow=D.row}return R.isSubagent=!0,R.parentAgentId=i,R.matrixEffect="spawn",R.matrixEffectTimer=0,R.matrixEffectSeeds=xl(),this.characters.set(c,R),this.subagentIdMap.set(a,c),this.subagentMeta.set(c,{parentAgentId:i,parentToolId:n}),c}removeSubagent(i,n){const a=`${i}:${n}`,c=this.subagentIdMap.get(a);if(c===void 0)return;const h=this.characters.get(c);if(h){if(h.matrixEffect==="despawn"){this.subagentIdMap.delete(a),this.subagentMeta.delete(c);return}if(h.seatId){const d=this.seats.get(h.seatId);d&&(d.assigned=!1)}h.matrixEffect="despawn",h.matrixEffectTimer=0,h.matrixEffectSeeds=xl(),h.bubbleType=null}this.subagentIdMap.delete(a),this.subagentMeta.delete(c),this.selectedAgentId===c&&(this.selectedAgentId=null),this.cameraFollowId===c&&(this.cameraFollowId=null)}removeAllSubagents(i){const n=[];for(const[a,c]of this.subagentIdMap){const h=this.subagentMeta.get(c);if(h&&h.parentAgentId===i){const d=this.characters.get(c);if(d){if(d.matrixEffect==="despawn"){this.subagentMeta.delete(c),n.push(a);continue}if(d.seatId){const p=this.seats.get(d.seatId);p&&(p.assigned=!1)}d.matrixEffect="despawn",d.matrixEffectTimer=0,d.matrixEffectSeeds=xl(),d.bubbleType=null}this.subagentMeta.delete(c),this.selectedAgentId===c&&(this.selectedAgentId=null),this.cameraFollowId===c&&(this.cameraFollowId=null),n.push(a)}}for(const a of n)this.subagentIdMap.delete(a)}getSubagentId(i,n){return this.subagentIdMap.get(`${i}:${n}`)??null}setAgentActive(i,n){const a=this.characters.get(i);a&&(a.isActive=n,n||(a.seatTimer=-1,a.path=[],a.moveProgress=0),this.rebuildFurnitureInstances())}rebuildFurnitureInstances(){const i=new Set;for(const a of this.characters.values()){if(!a.isActive||!a.seatId)continue;const c=this.seats.get(a.seatId);if(!c)continue;const h=c.facingDir===be.RIGHT?1:c.facingDir===be.LEFT?-1:0,d=c.facingDir===be.DOWN?1:c.facingDir===be.UP?-1:0;for(let p=1;p<=V2;p++){const m=c.seatCol+h*p,_=c.seatRow+d*p;i.add(`${m},${_}`)}for(let p=1;p<=$2;p++){const m=c.seatCol+h*p,_=c.seatRow+d*p;h!==0?(i.add(`${m},${_-1}`),i.add(`${m},${_+1}`)):(i.add(`${m-1},${_}`),i.add(`${m+1},${_}`))}}if(i.size===0){this.furniture=wu(this.layout.furniture);return}const n=this.layout.furniture.map(a=>{const c=Tt(a.type);if(!c)return a;for(let h=0;h<c.footprintH;h++)for(let d=0;d<c.footprintW;d++)if(i.has(`${a.col+d},${a.row+h}`)){const p=Hx(a.type);return p!==a.type?{...a,type:p}:a}return a});this.furniture=wu(n)}setAgentTool(i,n){const a=this.characters.get(i);a&&(a.currentTool=n)}showPermissionBubble(i){const n=this.characters.get(i);n&&(n.bubbleType="permission",n.bubbleTimer=0)}clearPermissionBubble(i){const n=this.characters.get(i);n&&n.bubbleType==="permission"&&(n.bubbleType=null,n.bubbleTimer=0)}showWaitingBubble(i){const n=this.characters.get(i);n&&(n.bubbleType="waiting",n.bubbleTimer=q2)}dismissBubble(i){const n=this.characters.get(i);!n||!n.bubbleType||(n.bubbleType==="permission"?(n.bubbleType=null,n.bubbleTimer=0):n.bubbleType==="waiting"&&(n.bubbleTimer=Math.min(n.bubbleTimer,K2)))}update(i){const n=[];for(const a of this.characters.values()){if(a.matrixEffect){a.matrixEffectTimer+=i,a.matrixEffectTimer>=T0&&(a.matrixEffect==="spawn"?(a.matrixEffect=null,a.matrixEffectTimer=0,a.matrixEffectSeeds=[]):n.push(a.id));continue}this.withOwnSeatUnblocked(a,()=>sx(a,i,this.walkableTiles,this.seats,this.tileMap,this.blockedTiles)),a.bubbleType==="waiting"&&(a.bubbleTimer-=i,a.bubbleTimer<=0&&(a.bubbleType=null,a.bubbleTimer=0))}for(const a of n)this.characters.delete(a)}getCharacters(){return Array.from(this.characters.values())}getCharacterAt(i,n){const a=this.getCharacters().sort((c,h)=>h.y-c.y);for(const c of a){if(c.matrixEffect==="despawn")continue;const h=c.state===et.TYPE?Ld:0,d=c.y+h,p=c.x-rv,m=c.x+rv,_=d-Z2,y=d;if(i>=p&&i<=m&&n>=_&&n<=y)return c.id}return null}}function Yx(t,i){const n=t.getContext("2d");n.imageSmoothingEnabled=!1;let a=0,c=0,h=!1;const d=p=>{if(h)return;const m=a===0?0:Math.min((p-a)/1e3,Y2);a=p,i.update(m),n.imageSmoothingEnabled=!1,i.render(n),c=requestAnimationFrame(d)};return c=requestAnimationFrame(d),()=>{h=!0,cancelAnimationFrame(c)}}const Cv=new Map,wv=new WeakMap;function qx(t){const i=wv.get(t);if(i)return i;const n=t.length,a=t[0].length,c=[];for(let h=0;h<n+2;h++)c.push(new Array(a+2).fill(""));for(let h=0;h<n;h++)for(let d=0;d<a;d++){if(t[h][d]==="")continue;const p=h+1,m=d+1;c[p-1][m]===""&&(c[p-1][m]="#FFFFFF"),c[p+1][m]===""&&(c[p+1][m]="#FFFFFF"),c[p][m-1]===""&&(c[p][m-1]="#FFFFFF"),c[p][m+1]===""&&(c[p][m+1]="#FFFFFF")}for(let h=0;h<n;h++)for(let d=0;d<a;d++)t[h][d]!==""&&(c[h+1][d+1]="");return wv.set(t,c),c}function Zs(t,i){let n=Cv.get(i);n||(n=new WeakMap,Cv.set(i,n));const a=n.get(t);if(a)return a;const c=t.length,h=t[0].length,d=document.createElement("canvas");d.width=h*i,d.height=c*i;const p=d.getContext("2d");p.imageSmoothingEnabled=!1;for(let m=0;m<c;m++)for(let _=0;_<h;_++){const y=t[m][_];y!==""&&(p.fillStyle=y,p.fillRect(_*i,m*i,i,i))}return n.set(t,d),d}const Kx=Array.from({length:Ee},()=>Array(Ee).fill(B0));let mn=[];const Gx="#3A3A5C";function Xx(t){mn=t,lx()}function Vx(t){const i=t-1;return i<0?null:i<mn.length?mn[i]:mn.length===0&&t>=1?Kx:null}function $x(){return mn.length>0?mn.length:1}function K0(t,i){const n=`floor-${t}-${i.h}-${i.s}-${i.b}-${i.c}`,a=Vx(t);return a?Od(n,a,{...i,colorize:!0}):Array.from({length:16},()=>Array(16).fill("#FF00FF"))}let Er=null;function Zx(t){Er=t}function Qx(){return Er!==null}function Jx(t,i,n){if(!Er)return null;const a=n.length,c=a>0?n[0].length:0;let h=0;i>0&&n[i-1][t]===Ue.WALL&&(h|=1),t<c-1&&n[i][t+1]===Ue.WALL&&(h|=2),i<a-1&&n[i+1][t]===Ue.WALL&&(h|=4),t>0&&n[i][t-1]===Ue.WALL&&(h|=8);const d=Er[h];return d?{sprite:d,offsetY:Ee-d.length}:null}function eE(t,i,n,a){if(!Er)return null;const c=n.length,h=c>0?n[0].length:0;let d=0;i>0&&n[i-1][t]===Ue.WALL&&(d|=1),t<h-1&&n[i][t+1]===Ue.WALL&&(d|=2),i<c-1&&n[i+1][t]===Ue.WALL&&(d|=4),t>0&&n[i][t-1]===Ue.WALL&&(d|=8);const p=Er[d];if(!p)return null;const m=`wall-${d}-${a.h}-${a.s}-${a.b}-${a.c}`;return{sprite:Od(m,p,{...a,colorize:!0}),offsetY:Ee-p.length}}function tE(t,i,n){if(!Er)return[];const a=t.length,c=a>0?t[0].length:0,h=n??c,d=[];for(let p=0;p<a;p++)for(let m=0;m<c;m++){if(t[p][m]!==Ue.WALL)continue;const _=p*h+m,y=i?.[_],b=y?eE(m,p,t,y):Jx(m,p,t);b&&d.push({sprite:b.sprite,x:m*Ee,y:p*Ee+b.offsetY,zY:(p+1)*Ee})}return d}function iE(t){const{h:i,s:n,b:a,c}=t;let h=.5;if(c!==0){const k=(100+c)/100;h=.5+(h-.5)*k}a!==0&&(h=h+a/200),h=Math.max(0,Math.min(1,h));const d=n/100,p=(1-Math.abs(2*h-1))*d,m=i/60,_=p*(1-Math.abs(m%2-1));let y=0,b=0,E=0;m<1?(y=p,b=_,E=0):m<2?(y=_,b=p,E=0):m<3?(y=0,b=p,E=_):m<4?(y=0,b=_,E=p):m<5?(y=_,b=0,E=p):(y=p,b=0,E=_);const R=h-p/2,D=k=>Math.max(0,Math.min(255,Math.round((k+R)*255)));return`#${D(y).toString(16).padStart(2,"0")}${D(b).toString(16).padStart(2,"0")}${D(E).toString(16).padStart(2,"0")}`}function sE(t,i,n,a,c,h,d){const p=Ee*c,m=i.length,_=m>0?i[0].length:0,y=d??_;for(let b=0;b<m;b++)for(let E=0;E<_;E++){const R=i[b][E];if(R===Ue.VOID)continue;if(R===Ue.WALL){if(R===Ue.WALL){const he=b*y+E,te=h?.[he];t.fillStyle=te?iE(te):Gx}else t.fillStyle=B0;t.fillRect(n+E*p,a+b*p,p,p);continue}const D=b*y+E,k=h?.[D]??{h:0,s:0,b:0,c:0},V=K0(R,k),X=Zs(V,c);t.drawImage(X,n+E*p,a+b*p)}}function rE(t,i,n,a,c,h,d,p){const m=[];for(const _ of i){const y=Zs(_.sprite,h),b=a+_.x*h,E=c+_.y*h;m.push({zY:_.zY,draw:R=>{R.drawImage(y,b,E)}})}for(const _ of n){const y=zx(_.palette,_.hueShift),b=rx(_,y),E=Zs(b,h),R=_.state===et.TYPE?Ld:0,D=Math.round(a+_.x*h-E.width/2),k=Math.round(c+(_.y+R)*h-E.height),V=_.y+Ee/2+o2;if(_.matrixEffect){const te=D,ue=k,de=b,_e=_;m.push({zY:V,draw:q=>{nx(q,_e,de,te,ue,h)}});continue}const X=d!==null&&_.id===d,he=p!==null&&_.id===p;if(X||he){const te=X?h2:u2,ue=qx(b),de=Zs(ue,h),_e=D-h,q=k-h;m.push({zY:V-c2,draw:ge=>{ge.save(),ge.globalAlpha=te,ge.drawImage(de,_e,q),ge.restore()}})}m.push({zY:V,draw:te=>{te.drawImage(E,D,k)}})}m.sort((_,y)=>_.zY-y.zY);for(const _ of m)_.draw(t)}function nE(t,i,n,a,c,h,d,p){if(a===null||!c)return;const m=n.get(a);if(m)for(const[_,y]of i){if(y.seatCol!==c.col||y.seatRow!==c.row)continue;const b=Ee*p,E=h+y.seatCol*b,R=d+y.seatRow*b;m.seatId===_?t.fillStyle=m2:y.assigned?t.fillStyle=y2:t.fillStyle=v2,t.fillRect(E,R,b,b);break}}function lE(t,i,n,a,c,h,d){const p=Ee*a;t.strokeStyle=S2,t.lineWidth=1,t.beginPath();for(let m=0;m<=c;m++){const _=i+m*p+.5;t.moveTo(_,n),t.lineTo(_,n+h*p)}for(let m=0;m<=h;m++){const _=n+m*p+.5;t.moveTo(i,_),t.lineTo(i+c*p,_)}if(t.stroke(),d){t.save(),t.strokeStyle=b2,t.lineWidth=1,t.setLineDash(O0);for(let m=0;m<h;m++)for(let _=0;_<c;_++)d[m]?.[_]===Ue.VOID&&t.strokeRect(i+_*p+.5,n+m*p+.5,p-1,p-1);t.restore()}}function aE(t,i,n,a,c,h,d,p){const m=Ee*a;t.save();const _=[];for(let y=-1;y<=c;y++)_.push({c:y,r:-1}),_.push({c:y,r:h});for(let y=0;y<h;y++)_.push({c:-1,r:y}),_.push({c,r:y});for(const{c:y,r:b}of _){const E=i+y*m,R=n+b*m,D=y===d&&b===p;D&&(t.fillStyle=C2,t.fillRect(E,R,m,m)),t.strokeStyle=D?w2:x2,t.lineWidth=1,t.setLineDash(O0),t.strokeRect(E+.5,R+.5,m-1,m-1)}t.restore()}function oE(t,i,n,a,c,h,d,p){const m=Zs(i,p),_=h+n*Ee*p,y=d+a*Ee*p;t.save(),t.globalAlpha=d2,t.drawImage(m,_,y),t.globalAlpha=f2,t.fillStyle=c?E2:T2,t.fillRect(_,y,m.width,m.height),t.restore()}function cE(t,i,n,a,c,h,d,p){const m=Ee*p,_=h+i*m,y=d+n*m;t.save(),t.strokeStyle=A2,t.lineWidth=2,t.setLineDash(_2),t.strokeRect(_+1,y+1,a*m-2,c*m-2),t.restore()}function hE(t,i,n,a,c,h,d,p){const m=Ee*p,_=h+(i+a)*m+1,y=d+n*m-1,b=Math.max(R0,p*D0);t.save(),t.beginPath(),t.arc(_,y,b,0,Math.PI*2),t.fillStyle=R2,t.fill(),t.strokeStyle="#fff",t.lineWidth=Math.max(M0,p*L0),t.lineCap="round";const E=b*k0;return t.beginPath(),t.moveTo(_-E,y-E),t.lineTo(_+E,y+E),t.moveTo(_+E,y-E),t.lineTo(_-E,y+E),t.stroke(),t.restore(),{cx:_,cy:y,radius:b}}function uE(t,i,n,a,c,h,d,p){const m=Ee*p,_=Math.max(R0,p*D0),y=h+i*m-1,b=d+n*m-1;t.save(),t.beginPath(),t.arc(y,b,_,0,Math.PI*2),t.fillStyle=D2,t.fill(),t.strokeStyle="#fff",t.lineWidth=Math.max(M0,p*L0),t.lineCap="round";const E=_*k0;t.beginPath(),t.arc(y,b,E,-Math.PI*.8,Math.PI*.7),t.stroke();const R=Math.PI*.7,D=y+E*Math.cos(R),k=b+E*Math.sin(R),V=_*.35;return t.beginPath(),t.moveTo(D+V*.6,k-V*.3),t.lineTo(D,k),t.lineTo(D+V*.7,k+V*.5),t.stroke(),t.restore(),{cx:y,cy:b,radius:_}}function dE(t,i,n,a,c){for(const h of i){if(!h.bubbleType)continue;const d=h.bubbleType==="permission"?mx:vx;let p=1;h.bubbleType==="waiting"&&h.bubbleTimer<Vm&&(p=h.bubbleTimer/Vm);const m=Zs(d,c),_=h.state===et.TYPE?g2:0,y=Math.round(n+h.x*c-m.width/2),b=Math.round(a+(h.y+_-p2)*c-m.height-1*c);t.save(),p<1&&(t.globalAlpha=p),t.drawImage(m,y,b),t.restore()}}function fE(t,i,n,a,c,h,d,p,m,_,y,b,E,R){t.clearRect(0,0,i,n);const D=E??(a.length>0?a[0].length:0),k=R??a.length,V=D*Ee*d,X=k*Ee*d,he=Math.floor((i-V)/2)+Math.round(p),te=Math.floor((n-X)/2)+Math.round(m);sE(t,a,he,te,d,b,E),_&&nE(t,_.seats,_.characters,_.selectedAgentId,_.hoveredTile,he,te,d);const ue=Qx()?tE(a,b,E):[],de=ue.length>0?[...ue,...c]:c,_e=_?.selectedAgentId??null,q=_?.hoveredAgentId??null;return rE(t,de,h,he,te,d,_e,q),dE(t,h,he,te,d),y&&(y.showGrid&&lE(t,he,te,d,D,k,a),y.showGhostBorder&&aE(t,he,te,d,D,k,y.ghostBorderHoverCol,y.ghostBorderHoverRow),y.ghostSprite&&y.ghostCol>=0&&oE(t,y.ghostSprite,y.ghostCol,y.ghostRow,y.ghostValid,he,te,d),y.hasSelection?(cE(t,y.selectedCol,y.selectedRow,y.selectedW,y.selectedH,he,te,d),y.deleteButtonBounds=hE(t,y.selectedCol,y.selectedRow,y.selectedW,y.selectedH,he,te,d),y.isRotatable?y.rotateButtonBounds=uE(t,y.selectedCol,y.selectedRow,y.selectedW,y.selectedH,he,te,d):y.rotateButtonBounds=null):(y.deleteButtonBounds=null,y.rotateButtonBounds=null)),{offsetX:he,offsetY:te}}function El(t,i,n,a,c){const h=n*t.cols+i;if(h<0||h>=t.tiles.length)return t;const d=t.tileColors||new Array(t.tiles.length).fill(null),p=c??(a===Ue.WALL||a===Ue.VOID?null:{...U2});if(t.tiles[h]===a){const y=d[h];if(p===null&&y===null||p&&y&&p.h===y.h&&p.s===y.s&&p.b===y.b&&p.c===y.c&&!!p.colorize==!!y.colorize)return t}const m=[...t.tiles];m[h]=a;const _=[...d];return _[h]=p,{...t,tiles:m,tileColors:_}}function _E(t,i){return vn(t,i.type,i.col,i.row)?{...t,furniture:[...t.furniture,i]}:t}function gE(t,i){const n=t.furniture.filter(a=>a.uid!==i);return n.length===t.furniture.length?t:{...t,furniture:n}}function pE(t,i,n,a){const c=t.furniture.find(h=>h.uid===i);return!c||!vn(t,c.type,n,a,i)?t:{...t,furniture:t.furniture.map(h=>h.uid===i?{...h,col:n,row:a}:h)}}function mE(t,i,n){const a=t.furniture.find(h=>h.uid===i);if(!a)return t;const c=j0(a.type);return c?{...t,furniture:t.furniture.map(h=>h.uid===i?{...h,type:c}:h)}:t}function vE(t,i){const n=t.furniture.find(c=>c.uid===i);if(!n)return t;const a=W0(n.type);return a?{...t,furniture:t.furniture.map(c=>c.uid===i?{...c,type:a}:c)}:t}function G0(t,i){const n=Tt(t);return n?.canPlaceOnWalls?i-(n.footprintH-1):i}function vn(t,i,n,a,c){const h=Tt(i);if(!h)return!1;if(h.canPlaceOnWalls){const y=a+h.footprintH-1;if(n<0||n+h.footprintW>t.cols||y<0||y>=t.rows)return!1}else if(n<0||a<0||n+h.footprintW>t.cols||a+h.footprintH>t.rows)return!1;const d=h.backgroundTiles||0;for(let y=0;y<h.footprintH;y++)if(!(y<d)&&!(a+y<0)&&!(h.canPlaceOnWalls&&y<h.footprintH-1))for(let b=0;b<h.footprintW;b++){const E=(a+y)*t.cols+(n+b),R=t.tiles[E];if(h.canPlaceOnWalls){if(R!==Ue.WALL)return!1}else if(R===Ue.VOID||R===Ue.WALL)return!1}const p=Ux(t.furniture,c);let m=null;if(h.canPlaceOnSurfaces){m=new Set;for(const y of t.furniture){if(y.uid===c)continue;const b=Tt(y.type);if(!(!b||!b.isDesk))for(let E=0;E<b.footprintH;E++)for(let R=0;R<b.footprintW;R++)m.add(`${y.col+R},${y.row+E}`)}}const _=h.backgroundTiles||0;for(let y=0;y<h.footprintH;y++)if(!(y<_)&&!(a+y<0))for(let b=0;b<h.footprintW;b++){const E=`${n+b},${a+y}`;if(p.has(E)&&!m?.has(E))return!1}return!0}function yE(t,i){const{cols:n,rows:a,tiles:c,furniture:h,tileColors:d}=t,p=d||new Array(c.length).fill(null);let m=n,_=a,y=0,b=0;if(i==="right"?m=n+1:i==="left"?(m=n+1,y=1):i==="down"?_=a+1:i==="up"&&(_=a+1,b=1),m>e2||_>t2)return null;const E=new Array(m*_).fill(Ue.VOID),R=new Array(m*_).fill(null);for(let k=0;k<a;k++)for(let V=0;V<n;V++){const X=k*n+V,he=(k+b)*m+(V+y);E[he]=c[X],R[he]=p[X]}const D=h.map(k=>({...k,col:k.col+y,row:k.row+b}));return{layout:{...t,cols:m,rows:_,tiles:E,tileColors:R,furniture:D},shift:{col:y,row:b}}}const SE={postMessage:t=>{}};let Nd=!0,Fi=null;function X0(t){Nd=t}function xv(){return Nd}function Ev(t,i,n){const a=t.currentTime+n,c=t.createOscillator(),h=t.createGain();c.type="sine",c.frequency.setValueAtTime(i,a),h.gain.setValueAtTime(P2,a),h.gain.exponentialRampToValueAtTime(.001,a+ev),c.connect(h),h.connect(t.destination),c.start(a),c.stop(a+ev)}async function bE(){if(Nd)try{Fi||(Fi=new AudioContext),Fi.state==="suspended"&&await Fi.resume(),Ev(Fi,I2,W2),Ev(Fi,j2,F2)}catch{}}function CE(){try{Fi||(Fi=new AudioContext),Fi.state==="suspended"&&Fi.resume()}catch{}}function wE({officeState:t,onClick:i,isEditMode:n,editorState:a,onEditorTileAction:c,onEditorEraseAction:h,onEditorSelectionChange:d,onDeleteSelected:p,onRotateSelected:m,onDragMove:_,editorTick:y,zoom:b,onZoomChange:E,panRef:R}){const D=K.useRef(null),k=K.useRef(null),V=K.useRef({x:0,y:0}),X=K.useRef(!1),he=K.useRef({mouseX:0,mouseY:0,panX:0,panY:0}),te=K.useRef(null),ue=K.useRef(null),de=K.useRef(!1),_e=K.useRef(0),q=K.useCallback((A,U)=>{const L=D.current;if(!L)return{x:A,y:U};const z=t.getLayout(),$=z.cols*Ee*b,I=z.rows*Ee*b,ae=L.width*Qm,ye=L.height*Qm,fe=$/2+L.width/2-ae,Ae=I/2+L.height/2-ye;return{x:Math.max(-fe,Math.min(fe,A)),y:Math.max(-Ae,Math.min(Ae,U))}},[t,b]),ge=K.useCallback(()=>{const A=D.current,U=k.current;if(!A||!U)return;const L=U.getBoundingClientRect(),z=window.devicePixelRatio||1;A.width=Math.round(L.width*z),A.height=Math.round(L.height*z),A.style.width=`${L.width}px`,A.style.height=`${L.height}px`},[]);K.useEffect(()=>{const A=D.current;if(!A)return;ge();const U=new ResizeObserver(()=>ge());k.current&&U.observe(k.current);const L=Yx(A,{update:z=>{t.update(z)},render:z=>{const $=A.width,I=A.height;let ae;if(n){const Se=a.activeTool===Te.TILE_PAINT||a.activeTool===Te.WALL_PAINT||a.activeTool===Te.ERASE;if(ae={showGrid:!0,ghostSprite:null,ghostCol:a.ghostCol,ghostRow:a.ghostRow,ghostValid:a.ghostValid,selectedCol:0,selectedRow:0,selectedW:0,selectedH:0,hasSelection:!1,isRotatable:!1,deleteButtonBounds:null,rotateButtonBounds:null,showGhostBorder:Se,ghostBorderHoverCol:Se?a.ghostCol:-999,ghostBorderHoverRow:Se?a.ghostRow:-999},a.activeTool===Te.FURNITURE_PLACE&&a.ghostCol>=0){const Be=Tt(a.selectedFurnitureType);if(Be){const De=G0(a.selectedFurnitureType,a.ghostRow);ae.ghostSprite=Be.sprite,ae.ghostRow=De,ae.ghostValid=vn(t.getLayout(),a.selectedFurnitureType,a.ghostCol,De)}}if(a.isDragMoving&&a.dragUid&&a.ghostCol>=0){const Be=t.getLayout().furniture.find(De=>De.uid===a.dragUid);if(Be){const De=Tt(Be.type);if(De){const Wt=a.ghostCol-a.dragOffsetCol,Gi=a.ghostRow-a.dragOffsetRow;ae.ghostSprite=De.sprite,ae.ghostCol=Wt,ae.ghostRow=Gi,ae.ghostValid=vn(t.getLayout(),Be.type,Wt,Gi,a.dragUid)}}}if(a.selectedFurnitureUid&&!a.isDragMoving){const Be=t.getLayout().furniture.find(De=>De.uid===a.selectedFurnitureUid);if(Be){const De=Tt(Be.type);De&&(ae.hasSelection=!0,ae.selectedCol=Be.col,ae.selectedRow=Be.row,ae.selectedW=De.footprintW,ae.selectedH=De.footprintH,ae.isRotatable=pd(Be.type))}}}if(t.cameraFollowId!==null){const Se=t.characters.get(t.cameraFollowId);if(Se){const Be=t.getLayout(),De=Be.cols*Ee*b,Wt=Be.rows*Ee*b,Gi=De/2-Se.x*b,Ar=Wt/2-Se.y*b,jl=Gi-R.current.x,Cn=Ar-R.current.y;Math.abs(jl)<Zm&&Math.abs(Cn)<Zm?R.current={x:Gi,y:Ar}:R.current={x:R.current.x+jl*$m,y:R.current.y+Cn*$m}}}const ye={selectedAgentId:t.selectedAgentId,hoveredAgentId:t.hoveredAgentId,hoveredTile:t.hoveredTile,seats:t.seats,characters:t.characters},{offsetX:fe,offsetY:Ae}=fE(z,$,I,t.tileMap,t.furniture,t.getCharacters(),b,R.current.x,R.current.y,ye,ae,t.getLayout().tileColors,t.getLayout().cols,t.getLayout().rows);V.current={x:fe,y:Ae},te.current=ae?.deleteButtonBounds??null,ue.current=ae?.rotateButtonBounds??null}});return()=>{L(),U.disconnect()}},[t,ge,n,a,y,b,R]);const Y=K.useCallback((A,U)=>{const L=D.current;if(!L)return null;const z=L.getBoundingClientRect(),$=window.devicePixelRatio||1,I=A-z.left,ae=U-z.top,ye=I*$,fe=ae*$,Ae=(ye-V.current.x)/b,Se=(fe-V.current.y)/b;return{worldX:Ae,worldY:Se,screenX:I,screenY:ae,deviceX:ye,deviceY:fe}},[b]),re=K.useCallback((A,U)=>{const L=Y(A,U);if(!L)return null;const z=Math.floor(L.worldX/Ee),$=Math.floor(L.worldY/Ee),I=t.getLayout();return n&&(a.activeTool===Te.TILE_PAINT||a.activeTool===Te.WALL_PAINT||a.activeTool===Te.ERASE)?z<-1||z>I.cols||$<-1||$>I.rows?null:{col:z,row:$}:z<0||z>=I.cols||$<0||$>=I.rows?null:{col:z,row:$}},[Y,t,n,a]),ee=K.useCallback((A,U)=>{const L=te.current;if(!L)return!1;const z=A-L.cx,$=U-L.cy;return z*z+$*$<=(L.radius+2)*(L.radius+2)},[]),Q=K.useCallback((A,U)=>{const L=ue.current;if(!L)return!1;const z=A-L.cx,$=U-L.cy;return z*z+$*$<=(L.radius+2)*(L.radius+2)},[]),j=K.useCallback(A=>{if(X.current){const I=window.devicePixelRatio||1,ae=(A.clientX-he.current.mouseX)*I,ye=(A.clientY-he.current.mouseY)*I;R.current=q(he.current.panX+ae,he.current.panY+ye);return}if(n){const I=re(A.clientX,A.clientY);if(I){if(a.ghostCol=I.col,a.ghostRow=I.row,a.dragUid&&!a.isDragMoving&&(I.col!==a.dragStartCol||I.row!==a.dragStartRow)&&(a.isDragMoving=!0),a.isDragging&&(a.activeTool===Te.TILE_PAINT||a.activeTool===Te.WALL_PAINT||a.activeTool===Te.ERASE)&&!a.dragUid&&c(I.col,I.row),de.current&&(a.activeTool===Te.TILE_PAINT||a.activeTool===Te.WALL_PAINT||a.activeTool===Te.ERASE)){const ye=t.getLayout();I.col>=0&&I.col<ye.cols&&I.row>=0&&I.row<ye.rows&&h(I.col,I.row)}}else a.ghostCol=-1,a.ghostRow=-1;const ae=D.current;if(ae)if(a.isDragMoving)ae.style.cursor="grabbing";else{const ye=Y(A.clientX,A.clientY);if(ye&&(ee(ye.deviceX,ye.deviceY)||Q(ye.deviceX,ye.deviceY)))ae.style.cursor="pointer";else if(a.activeTool===Te.FURNITURE_PICK&&I){const Ae=t.getLayout().furniture.find(Se=>{const Be=Tt(Se.type);return Be?I.col>=Se.col&&I.col<Se.col+Be.footprintW&&I.row>=Se.row&&I.row<Se.row+Be.footprintH:!1});ae.style.cursor=Ae?"pointer":"crosshair"}else if((a.activeTool===Te.SELECT||a.activeTool===Te.FURNITURE_PLACE&&a.selectedFurnitureType==="")&&I){const Ae=t.getLayout().furniture.find(Se=>{const Be=Tt(Se.type);return Be?I.col>=Se.col&&I.col<Se.col+Be.footprintW&&I.row>=Se.row&&I.row<Se.row+Be.footprintH:!1});ae.style.cursor=Ae?"grab":"crosshair"}else ae.style.cursor="crosshair"}return}const U=Y(A.clientX,A.clientY);if(!U)return;const L=t.getCharacterAt(U.worldX,U.worldY),z=re(A.clientX,A.clientY);t.hoveredTile=z;const $=D.current;if($){let I="default";if(L!==null)I="pointer";else if(t.selectedAgentId!==null&&z){const ae=t.getSeatAtTile(z.col,z.row);if(ae){const ye=t.seats.get(ae);if(ye){const fe=t.characters.get(t.selectedAgentId);(!ye.assigned||fe&&fe.seatId===ae)&&(I="pointer")}}}$.style.cursor=I}t.hoveredAgentId=L},[t,Y,re,n,a,c,h,R,ee,Q,q]),ne=K.useCallback(A=>{if(CE(),A.button===1){A.preventDefault(),t.cameraFollowId=null,X.current=!0,he.current={mouseX:A.clientX,mouseY:A.clientY,panX:R.current.x,panY:R.current.y};const $=D.current;$&&($.style.cursor="grabbing");return}if(A.button===2&&n){const $=re(A.clientX,A.clientY);if($&&(a.activeTool===Te.TILE_PAINT||a.activeTool===Te.WALL_PAINT||a.activeTool===Te.ERASE)){const I=t.getLayout();$.col>=0&&$.col<I.cols&&$.row>=0&&$.row<I.rows&&(de.current=!0,h($.col,$.row))}return}if(!n)return;const U=Y(A.clientX,A.clientY);if(U&&Q(U.deviceX,U.deviceY)){m();return}if(U&&ee(U.deviceX,U.deviceY)){p();return}const L=re(A.clientX,A.clientY);if((a.activeTool===Te.SELECT||a.activeTool===Te.FURNITURE_PLACE&&a.selectedFurnitureType==="")&&L){const $=t.getLayout();let I=null;for(const ae of $.furniture){const ye=Tt(ae.type);ye&&L.col>=ae.col&&L.col<ae.col+ye.footprintW&&L.row>=ae.row&&L.row<ae.row+ye.footprintH&&(!I||ye.canPlaceOnSurfaces)&&(I=ae)}if(I){a.startDrag(I.uid,L.col,L.row,L.col-I.col,L.row-I.row);return}else a.clearSelection(),d()}a.isDragging=!0,L&&c(L.col,L.row)},[t,n,a,re,Y,c,h,d,p,m,ee,Q,R]),ce=K.useCallback(A=>{if(A.button===1){X.current=!1;const U=D.current;U&&(U.style.cursor=n?"crosshair":"default");return}if(A.button===2){de.current=!1;return}if(a.dragUid){if(a.isDragMoving){const L=a.ghostCol-a.dragOffsetCol,z=a.ghostRow-a.dragOffsetRow,$=t.getLayout().furniture.find(I=>I.uid===a.dragUid);$&&vn(t.getLayout(),$.type,L,z,a.dragUid)&&_(a.dragUid,L,z),a.clearSelection()}else a.selectedFurnitureUid===a.dragUid?a.clearSelection():a.selectedFurnitureUid=a.dragUid;a.clearDrag(),d();const U=D.current;U&&(U.style.cursor="crosshair");return}a.isDragging=!1,a.wallDragAdding=null},[a,n,t,_,d]),O=K.useCallback(A=>{if(n)return;const U=Y(A.clientX,A.clientY);if(!U)return;const L=t.getCharacterAt(U.worldX,U.worldY);if(L!==null){t.dismissBubble(L),t.selectedAgentId===L?(t.selectedAgentId=null,t.cameraFollowId=null):(t.selectedAgentId=L,t.cameraFollowId=L),i(L);return}if(t.selectedAgentId!==null){const z=t.characters.get(t.selectedAgentId);if(z&&!z.isSubagent){const $=re(A.clientX,A.clientY);if($){const I=t.getSeatAtTile($.col,$.row);if(I){const ae=t.seats.get(I);if(ae&&z){if(z.seatId===I){t.sendToSeat(t.selectedAgentId),t.selectedAgentId=null,t.cameraFollowId=null;return}else if(!ae.assigned){t.reassignSeat(t.selectedAgentId,I),t.selectedAgentId=null,t.cameraFollowId=null;const ye={};for(const fe of t.characters.values())fe.isSubagent||(ye[fe.id]={palette:fe.palette,seatId:fe.seatId});return}}}}}t.selectedAgentId=null,t.cameraFollowId=null}},[t,i,Y,re,n]),Z=K.useCallback(()=>{X.current=!1,de.current=!1,a.isDragging=!1,a.wallDragAdding=null,a.clearDrag(),a.ghostCol=-1,a.ghostRow=-1,t.hoveredAgentId=null,t.hoveredTile=null},[t,a]),N=K.useCallback(A=>{if(A.preventDefault(),!n&&t.selectedAgentId!==null){const U=re(A.clientX,A.clientY);U&&t.walkToTile(t.selectedAgentId,U.col,U.row)}},[n,t,re]),me=K.useCallback(A=>{if(A.preventDefault(),A.ctrlKey||A.metaKey){if(_e.current+=A.deltaY,Math.abs(_e.current)>=O2){const U=_e.current<0?1:-1;_e.current=0;const L=Math.max(zo,Math.min(Bd,b+U));L!==b&&E(L)}}else{const U=window.devicePixelRatio||1;t.cameraFollowId=null,R.current=q(R.current.x-A.deltaX*U,R.current.y-A.deltaY*U)}},[b,E,t,R,q]),we=K.useCallback(A=>{A.button===1&&A.preventDefault()},[]);return T.jsx("div",{ref:k,style:{width:"100%",height:"100%",position:"relative",overflow:"hidden",background:"#1E1E2E"},children:T.jsx("canvas",{ref:D,onMouseMove:j,onMouseDown:ne,onMouseUp:ce,onClick:O,onAuxClick:we,onMouseLeave:Z,onWheel:me,onContextMenu:N,style:{display:"block"}})})}function xE(t,i,n){const a=i[t];if(a&&a.length>0){const c=[...a].reverse().find(h=>!h.done);if(c)return c.permissionWait?"Needs approval":c.status;if(n){const h=a[a.length-1];if(h)return h.status}}return"Idle"}function EE({officeState:t,agents:i,agentTools:n,subagentCharacters:a,containerRef:c,zoom:h,panRef:d,onCloseAgent:p}){const[,m]=K.useState(0);K.useEffect(()=>{let _e=0;const q=()=>{m(ge=>ge+1),_e=requestAnimationFrame(q)};return _e=requestAnimationFrame(q),()=>cancelAnimationFrame(_e)},[]);const _=c.current;if(!_)return null;const y=_.getBoundingClientRect(),b=window.devicePixelRatio||1,E=Math.round(y.width*b),R=Math.round(y.height*b),D=t.getLayout(),k=D.cols*Ee*h,V=D.rows*Ee*h,X=Math.floor((E-k)/2)+Math.round(d.current.x),he=Math.floor((R-V)/2)+Math.round(d.current.y),te=t.selectedAgentId,ue=t.hoveredAgentId,de=[...i,...a.map(_e=>_e.id)];return T.jsx(T.Fragment,{children:de.map(_e=>{const q=t.characters.get(_e);if(!q)return null;const ge=te===_e,Y=ue===_e,re=q.isSubagent;if(!ge&&!Y)return null;const ee=q.state===et.TYPE?Ld:0,Q=(X+q.x*h)/b,j=(he+(q.y+ee-Q2)*h)/b,ne=re&&q.bubbleType==="permission";let ce;if(re)if(ne)ce="Needs approval";else{const A=a.find(U=>U.id===_e);ce=A?A.label:"Subtask"}else ce=xE(_e,n,q.isActive);const O=n[_e],Z=ne||O?.some(A=>A.permissionWait&&!A.done),N=O?.some(A=>!A.done),me=q.isActive;let we=null;return Z?we="var(--pixel-status-permission)":me&&N&&(we="var(--pixel-status-active)"),T.jsx("div",{style:{position:"absolute",left:Q,top:j-24,transform:"translateX(-50%)",display:"flex",flexDirection:"column",alignItems:"center",pointerEvents:ge?"auto":"none",zIndex:ge?"var(--pixel-overlay-selected-z)":"var(--pixel-overlay-z)"},children:T.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5,background:"var(--pixel-bg)",border:ge?"2px solid var(--pixel-border-light)":"2px solid var(--pixel-border)",borderRadius:0,padding:ge?"3px 6px 3px 8px":"3px 8px",boxShadow:"var(--pixel-shadow)",whiteSpace:"nowrap",maxWidth:220},children:[we&&T.jsx("span",{className:me&&!Z?"pixel-agents-pulse":void 0,style:{width:6,height:6,borderRadius:"50%",background:we,flexShrink:0}}),T.jsx("span",{style:{fontSize:re?"20px":"22px",fontStyle:re?"italic":void 0,color:"var(--vscode-foreground)",overflow:"hidden",textOverflow:"ellipsis"},children:ce}),ge&&!re&&T.jsx("button",{onClick:A=>{A.stopPropagation(),p(_e)},title:"Close agent",style:{background:"none",border:"none",color:"var(--pixel-close-text)",cursor:"pointer",padding:"0 2px",fontSize:"26px",lineHeight:1,marginLeft:2,flexShrink:0},onMouseEnter:A=>{A.currentTarget.style.color="var(--pixel-close-hover)"},onMouseLeave:A=>{A.currentTarget.style.color="var(--pixel-close-text)"},children:""})]})},_e)})})}const Oi={padding:"3px 8px",fontSize:"22px",background:"rgba(255, 255, 255, 0.08)",color:"rgba(255, 255, 255, 0.7)",border:"2px solid transparent",borderRadius:0,cursor:"pointer"},fs={...Oi,background:"rgba(90, 140, 255, 0.25)",color:"rgba(255, 255, 255, 0.9)",border:"2px solid #5a8cff"},V0={padding:"2px 6px",fontSize:"20px",background:"transparent",color:"rgba(255, 255, 255, 0.5)",border:"2px solid transparent",borderRadius:0,cursor:"pointer"},TE={...V0,background:"rgba(255, 255, 255, 0.08)",color:"rgba(255, 255, 255, 0.8)",border:"2px solid #5a8cff"};function AE({patternIndex:t,color:i,selected:n,onClick:a}){const c=K.useRef(null),h=32,d=2;return K.useEffect(()=>{const p=c.current;if(!p)return;const m=p.getContext("2d");if(!m)return;p.width=h,p.height=h,m.imageSmoothingEnabled=!1;const _=K0(t,i),y=Zs(_,d);m.drawImage(y,0,0)},[t,i]),T.jsx("button",{onClick:a,title:`Floor ${t}`,style:{width:h,height:h,padding:0,border:n?"2px solid #5a8cff":"2px solid #4a4a6a",borderRadius:0,cursor:"pointer",overflow:"hidden",flexShrink:0,background:"#2A2A3A"},children:T.jsx("canvas",{ref:c,style:{width:h,height:h,display:"block"}})})}function ii({label:t,value:i,min:n,max:a,onChange:c}){return T.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[T.jsx("span",{style:{fontSize:"20px",color:"#999",width:28,textAlign:"right",flexShrink:0},children:t}),T.jsx("input",{type:"range",min:n,max:a,value:i,onChange:h=>c(Number(h.target.value)),style:{flex:1,height:12,accentColor:"rgba(90, 140, 255, 0.8)"}}),T.jsx("span",{style:{fontSize:"20px",color:"#999",width:48,textAlign:"right",flexShrink:0},children:i})]})}const RE={h:0,s:0,b:0,c:0};function DE({activeTool:t,selectedTileType:i,selectedFurnitureType:n,selectedFurnitureUid:a,selectedFurnitureColor:c,floorColor:h,wallColor:d,onToolChange:p,onTileTypeChange:m,onFloorColorChange:_,onWallColorChange:y,onSelectedFurnitureColorChange:b,onFurnitureTypeChange:E,loadedAssets:R}){const[D,k]=K.useState("desks"),[V,X]=K.useState(!1),[he,te]=K.useState(!1),[ue,de]=K.useState(!1);K.useEffect(()=>{if(R)try{console.log(`[EditorToolbar] Building dynamic catalog with ${R.catalog.length} assets...`);const N=I0(R);console.log(`[EditorToolbar] Catalog build result: ${N}`);const me=mv();if(me.length>0){const we=me[0]?.id;we&&(console.log(`[EditorToolbar] Setting active category to: ${we}`),k(we))}}catch(N){console.error("[EditorToolbar] Error building dynamic catalog:",N)}},[R]);const _e=K.useCallback((N,me)=>{_({...h,[N]:me})},[h,_]),q=K.useCallback((N,me)=>{y({...d,[N]:me})},[d,y]),ge=c??RE,Y=K.useCallback((N,me)=>{b({...ge,[N]:me})},[ge,b]),re=Nx(D),ee=$x(),Q=Array.from({length:ee},(N,me)=>me+1),j=36,ne=t===Te.TILE_PAINT||t===Te.EYEDROPPER,ce=t===Te.WALL_PAINT,O=t===Te.ERASE,Z=t===Te.FURNITURE_PLACE||t===Te.FURNITURE_PICK;return T.jsxs("div",{style:{position:"absolute",bottom:68,left:10,zIndex:50,background:"#1e1e2e",border:"2px solid #4a4a6a",borderRadius:0,padding:"6px 8px",display:"flex",flexDirection:"column-reverse",gap:6,boxShadow:"2px 2px 0px #0a0a14",maxWidth:"calc(100vw - 20px)"},children:[T.jsxs("div",{style:{display:"flex",gap:4,flexWrap:"wrap"},children:[T.jsx("button",{style:ne?fs:Oi,onClick:()=>p(Te.TILE_PAINT),title:"Paint floor tiles",children:"Floor"}),T.jsx("button",{style:ce?fs:Oi,onClick:()=>p(Te.WALL_PAINT),title:"Paint walls (click to toggle)",children:"Wall"}),T.jsx("button",{style:O?fs:Oi,onClick:()=>p(Te.ERASE),title:"Erase tiles to void",children:"Erase"}),T.jsx("button",{style:Z?fs:Oi,onClick:()=>p(Te.FURNITURE_PLACE),title:"Place furniture",children:"Furniture"})]}),ne&&T.jsxs("div",{style:{display:"flex",flexDirection:"column-reverse",gap:6},children:[T.jsxs("div",{style:{display:"flex",gap:4,alignItems:"center"},children:[T.jsx("button",{style:V?fs:Oi,onClick:()=>X(N=>!N),title:"Adjust floor color",children:"Color"}),T.jsx("button",{style:t===Te.EYEDROPPER?fs:Oi,onClick:()=>p(Te.EYEDROPPER),title:"Pick floor pattern + color from existing tile",children:"Pick"})]}),V&&T.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:3,padding:"4px 6px",background:"#181828",border:"2px solid #4a4a6a",borderRadius:0},children:[T.jsx(ii,{label:"H",value:h.h,min:0,max:360,onChange:N=>_e("h",N)}),T.jsx(ii,{label:"S",value:h.s,min:0,max:100,onChange:N=>_e("s",N)}),T.jsx(ii,{label:"B",value:h.b,min:-100,max:100,onChange:N=>_e("b",N)}),T.jsx(ii,{label:"C",value:h.c,min:-100,max:100,onChange:N=>_e("c",N)})]}),T.jsx("div",{style:{display:"flex",gap:4,overflowX:"auto",flexWrap:"nowrap",paddingBottom:2},children:Q.map(N=>T.jsx(AE,{patternIndex:N,color:h,selected:i===N,onClick:()=>m(N)},N))})]}),ce&&T.jsxs("div",{style:{display:"flex",flexDirection:"column-reverse",gap:6},children:[T.jsx("div",{style:{display:"flex",gap:4,alignItems:"center"},children:T.jsx("button",{style:he?fs:Oi,onClick:()=>te(N=>!N),title:"Adjust wall color",children:"Color"})}),he&&T.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:3,padding:"4px 6px",background:"#181828",border:"2px solid #4a4a6a",borderRadius:0},children:[T.jsx(ii,{label:"H",value:d.h,min:0,max:360,onChange:N=>q("h",N)}),T.jsx(ii,{label:"S",value:d.s,min:0,max:100,onChange:N=>q("s",N)}),T.jsx(ii,{label:"B",value:d.b,min:-100,max:100,onChange:N=>q("b",N)}),T.jsx(ii,{label:"C",value:d.c,min:-100,max:100,onChange:N=>q("c",N)})]})]}),Z&&T.jsxs("div",{style:{display:"flex",flexDirection:"column-reverse",gap:4},children:[T.jsxs("div",{style:{display:"flex",gap:2,flexWrap:"wrap",alignItems:"center"},children:[mv().map(N=>T.jsx("button",{style:D===N.id?TE:V0,onClick:()=>k(N.id),children:N.label},N.id)),T.jsx("div",{style:{width:1,height:14,background:"rgba(255,255,255,0.15)",margin:"0 2px",flexShrink:0}}),T.jsx("button",{style:t===Te.FURNITURE_PICK?fs:Oi,onClick:()=>p(Te.FURNITURE_PICK),title:"Pick furniture type from placed item",children:"Pick"})]}),T.jsx("div",{style:{display:"flex",gap:4,overflowX:"auto",flexWrap:"nowrap",paddingBottom:2},children:re.map(N=>{const me=Zs(N.sprite,2),we=n===N.type;return T.jsx("button",{onClick:()=>E(N.type),title:N.label,style:{width:j,height:j,background:"#2A2A3A",border:we?"2px solid #5a8cff":"2px solid #4a4a6a",borderRadius:0,cursor:"pointer",padding:0,display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden",flexShrink:0},children:T.jsx("canvas",{ref:A=>{if(!A)return;const U=A.getContext("2d");if(!U)return;const L=Math.min(j/me.width,j/me.height)*.85;A.width=j,A.height=j,U.imageSmoothingEnabled=!1,U.clearRect(0,0,j,j);const z=me.width*L,$=me.height*L;U.drawImage(me,(j-z)/2,(j-$)/2,z,$)},style:{width:j,height:j}})},N.type)})})]}),a&&T.jsxs("div",{style:{display:"flex",flexDirection:"column-reverse",gap:3},children:[T.jsxs("div",{style:{display:"flex",gap:4,alignItems:"center"},children:[T.jsx("button",{style:ue?fs:Oi,onClick:()=>de(N=>!N),title:"Adjust selected furniture color",children:"Color"}),c&&T.jsx("button",{style:{...Oi,fontSize:"20px",padding:"2px 6px"},onClick:()=>b(null),title:"Remove color (restore original)",children:"Clear"})]}),ue&&T.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:3,padding:"4px 6px",background:"#181828",border:"2px solid #4a4a6a",borderRadius:0},children:[ge.colorize?T.jsxs(T.Fragment,{children:[T.jsx(ii,{label:"H",value:ge.h,min:0,max:360,onChange:N=>Y("h",N)}),T.jsx(ii,{label:"S",value:ge.s,min:0,max:100,onChange:N=>Y("s",N)})]}):T.jsxs(T.Fragment,{children:[T.jsx(ii,{label:"H",value:ge.h,min:-180,max:180,onChange:N=>Y("h",N)}),T.jsx(ii,{label:"S",value:ge.s,min:-100,max:100,onChange:N=>Y("s",N)})]}),T.jsx(ii,{label:"B",value:ge.b,min:-100,max:100,onChange:N=>Y("b",N)}),T.jsx(ii,{label:"C",value:ge.c,min:-100,max:100,onChange:N=>Y("c",N)}),T.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontSize:"20px",color:"#999",cursor:"pointer"},children:[T.jsx("input",{type:"checkbox",checked:!!ge.colorize,onChange:N=>b({...ge,colorize:N.target.checked||void 0}),style:{accentColor:"rgba(90, 140, 255, 0.8)"}}),"Colorize"]})]})]})]})}class kE{constructor(){this.isEditMode=!1,this.activeTool=Te.SELECT,this.selectedTileType=Ue.FLOOR_1,this.selectedFurnitureType="desk",this.floorColor={...N2},this.wallColor={...H2},this.wallDragAdding=null,this.pickedFurnitureColor=null,this.ghostCol=-1,this.ghostRow=-1,this.ghostValid=!1,this.selectedFurnitureUid=null,this.isDragging=!1,this.undoStack=[],this.redoStack=[],this.isDirty=!1,this.dragUid=null,this.dragStartCol=0,this.dragStartRow=0,this.dragOffsetCol=0,this.dragOffsetRow=0,this.isDragMoving=!1}pushUndo(i){this.undoStack.push(i),this.undoStack.length>Jm&&this.undoStack.shift()}popUndo(){return this.undoStack.pop()||null}pushRedo(i){this.redoStack.push(i),this.redoStack.length>Jm&&this.redoStack.shift()}popRedo(){return this.redoStack.pop()||null}clearRedo(){this.redoStack=[]}clearSelection(){this.selectedFurnitureUid=null}clearGhost(){this.ghostCol=-1,this.ghostRow=-1,this.ghostValid=!1}startDrag(i,n,a,c,h){this.dragUid=i,this.dragStartCol=n,this.dragStartRow=a,this.dragOffsetCol=c,this.dragOffsetRow=h,this.isDragMoving=!1}clearDrag(){this.dragUid=null,this.isDragMoving=!1}reset(){this.activeTool=Te.SELECT,this.selectedFurnitureUid=null,this.ghostCol=-1,this.ghostRow=-1,this.ghostValid=!1,this.isDragging=!1,this.wallDragAdding=null,this.undoStack=[],this.redoStack=[],this.isDirty=!1,this.dragUid=null,this.isDragMoving=!1}}const ME={Reading:"Read",Searching:"Grep",Globbing:"Glob",Fetching:"WebFetch","Searching web":"WebSearch",Writing:"Write",Editing:"Edit",Running:"Bash",Task:"Task"};function Tv(t){for(const[n,a]of Object.entries(ME))if(t.startsWith(n))return a;return t.split(/[\s:]/)[0]||null}function LE(){const t=window.devicePixelRatio||1;return Math.max(zo,Math.round(k2*t))}function Av(t){const i={};for(const n of t.characters.values())n.isSubagent||(i[n.id]={palette:n.palette,hueShift:n.hueShift,seatId:n.seatId})}function BE(t,i,n){const[a,c]=K.useState([]),[h,d]=K.useState(null),[p,m]=K.useState({}),[_,y]=K.useState({}),[b,E]=K.useState({}),[R,D]=K.useState([]),[k,V]=K.useState(!1),[X,he]=K.useState(),te=K.useRef(!1);return K.useEffect(()=>{let ue=[];const de=_e=>{const q=_e.data,ge=t();if(q.type==="layoutLoaded"){if(te.current&&n?.()){console.log("[Webview] Skipping external layout update  editor has unsaved changes");return}const Y=q.layout,re=Y&&Y.version===1?Wx(Y):null;re?(ge.rebuildFromLayout(re),i?.(re)):i?.(ge.getLayout());for(const ee of ue)ge.addAgent(ee.id,ee.palette,ee.hueShift,ee.seatId,!0);ue=[],te.current=!0,V(!0),ge.characters.size>0&&Av(ge)}else if(q.type==="agentCreated"){const Y=q.id;c(re=>re.includes(Y)?re:[...re,Y]),d(Y),ge.addAgent(Y),Av(ge)}else if(q.type==="agentClosed"){const Y=q.id;c(re=>re.filter(ee=>ee!==Y)),d(re=>re===Y?null:re),m(re=>{if(!(Y in re))return re;const ee={...re};return delete ee[Y],ee}),y(re=>{if(!(Y in re))return re;const ee={...re};return delete ee[Y],ee}),E(re=>{if(!(Y in re))return re;const ee={...re};return delete ee[Y],ee}),ge.removeAllSubagents(Y),D(re=>re.filter(ee=>ee.parentAgentId!==Y)),ge.removeAgent(Y)}else if(q.type==="existingAgents"){const Y=q.agents,re=q.agentMeta||{};for(const ee of Y){const Q=re[ee];ue.push({id:ee,palette:Q?.palette,hueShift:Q?.hueShift,seatId:Q?.seatId})}c(ee=>{const Q=new Set(ee),j=[...ee];for(const ne of Y)Q.has(ne)||j.push(ne);return j.sort((ne,ce)=>ne-ce)})}else if(q.type==="agentToolStart"){const Y=q.id,re=q.toolId,ee=q.status;m(j=>{const ne=j[Y]||[];return ne.some(ce=>ce.toolId===re)?j:{...j,[Y]:[...ne,{toolId:re,status:ee,done:!1}]}});const Q=Tv(ee);if(ge.setAgentTool(Y,Q),ge.setAgentActive(Y,!0),ge.clearPermissionBubble(Y),ee.startsWith("Subtask:")){const j=ee.slice(8).trim(),ne=ge.addSubagent(Y,re);D(ce=>ce.some(O=>O.id===ne)?ce:[...ce,{id:ne,parentAgentId:Y,parentToolId:re,label:j}])}}else if(q.type==="agentToolDone"){const Y=q.id,re=q.toolId;m(ee=>{const Q=ee[Y];return Q?{...ee,[Y]:Q.map(j=>j.toolId===re?{...j,done:!0}:j)}:ee})}else if(q.type==="agentToolsClear"){const Y=q.id;m(re=>{if(!(Y in re))return re;const ee={...re};return delete ee[Y],ee}),E(re=>{if(!(Y in re))return re;const ee={...re};return delete ee[Y],ee}),ge.removeAllSubagents(Y),D(re=>re.filter(ee=>ee.parentAgentId!==Y)),ge.setAgentTool(Y,null),ge.clearPermissionBubble(Y)}else if(q.type==="agentSelected"){const Y=q.id;d(Y)}else if(q.type==="agentStatus"){const Y=q.id,re=q.status;y(ee=>{if(re==="active"){if(!(Y in ee))return ee;const Q={...ee};return delete Q[Y],Q}return{...ee,[Y]:re}}),ge.setAgentActive(Y,re==="active"),re==="waiting"&&(ge.showWaitingBubble(Y),bE())}else if(q.type==="agentToolPermission"){const Y=q.id;m(re=>{const ee=re[Y];return ee?{...re,[Y]:ee.map(Q=>Q.done?Q:{...Q,permissionWait:!0})}:re}),ge.showPermissionBubble(Y)}else if(q.type==="subagentToolPermission"){const Y=q.id,re=q.parentToolId,ee=ge.getSubagentId(Y,re);ee!==null&&ge.showPermissionBubble(ee)}else if(q.type==="agentToolPermissionClear"){const Y=q.id;m(re=>{const ee=re[Y];return!ee||!ee.some(j=>j.permissionWait)?re:{...re,[Y]:ee.map(j=>j.permissionWait?{...j,permissionWait:!1}:j)}}),ge.clearPermissionBubble(Y);for(const[re,ee]of ge.subagentMeta)ee.parentAgentId===Y&&ge.clearPermissionBubble(re)}else if(q.type==="subagentToolStart"){const Y=q.id,re=q.parentToolId,ee=q.toolId,Q=q.status;E(ne=>{const ce=ne[Y]||{},O=ce[re]||[];return O.some(Z=>Z.toolId===ee)?ne:{...ne,[Y]:{...ce,[re]:[...O,{toolId:ee,status:Q,done:!1}]}}});const j=ge.getSubagentId(Y,re);if(j!==null){const ne=Tv(Q);ge.setAgentTool(j,ne),ge.setAgentActive(j,!0)}}else if(q.type==="subagentToolDone"){const Y=q.id,re=q.parentToolId,ee=q.toolId;E(Q=>{const j=Q[Y];if(!j)return Q;const ne=j[re];return ne?{...Q,[Y]:{...j,[re]:ne.map(ce=>ce.toolId===ee?{...ce,done:!0}:ce)}}:Q})}else if(q.type==="subagentClear"){const Y=q.id,re=q.parentToolId;E(ee=>{const Q=ee[Y];if(!Q||!(re in Q))return ee;const j={...Q};if(delete j[re],Object.keys(j).length===0){const ne={...ee};return delete ne[Y],ne}return{...ee,[Y]:j}}),ge.removeSubagent(Y,re),D(ee=>ee.filter(Q=>!(Q.parentAgentId===Y&&Q.parentToolId===re)))}else if(q.type==="characterSpritesLoaded"){const Y=q.characters;console.log(`[Webview] Received ${Y.length} pre-colored character sprites`),Lx(Y)}else if(q.type==="floorTilesLoaded"){const Y=q.sprites;console.log(`[Webview] Received ${Y.length} floor tile patterns`),Xx(Y)}else if(q.type==="wallTilesLoaded"){const Y=q.sprites;console.log(`[Webview] Received ${Y.length} wall tile sprites`),Zx(Y)}else if(q.type==="settingsLoaded"){const Y=q.soundEnabled;X0(Y)}else if(q.type==="furnitureAssetsLoaded")try{const Y=q.catalog,re=q.sprites;console.log(` Webview: Loaded ${Y.length} furniture assets`),I0({catalog:Y,sprites:re}),he({catalog:Y,sprites:re})}catch(Y){console.error(" Webview: Error processing furnitureAssetsLoaded:",Y)}};return window.addEventListener("message",de),()=>window.removeEventListener("message",de)},[t]),{agents:a,selectedAgent:h,agentTools:p,agentStatuses:_,subagentTools:b,subagentCharacters:R,layoutReady:k,loadedAssets:X}}function OE(t,i){const[n,a]=K.useState(!1),[c,h]=K.useState(0),[d,p]=K.useState(!1),[m,_]=K.useState(LE),y=K.useRef(null),b=K.useRef({x:0,y:0}),E=K.useRef(null),R=K.useCallback(L=>{E.current=structuredClone(L)},[]),D=K.useCallback(L=>{y.current&&clearTimeout(y.current),y.current=setTimeout(()=>{},z2)},[]),k=K.useCallback(L=>{const z=t();i.pushUndo(z.getLayout()),i.clearRedo(),i.isDirty=!0,p(!0),z.rebuildFromLayout(L),D(L),h($=>$+1)},[t,i,D]),V=K.useCallback(()=>{},[]),X=K.useCallback(()=>{a(L=>{const z=!L;if(i.isEditMode=z,z){const I=t().getLayout();if(I.tileColors){for(let ae=0;ae<I.tiles.length;ae++)if(I.tiles[ae]===Ue.WALL&&I.tileColors[ae]){i.wallColor={...I.tileColors[ae]};break}}}else i.clearSelection(),i.clearGhost(),i.clearDrag(),de.current=!1;return z})},[i,t]),he=K.useCallback(L=>{i.activeTool===L?i.activeTool=Te.SELECT:i.activeTool=L,i.clearSelection(),i.clearGhost(),i.clearDrag(),q.current=null,de.current=!1,h(z=>z+1)},[i]),te=K.useCallback(L=>{i.selectedTileType=L,h(z=>z+1)},[i]),ue=K.useCallback(L=>{i.floorColor=L,h(z=>z+1)},[i]),de=K.useRef(!1),_e=K.useCallback(L=>{i.wallColor=L;const z=t(),$=z.getLayout(),ae=[...$.tileColors||new Array($.tiles.length).fill(null)];let ye=!1;for(let fe=0;fe<$.tiles.length;fe++)$.tiles[fe]===Ue.WALL&&(ae[fe]={...L},ye=!0);if(ye){de.current||(i.pushUndo($),i.clearRedo(),de.current=!0);const fe={...$,tileColors:ae};i.isDirty=!0,p(!0),z.rebuildFromLayout(fe),D(fe)}h(fe=>fe+1)},[i,t,D]),q=K.useRef(null),ge=K.useCallback(L=>{const z=i.selectedFurnitureUid;if(!z)return;const $=t(),I=$.getLayout();q.current!==z&&(i.pushUndo(I),i.clearRedo(),q.current=z);const ae=I.furniture.map(fe=>fe.uid===z?{...fe,color:L??void 0}:fe),ye={...I,furniture:ae};i.isDirty=!0,p(!0),$.rebuildFromLayout(ye),D(ye),h(fe=>fe+1)},[t,i,D]),Y=K.useCallback(L=>{i.selectedFurnitureType===L?(i.selectedFurnitureType="",i.clearGhost()):i.selectedFurnitureType=L,h(z=>z+1)},[i]),re=K.useCallback(()=>{const L=i.selectedFurnitureUid;if(!L)return;const z=t(),$=gE(z.getLayout(),L);$!==z.getLayout()&&(k($),i.clearSelection(),q.current=null)},[t,i,k]),ee=K.useCallback(()=>{if(i.activeTool===Te.FURNITURE_PLACE){const I=j0(i.selectedFurnitureType);I&&(i.selectedFurnitureType=I,h(ae=>ae+1));return}const L=i.selectedFurnitureUid;if(!L)return;const z=t(),$=mE(z.getLayout(),L);$!==z.getLayout()&&k($)},[t,i,k]),Q=K.useCallback(()=>{if(i.activeTool===Te.FURNITURE_PLACE){const I=W0(i.selectedFurnitureType);I&&(i.selectedFurnitureType=I,h(ae=>ae+1));return}const L=i.selectedFurnitureUid;if(!L)return;const z=t(),$=vE(z.getLayout(),L);$!==z.getLayout()&&k($)},[t,i,k]),j=K.useCallback(()=>{const L=i.popUndo();if(!L)return;const z=t();i.pushRedo(z.getLayout()),z.rebuildFromLayout(L),D(L),i.isDirty=!0,p(!0),h($=>$+1)},[t,i,D]),ne=K.useCallback(()=>{const L=i.popRedo();if(!L)return;const z=t();i.pushUndo(z.getLayout()),z.rebuildFromLayout(L),D(L),i.isDirty=!0,p(!0),h($=>$+1)},[t,i,D]),ce=K.useCallback(()=>{if(!E.current)return;const L=structuredClone(E.current);k(L),i.reset(),p(!1)},[i,k]),O=K.useCallback(()=>{y.current&&(clearTimeout(y.current),y.current=null);const z=t().getLayout();E.current=structuredClone(z),i.isDirty=!1,p(!1)},[t,i]),Z=K.useCallback(()=>{q.current=null,h(L=>L+1)},[]),N=K.useCallback(L=>{_(Math.max(zo,Math.min(Bd,L)))},[]),me=K.useCallback((L,z,$)=>{const ae=t().getLayout(),ye=pE(ae,L,z,$);ye!==ae&&k(ye)},[t,k]),we=K.useCallback((L,z,$)=>{if(z>=0&&z<L.cols&&$>=0&&$<L.rows)return null;const I=[];z<0&&I.push("left"),z>=L.cols&&I.push("right"),$<0&&I.push("up"),$>=L.rows&&I.push("down");let ae=L,ye=0,fe=0;for(const Ae of I){const Se=yE(ae,Ae);if(!Se)return null;ae=Se.layout,ye+=Se.shift.col,fe+=Se.shift.row}return{layout:ae,col:z+ye,row:$+fe,shift:{col:ye,row:fe}}},[]),A=K.useCallback((L,z)=>{const $=t();let I=$.getLayout(),ae=L,ye=z;if(i.activeTool===Te.TILE_PAINT||i.activeTool===Te.WALL_PAINT){const fe=we(I,L,z);fe&&(I=fe.layout,ae=fe.col,ye=fe.row,$.rebuildFromLayout(I,fe.shift))}if(i.activeTool===Te.TILE_PAINT){const fe=El(I,ae,ye,i.selectedTileType,i.floorColor);fe!==I&&k(fe)}else if(i.activeTool===Te.WALL_PAINT){const fe=ye*I.cols+ae,Ae=I.tiles[fe]===Ue.WALL;if(i.wallDragAdding===null&&(i.wallDragAdding=!Ae),i.wallDragAdding){const Se=El(I,ae,ye,Ue.WALL,i.wallColor);Se!==I&&k(Se)}else if(Ae){const Se=El(I,ae,ye,i.selectedTileType,i.floorColor);Se!==I&&k(Se)}}else if(i.activeTool===Te.ERASE){if(L<0||L>=I.cols||z<0||z>=I.rows)return;const fe=z*I.cols+L;if(I.tiles[fe]===Ue.VOID)return;const Ae=El(I,L,z,Ue.VOID);Ae!==I&&k(Ae)}else if(i.activeTool===Te.FURNITURE_PLACE){const fe=i.selectedFurnitureType;if(fe===""){const Ae=I.furniture.find(Se=>{const Be=Tt(Se.type);return Be?L>=Se.col&&L<Se.col+Be.footprintW&&z>=Se.row&&z<Se.row+Be.footprintH:!1});i.selectedFurnitureUid=Ae?Ae.uid:null,h(Se=>Se+1)}else{const Ae=G0(fe,z);if(!vn(I,fe,L,Ae))return;const Be={uid:`f-${Date.now()}-${Math.random().toString(36).slice(2,6)}`,type:fe,col:L,row:Ae};i.pickedFurnitureColor&&(Be.color={...i.pickedFurnitureColor});const De=_E(I,Be);De!==I&&k(De)}}else if(i.activeTool===Te.FURNITURE_PICK){const fe=I.furniture.find(Ae=>{const Se=Tt(Ae.type);return Se?L>=Ae.col&&L<Ae.col+Se.footprintW&&z>=Ae.row&&z<Ae.row+Se.footprintH:!1});fe&&(i.selectedFurnitureType=fe.type,i.pickedFurnitureColor=fe.color?{...fe.color}:null,i.activeTool=Te.FURNITURE_PLACE),h(Ae=>Ae+1)}else if(i.activeTool===Te.EYEDROPPER){const fe=z*I.cols+L,Ae=I.tiles[fe];if(Ae!==void 0&&Ae!==Ue.WALL&&Ae!==Ue.VOID){i.selectedTileType=Ae;const Se=I.tileColors?.[fe];Se&&(i.floorColor={...Se}),i.activeTool=Te.TILE_PAINT}else if(Ae===Ue.WALL){const Se=I.tileColors?.[fe];Se&&(i.wallColor={...Se}),i.activeTool=Te.WALL_PAINT}h(Se=>Se+1)}else if(i.activeTool===Te.SELECT){const fe=I.furniture.find(Ae=>{const Se=Tt(Ae.type);return Se?L>=Ae.col&&L<Ae.col+Se.footprintW&&z>=Ae.row&&z<Ae.row+Se.footprintH:!1});i.selectedFurnitureUid=fe?fe.uid:null,h(Ae=>Ae+1)}},[t,i,k,we]),U=K.useCallback((L,z)=>{const I=t().getLayout();if(L<0||L>=I.cols||z<0||z>=I.rows)return;const ae=z*I.cols+L;if(I.tiles[ae]===Ue.VOID)return;const ye=El(I,L,z,Ue.VOID);ye!==I&&k(ye)},[t,k]);return{isEditMode:n,editorTick:c,isDirty:d,zoom:m,panRef:b,saveTimerRef:y,setLastSavedLayout:R,handleOpenClaude:V,handleToggleEditMode:X,handleToolChange:he,handleTileTypeChange:te,handleFloorColorChange:ue,handleWallColorChange:_e,handleSelectedFurnitureColorChange:ge,handleFurnitureTypeChange:Y,handleDeleteSelected:re,handleRotateSelected:ee,handleToggleState:Q,handleUndo:j,handleRedo:ne,handleReset:ce,handleSave:O,handleZoomChange:N,handleEditorTileAction:A,handleEditorEraseAction:U,handleEditorSelectionChange:Z,handleDragMove:me}}function zE(t,i,n,a,c,h,d,p,m){K.useEffect(()=>{if(!t)return;const _=y=>{if(y.key==="Escape"){if(i.activeTool===Te.FURNITURE_PICK)i.activeTool=Te.FURNITURE_PLACE,i.clearGhost();else if(i.activeTool===Te.FURNITURE_PLACE&&i.selectedFurnitureType!=="")i.selectedFurnitureType="",i.clearGhost();else if(i.activeTool!==Te.SELECT)i.activeTool=Te.SELECT,i.clearGhost();else if(i.selectedFurnitureUid)i.clearSelection();else{m();return}i.clearDrag(),p()}else y.key==="Delete"||y.key==="Backspace"?i.selectedFurnitureUid&&n():y.key==="r"||y.key==="R"?a():y.key==="t"||y.key==="T"?c():y.key==="z"&&(y.ctrlKey||y.metaKey)&&!y.shiftKey?(y.preventDefault(),h()):(y.key==="y"&&(y.ctrlKey||y.metaKey)||y.key==="z"&&(y.ctrlKey||y.metaKey)&&y.shiftKey)&&(y.preventDefault(),d())};return window.addEventListener("keydown",_),()=>window.removeEventListener("keydown",_)},[t,i,n,a,c,h,d,p,m])}const _o={width:40,height:40,padding:0,background:"var(--pixel-bg)",color:"var(--pixel-text)",border:"2px solid var(--pixel-border)",borderRadius:0,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"var(--pixel-shadow)"};function NE({zoom:t,onZoomChange:i}){const[n,a]=K.useState(null),[c,h]=K.useState(!1),[d,p]=K.useState(!1),m=K.useRef(null),_=K.useRef(null),y=K.useRef(t),b=t<=zo,E=t>=Bd;return K.useEffect(()=>{if(t!==y.current)return y.current=t,m.current&&clearTimeout(m.current),_.current&&clearTimeout(_.current),h(!0),p(!1),_.current=setTimeout(()=>{p(!0)},M2),m.current=setTimeout(()=>{h(!1),p(!1)},L2),()=>{m.current&&clearTimeout(m.current),_.current&&clearTimeout(_.current)}},[t]),T.jsxs(T.Fragment,{children:[c&&T.jsxs("div",{style:{position:"absolute",top:10,left:"50%",transform:"translateX(-50%)",zIndex:"var(--pixel-controls-z)",background:"var(--pixel-bg)",border:"2px solid var(--pixel-border)",borderRadius:0,padding:"4px 12px",boxShadow:"var(--pixel-shadow)",fontSize:"26px",color:"var(--pixel-text)",userSelect:"none",opacity:d?0:1,transition:`opacity ${B2}s ease-out`,pointerEvents:"none"},children:[t,"x"]}),T.jsxs("div",{style:{position:"absolute",top:8,left:8,zIndex:"var(--pixel-controls-z)",display:"flex",flexDirection:"column",gap:4},children:[T.jsx("button",{onClick:()=>i(t+1),disabled:E,onMouseEnter:()=>a("plus"),onMouseLeave:()=>a(null),style:{..._o,background:n==="plus"&&!E?"var(--pixel-btn-hover-bg)":_o.background,cursor:E?"default":"pointer",opacity:E?"var(--pixel-btn-disabled-opacity)":1},title:"Zoom in (Ctrl+Scroll)",children:T.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",children:[T.jsx("line",{x1:"9",y1:"3",x2:"9",y2:"15",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),T.jsx("line",{x1:"3",y1:"9",x2:"15",y2:"9",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})}),T.jsx("button",{onClick:()=>i(t-1),disabled:b,onMouseEnter:()=>a("minus"),onMouseLeave:()=>a(null),style:{..._o,background:n==="minus"&&!b?"var(--pixel-btn-hover-bg)":_o.background,cursor:b?"default":"pointer",opacity:b?"var(--pixel-btn-disabled-opacity)":1},title:"Zoom out (Ctrl+Scroll)",children:T.jsx("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",children:T.jsx("line",{x1:"3",y1:"9",x2:"15",y2:"9",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})})]})]})}const Tl={display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",padding:"6px 10px",fontSize:"24px",color:"rgba(255, 255, 255, 0.8)",background:"transparent",border:"none",borderRadius:0,cursor:"pointer",textAlign:"left"};function HE({isOpen:t,onClose:i,isDebugMode:n,onToggleDebugMode:a}){const[c,h]=K.useState(null),[d,p]=K.useState(xv);return t?T.jsxs(T.Fragment,{children:[T.jsx("div",{onClick:i,style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.5)",zIndex:49}}),T.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:50,background:"var(--pixel-bg)",border:"2px solid var(--pixel-border)",borderRadius:0,padding:"4px",boxShadow:"var(--pixel-shadow)",minWidth:200},children:[T.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"4px 10px",borderBottom:"1px solid var(--pixel-border)",marginBottom:"4px"},children:[T.jsx("span",{style:{fontSize:"24px",color:"rgba(255, 255, 255, 0.9)"},children:"Settings"}),T.jsx("button",{onClick:i,onMouseEnter:()=>h("close"),onMouseLeave:()=>h(null),style:{background:c==="close"?"rgba(255, 255, 255, 0.08)":"transparent",border:"none",borderRadius:0,color:"rgba(255, 255, 255, 0.6)",fontSize:"24px",cursor:"pointer",padding:"0 4px",lineHeight:1},children:"X"})]}),T.jsx("button",{onClick:()=>{i()},onMouseEnter:()=>h("sessions"),onMouseLeave:()=>h(null),style:{...Tl,background:c==="sessions"?"rgba(255, 255, 255, 0.08)":"transparent"},children:"Open Sessions Folder"}),T.jsx("button",{onClick:()=>{i()},onMouseEnter:()=>h("export"),onMouseLeave:()=>h(null),style:{...Tl,background:c==="export"?"rgba(255, 255, 255, 0.08)":"transparent"},children:"Export Layout"}),T.jsx("button",{onClick:()=>{i()},onMouseEnter:()=>h("import"),onMouseLeave:()=>h(null),style:{...Tl,background:c==="import"?"rgba(255, 255, 255, 0.08)":"transparent"},children:"Import Layout"}),T.jsxs("button",{onClick:()=>{const m=!xv();X0(m),p(m)},onMouseEnter:()=>h("sound"),onMouseLeave:()=>h(null),style:{...Tl,background:c==="sound"?"rgba(255, 255, 255, 0.08)":"transparent"},children:[T.jsx("span",{children:"Sound Notifications"}),T.jsx("span",{style:{width:14,height:14,border:"2px solid rgba(255, 255, 255, 0.5)",borderRadius:0,background:d?"rgba(90, 140, 255, 0.8)":"transparent",flexShrink:0,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",lineHeight:1,color:"#fff"},children:d?"X":""})]}),T.jsxs("button",{onClick:a,onMouseEnter:()=>h("debug"),onMouseLeave:()=>h(null),style:{...Tl,background:c==="debug"?"rgba(255, 255, 255, 0.08)":"transparent"},children:[T.jsx("span",{children:"Debug View"}),n&&T.jsx("span",{style:{width:6,height:6,borderRadius:"50%",background:"rgba(90, 140, 255, 0.8)",flexShrink:0}})]})]})]}):null}const UE={position:"absolute",bottom:10,left:10,zIndex:"var(--pixel-controls-z)",display:"flex",alignItems:"center",gap:4,background:"var(--pixel-bg)",border:"2px solid var(--pixel-border)",borderRadius:0,padding:"4px 6px",boxShadow:"var(--pixel-shadow)"},gn={padding:"5px 10px",fontSize:"24px",color:"var(--pixel-text)",background:"var(--pixel-btn-bg)",border:"2px solid transparent",borderRadius:0,cursor:"pointer"},Rv={...gn,background:"var(--pixel-active-bg)",border:"2px solid var(--pixel-accent)"};function IE({isEditMode:t,onOpenClaude:i,onToggleEditMode:n,isDebugMode:a,onToggleDebugMode:c}){const[h,d]=K.useState(null),[p,m]=K.useState(!1);return T.jsxs("div",{style:UE,children:[T.jsx("button",{onClick:i,onMouseEnter:()=>d("agent"),onMouseLeave:()=>d(null),style:{...gn,padding:"5px 12px",background:h==="agent"?"var(--pixel-agent-hover-bg)":"var(--pixel-agent-bg)",border:"2px solid var(--pixel-agent-border)",color:"var(--pixel-agent-text)"},children:"+ Agent"}),T.jsx("button",{onClick:n,onMouseEnter:()=>d("edit"),onMouseLeave:()=>d(null),style:t?{...Rv}:{...gn,background:h==="edit"?"var(--pixel-btn-hover-bg)":gn.background},title:"Edit office layout",children:"Layout"}),T.jsxs("div",{style:{position:"relative"},children:[T.jsx("button",{onClick:()=>m(_=>!_),onMouseEnter:()=>d("settings"),onMouseLeave:()=>d(null),style:p?{...Rv}:{...gn,background:h==="settings"?"var(--pixel-btn-hover-bg)":gn.background},title:"Settings",children:"Settings"}),T.jsx(HE,{isOpen:p,onClose:()=>m(!1),isDebugMode:a,onToggleDebugMode:c})]})]})}const jE=40;function WE({tool:t}){return T.jsx("span",{className:t.done?void 0:"pixel-agents-pulse",style:{width:6,height:6,borderRadius:"50%",background:t.done?"var(--vscode-charts-green, #89d185)":t.permissionWait?"var(--vscode-charts-yellow, #cca700)":"var(--vscode-charts-blue, #3794ff)",display:"inline-block",flexShrink:0}})}function Dv({tool:t}){return T.jsxs("span",{style:{fontSize:"22px",opacity:t.done?.5:.8,display:"flex",alignItems:"center",gap:5},children:[T.jsx(WE,{tool:t}),t.permissionWait&&!t.done?"Needs approval":t.status]})}function FE({agents:t,selectedAgent:i,agentTools:n,agentStatuses:a,subagentTools:c,onSelectAgent:h}){const d=p=>{const m=i===p,_=n[p]||[],y=c[p]||{},b=a[p],E=_.some(R=>!R.done);return T.jsxs("div",{style:{border:`2px solid ${m?"#5a8cff":"#4a4a6a"}`,borderRadius:0,padding:"6px 8px",background:m?"var(--vscode-list-activeSelectionBackground, rgba(255,255,255,0.04))":void 0},children:[T.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:0},children:[T.jsxs("button",{onClick:()=>h(p),style:{borderRadius:0,padding:"6px 10px",fontSize:"26px",background:m?"rgba(90, 140, 255, 0.25)":void 0,color:m?"#fff":void 0,fontWeight:m?"bold":void 0},children:["Agent #",p]}),T.jsx("button",{onClick:()=>SE.postMessage({type:"closeAgent",id:p}),style:{borderRadius:0,padding:"6px 8px",fontSize:"26px",opacity:.7,background:m?"rgba(90, 140, 255, 0.25)":void 0,color:m?"#fff":void 0},title:"Close agent",children:""})]}),(_.length>0||b==="waiting")&&T.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:1,marginTop:4,paddingLeft:4},children:[_.map(R=>T.jsxs("div",{children:[T.jsx(Dv,{tool:R}),y[R.toolId]&&y[R.toolId].length>0&&T.jsx("div",{style:{borderLeft:"2px solid var(--vscode-widget-border, rgba(255,255,255,0.12))",marginLeft:3,paddingLeft:8,marginTop:1,display:"flex",flexDirection:"column",gap:1},children:y[R.toolId].map(D=>T.jsx(Dv,{tool:D},D.toolId))})]},R.toolId)),b==="waiting"&&!E&&T.jsxs("span",{style:{fontSize:"22px",opacity:.85,display:"flex",alignItems:"center",gap:5},children:[T.jsx("span",{style:{width:6,height:6,borderRadius:"50%",background:"var(--vscode-charts-yellow, #cca700)",display:"inline-block",flexShrink:0}}),"Might be waiting for input"]})]})]},p)};return T.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"var(--vscode-editor-background)",zIndex:jE,overflow:"auto"},children:T.jsx("div",{style:{padding:"12px 12px 12px",fontSize:"28px"},children:T.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:t.map(d)})})})}const xu={current:null},si=new kE;function go(){return xu.current||(xu.current=new Px),xu.current}const yr={padding:"4px 10px",fontSize:"22px",background:"var(--pixel-btn-bg)",color:"var(--pixel-text-dim)",border:"2px solid transparent",borderRadius:0,cursor:"pointer"},kv={...yr,opacity:"var(--pixel-btn-disabled-opacity)",cursor:"default"};function PE({editor:t,editorState:i}){const[n,a]=K.useState(!1),c=i.undoStack.length===0,h=i.redoStack.length===0;return T.jsxs("div",{style:{position:"absolute",top:8,left:"50%",transform:"translateX(-50%)",zIndex:"var(--pixel-controls-z)",display:"flex",gap:4,alignItems:"center",background:"var(--pixel-bg)",border:"2px solid var(--pixel-border)",borderRadius:0,padding:"4px 8px",boxShadow:"var(--pixel-shadow)"},children:[T.jsx("button",{style:c?kv:yr,onClick:c?void 0:t.handleUndo,title:"Undo (Ctrl+Z)",children:"Undo"}),T.jsx("button",{style:h?kv:yr,onClick:h?void 0:t.handleRedo,title:"Redo (Ctrl+Y)",children:"Redo"}),T.jsx("button",{style:yr,onClick:t.handleSave,title:"Save layout",children:"Save"}),n?T.jsxs("div",{style:{display:"flex",gap:4,alignItems:"center"},children:[T.jsx("span",{style:{fontSize:"22px",color:"var(--pixel-reset-text)"},children:"Reset?"}),T.jsx("button",{style:{...yr,background:"var(--pixel-danger-bg)",color:"#fff"},onClick:()=>{a(!1),t.handleReset()},children:"Yes"}),T.jsx("button",{style:yr,onClick:()=>a(!1),children:"No"})]}):T.jsx("button",{style:yr,onClick:()=>a(!0),title:"Reset to last saved layout",children:"Reset"})]})}function YE(){const t=OE(go,si),i=K.useCallback(()=>t.isEditMode&&t.isDirty,[t.isEditMode,t.isDirty]),{agents:n,selectedAgent:a,agentTools:c,agentStatuses:h,subagentTools:d,subagentCharacters:p,layoutReady:m,loadedAssets:_}=BE(go,t.setLastSavedLayout,i),[y,b]=K.useState(!1),E=K.useCallback(()=>b(de=>!de),[]),R=K.useCallback(de=>{},[]),D=K.useRef(null),[k,V]=K.useState(0);zE(t.isEditMode,si,t.handleDeleteSelected,t.handleRotateSelected,t.handleToggleState,t.handleUndo,t.handleRedo,K.useCallback(()=>V(de=>de+1),[]),t.handleToggleEditMode);const X=K.useCallback(de=>{},[]),he=K.useCallback(de=>{const q=go().subagentMeta.get(de);q&&q.parentAgentId},[]),te=go(),ue=t.isEditMode&&(()=>{if(si.selectedFurnitureUid){const de=te.getLayout().furniture.find(_e=>_e.uid===si.selectedFurnitureUid);if(de&&pd(de.type))return!0}return!!(si.activeTool===Te.FURNITURE_PLACE&&pd(si.selectedFurnitureType))})();return m?T.jsxs("div",{ref:D,style:{width:"100%",height:"100%",position:"relative",overflow:"hidden"},children:[T.jsx("style",{children:`
        @keyframes pixel-agents-pulse {
          0%, 100% { opacity: 1; }
          50% { opacity: 0.3; }
        }
        .pixel-agents-pulse { animation: pixel-agents-pulse ${J2}s ease-in-out infinite; }
      `}),T.jsx(wE,{officeState:te,onClick:he,isEditMode:t.isEditMode,editorState:si,onEditorTileAction:t.handleEditorTileAction,onEditorEraseAction:t.handleEditorEraseAction,onEditorSelectionChange:t.handleEditorSelectionChange,onDeleteSelected:t.handleDeleteSelected,onRotateSelected:t.handleRotateSelected,onDragMove:t.handleDragMove,editorTick:t.editorTick,zoom:t.zoom,onZoomChange:t.handleZoomChange,panRef:t.panRef}),T.jsx(NE,{zoom:t.zoom,onZoomChange:t.handleZoomChange}),T.jsx("div",{style:{position:"absolute",inset:0,background:"var(--pixel-vignette)",pointerEvents:"none",zIndex:40}}),T.jsx(IE,{isEditMode:t.isEditMode,onOpenClaude:t.handleOpenClaude,onToggleEditMode:t.handleToggleEditMode,isDebugMode:y,onToggleDebugMode:E}),t.isEditMode&&t.isDirty&&T.jsx(PE,{editor:t,editorState:si}),ue&&T.jsxs("div",{style:{position:"absolute",top:8,left:"50%",transform:t.isDirty?"translateX(calc(-50% + 100px))":"translateX(-50%)",zIndex:49,background:"var(--pixel-hint-bg)",color:"#fff",fontSize:"20px",padding:"3px 8px",borderRadius:0,border:"2px solid var(--pixel-accent)",boxShadow:"var(--pixel-shadow)",pointerEvents:"none",whiteSpace:"nowrap"},children:["Press ",T.jsx("b",{children:"R"})," to rotate"]}),t.isEditMode&&(()=>{const de=si.selectedFurnitureUid,_e=de?te.getLayout().furniture.find(q=>q.uid===de)?.color??null:null;return T.jsx(DE,{activeTool:si.activeTool,selectedTileType:si.selectedTileType,selectedFurnitureType:si.selectedFurnitureType,selectedFurnitureUid:de,selectedFurnitureColor:_e,floorColor:si.floorColor,wallColor:si.wallColor,onToolChange:t.handleToolChange,onTileTypeChange:t.handleTileTypeChange,onFloorColorChange:t.handleFloorColorChange,onWallColorChange:t.handleWallColorChange,onSelectedFurnitureColorChange:t.handleSelectedFurnitureColorChange,onFurnitureTypeChange:t.handleFurnitureTypeChange,loadedAssets:_})})(),T.jsx(EE,{officeState:te,agents:n,agentTools:c,subagentCharacters:p,containerRef:D,zoom:t.zoom,panRef:t.panRef,onCloseAgent:X}),y&&T.jsx(FE,{agents:n,selectedAgent:a,agentTools:c,agentStatuses:h,subagentTools:d,onSelectAgent:R})]}):T.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--vscode-foreground)"},children:"Loading..."})}const Eu=new Map;let qE=1;function Mv(t){return Eu.has(t)||Eu.set(t,qE++),Eu.get(t)}function KE({ws:t,activeSessions:i}){const n=K.useRef(!1);return K.useEffect(()=>{n.current||(n.current=!0,window.dispatchEvent(new MessageEvent("message",{data:{type:"layoutLoaded",layout:null}})));const a=i.map(c=>Mv(c.sessionId));window.dispatchEvent(new MessageEvent("message",{data:{type:"existingAgents",agents:a,agentMeta:{}}}))},[i.map(a=>a.sessionId).join(",")]),K.useEffect(()=>{if(!t)return;function a(c){try{const h=JSON.parse(c.data);if(h.type==="agent_status"){const d=Mv(h.sessionId);h.status==="active"&&h.toolStatus?window.dispatchEvent(new MessageEvent("message",{data:{type:"agentToolStart",id:d,toolId:h.toolId||`t-${d}`,status:h.toolStatus}})):window.dispatchEvent(new MessageEvent("message",{data:{type:"agentStatus",id:d,status:h.status||"active"}}))}}catch{}}return t.addEventListener("message",a),()=>t.removeEventListener("message",a)},[t]),T.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden",position:"relative"},children:[T.jsx(YE,{}),T.jsxs("div",{style:{position:"absolute",bottom:0,left:0,right:0,fontSize:"0.6rem",color:"#333",textAlign:"center",padding:"2px",background:"rgba(0,0,0,0.5)"},children:["Pixel art inspired by"," ",T.jsx("a",{href:"https://github.com/georgetrad/pixel-agents",target:"_blank",rel:"noreferrer",style:{color:"#58a6ff"},children:"Pixel Agents"})," ","by Pablo De Lucca  MIT License"]})]})}function GE({token:t,onLogout:i,isDark:n,onToggleTheme:a}){const c=Ki(),[h,d]=K.useState([]),[p,m]=K.useState([]),[_,y]=K.useState([]),[b,E]=K.useState(null),[R,D]=K.useState(!1),[k,V]=K.useState(!1),[X,he]=K.useState(!1),[te,ue]=K.useState("terminal"),de=K.useRef(null);K.useEffect(()=>{const Y=location.protocol==="https:"?"wss":"ws",re=location.pathname.replace(/\/+$/,""),ee=`${Y}://${location.host}${re}/ws?token=${t}`;console.log("[dashboard] WebSocket connecting to:",ee);const Q=new WebSocket(ee);return de.current=Q,Q.onopen=()=>{console.log("[dashboard] WebSocket connected"),D(!0),Q.send(JSON.stringify({type:"scan_history",machineId:"_all"}))},Q.onmessage=j=>{try{const ne=JSON.parse(j.data);console.log("[dashboard] ",ne.type),ne.type==="session_list"&&d(ne.sessions||[]),ne.type==="active_sessions"&&m((ne.sessions||[]).map(ce=>({...ce,machineId:ne.machineId}))),ne.type==="session_history"&&y((ne.sessions||[]).map(ce=>({...ce,machineId:ce.machineId||ne.machineId})))}catch{}},Q.onerror=j=>console.error("[dashboard] WebSocket error:",j),Q.onclose=j=>{console.log("[dashboard] WebSocket closed:",j.code,j.reason),D(!1),j.code===4001&&i()},()=>Q.close()},[t]);function _e(Y,re,ee,Q){E({machineId:Y,sessionId:re}),he(!1),de.current?.readyState===WebSocket.OPEN&&de.current.send(JSON.stringify({type:"open_terminal",machineId:Y,sessionId:re,cols:220,rows:50,command:ee||["claude"],cwd:Q||void 0}))}function q(Y){const re=h[0]?.machineId||p[0]?.machineId||"local-dev",ee=`new-${Date.now()}`;_e(re,ee,["claude"],Y)}const ge=h[0]?.machineId||p[0]?.machineId;return T.jsxs(T.Fragment,{children:[T.jsx("style",{children:`
        @import url('https://fonts.googleapis.com/css2?family=DM+Sans:wght@300;400;500;600&display=swap');
        * { box-sizing: border-box; }
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 4px; }
        .sidebar-btn:hover { background: ${c.bgHover} !important; color: ${c.textPrimary} !important; }
        .view-pill:hover { background: ${c.bgHover} !important; }
        .topbar-btn:hover { background: ${c.bgHover} !important; }
        @keyframes pulse { 0%,100%{opacity:1} 50%{opacity:0.4} }
        @keyframes slideIn { from{opacity:0;transform:translateX(-8px)} to{opacity:1;transform:translateX(0)} }
      `}),T.jsxs("div",{style:{display:"flex",height:"100vh",background:c.bgBase,color:c.textPrimary,fontFamily:c.fontSans,overflow:"hidden"},children:[T.jsxs("div",{style:{width:"240px",flexShrink:0,background:c.bgPanel,borderRight:`1px solid ${c.border}`,display:"flex",flexDirection:"column",animation:"slideIn 0.3s ease"},children:[T.jsxs("div",{style:{padding:"0.875rem 1rem",borderBottom:`1px solid ${c.border}`},children:[T.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.6rem"},children:[T.jsx("div",{style:{width:"26px",height:"26px",borderRadius:"6px",background:`linear-gradient(135deg, ${c.accent}, #818cf8)`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",flexShrink:0},children:""}),T.jsx("span",{style:{fontWeight:600,fontSize:"0.875rem",letterSpacing:"-0.01em"},children:"Claude Code"})]}),T.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:"5px",padding:"3px 8px",borderRadius:c.radiusPill,background:R?c.successDim:c.dangerDim,border:`1px solid ${R?"rgba(16,185,129,0.25)":"rgba(239,68,68,0.25)"}`,fontSize:"0.7rem",fontWeight:500,color:R?c.success:c.danger},children:[T.jsx("span",{style:{width:"5px",height:"5px",borderRadius:"50%",background:R?c.success:c.danger,animation:R?"none":"pulse 1.5s infinite",display:"inline-block"}}),R?ge||"":""]})]}),T.jsxs("div",{style:{padding:"0.5rem 0.75rem",borderBottom:`1px solid ${c.border}`,display:"flex",alignItems:"center",gap:"4px"},children:[T.jsx("span",{style:{flex:1,fontSize:"0.68rem",fontWeight:600,color:c.textMuted,letterSpacing:"0.06em",textTransform:"uppercase"},children:"Sessions"}),T.jsx("button",{className:"sidebar-btn",onClick:()=>he(Y=>!Y),title:"",style:{background:X?c.accentDim:"none",border:`1px solid ${X?c.borderAccent:"transparent"}`,color:X?c.accent:c.textMuted,borderRadius:c.radiusSm,cursor:"pointer",padding:"3px 7px",fontSize:"0.8rem",transition:"all 0.15s"},children:""}),T.jsx("button",{className:"sidebar-btn",onClick:()=>V(!0),title:"",style:{background:"none",border:"1px solid transparent",color:c.textMuted,borderRadius:c.radiusSm,cursor:"pointer",padding:"3px 6px",fontSize:"0.78rem",transition:"all 0.15s"},children:""}),T.jsx("button",{className:"sidebar-btn",onClick:i,title:"",style:{background:"none",border:"1px solid transparent",color:c.textMuted,borderRadius:c.radiusSm,cursor:"pointer",padding:"3px 6px",fontSize:"0.72rem",transition:"all 0.15s"},children:""})]}),X&&T.jsx(Jw,{ws:de.current,machineId:h[0]?.machineId||"local",historySessions:_,onLaunch:q,onClose:()=>he(!1)}),T.jsx(Qw,{sessions:h,activeSessions:p,historySessions:_,active:b,onOpen:_e})]}),T.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[T.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end",padding:"6px 12px",borderBottom:`1px solid ${c.border}`,background:c.bgPanel,flexShrink:0,gap:"4px"},children:[T.jsx("button",{className:"view-pill",onClick:a,title:n?"":"",style:{background:"none",border:"1px solid transparent",color:c.textMuted,borderRadius:c.radiusPill,cursor:"pointer",padding:"3px 10px",fontSize:"0.85rem",transition:"all 0.15s",marginRight:"4px"},children:n?"":""}),["terminal","pixel"].map(Y=>T.jsx("button",{className:"view-pill",onClick:()=>ue(Y),style:{background:te===Y?c.bgHover:"none",border:`1px solid ${te===Y?c.border:"transparent"}`,color:te===Y?c.textPrimary:c.textMuted,borderRadius:c.radiusPill,cursor:"pointer",padding:"3px 12px",fontSize:"0.72rem",fontWeight:500,fontFamily:c.fontSans,transition:"all 0.15s"},children:Y==="terminal"?" ":" "},Y))]}),te==="pixel"?T.jsx(KE,{ws:de.current,activeSessions:p}):b?T.jsx(Kw,{machineId:b.machineId,sessionId:b.sessionId,ws:de.current},`${b.machineId}-${b.sessionId}`):T.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:"0.75rem",color:c.textMuted},children:[T.jsx("div",{style:{width:"56px",height:"56px",borderRadius:"14px",background:c.bgCard,border:`1px solid ${c.border}`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.5rem",marginBottom:"0.25rem"},children:""}),T.jsx("div",{style:{fontSize:"0.9rem",color:c.textSecondary,fontWeight:500},children:" Session "}),T.jsx("div",{style:{fontSize:"0.78rem",color:c.textMuted},children:"  "})]})]})]}),k&&T.jsx(Gw,{token:t,onClose:()=>V(!1)})]})}function XE(){const[t,i]=K.useState(localStorage.getItem("token")),[n,a]=K.useState("login"),[c,h]=K.useState(localStorage.getItem("theme")!=="light");function d(){const y=!c;h(y),localStorage.setItem("theme",y?"dark":"light")}function p(y){localStorage.setItem("token",y),i(y)}function m(){localStorage.removeItem("token"),i(null),a("login")}const _=Db(c);return T.jsx(Bv.Provider,{value:_,children:t?T.jsx(GE,{token:t,onLogout:m,isDark:c,onToggleTheme:d}):n==="register"?T.jsx(Lb,{onLogin:p,onBack:()=>a("login")}):T.jsx(Mb,{onLogin:p,onRegister:()=>a("register"),isDark:c,onToggleTheme:d})})}Ab.createRoot(document.getElementById("root")).render(T.jsx(K.StrictMode,{children:T.jsx(XE,{})}));
